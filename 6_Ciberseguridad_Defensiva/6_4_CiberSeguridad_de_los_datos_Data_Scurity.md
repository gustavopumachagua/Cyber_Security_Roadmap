| **Inicio**         | **atr√°s 3**                                          | **Siguiente 5**                                                                           |
| ------------------ | ---------------------------------------------------- | ----------------------------------------------------------------------------------------- |
| [üè†](../README.md) | [‚è™](./6_3_Criptografia_moderna_y_Ciberseguridad.md) | [‚è©](./6_5_CiberSeguridad_de_las_Comunicaciones_y_redes_informaticas_Network_Security.md) |

---

## **√çndice**

| Temario                                                                                                                                                 |
| ------------------------------------------------------------------------------------------------------------------------------------------------------- |
| [433. Seguridad de los datos](#433-seguridad-de-los-datos)                                                                                              |
| [434. Cyber Security Framework (CSF)](#434-cyber-security-framework-csf)                                                                                |
| [435. Integridad de los datos](#435-integridad-de-los-datos)                                                                                            |
| [436. Funciones Hash](#436-funciones-hash)                                                                                                              |
| [437. Aplicaciones de las funciones Hash](#437-aplicaciones-de-las-funciones-hash)                                                                      |
| [438. Funciones Hash modernas](#438-funciones-hash-modernas)                                                                                            |
| [439. Funciones Hash modernas en la pr√°ctica](#439-funciones-hash-modernas-en-la-pr√°ctica)                                                              |
| [440. Funcionamiento de SHA-2](#440-funcionamiento-de-sha-2)                                                                                            |
| [441. Caso pr√°ctico: Hashing de contrase√±as en BBDD](#441-caso-pr√°ctico-hashing-de-contrase√±as-en-bbdd)                                                 |
| [442. Ataques a funciones Hash (Rainbow tables)](#442-ataques-a-funciones-hash-rainbow-tables)                                                          |
| [443. Checksums](#443-checksums)                                                                                                                        |
| [444. Checksums en la pr√°ctica: CyberChef](#444-checksums-en-la-pr√°ctica-cyberchef)                                                                     |
| [445. Error Correcting Codes (ECC)](#445-error-correcting-codes-ecc)                                                                                    |
| [446. Funcionamiento Hamming Codes](#446-funcionamiento-hamming-codes)                                                                                  |
| [447. Error Correcting Codes en la pr√°ctica](#447-error-correcting-codes-en-la-pr√°ctica)                                                                |
| [448. Message Authentication Code (MAC)](#448-message-authentication-code-mac)                                                                          |
| [449. CBC-MAC](#449-cbc-mac)                                                                                                                            |
| [450. ¬øC√≥mo construir√≠as una funci√≥n MAC con una funci√≥n HASH?](#450-c√≥mo-construir√≠as-una-funci√≥n-mac-con-una-funci√≥n-hash)                            |
| [451. HMAC](#451-hmac)                                                                                                                                  |
| [452. No repudio y HMACs](#452-no-repudio-y-hmacs)                                                                                                      |
| [453. Confidencialidad, integridad y autenticaci√≥n (aes-256-cbc-hmac-sha256)](#453-confidencialidad-integridad-y-autenticaci√≥n-aes-256-cbc-hmac-sha256) |
| [454. Modo de operaci√≥n GCM](#454-modo-de-operaci√≥n-gcm)                                                                                                |
| [455. Protecci√≥n de los datos](#455-protecci√≥n-de-los-datos)                                                                                            |
| [456. Ampliaci√≥n del entorno: Instalaci√≥n Windows 11](#456-ampliaci√≥n-del-entorno-instalaci√≥n-windows-11)                                               |
| [457. Clasificaci√≥n de la informaci√≥n: GDPR, PCI-DSS, HIPAA](#457-clasificaci√≥n-de-la-informaci√≥n-gdpr-pci-dss-hipaa)                                   |
| [458. ISO 27001 y 27002](#458-iso-27001-y-27002)                                                                                                        |
| [459. Data Loss Prevention (DLP)](#459-data-loss-prevention-dlp)                                                                                        |
| [460. DLP Profesional/Empresarial](#460-dlp-profesionalempresarial)                                                                                     |
| [461. Cuadrante m√°gico de Gartner](#461-cuadrante-m√°gico-de-gartner)                                                                                    |
| [462. Information Rights Management (IRM)](#462-information-rights-management-irm)                                                                      |
| [463. IRM Profesional/Empresarial](#463-irm-profesionalempresarial)                                                                                     |
| [464. Full Disk Encryption](#464-full-disk-encryption)                                                                                                  |
| [465. Full Disk Encryption con Bitlocker](#465-full-disk-encryption-con-bitlocker)                                                                      |
| [466. Full Disk Encryption en Linux (LUKS)](#466-full-disk-encryption-en-linux-luks)                                                                    |
| [467. Autopsy con full disk encryption (Bitlocker)](#467-autopsy-con-full-disk-encryption-bitlocker)                                                    |
| [468. Tokenizaci√≥n](#468-tokenizaci√≥n)                                                                                                                  |
| [469. Disponibilidad y Ciberresiliencia](#469-disponibilidad-y-ciberresiliencia)                                                                        |
| [470. Ciberresiliencia](#470-ciberresiliencia)                                                                                                          |
| [471. Backups (Copias de seguridad)](#471-backups-copias-de-seguridad)                                                                                  |
| [472. Tipos de Backup: Completo, Incremental](#472-tipos-de-backup-completo-incremental)                                                                |
| [473. Tipos de Backups: Diferencial, Incremental inverso](#473-tipos-de-backups-diferencial-incremental-inverso)                                        |
| [474. ¬øCu√°ndo utilizar√≠as cada tipo de backup?](#474-cu√°ndo-utilizar√≠as-cada-tipo-de-backup)                                                            |
| [475. Caso pr√°ctico: Backup Profesional/Empresarial](#475-caso-pr√°ctico-backup-profesionalempresarial)                                                  |
| [476. Consideraciones de seguridad al almacenar Backups](#476-consideraciones-de-seguridad-al-almacenar-backups)                                        |
| [477. Inventariado de activos: CMDB](#477-inventariado-de-activos-cmdb)                                                                                 |
| [478. Almacenamiento de claves: TPM y HSM](#478-almacenamiento-de-claves-tpm-y-hsm)                                                                     |

---

# **CiberSeguridad de los datos (Data Scurity)**

## **433. Seguridad de los datos**

### ‚úÖ ¬øQu√© es la Seguridad de los Datos?

La **seguridad de los datos** es el conjunto de pr√°cticas, herramientas y medidas que se aplican para **proteger los datos** contra accesos no autorizados, corrupci√≥n, p√©rdida o robo.

#### üéØ Objetivo:

Evitar que los datos sensibles (como contrase√±as, n√∫meros de tarjetas, historial m√©dico, etc.) caigan en manos equivocadas o sean alterados.

---

### üîê Principios clave de la Seguridad de los Datos

1. **Confidencialidad**

   Solo las personas autorizadas pueden acceder a los datos.
   _Ejemplo: Las historias cl√≠nicas solo pueden verlas los doctores._

2. **Integridad**

   Los datos deben mantenerse completos y sin alteraciones no autorizadas.
   _Ejemplo: Que no se cambie el precio de un producto en una tienda online sin permisos._

3. **Disponibilidad**

   Los datos deben estar accesibles cuando se necesiten.
   _Ejemplo: Que un usuario pueda acceder a su cuenta bancaria sin fallas._

---

### üß∞ ¬øC√≥mo se garantiza la Seguridad de los Datos?

Se puede garantizar aplicando una **combinaci√≥n de tecnolog√≠as, pol√≠ticas y buenas pr√°cticas**.

### A. Cifrado de datos (Encryptaci√≥n)

Transforma la informaci√≥n en un formato ilegible sin una clave.

```plaintext
Original: hola123
Cifrado: 7g#JHD@82ksd
```

üìå _Se usa para proteger contrase√±as, datos de tarjetas, correos electr√≥nicos, etc._

### B. Control de acceso (Autenticaci√≥n y autorizaci√≥n)

- **Autenticaci√≥n:** ¬øQui√©n eres? (Ej: usuario + contrase√±a, huella, 2FA)
- **Autorizaci√≥n:** ¬øQu√© puedes hacer? (Ej: solo los administradores pueden borrar usuarios)

### C. Copias de seguridad (Backups)

Permiten recuperar la informaci√≥n ante desastres, errores o ataques (como ransomware).

### D. Firewalls y antivirus

Protegen los sistemas de accesos externos no autorizados o software malicioso.

### E. Normativas legales

Como el **GDPR (Europa)** o la **Ley de Protecci√≥n de Datos Personales (Per√∫)**, que exigen medidas m√≠nimas para proteger los datos personales.

---

### üõ†Ô∏è ¬øC√≥mo se implementa la Seguridad de los Datos?

Depende del entorno. Te explico con ejemplos:

---

### üß© Ejemplo 1: En una base de datos (MySQL o SQL Server)

#### A. Cifrado de contrase√±as al guardar usuarios:

```sql
-- Guardar una contrase√±a cifrada con SHA2
INSERT INTO usuarios (nombre, email, contrase√±a)
VALUES ('Ana', 'ana@email.com', SHA2('clave123', 256));
```

> ‚úÖ Esto evita guardar contrase√±as en texto plano.

---

#### B. Control de acceso por roles:

```sql
-- Crear un rol de solo lectura
CREATE ROLE solo_lectura;
GRANT SELECT ON base_de_datos.* TO 'usuario_lectura'@'localhost';
```

> ‚úÖ As√≠ se evita que un usuario pueda modificar datos sin autorizaci√≥n.

---

### üß© Ejemplo 2: En un backend con Node.js

Usando bcrypt para cifrar contrase√±as antes de guardarlas:

```js
const bcrypt = require("bcrypt");
const contrase√±a = "secreta123";

bcrypt.hash(contrase√±a, 10, (err, hash) => {
  console.log("Contrase√±a cifrada:", hash);
});
```

> ‚úÖ Aunque alguien robe la base de datos, no podr√° ver las contrase√±as reales.

---

### üß© Ejemplo 3: En un sistema web con autenticaci√≥n

- Usas **JWT** (JSON Web Tokens) para validar que el usuario est√° autenticado.
- Los endpoints protegidos solo pueden ser accedidos si el token es v√°lido.

```js
// Middleware de verificaci√≥n en Express.js
function autenticarToken(req, res, next) {
  const token = req.headers["authorization"];
  if (!token) return res.sendStatus(403);

  jwt.verify(token, "clave_secreta", (err, user) => {
    if (err) return res.sendStatus(403);
    req.user = user;
    next();
  });
}
```

> ‚úÖ Asegura que solo usuarios logueados accedan a rutas privadas.

---

### üß™ Ejemplo completo: Seguridad de datos en un sistema de usuarios

Supongamos que tienes una API para registro y login.

#### 1. Registro de usuario

```js
// Express + MongoDB + bcrypt
app.post("/registro", async (req, res) => {
  const { email, password } = req.body;
  const hash = await bcrypt.hash(password, 10);
  const nuevoUsuario = new Usuario({ email, password: hash });
  await nuevoUsuario.save();
  res.send("Usuario registrado con seguridad");
});
```

#### 2. Login de usuario

```js
app.post("/login", async (req, res) => {
  const { email, password } = req.body;
  const usuario = await Usuario.findOne({ email });

  if (!usuario) return res.status(404).send("No existe el usuario");

  const valido = await bcrypt.compare(password, usuario.password);
  if (!valido) return res.status(401).send("Contrase√±a incorrecta");

  const token = jwt.sign({ id: usuario._id }, "clave_secreta");
  res.json({ token });
});
```

#### 3. Ruta protegida

```js
app.get("/perfil", autenticarToken, async (req, res) => {
  const usuario = await Usuario.findById(req.user.id);
  res.json({ email: usuario.email });
});
```

> ‚úÖ Este sistema:

- Cifra las contrase√±as (Confidencialidad)
- Usa autenticaci√≥n por token (Control de acceso)
- Protege las rutas (Disponibilidad y control)
- Solo da acceso a quien est√© autenticado (Autorizaci√≥n)

---

### ‚úÖ Conclusi√≥n

La **Seguridad de los Datos** es vital en cualquier sistema o aplicaci√≥n. Su implementaci√≥n se basa en:

- **Cifrar informaci√≥n sensible**
- **Restringir accesos**
- **Guardar respaldos**
- **Seguir buenas pr√°cticas de desarrollo seguro**
- **Cumplir con normativas legales**

---

[üîº](#√≠ndice)

---

## **434. Cyber Security Framework (CSF)**

![Cyber Security Framework](../img/6_Ciberseguridad_Defensiva/Cybersecurity_Framework.png "Cyber Security Framework")

### üîê ¬øQu√© es el Cybersecurity Framework (CSF)?

El **Cybersecurity Framework** (CSF) es una gu√≠a creada por el **NIST** (National Institute of Standards and Technology) de EE.UU., que ayuda a **organizaciones de cualquier tama√±o** a **gestionar y reducir riesgos de ciberseguridad**.

---

### üéØ ¬øPara qu√© sirve?

- Ayuda a **identificar vulnerabilidades**.
- Establece un **lenguaje com√∫n** entre equipos t√©cnicos y de gesti√≥n.
- Define pasos para **proteger, detectar y responder** ante ciberataques.
- Es flexible: se adapta a cualquier organizaci√≥n, sector o pa√≠s.

---

### üß± Componentes del Cybersecurity Framework

El CSF se basa en 3 partes principales:

---

#### 1. **Funciones centrales (Core Functions)**

Son 5 funciones que definen el ciclo completo de la ciberseguridad:

| Funci√≥n      | ¬øQu√© hace?                         | Ejemplo sencillo                             |
| ------------ | ---------------------------------- | -------------------------------------------- |
| **IDENTIFY** | Entender qu√© activos y riesgos hay | Saber qu√© equipos tienes y qu√© datos manejas |
| **PROTECT**  | Implementar defensas               | Usar antivirus, firewalls, cifrado, backups  |
| **DETECT**   | Encontrar incidentes r√°pidamente   | Sistemas que detectan accesos no autorizados |
| **RESPOND**  | Actuar ante incidentes             | Tener un plan cuando hay un ataque           |
| **RECOVER**  | Volver a la normalidad             | Restaurar backups, analizar lo que ocurri√≥   |

---

#### 2. **Categor√≠as y Subcategor√≠as**

Cada funci√≥n tiene **categor√≠as** (como "gesti√≥n de activos") y subcategor√≠as (como "tener inventario de hardware y software").

Ejemplo:

- IDENTIFY ‚Üí Asset Management (ID.AM)

  - ID.AM-1: Los activos f√≠sicos est√°n inventariados
  - ID.AM-2: Los activos de software est√°n identificados

---

#### 3. **Tiers de implementaci√≥n (Niveles de madurez)**

Define cu√°n avanzado est√° tu programa de ciberseguridad:

| Nivel | Nombre        | ¬øQu√© tan preparado est√°s?              |
| ----- | ------------- | -------------------------------------- |
| 1     | Partial       | Reacci√≥n improvisada                   |
| 2     | Risk Informed | Algunas pol√≠ticas pero no sistem√°ticas |
| 3     | Repeatable    | Pol√≠ticas documentadas y repetibles    |
| 4     | Adaptive      | Monitoreo y mejoras continuas          |

---

### üíª ¬øC√≥mo se _instala_ o implementa el CSF?

No se "instala" como un programa, sino que se **implementa como una pol√≠tica y proceso continuo** en una organizaci√≥n.

---

### üß≠ Pasos para aplicar el CSF en una empresa o proyecto:

#### 1. **Entender el entorno**

- ¬øQu√© activos tengo?
- ¬øQu√© servicios manejo?
- ¬øQu√© tipo de datos manejo (personales, financieros, etc.)?

#### 2. **Evaluar el estado actual**

- ¬øQu√© tengo protegido?
- ¬øQu√© medidas de detecci√≥n existen?
- ¬øHay backups? ¬øHay pol√≠ticas?

#### 3. **Establecer el estado deseado**

- Quiero tener detecci√≥n temprana de amenazas.
- Quiero pol√≠ticas claras de acceso.
- Quiero que todos mis usuarios tengan autenticaci√≥n de 2 pasos.

#### 4. **Crear un plan de acci√≥n**

- Implementar firewalls.
- Hacer inventario de activos.
- Capacitar al personal.
- Configurar copias de seguridad autom√°ticas.

#### 5. **Medir y mejorar continuamente**

- Revisar alertas.
- Evaluar incidentes.
- Actualizar pol√≠ticas.

---

### ‚úÖ Ejemplo completo: Aplicaci√≥n del CSF en una peque√±a empresa de e-commerce

Supongamos que tienes una tienda online que vende productos tecnol√≥gicos.

#### üöÄ Objetivo:

Implementar el Cybersecurity Framework para proteger la web, base de datos y a los clientes.

---

### üîé 1. IDENTIFY (Identificar)

**Acciones:**

- Crear un inventario de servidores, laptops y celulares usados por empleados.
- Identificar los datos sensibles: contrase√±as, correos, tarjetas.
- Evaluar riesgos: ¬øqu√© pasar√≠a si un atacante borra la base de datos?

---

### üîê 2. PROTECT (Proteger)

**Acciones:**

- Activar el cifrado de contrase√±as con bcrypt en Node.js.
- Instalar un firewall en el servidor.
- Usar HTTPS en todo el sitio web.
- Habilitar 2FA en el panel de administraci√≥n.
- Configurar backups autom√°ticos diarios de la base de datos.

---

### üß≠ 3. DETECT (Detectar)

**Acciones:**

- Instalar un sistema de detecci√≥n de intrusos como **Fail2Ban** o **Wazuh**.
- Configurar alertas por correo si alguien intenta m√∫ltiples logins fallidos.
- Revisar logs de acceso una vez por semana.

---

### ‚ö†Ô∏è 4. RESPOND (Responder)

**Acciones:**

- Crear un plan de respuesta ante incidentes:

  - ¬øQui√©n act√∫a si se detecta una brecha?
  - ¬øC√≥mo se informa a los clientes?
  - ¬øQu√© sistemas se apagan?

- Tener contacto directo con un proveedor de hosting para cortar acceso r√°pidamente.

---

### ‚ôªÔ∏è 5. RECOVER (Recuperar)

**Acciones:**

- Probar restaurar una copia de seguridad 1 vez al mes.
- Hacer un informe de qu√© ocurri√≥ si hubo un incidente.
- Implementar mejoras basadas en lo aprendido.

---

### üìä Resultado

| Funci√≥n  | Estado actual                    |
| -------- | -------------------------------- |
| Identify | ‚úÖ Inventario hecho              |
| Protect  | ‚úÖ Cifrado, 2FA, backups         |
| Detect   | ‚úÖ Logs y alertas                |
| Respond  | ‚úÖ Plan de respuesta escrito     |
| Recover  | ‚úÖ Backups probados mensualmente |

> üéâ Esta empresa ahora tiene un sistema robusto y documentado basado en el **Cybersecurity Framework del NIST**.

---

### üß† Conclusi√≥n

| Pregunta           | Respuesta                                                 |
| ------------------ | --------------------------------------------------------- |
| ¬øQu√© es?           | Una gu√≠a estructurada para mejorar la ciberseguridad.     |
| ¬øSe instala?       | No como software, se **implementa como proceso**.         |
| ¬øEs flexible?      | S√≠, sirve para cualquier empresa o proyecto.              |
| ¬øQu√© partes tiene? | 5 funciones: Identify, Protect, Detect, Respond, Recover. |
| ¬øD√≥nde se usa?     | En gobiernos, empresas privadas, ONGs, hospitales, etc.   |

---

[üîº](#√≠ndice)

---

## **435. Integridad de los datos**

### üß© ¬øQu√© es la **Integridad de los Datos**?

La **integridad de los datos** es el principio que garantiza que la informaci√≥n almacenada y procesada en un sistema **es precisa, consistente y confiable a lo largo del tiempo**.

> üéØ En pocas palabras: que los datos **no se corrompan**, **no se alteren sin permiso** y **se mantengan correctos** durante todo su ciclo de vida.

---

### üîé Ejemplos sencillos de p√©rdida de integridad:

1. Alguien cambia la nota de un alumno sin autorizaci√≥n.
2. Un n√∫mero de DNI est√° mal escrito (por ejemplo, con letras).
3. Se registra una venta con fecha en el a√±o 3025.
4. Una transacci√≥n bancaria se graba dos veces.

---

### üìã Tipos de Integridad de los Datos

| Tipo                               | ¬øQu√© asegura?                                             | Ejemplo sencillo                                            |
| ---------------------------------- | --------------------------------------------------------- | ----------------------------------------------------------- |
| **Integridad de entidad**          | Que cada fila en una tabla tenga una identidad √∫nica.     | Cada usuario tiene un `id` √∫nico, no se repite.             |
| **Integridad referencial**         | Que las relaciones entre tablas sean v√°lidas.             | Un pedido debe tener un cliente que exista.                 |
| **Integridad de dominio**          | Que los valores est√©n dentro de un rango o tipo aceptado. | El campo "edad" solo acepta n√∫meros positivos.              |
| **Integridad l√≥gica o de negocio** | Que se cumplan reglas espec√≠ficas del negocio.            | Un producto no puede tener m√°s ventas que stock disponible. |

---

### üõ†Ô∏è ¬øC√≥mo se **implementa** la integridad de los datos?

#### ‚ö†Ô∏è No se "instala" como una app, sino que se asegura usando:

- Reglas de validaci√≥n en **bases de datos**
- Restricciones en el **backend**
- Validaciones en el **frontend**
- Controles de acceso
- Verificaciones autom√°ticas y manuales

---

### üß± Ejemplos pr√°cticos por nivel:

#### üî∏ 1. En una base de datos (SQL)

```sql
-- Integridad de entidad: clave primaria
CREATE TABLE usuarios (
  id INT PRIMARY KEY,
  nombre VARCHAR(100)
);

-- Integridad de dominio: restricci√≥n de edad
ALTER TABLE usuarios
ADD CONSTRAINT edad_valida CHECK (edad >= 0 AND edad <= 120);

-- Integridad referencial: pedidos deben tener un cliente v√°lido
CREATE TABLE pedidos (
  id INT PRIMARY KEY,
  id_cliente INT,
  FOREIGN KEY (id_cliente) REFERENCES usuarios(id)
);
```

‚úÖ As√≠ te aseguras que:

- No haya dos usuarios con el mismo ID.
- No se ingresen edades inv√°lidas.
- No se registre un pedido para un cliente inexistente.

---

#### üî∏ 2. En un backend (Node.js + MongoDB)

```js
// Validaci√≥n con Mongoose (MongoDB)
const pedidoSchema = new mongoose.Schema({
  cliente: {
    type: mongoose.Schema.Types.ObjectId,
    ref: "Usuario",
    required: true,
  },
  total: { type: Number, min: 0 },
  fecha: { type: Date, default: Date.now },
});
```

‚úÖ Aqu√≠ se asegura que:

- Un pedido tenga un cliente real.
- El total no sea negativo.
- La fecha se establezca correctamente.

---

#### üî∏ 3. En el frontend (React o HTML/JS)

```html
<input type="number" min="0" max="120" placeholder="Edad" />
```

‚úÖ El usuario no podr√° escribir una edad fuera de rango (prevenci√≥n temprana).

---

### üîÑ Otras formas de asegurar integridad:

| Estrategia              | ¬øC√≥mo ayuda?                                                |
| ----------------------- | ----------------------------------------------------------- |
| **Triggers**            | Detectan y bloquean cambios inv√°lidos en BD.                |
| **Checksums / Hashing** | Detectan si los datos fueron alterados sin permiso.         |
| **Backups y registros** | Permiten restaurar informaci√≥n si se corrompe.              |
| **Control de acceso**   | Evitan que usuarios no autorizados alteren datos sensibles. |

---

### ‚úÖ Ejemplo completo: Sistema de registro de estudiantes

#### üß© Supongamos que desarrollas un sistema web para una universidad.

##### üéØ Requisitos:

- Cada estudiante debe tener un c√≥digo √∫nico.
- La edad debe estar entre 15 y 100 a√±os.
- Un curso no puede tener m√°s de 30 alumnos.
- Un estudiante no puede matricularse dos veces al mismo curso.

---

### üî∏ 1. Base de datos (SQL)

```sql
CREATE TABLE estudiantes (
  id INT PRIMARY KEY,
  nombre VARCHAR(100),
  edad INT CHECK (edad >= 15 AND edad <= 100)
);

CREATE TABLE cursos (
  id INT PRIMARY KEY,
  nombre VARCHAR(100),
  cupo_maximo INT DEFAULT 30
);

CREATE TABLE matriculas (
  id_estudiante INT,
  id_curso INT,
  PRIMARY KEY (id_estudiante, id_curso),
  FOREIGN KEY (id_estudiante) REFERENCES estudiantes(id),
  FOREIGN KEY (id_curso) REFERENCES cursos(id)
);
```

‚úÖ Aqu√≠:

- No se pueden duplicar estudiantes ni matr√≠culas.
- Se evita inscribir a estudiantes con edades no v√°lidas.

---

### üî∏ 2. Backend (Node.js)

```js
// Validaci√≥n l√≥gica en backend
app.post("/matricular", async (req, res) => {
  const { idEstudiante, idCurso } = req.body;

  // Verificar si ya est√° matriculado
  const yaExiste = await Matricula.findOne({ idEstudiante, idCurso });
  if (yaExiste) return res.status(400).send("Ya est√° matriculado.");

  // Verificar el l√≠mite del curso
  const cantidad = await Matricula.countDocuments({ idCurso });
  if (cantidad >= 30) return res.status(400).send("Curso lleno.");

  await Matricula.create({ idEstudiante, idCurso });
  res.send("Matriculaci√≥n exitosa");
});
```

---

### üî∏ 3. Frontend (React)

```jsx
<input type="number" min={15} max={100} placeholder="Edad del estudiante" />
```

---

### üìå Conclusi√≥n

| Pregunta               | Respuesta                                                    |
| ---------------------- | ------------------------------------------------------------ |
| ¬øQu√© es?               | Es mantener los datos correctos, sin alteraciones indebidas. |
| ¬øPor qu√© importa?      | Evita errores, fraudes, corrupci√≥n o inconsistencias.        |
| ¬øC√≥mo se implementa?   | Usando validaciones en BD, backend y frontend.               |
| ¬øSe puede automatizar? | S√≠, con triggers, reglas, y validadores.                     |
| ¬øQu√© protege?          | Veracidad y coherencia de la informaci√≥n.                    |

---

[üîº](#√≠ndice)

---

## **436. Funciones Hash**

### üîê ¬øQu√© es una Funci√≥n Hash?

Una **funci√≥n hash** es un **algoritmo matem√°tico** que toma una entrada (como un texto, archivo o contrase√±a) y genera una **salida √∫nica y de longitud fija** (el "hash").

> üéØ El objetivo principal es **representar los datos de forma segura y √∫nica**.

---

### üì¶ Caracter√≠sticas de una funci√≥n hash

| Caracter√≠stica    | Explicaci√≥n                                                                     |
| ----------------- | ------------------------------------------------------------------------------- |
| üîÅ Determin√≠stica | La misma entrada siempre genera la misma salida.                                |
| üî¢ Longitud fija  | Sin importar el tama√±o del dato original, el hash siempre tiene el mismo largo. |
| üîê Irreversible   | No se puede obtener la entrada original desde el hash.                          |
| üßä √önica          | Dos entradas diferentes no deber√≠an dar el mismo hash (colisi√≥n).               |
| ‚ö° R√°pida         | Debe calcularse r√°pidamente.                                                    |

---

### ‚ú® Ejemplo simple de funci√≥n hash

Supongamos que tenemos esta contrase√±a:

```plaintext
"gato123"
```

Y aplicamos una funci√≥n hash llamada SHA-256:

```plaintext
SHA-256("gato123") =
5e8ff9bf55ba3508199d22e984129be6... (64 caracteres hexadecimales)
```

Ahora almacenamos ese hash en la base de datos, **no la contrase√±a real**.

---

### üõ°Ô∏è ¬øPara qu√© se usan las funciones hash?

| Uso com√∫n                               | Ejemplo                                                      |
| --------------------------------------- | ------------------------------------------------------------ |
| ‚úîÔ∏è Almacenamiento seguro de contrase√±as | Cifrar contrase√±as antes de guardarlas en una base de datos. |
| ‚úîÔ∏è Verificaci√≥n de integridad           | Comprobar que un archivo no ha sido modificado.              |
| ‚úîÔ∏è Firmas digitales                     | Validar la autenticidad de mensajes o documentos.            |
| ‚úîÔ∏è Bloques de blockchain                | Identificar bloques y garantizar que no se han alterado.     |

---

### üß∞ Tipos de funciones hash comunes

| Nombre      | Longitud del hash        | Seguridad             | Uso actual                     |
| ----------- | ------------------------ | --------------------- | ------------------------------ |
| **MD5**     | 128 bits (32 caracteres) | ‚ùå Inseguro           | Solo para checksums            |
| **SHA-1**   | 160 bits (40 caracteres) | ‚ùå Inseguro           | Obsoleto                       |
| **SHA-256** | 256 bits (64 caracteres) | ‚úÖ Seguro             | Contrase√±as, blockchain        |
| **bcrypt**  | Variable + "sal"         | ‚úÖ Muy seguro         | Contrase√±as en sistemas reales |
| **Argon2**  | Variable                 | ‚úÖ Recomendado actual | Seguridad moderna avanzada     |

---

### ‚öôÔ∏è ¬øC√≥mo se **instala** o se usa una funci√≥n hash?

Depende del entorno. Aqu√≠ te explico 3 formas:

---

#### ‚úÖ 1. En JavaScript (Node.js)

Instala el m√≥dulo `bcrypt`:

```bash
npm install bcrypt
```

Uso:

```js
const bcrypt = require("bcrypt");

const password = "gato123";

bcrypt.hash(password, 10, (err, hash) => {
  console.log("Contrase√±a cifrada:", hash);
});
```

Verificaci√≥n:

```js
bcrypt.compare("gato123", hash, (err, result) => {
  if (result) {
    console.log("Coincide");
  } else {
    console.log("No coincide");
  }
});
```

---

#### ‚úÖ 2. En Python

Usando la biblioteca `hashlib` para SHA-256:

```python
import hashlib

mensaje = "gato123"
hash = hashlib.sha256(mensaje.encode()).hexdigest()

print("Hash SHA-256:", hash)
```

---

#### ‚úÖ 3. En SQL Server

Hash de una contrase√±a con SHA2_256:

```sql
SELECT HASHBYTES('SHA2_256', CONVERT(VARBINARY, 'gato123'));
```

---

### üîê ¬øQu√© es el "sal" (salt) en hashing?

El **"sal"** es un valor aleatorio que se agrega a la contrase√±a antes de aplicar el hash para evitar ataques de diccionario y rainbow tables.

> Ejemplo:

```plaintext
Contrase√±a: gato123
Sal: xz9#
Final: xz9#gato123 ‚Üí hash ‚Üí cifrado m√°s fuerte
```

Librer√≠as como **bcrypt** ya agregan el sal autom√°ticamente.

---

### ‚úÖ Ejemplo completo: Sistema de login con hash de contrase√±a

Vamos a construir un **peque√±o sistema de registro y login en Node.js** usando bcrypt para aplicar funciones hash.

---

#### üõ†Ô∏è Paso 1: Instalar dependencias

```bash
npm init -y
npm install express bcrypt body-parser
```

---

#### üß© Paso 2: C√≥digo

```js
// app.js
const express = require("express");
const bcrypt = require("bcrypt");
const bodyParser = require("body-parser");

const app = express();
app.use(bodyParser.json());

const usuarios = []; // Simula base de datos

// Registro
app.post("/registro", async (req, res) => {
  const { usuario, contrase√±a } = req.body;
  const hash = await bcrypt.hash(contrase√±a, 10);
  usuarios.push({ usuario, contrase√±a: hash });
  res.send("Usuario registrado con contrase√±a segura");
});

// Login
app.post("/login", async (req, res) => {
  const { usuario, contrase√±a } = req.body;
  const user = usuarios.find((u) => u.usuario === usuario);
  if (!user) return res.status(404).send("Usuario no encontrado");

  const coincide = await bcrypt.compare(contrase√±a, user.contrase√±a);
  if (!coincide) return res.status(401).send("Contrase√±a incorrecta");

  res.send("Login exitoso");
});

app.listen(3000, () => console.log("Servidor corriendo en puerto 3000"));
```

---

#### üì¶ Ejecuci√≥n

1. Corre el servidor:

   ```bash
   node app.js
   ```

2. Enviar POST a `/registro`:

```json
{
  "usuario": "gussdev",
  "contrase√±a": "gato123"
}
```

3. Enviar POST a `/login` con los mismos datos.

---

#### üîê ¬øQu√© pas√≥?

- Al registrarte, la contrase√±a **se convirti√≥ en un hash con bcrypt**.
- Se almacen√≥ el hash, **no la contrase√±a real**.
- Al iniciar sesi√≥n, se compara la contrase√±a ingresada con el hash almacenado.

‚úÖ Esto protege la seguridad incluso si la base de datos es robada.

---

### üß† Conclusi√≥n

| Pregunta            | Respuesta                                                                  |
| ------------------- | -------------------------------------------------------------------------- |
| ¬øQu√© es?            | Es una funci√≥n que convierte datos en un resumen cifrado √∫nico.            |
| ¬øPara qu√© sirve?    | Para proteger contrase√±as, verificar integridad, firmar digitalmente, etc. |
| ¬øSe puede revertir? | No. El hash no es reversible.                                              |
| ¬øQu√© tan segura es? | Depende del algoritmo (bcrypt, Argon2 = seguros).                          |
| ¬øD√≥nde se usa?      | Login de usuarios, blockchain, antivirus, base de datos.                   |

---

[üîº](#√≠ndice)

---

## **437. Aplicaciones de las funciones Hash**

### üß† ¬øQu√© son las funciones hash? (Resumen r√°pido)

Una **funci√≥n hash** transforma cualquier dato (texto, archivo, n√∫mero, etc.) en una **cadena √∫nica y de longitud fija** llamada **hash**. Esta cadena representa el contenido de forma segura.

> Ejemplo:

```plaintext
Entrada: "Gustavo123"
Hash SHA-256: 8b7df0...c5ad (64 caracteres)
```

---

### üéØ ¬øPara qu√© sirven las funciones hash?

Las funciones hash tienen muchas aplicaciones en inform√°tica, seguridad y desarrollo. Vamos a ver las principales:

---

### üîê 1. **Almacenamiento seguro de contrase√±as**

#### ‚úÖ ¬øQu√© problema resuelve?

Si guardas contrase√±as **en texto plano**, cualquiera que robe la base de datos podr√° verlas.

#### üéØ Soluci√≥n:

Hashear la contrase√±a y guardar **solo el hash**.

```js
// Node.js con bcrypt
const bcrypt = require("bcrypt");
const hash = await bcrypt.hash("Gato123", 10);
```

En la base de datos guardas:

```plaintext
usuario: gustavo
contrase√±a: $2b$10$Xkz...
```

---

### üßæ 2. **Verificaci√≥n de integridad de archivos**

#### ‚úÖ ¬øQu√© problema resuelve?

Cuando descargas un archivo, **puede corromperse o alterarse** por un atacante.

#### üéØ Soluci√≥n:

El autor publica un **hash oficial del archivo**. T√∫ comparas si el hash coincide despu√©s de descargarlo.

```bash
sha256sum archivo.zip
# ‚Üí debe dar el mismo hash que el original publicado
```

> Si los hashes **no coinciden**, el archivo fue modificado.

---

### üßë‚Äç‚öñÔ∏è 3. **Firmas digitales y certificados**

#### ‚úÖ ¬øQu√© problema resuelve?

Asegurar que un mensaje o documento **fue creado por alguien espec√≠fico** y **no ha sido alterado**.

#### üéØ Soluci√≥n:

Se genera un hash del mensaje, y luego se **firma ese hash** con una clave privada.

> El receptor puede verificar la firma usando la clave p√∫blica.

---

### üîê 4. **Verificaci√≥n de datos en bases de datos**

#### ‚úÖ ¬øQu√© problema resuelve?

Detectar si alg√∫n dato fue **modificado sin autorizaci√≥n**.

#### üéØ Soluci√≥n:

Guardar el hash de los registros cr√≠ticos. Si alguien cambia los datos, el nuevo hash no coincidir√°.

```sql
-- Guarda hash de nombre+apellido+fecha
SELECT HASHBYTES('SHA2_256', CONCAT(nombre, apellido, fecha_nac))
```

---

### üîó 5. **Blockchain y criptomonedas**

#### ‚úÖ ¬øQu√© problema resuelve?

Asegurar que los bloques en una cadena de bloques **no puedan modificarse**.

#### üéØ Soluci√≥n:

Cada bloque tiene un hash que depende del contenido del bloque anterior.

> Si alteras un bloque, todos los hashes siguientes **cambian**, rompiendo la cadena.

---

### üìä 6. **Indexaci√≥n r√°pida y estructuras como Hash Tables**

#### ‚úÖ ¬øQu√© problema resuelve?

Buscar datos de forma lenta en estructuras lineales (como listas).

#### üéØ Soluci√≥n:

Usar una funci√≥n hash para asignar una **posici√≥n directa** en memoria.

> Ejemplo: un diccionario usa hash para encontrar claves en milisegundos.

---

### ‚öôÔ∏è ¬øC√≥mo se _implementan_ las aplicaciones de funciones hash?

#### No se "instalan" como un programa, sino que se **usan con librer√≠as o herramientas** seg√∫n el entorno:

---

### üì¶ En Node.js (JavaScript)

```bash
npm install bcrypt crypto
```

```js
// Bcrypt para contrase√±as
const bcrypt = require("bcrypt");
const hash = await bcrypt.hash("Gato123", 10);

// SHA-256 para integridad
const crypto = require("crypto");
const hash2 = crypto.createHash("sha256").update("Hola mundo").digest("hex");
```

---

### üêç En Python

```python
import hashlib

mensaje = "gato123"
hash = hashlib.sha256(mensaje.encode()).hexdigest()
print("SHA-256:", hash)
```

---

### üßæ En l√≠nea de comandos (Linux)

```bash
sha256sum archivo.txt
```

---

### üõ¢Ô∏è En SQL Server

```sql
SELECT HASHBYTES('SHA2_256', CONVERT(VARBINARY, 'Gustavo123'));
```

---

### ‚úÖ Ejemplo completo: Sistema de registro/login y verificaci√≥n de integridad de archivo

Vamos a construir un mini proyecto con dos partes:

---

#### üß© Parte 1: Sistema de login con hash (Node.js + bcrypt)

```bash
npm init -y
npm install express bcrypt body-parser
```

```js
// app.js
const express = require("express");
const bcrypt = require("bcrypt");
const bodyParser = require("body-parser");

const app = express();
app.use(bodyParser.json());

const usuarios = [];

// Registro
app.post("/registro", async (req, res) => {
  const { usuario, contrase√±a } = req.body;
  const hash = await bcrypt.hash(contrase√±a, 10);
  usuarios.push({ usuario, contrase√±a: hash });
  res.send("Usuario registrado");
});

// Login
app.post("/login", async (req, res) => {
  const { usuario, contrase√±a } = req.body;
  const user = usuarios.find((u) => u.usuario === usuario);
  if (!user) return res.status(404).send("Usuario no encontrado");

  const valido = await bcrypt.compare(contrase√±a, user.contrase√±a);
  if (!valido) return res.status(401).send("Contrase√±a incorrecta");

  res.send("Login exitoso");
});

app.listen(3000, () => console.log("Servidor en puerto 3000"));
```

---

#### üß© Parte 2: Verificaci√≥n de integridad de archivo

```js
const fs = require("fs");
const crypto = require("crypto");

const archivo = fs.readFileSync("archivo.txt");
const hash = crypto.createHash("sha256").update(archivo).digest("hex");

console.log("Hash del archivo:", hash);
```

> ‚úÖ Puedes usar esto para verificar si el archivo `archivo.txt` ha sido alterado.

---

### üìå Conclusi√≥n

| Aplicaci√≥n     | ¬øQu√© permite?                   |
| -------------- | ------------------------------- |
| Contrase√±as    | Guardar sin exponerlas.         |
| Archivos       | Verificar integridad.           |
| Blockchain     | Proteger la cadena de datos.    |
| Firmas         | Garantizar autenticidad.        |
| Bases de datos | Validar que no hubo alteraci√≥n. |

---

[üîº](#√≠ndice)

---

## **438. Funciones Hash modernas**

### üîê ¬øQu√© son las funciones hash modernas?

Las **funciones hash modernas** son algoritmos criptogr√°ficos **m√°s seguros y resistentes a ataques actuales** que las funciones hash tradicionales (como MD5 o SHA-1).
Estas se utilizan para proteger datos sensibles, especialmente **contrase√±as** y **autenticaci√≥n** en sistemas modernos.

---

### üéØ Objetivo:

Evitar que un atacante:

- Obtenga las contrase√±as reales si roba la base de datos.
- Use ataques de diccionario o fuerza bruta para encontrar las claves.

---

### üß± ¬øQu√© las hace modernas?

| Caracter√≠stica                            | Explicaci√≥n                                                          |
| ----------------------------------------- | -------------------------------------------------------------------- |
| ‚úÖ **Incluyen "sal" aleatorio**           | Se a√±ade un valor √∫nico a cada entrada antes de hashearla.           |
| üïí **Son lentas a prop√≥sito**             | Esto dificulta los ataques automatizados por fuerza bruta.           |
| üîÅ **Permiten configurar la complejidad** | Puedes ajustar el "costo" o "n√∫mero de rondas" del c√°lculo del hash. |
| üîê **Dise√±adas para contrase√±as**         | Est√°n hechas espec√≠ficamente para autenticaci√≥n segura de usuarios.  |

---

### üß¨ ¬øCu√°les son las funciones hash modernas m√°s usadas?

| Funci√≥n    | Ventajas                                                      | Uso com√∫n                  |
| ---------- | ------------------------------------------------------------- | -------------------------- |
| **bcrypt** | Amplio soporte, configurable, incluye sal                     | Login de usuarios, APIs    |
| **scrypt** | M√°s resistente a hardware especializado (ASICs)               | Seguridad extra alta       |
| **Argon2** | üèÜ Ganador del PHC (Password Hashing Competition), muy seguro | Recomendado en apps nuevas |

---

### ‚öôÔ∏è ¬øC√≥mo se _instalan_ o se usan?

No se instalan solas, sino que se implementan usando **librer√≠as o m√≥dulos** disponibles para distintos lenguajes de programaci√≥n.

---

#### ‚úÖ En Node.js (JavaScript)

Instala `bcrypt`:

```bash
npm install bcrypt
```

Uso:

```js
const bcrypt = require("bcrypt");

const contrase√±a = "gato123";
const hash = await bcrypt.hash(contrase√±a, 10); // 10 es el "salt rounds"
console.log("Contrase√±a cifrada:", hash);
```

Verificaci√≥n:

```js
const valido = await bcrypt.compare("gato123", hash);
console.log("¬øContrase√±a v√°lida?", valido);
```

---

### ‚úÖ En Python

Con `argon2-cffi`:

```bash
pip install argon2-cffi
```

Uso:

```python
from argon2 import PasswordHasher

ph = PasswordHasher()
hash = ph.hash("gato123")

print("Contrase√±a cifrada:", hash)
print("Verificaci√≥n:", ph.verify(hash, "gato123"))  # Devuelve True
```

---

### ‚úÖ En PHP

PHP tiene `password_hash()` con bcrypt incorporado:

```php
$hash = password_hash("gato123", PASSWORD_BCRYPT);
if (password_verify("gato123", $hash)) {
  echo "Contrase√±a v√°lida";
}
```

---

### ‚úÖ En SQL Server

SQL Server no soporta funciones modernas directamente (solo SHA2), as√≠ que debes hacerlo desde tu aplicaci√≥n (backend).

---

### üí£ ¬øPor qu√© no usar MD5 o SHA-1?

| Funci√≥n antigua | ¬øPor qu√© ya no se usa?                               |
| --------------- | ---------------------------------------------------- |
| **MD5**         | Vulnerable a colisiones. Se puede romper f√°cilmente. |
| **SHA-1**       | Tambi√©n puede romperse con ataques conocidos.        |

> ‚ö†Ô∏è **¬°Nunca uses MD5 o SHA-1 para guardar contrase√±as!**

---

### ‚úÖ Ejemplo completo: Registro y login con bcrypt en Node.js

---

#### üõ†Ô∏è Paso 1: Instalar

```bash
npm init -y
npm install express bcrypt body-parser
```

---

#### üß© Paso 2: C√≥digo completo

```js
// app.js
const express = require("express");
const bcrypt = require("bcrypt");
const bodyParser = require("body-parser");

const app = express();
app.use(bodyParser.json());

const usuarios = []; // Simula una base de datos

// Registro
app.post("/registro", async (req, res) => {
  const { usuario, contrase√±a } = req.body;

  // Aplicar funci√≥n hash moderna: bcrypt
  const hash = await bcrypt.hash(contrase√±a, 12); // 12 rondas de sal

  usuarios.push({ usuario, contrase√±a: hash });
  res.send("Usuario registrado de forma segura");
});

// Login
app.post("/login", async (req, res) => {
  const { usuario, contrase√±a } = req.body;

  const user = usuarios.find((u) => u.usuario === usuario);
  if (!user) return res.status(404).send("Usuario no encontrado");

  const valido = await bcrypt.compare(contrase√±a, user.contrase√±a);
  if (!valido) return res.status(401).send("Contrase√±a incorrecta");

  res.send("Login exitoso");
});

// Arranque
app.listen(3000, () => {
  console.log("Servidor corriendo en puerto 3000");
});
```

---

#### üß™ ¬øC√≥mo probarlo?

1. Ejecuta:

   ```bash
   node app.js
   ```

2. Usa Postman o curl para enviar un POST a:

- `/registro` con:

```json
{
  "usuario": "gustavo",
  "contrase√±a": "gato123"
}
```

- Luego un POST a `/login` con los mismos datos.

---

#### üîç ¬øQu√© est√° pasando?

- Al registrarte, la contrase√±a se **hashea con bcrypt (una funci√≥n hash moderna)**.
- Se guarda el **hash** en lugar de la contrase√±a.
- En el login, se compara lo que ingresas con el hash guardado.

‚úÖ Esto protege tus datos **incluso si alguien accede a la base de datos**.

---

### üìå Conclusi√≥n

| Pregunta                    | Respuesta                                                                    |
| --------------------------- | ---------------------------------------------------------------------------- |
| ¬øQu√© son?                   | Algoritmos seguros para convertir datos en representaciones irreversibles.   |
| ¬øQu√© las hace modernas?     | Uso de sal, resistencia a ataques, configurables, lentitud intencional.      |
| ¬øPara qu√© sirven?           | Principalmente para contrase√±as, autenticaci√≥n, y firmas digitales.          |
| ¬øCu√°les son las m√°s usadas? | `bcrypt`, `scrypt`, `Argon2`.                                                |
| ¬øDebo usarlas?              | ‚úÖ S√≠, siempre para autenticaci√≥n segura.                                    |
| ¬øC√≥mo usarlas?              | Con librer√≠as: `bcrypt` (Node.js), `argon2` (Python), `password_hash` (PHP). |

---

[üîº](#√≠ndice)

---

## **439. Funciones Hash modernas en la pr√°ctica**

### üîç ¬øQu√© son las funciones hash modernas **en la pr√°ctica**?

En la pr√°ctica, las funciones hash modernas se usan para **proteger informaci√≥n sensible**, especialmente **contrase√±as**, y verificar **la integridad de los datos**. Estas funciones permiten transformar un dato (como una contrase√±a) en una cadena aparentemente aleatoria e irreversible.

---

### üõ°Ô∏è ¬øPor qu√© no se usan funciones antiguas como MD5 o SHA1?

Porque son **r√°pidas y vulnerables**: los atacantes pueden hacer millones de intentos por segundo (ataques de fuerza bruta) o usar ‚Äúdiccionarios invertidos‚Äù (rainbow tables) y descubrir las contrase√±as originales f√°cilmente.

---

### üöÄ Funciones hash modernas **m√°s usadas en la pr√°ctica**

| Funci√≥n  | Fortalezas principales                              | Uso t√≠pico               |
| -------- | --------------------------------------------------- | ------------------------ |
| `bcrypt` | Lenta, usa sal, muy adoptada                        | Almacenar contrase√±as    |
| `scrypt` | M√°s fuerte que bcrypt contra hardware especializado | Apps de alta seguridad   |
| `Argon2` | ü•á Ganador del Password Hashing Competition         | Recomendado por expertos |

---

### ‚öôÔ∏è ¬øC√≥mo se **instalan y usan** en la pr√°ctica?

Te muestro c√≥mo se implementan en **Node.js (con bcrypt)** y **Python (con Argon2)**, los lenguajes m√°s comunes en desarrollo moderno.

---

#### üü¢ 1. Instalaci√≥n y uso con Node.js (`bcrypt`)

##### üß± Instalaci√≥n

```bash
npm install bcrypt
```

##### üîê Uso pr√°ctico: cifrar y verificar una contrase√±a

```js
const bcrypt = require("bcrypt");

const contrase√±aOriginal = "gato123";

async function ejemploHash() {
  const hash = await bcrypt.hash(contrase√±aOriginal, 12); // 12 rondas
  console.log("Hash generado:", hash);

  const esValida = await bcrypt.compare("gato123", hash);
  console.log("¬øContrase√±a v√°lida?", esValida); // true
}

ejemploHash();
```

‚úÖ Este flujo es usado **diariamente en millones de aplicaciones web**.

---

#### üü£ 2. Instalaci√≥n y uso con Python (`argon2`)

##### üß± Instalaci√≥n

```bash
pip install argon2-cffi
```

##### üîê Uso pr√°ctico:

```python
from argon2 import PasswordHasher

ph = PasswordHasher()

# Cifrar
hash = ph.hash("gato123")
print("Hash generado:", hash)

# Verificar
print("¬øEs v√°lida?", ph.verify(hash, "gato123"))  # True
```

---

### üß† ¬øQu√© pasa en la pr√°ctica cuando registramos usuarios?

1. **El usuario env√≠a su contrase√±a.**
2. **Se aplica la funci√≥n hash moderna con "sal".**
3. **Se guarda el hash en la base de datos (no la contrase√±a real).**
4. **En el login**, se aplica la misma funci√≥n hash y se compara con el hash almacenado.

---

### üí° ¬øQu√© ventajas pr√°cticas ofrece esto?

| Ventaja                      | Explicaci√≥n                                                 |
| ---------------------------- | ----------------------------------------------------------- |
| ‚úÖ Seguridad                 | Nadie puede recuperar la contrase√±a original desde el hash. |
| ‚úÖ Protecci√≥n contra ataques | La sal y la lentitud dificultan ataques por fuerza bruta.   |
| ‚úÖ Verificaci√≥n segura       | Podemos saber si una contrase√±a es correcta sin conocerla.  |

---

### üß™ EJEMPLO COMPLETO: Sistema de autenticaci√≥n usando bcrypt (Node.js)

#### üß∞ Paso 1: Instalar dependencias

```bash
npm init -y
npm install express bcrypt body-parser
```

---

#### üìÑ Paso 2: C√≥digo completo de API de registro y login

```js
// archivo: app.js
const express = require("express");
const bcrypt = require("bcrypt");
const bodyParser = require("body-parser");

const app = express();
app.use(bodyParser.json());

const usuarios = []; // Simula una base de datos

// Ruta: Registro
app.post("/registro", async (req, res) => {
  const { usuario, contrase√±a } = req.body;

  // Aplicar funci√≥n hash moderna
  const hash = await bcrypt.hash(contrase√±a, 12);

  usuarios.push({ usuario, contrase√±a: hash });
  res.send("Usuario registrado con √©xito");
});

// Ruta: Login
app.post("/login", async (req, res) => {
  const { usuario, contrase√±a } = req.body;
  const user = usuarios.find((u) => u.usuario === usuario);
  if (!user) return res.status(404).send("Usuario no encontrado");

  const valido = await bcrypt.compare(contrase√±a, user.contrase√±a);
  if (!valido) return res.status(401).send("Contrase√±a incorrecta");

  res.send("Login exitoso");
});

// Iniciar servidor
app.listen(3000, () => {
  console.log("Servidor en http://localhost:3000");
});
```

---

#### üì´ ¬øC√≥mo probarlo?

1. Abre Postman o usa `curl`.
2. Env√≠a POST a `http://localhost:3000/registro` con:

```json
{
  "usuario": "gustavo",
  "contrase√±a": "gato123"
}
```

3. Luego POST a `http://localhost:3000/login` con los mismos datos.

---

### üîê ¬øD√≥nde est√° la funci√≥n hash moderna en este ejemplo?

‚úÖ Est√° aqu√≠:

```js
const hash = await bcrypt.hash(contrase√±a, 12);
```

> Esto cifra la contrase√±a con sal + 12 rondas, lo cual la hace muy dif√≠cil de romper.

---

### üß† Preguntas frecuentes

**üî∏ ¬øPuedo ver la contrase√±a original desde el hash?**

No. El hash es **irreversible**.

**üî∏ ¬øDebo guardar la sal por separado?**

No en bcrypt, porque ya la incluye autom√°ticamente en el hash generado.

**üî∏ ¬øQu√© significa `12` en `bcrypt.hash`?**

Es el n√∫mero de rondas. A mayor n√∫mero, m√°s lento y seguro.

**üî∏ ¬øQu√© pasa si me roban la base de datos?**

Si usas bcrypt o Argon2 correctamente, **las contrase√±as seguir√°n protegidas**, porque no se pueden revertir.

---

### üß© Conclusi√≥n

Las **funciones hash modernas en la pr√°ctica**:

‚úÖ Se instalan mediante librer√≠as (`bcrypt`, `argon2`, etc.)

‚úÖ Se usan para proteger contrase√±as y datos cr√≠ticos

‚úÖ Se aplican f√°cilmente en Node.js, Python, PHP, etc.

‚úÖ Son esenciales para proteger a los usuarios en apps modernas

---

[üîº](#√≠ndice)

---

## **440. Funcionamiento de SHA-2**

### üîê ¬øQu√© es SHA-2?

**SHA-2** (Secure Hash Algorithm 2) es una **familia de funciones hash criptogr√°ficas** desarrollada por la NSA y publicada por el NIST en 2001. Es m√°s segura que **SHA-1** y **MD5**, y se utiliza ampliamente en aplicaciones de seguridad como:

- Contrase√±as
- Firmas digitales
- Certificados SSL
- Blockchain
- Integridad de archivos

---

### üì¶ ¬øQu√© significa que es una _familia_ de funciones?

SHA-2 **no es una sola funci√≥n**, sino un **grupo**:

| Variante   | Tama√±o del hash | Uso com√∫n                          |
| ---------- | --------------- | ---------------------------------- |
| SHA-224    | 224 bits        | Seguridad moderada                 |
| SHA-256 ‚úÖ | 256 bits        | M√°s usado hoy (Bitcoin, JWT, etc.) |
| SHA-384    | 384 bits        | Alta seguridad                     |
| SHA-512    | 512 bits        | Muy alta seguridad                 |

> En la pr√°ctica, **SHA-256** es el m√°s usado. Es r√°pido, seguro y bien soportado.

---

### üîÑ ¬øC√≥mo funciona SHA-2 (SHA-256)?

De forma resumida y entendible:

1. **Entrada:** Un texto, archivo o mensaje (de cualquier longitud)
2. **Divisi√≥n:** Se divide en bloques de 512 bits
3. **Padding:** Se rellena el mensaje con ceros + la longitud original
4. **Compresi√≥n:** Se usan 64 rondas de operaciones matem√°ticas (bitwise, rotaciones, sumas) sobre los bloques
5. **Resultado:** Un _hash fijo_ de 256 bits (64 caracteres hexadecimales)

Ejemplo:

```txt
Texto original: hola123
SHA-256: 8c6976e5b5410415bde908bd4dee15dfb16fe528
         47bd1fc53a3d3a4a8d11a2f3
```

> ‚úÖ Si cambias una sola letra, cambia totalmente el hash.
>
> ‚úÖ Siempre devuelve la misma longitud (64 caracteres hexadecimales).

---

### ‚öôÔ∏è ¬øC√≥mo se instala SHA-2?

Depende del lenguaje. Aqu√≠ te muestro en los m√°s comunes:

---

#### üü¢ Node.js (SHA-256)

SHA-2 ya viene incluido en Node.js (`crypto` module):

```bash
# No necesitas instalar nada extra
```

##### Ejemplo:

```js
const crypto = require("crypto");

const texto = "hola123";
const hash = crypto.createHash("sha256").update(texto).digest("hex");

console.log("SHA-256:", hash);
```

---

#### üü£ Python (SHA-256)

SHA-2 ya est√° en la librer√≠a est√°ndar (`hashlib`):

```bash
# No necesitas instalar nada
```

##### Ejemplo:

```python
import hashlib

texto = "hola123"
hash = hashlib.sha256(texto.encode()).hexdigest()

print("SHA-256:", hash)
```

---

#### üü† Linux (SHA-256)

Puedes calcularlo desde la terminal con:

```bash
echo -n "hola123" | sha256sum
```

---

#### üîµ Windows (PowerShell)

```powershell
Get-FileHash -Algorithm SHA256 archivo.txt
```

---

### üîê Propiedades importantes de SHA-2

| Propiedad         | Descripci√≥n                                                            |
| ----------------- | ---------------------------------------------------------------------- |
| ‚úÖ Unidireccional | No se puede ‚Äúdeshacer‚Äù el hash                                         |
| ‚úÖ Determin√≠stico | Siempre da el mismo resultado con la misma entrada                     |
| ‚úÖ Sensible       | Cambiar una letra cambia completamente el resultado                    |
| ‚úÖ R√°pido         | Adecuado para integridad, pero no para contrase√±as (mejor usar bcrypt) |

---

### üí° Aplicaciones pr√°cticas de SHA-2

| Caso                                | ¬øC√≥mo lo usa SHA-256?                                  |
| ----------------------------------- | ------------------------------------------------------ |
| üîê Verificar integridad de archivos | Se calcula el hash y se compara despu√©s de la descarga |
| üîë Firmas digitales y certificados  | Se usa para resumir el mensaje antes de firmarlo       |
| üì¶ Blockchain (Bitcoin)             | Cada bloque y transacci√≥n usa SHA-256                  |
| üåê JWT (JSON Web Tokens)            | Firma tokens con SHA-256 (HS256)                       |

---

### ‚úÖ EJEMPLO COMPLETO: Verificar la integridad de un archivo usando SHA-256

Supongamos que quieres **asegurarte de que un archivo no ha sido alterado** durante una descarga.

---

#### üìù Paso 1: Calcular el hash del archivo original

```bash
sha256sum archivo.txt
```

Sup√≥n que te devuelve:

```
e3b0c44298fc1c149afbf4c8996fb924... archivo.txt
```

---

#### üì¶ Paso 2: Descargar el archivo en otro lugar y volver a calcular

```bash
sha256sum archivo_descargado.txt
```

Si el resultado **es exactamente igual**, el archivo est√° **√≠ntegro y no fue modificado**.

---

#### üßë‚Äçüíª Mismo ejemplo en c√≥digo Node.js

```js
const fs = require("fs");
const crypto = require("crypto");

function sha256Archivo(rutaArchivo) {
  const fileBuffer = fs.readFileSync(rutaArchivo);
  const hash = crypto.createHash("sha256").update(fileBuffer).digest("hex");
  console.log(`SHA-256 de ${rutaArchivo}: ${hash}`);
}

sha256Archivo("archivo.txt");
```

---

### üõ°Ô∏è Recomendaciones

- **SHA-256** no es para guardar contrase√±as. Es r√°pido. Usa **bcrypt o Argon2** para eso.
- SHA-2 es excelente para:

  - Integridad de archivos
  - Firmas digitales
  - Tokens seguros (JWT)

- Nunca conf√≠es en MD5 o SHA1 para seguridad.

---

### üìå Conclusi√≥n

SHA-2 (especialmente SHA-256) es:

‚úÖ Seguro y moderno

‚úÖ F√°cil de usar e integrar

‚úÖ Esencial en la verificaci√≥n de integridad y autenticaci√≥n digital

‚úÖ Disponible en casi todos los lenguajes

---

[üîº](#√≠ndice)

---

## **441. Caso pr√°ctico: Hashing de contrase√±as en BBDD**

### üß† 1. ¬øQu√© es el hashing de contrase√±as y por qu√© se usa?

**Hashing de contrase√±as** es el proceso de transformar una contrase√±a original (como `"gato123"`) en una **cadena irreconocible e irreversible**, llamada **hash**.

> Por ejemplo, usando `bcrypt`, `"gato123"` puede convertirse en:

```
$2b$12$2zshBlgHlHkRmK.x6pQsiOVXnA3PlW6p0Z6TTDK3CqvTbcRzKnxxG
```

#### üîê ¬øPor qu√© hacer esto?

Porque **guardar contrase√±as directamente en texto plano es un riesgo enorme**. Si un atacante accede a tu base de datos, podr√° ver todas las contrase√±as.
Con hashing:

- ‚úÖ Nadie (ni t√∫) puede recuperar la contrase√±a original
- ‚úÖ El sistema solo puede verificar si el usuario ingres√≥ la misma contrase√±a

---

### üß± 2. ¬øQu√© herramienta se usa para hashear?

Las funciones modernas de hashing para contrase√±as son:

| Nombre      | Caracter√≠stica principal                        |
| ----------- | ----------------------------------------------- |
| `bcrypt` ‚úÖ | Muy usado, seguro, con sal integrada            |
| `argon2`    | M√°s moderno y m√°s robusto, pero menos soportado |
| `scrypt`    | Bueno contra ataques por hardware, menos usado  |

Aqu√≠ usaremos **bcrypt**, porque es seguro y f√°cil de usar en la pr√°ctica.

---

### ‚öôÔ∏è 3. Instalaci√≥n

#### Requisitos:

- Node.js
- MongoDB local o en la nube (usaremos `mongoose`)
- Un cliente como Postman para probar

#### üõ†Ô∏è Instalar dependencias

```bash
npm init -y
npm install express mongoose bcrypt body-parser
```

---

### ‚úÖ 4. Ejemplo completo: Registro y Login con hashing en MongoDB

#### üìÇ Estructura de archivos

```
hashing-app/
‚îú‚îÄ‚îÄ app.js
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îî‚îÄ‚îÄ Usuario.js
```

---

#### üìÑ `models/Usuario.js`: Modelo de usuario con hash autom√°tico

```js
const mongoose = require("mongoose");
const bcrypt = require("bcrypt");

const UsuarioSchema = new mongoose.Schema({
  email: { type: String, required: true, unique: true },
  contrase√±a: { type: String, required: true },
});

// Middleware para hashear antes de guardar
UsuarioSchema.pre("save", async function (next) {
  if (!this.isModified("contrase√±a")) return next();

  const sal = await bcrypt.genSalt(12);
  this.contrase√±a = await bcrypt.hash(this.contrase√±a, sal);
  next();
});

// M√©todo para comparar contrase√±as
UsuarioSchema.methods.verificarContrase√±a = function (contrase√±aIngresada) {
  return bcrypt.compare(contrase√±aIngresada, this.contrase√±a);
};

module.exports = mongoose.model("Usuario", UsuarioSchema);
```

---

#### üìÑ `app.js`: Rutas de registro y login

```js
const express = require("express");
const mongoose = require("mongoose");
const bodyParser = require("body-parser");
const Usuario = require("./models/Usuario");

const app = express();
app.use(bodyParser.json());

mongoose.connect("mongodb://localhost:27017/hashing", {
  useNewUrlParser: true,
  useUnifiedTopology: true,
});

// Ruta de registro
app.post("/registro", async (req, res) => {
  const { email, contrase√±a } = req.body;
  try {
    const nuevoUsuario = new Usuario({ email, contrase√±a });
    await nuevoUsuario.save();
    res.status(201).send("Usuario registrado correctamente");
  } catch (error) {
    res.status(400).send("Error al registrar: " + error.message);
  }
});

// Ruta de login
app.post("/login", async (req, res) => {
  const { email, contrase√±a } = req.body;
  try {
    const usuario = await Usuario.findOne({ email });
    if (!usuario) return res.status(404).send("Usuario no encontrado");

    const esCorrecta = await usuario.verificarContrase√±a(contrase√±a);
    if (!esCorrecta) return res.status(401).send("Contrase√±a incorrecta");

    res.send("Login exitoso");
  } catch (error) {
    res.status(500).send("Error del servidor");
  }
});

app.listen(3000, () => console.log("Servidor en http://localhost:3000"));
```

---

### üîç 5. ¬øC√≥mo probarlo?

#### üìÆ Registro (POST a `/registro`)

```json
{
  "email": "gustavo@email.com",
  "contrase√±a": "gato123"
}
```

‚úÖ En la base de datos, ver√°s algo como:

```json
{
  "email": "gustavo@email.com",
  "contrase√±a": "$2b$12$qPUqKdaFSJTC5z2ipivEtuOSliMdqQ..."
}
```

#### üìÆ Login (POST a `/login`)

```json
{
  "email": "gustavo@email.com",
  "contrase√±a": "gato123"
}
```

‚úÖ Si la contrase√±a es correcta: `"Login exitoso"`

‚ùå Si es incorrecta: `"Contrase√±a incorrecta"`

---

### üìå Conclusiones

| Concepto         | Resumen                                          |
| ---------------- | ------------------------------------------------ |
| üîê Hashing       | Transforma una contrase√±a en algo irreversible   |
| ‚úÖ `bcrypt`      | Funci√≥n moderna y segura                         |
| üì¶ Base de datos | Solo guarda el hash, no la contrase√±a            |
| üë®‚Äçüíª Pr√°ctica      | Verifica el hash para autenticar, no desencripta |

---

[üîº](#√≠ndice)

---

## **442. Ataques a funciones Hash (Rainbow tables)**

### üß† 1. ¬øQu√© es una funci√≥n Hash?

Una funci√≥n hash convierte datos (como contrase√±as) en una cadena _irreversible_ y _√∫nica_. Por ejemplo:

```bash
Contrase√±a: gato123
SHA-256: 8c6976e5b5410415bde908bd4dee15dfb16fe52847bd1fc53a3d3a4a8d11a2f3
```

> üîê Idealmente, no se puede obtener "gato123" solo viendo el hash. Pero‚Ä¶

---

### üí• 2. ¬øQu√© es un ataque con Rainbow Tables?

Un **ataque con Rainbow Tables** es una t√©cnica que **usa una base de datos precalculada de hashes y sus contrase√±as originales**.

#### üóÇÔ∏è ¬øC√≥mo funciona?

1. Un atacante **genera millones de contrase√±as posibles** (ej: `123456`, `admin`, `hola123`, etc.)
2. Calcula sus hashes (ej: usando SHA-1, SHA-256)
3. Guarda esos pares `contrase√±a ‚Üí hash` en una gran **tabla**
4. Cuando roba una base de datos con hashes, **busca coincidencias en su tabla**

üîç **Ejemplo simple** de una Rainbow Table (resumen):

| Contrase√±a | SHA-1 Hash                               |
| ---------- | ---------------------------------------- |
| 123456     | 7c4a8d09ca3762af61e59520943dc26494f8941b |
| password   | 5baa61e4c9b93f3f0682250b6cf8331b7ee68fd8 |
| hola123    | 8c6976e5b5410415bde908bd4dee15dfb16fe528 |

---

### üò® ¬øPor qu√© funciona?

Porque **funciones hash como MD5, SHA-1 o SHA-256 no son suficientes por s√≠ solas** para proteger contrase√±as si:

- ‚ö†Ô∏è Son r√°pidas (como SHA-1)
- ‚ö†Ô∏è No usan una ‚Äúsal‚Äù (salt)
- ‚ö†Ô∏è Usan contrase√±as comunes (como `admin123`, `123456`)

---

### üõ°Ô∏è 3. ¬øC√≥mo defenderse?

#### ‚úÖ Agregando una "sal" (salt)

Una **sal** es un valor aleatorio que se agrega a la contrase√±a **antes de hashearla**, as√≠:

```bash
Contrase√±a: gato123
Salt: X7d2s9
Hash de ("gato123X7d2s9") ‚Üí hash diferente y √∫nico
```

> üîê As√≠, incluso si dos usuarios tienen la misma contrase√±a, los hashes ser√°n **completamente distintos**.

---

#### ‚úÖ Usar funciones dise√±adas para contrase√±as

| Funci√≥n     | Caracter√≠sticas                  |
| ----------- | -------------------------------- |
| `bcrypt` ‚úÖ | Lenta, usa sal autom√°ticamente   |
| `argon2`    | Mejor contra ataques de hardware |
| `scrypt`    | Buen equilibrio entre CPU y RAM  |

Estas funciones est√°n dise√±adas para evitar ataques por fuerza bruta y Rainbow Tables, porque son **intencionalmente lentas** y usan **salt por defecto**.

---

### ‚öôÔ∏è 4. ¬øC√≥mo se instala una herramienta para protegernos? (Usando `bcrypt` en Node.js)

```bash
npm install bcrypt
```

---

#### üîê Ejemplo de protecci√≥n real con `bcrypt`

```js
const bcrypt = require("bcrypt");

// 1. Contrase√±a original
const contrase√±a = "gato123";

// 2. Generar hash con sal (autom√°tica)
bcrypt.hash(contrase√±a, 12, (err, hash) => {
  console.log("Hash seguro:", hash);

  // 3. Verificar luego la contrase√±a ingresada
  bcrypt.compare("gato123", hash, (err, esValido) => {
    console.log("¬øContrase√±a v√°lida?", esValido); // true
  });
});
```

> üîê Cada vez que ejecutes este c√≥digo, aunque uses la misma contrase√±a, se genera un hash distinto. ¬°Eso es gracias al salt!

---

### üìå 5. Simulaci√≥n: ¬øQu√© pasar√≠a sin sal?

```js
const crypto = require("crypto");

const contrase√±a = "123456";
const hash1 = crypto.createHash("sha256").update(contrase√±a).digest("hex");
const hash2 = crypto.createHash("sha256").update(contrase√±a).digest("hex");

console.log(hash1 === hash2); // true ‚ùå ¬°Muy predecible!
```

> ‚ö†Ô∏è Dos contrase√±as iguales generan el mismo hash ‚Üí vulnerable a rainbow tables

---

### ‚úÖ 6. Simulaci√≥n: ¬øQu√© pasa con `bcrypt`?

```js
const bcrypt = require("bcrypt");

const contrase√±a = "123456";

(async () => {
  const hash1 = await bcrypt.hash(contrase√±a, 12);
  const hash2 = await bcrypt.hash(contrase√±a, 12);

  console.log(hash1 === hash2); // false ‚úÖ cada hash es diferente
})();
```

> ‚úÖ Dos contrase√±as iguales ‚Üí hashes diferentes ‚Üí Rainbow Table queda in√∫til

---

### üíª 7. Ejemplo completo: Guardar una contrase√±a protegida en MongoDB con bcrypt

#### üß± Instalaci√≥n

```bash
npm install express mongoose bcrypt body-parser
```

---

#### üìÑ `models/Usuario.js`

```js
const mongoose = require("mongoose");
const bcrypt = require("bcrypt");

const UsuarioSchema = new mongoose.Schema({
  email: String,
  contrase√±a: String,
});

UsuarioSchema.pre("save", async function (next) {
  if (!this.isModified("contrase√±a")) return next();
  const sal = await bcrypt.genSalt(12);
  this.contrase√±a = await bcrypt.hash(this.contrase√±a, sal);
  next();
});

UsuarioSchema.methods.verificar = function (contrase√±aIngresada) {
  return bcrypt.compare(contrase√±aIngresada, this.contrase√±a);
};

module.exports = mongoose.model("Usuario", UsuarioSchema);
```

---

#### üìÑ `app.js`

```js
const express = require("express");
const mongoose = require("mongoose");
const bodyParser = require("body-parser");
const Usuario = require("./models/Usuario");

const app = express();
app.use(bodyParser.json());

mongoose.connect("mongodb://localhost:27017/rainbow", {
  useNewUrlParser: true,
  useUnifiedTopology: true,
});

// REGISTRO
app.post("/registro", async (req, res) => {
  const { email, contrase√±a } = req.body;
  const nuevoUsuario = new Usuario({ email, contrase√±a });
  await nuevoUsuario.save();
  res.send("Registrado con contrase√±a segura.");
});

// LOGIN
app.post("/login", async (req, res) => {
  const { email, contrase√±a } = req.body;
  const usuario = await Usuario.findOne({ email });
  if (!usuario) return res.send("No existe");

  const valido = await usuario.verificar(contrase√±a);
  res.send(valido ? "Acceso concedido" : "Contrase√±a incorrecta");
});

app.listen(3000, () => console.log("Servidor en http://localhost:3000"));
```

---

### üõ°Ô∏è 8. Resumen y buenas pr√°cticas

| Riesgo                | Soluci√≥n                       |
| --------------------- | ------------------------------ |
| Rainbow Tables        | ‚úÖ Usar salt (bcrypt, argon2)  |
| Contrase√±as comunes   | ‚úÖ Obligar contrase√±as fuertes |
| Hash r√°pido (SHA-1)   | ‚ùå No usarlo para contrase√±as  |
| Reutilizaci√≥n de hash | ‚ùå Nunca usar el mismo hash    |

---

### üß† ¬øQu√© aprendiste hoy?

- Qu√© son los ataques con Rainbow Tables
- Por qu√© SHA-256 no es suficiente por s√≠ solo
- C√≥mo `bcrypt` soluciona este problema
- C√≥mo aplicarlo en un sistema real

---

[üîº](#√≠ndice)

---

## **443. Checksums**

![Checksums](../img/6_Ciberseguridad_Defensiva/Checksums.webp "Checksums")

### ‚úÖ ¬øQu√© es un **Checksum**?

Un **checksum** (suma de comprobaci√≥n) es un valor generado a partir de un archivo, mensaje o conjunto de datos para **verificar su integridad**.

> En otras palabras: sirve para comprobar si un archivo **ha sido alterado, da√±ado o modificado**.

---

### üß† ¬øC√≥mo funciona?

1. Aplicas un algoritmo a un archivo ‚Üí genera una cadena (checksum)
2. Cuando alguien recibe el archivo, vuelve a calcular el checksum
3. Si **los checksums coinciden**, el archivo est√° **intacto**
4. Si **no coinciden**, el archivo est√° **corrupto o modificado**

---

### üîí Ejemplo de la vida real:

Sup√≥n que descargas un archivo llamado `antivirus.iso`. En la p√°gina del proveedor ves:

```bash
SHA256: 3a7bd3e2360f9d15e6fc7c7fdb68d2e4a96d3b7c2158b2753957a6b7f9dd4232
```

Ahora t√∫ haces un checksum localmente:

```bash
sha256sum antivirus.iso
```

Si tu resultado es el mismo, ¬°el archivo est√° bien!

Si **no lo es**, puede estar **corrupto o manipulado** (p. ej., un ataque).

---

### üõ†Ô∏è ¬øQu√© algoritmos de Checksum existen?

| Algoritmo | Caracter√≠stica                          |
| --------- | --------------------------------------- |
| CRC32     | Muy r√°pido, pero poco seguro (archivos) |
| MD5       | Popular, pero vulnerable                |
| SHA-1     | Mejor que MD5, pero obsoleto            |
| SHA-256   | Muy usado actualmente                   |

> ‚ö†Ô∏è Recuerda: **Checksum ‚â† Seguridad criptogr√°fica**. MD5 puede detectar errores, pero **no debe usarse para contrase√±as**.

---

### üíª ¬øC√≥mo calcular checksums en tu computadora?

#### üì¶ En Windows

Puedes usar PowerShell o instalar herramientas:

##### Con PowerShell:

```powershell
Get-FileHash .\archivo.txt -Algorithm SHA256
```

##### Con CertUtil:

```cmd
certutil -hashfile archivo.txt SHA256
```

---

#### üêß En Linux o WSL:

```bash
md5sum archivo.txt       # MD5
sha1sum archivo.txt      # SHA-1
sha256sum archivo.txt    # SHA-256
```

---

#### üçè En macOS:

```bash
shasum -a 256 archivo.txt
md5 archivo.txt
```

---

### üß™ Ejemplo paso a paso (SHA-256 con archivo .txt)

#### üìå Paso 1: Crea un archivo

```bash
echo "Hola Gustavo" > saludo.txt
```

#### üìå Paso 2: Calcula su SHA-256

```bash
sha256sum saludo.txt
```

Resultado esperado (puede variar si hay espacios o saltos de l√≠nea):

```
c98c24b677effd69df0121e50253e90c0f0df196adce6d8d3d71f1005b8b9b62  saludo.txt
```

#### üìå Paso 3: Modifica el archivo

```bash
echo "!" >> saludo.txt
```

#### üìå Paso 4: Calcula nuevamente

```bash
sha256sum saludo.txt
```

Nuevo resultado:

```
ef2aa22b89fca35074f8d1471d6c843a5f3d38d2fd0a8e3e30043f4379ff1720  saludo.txt
```

> ‚ùå El hash cambi√≥. ¬°El archivo fue modificado!

---

### üß∞ ¬øD√≥nde se usan los Checksums?

| Aplicaci√≥n                    | Ejemplo pr√°ctico                      |
| ----------------------------- | ------------------------------------- |
| Descarga de software          | Verificar que el archivo es genuino   |
| Transmisi√≥n de datos          | Detectar errores en redes             |
| Backups y copias de seguridad | Asegurar que no se da√±√≥ un respaldo   |
| Archivos cr√≠ticos             | Confirmar que no han sido manipulados |

---

### ‚öôÔ∏è Ejemplo completo en Node.js

#### üì¶ Instala las dependencias

```bash
npm init -y
npm install crypto fs
```

---

#### üìÑ C√≥digo completo: `checksum.js`

```js
const fs = require("fs");
const crypto = require("crypto");

function calcularChecksum(archivo, algoritmo = "sha256") {
  const contenido = fs.readFileSync(archivo);
  const hash = crypto.createHash(algoritmo).update(contenido).digest("hex");
  return hash;
}

// Archivo de prueba
const archivo = "saludo.txt";

// Calcular checksum
const resultado = calcularChecksum(archivo, "sha256");
console.log(`SHA-256 de ${archivo}: ${resultado}`);
```

---

#### üìå Uso

1. Crea un archivo llamado `saludo.txt` con alg√∫n texto
2. Corre el script:

```bash
node checksum.js
```

3. Modifica el archivo y vuelve a correr el script
4. Notar√°s que el hash cambia

---

### üîê Diferencia entre **Checksum** y **Hash para seguridad**

| Caracter√≠stica       | Checksum | Hash Criptogr√°fico (bcrypt) |
| -------------------- | -------- | --------------------------- |
| Detecta errores      | ‚úÖ       | ‚úÖ                          |
| Evita ataques        | ‚ùå       | ‚úÖ                          |
| Usado en contrase√±as | ‚ùå       | ‚úÖ                          |
| Usado en archivos    | ‚úÖ       | ‚úÖ                          |

---

### üìå Resumen r√°pido

- **Checksum** = huella de un archivo para saber si fue alterado
- Muy √∫til en redes, sistemas de archivos y verificaci√≥n de integridad
- No es seguro para proteger contrase√±as, pero s√≠ para detectar errores
- SHA-256 es uno de los m√°s usados actualmente

---

[üîº](#√≠ndice)

---

## **444. Checksums en la pr√°ctica: CyberChef**

### ‚úÖ ¬øQu√© es **CyberChef**?

**CyberChef** es una **herramienta web** gratuita creada por GCHQ (Reino Unido) que permite realizar operaciones comunes de ciberseguridad como:

- Codificaci√≥n y decodificaci√≥n (Base64, URL, etc.)
- Criptograf√≠a (hashes, cifrados)
- An√°lisis de datos binarios
- Conversi√≥n de formatos

> üß† **CyberChef se llama ‚Äúel cuchillo suizo del an√°lisis de datos‚Äù** porque puedes arrastrar y soltar funciones para procesar texto o archivos.

---

### üîç ¬øQu√© son los **Checksums** y c√≥mo se aplican en CyberChef?

Un **checksum** es un valor num√©rico o hash que sirve para verificar la integridad de un archivo o mensaje. En CyberChef, puedes calcular:

- MD5
- SHA-1
- SHA-256
- SHA-512
- Entre muchos otros

Esto te permite verificar si **un archivo ha sido alterado o manipulado**, ideal para validar integridad.

---

### üíª ¬øC√≥mo accedo o instalo CyberChef?

#### Opci√≥n 1: Usar CyberChef online (m√°s f√°cil)

üëâ Sitio oficial:
[https://gchq.github.io/CyberChef/](https://gchq.github.io/CyberChef/)

No necesitas instalar nada. Solo abre el navegador.

---

#### Opci√≥n 2: Instalar CyberChef localmente

1. Aseg√∫rate de tener **Git** y **Node.js** instalados.
2. Abre tu terminal y ejecuta:

```bash
git clone https://github.com/gchq/CyberChef.git
cd CyberChef
npm install
npm run dev
```

3. Abre en tu navegador: `http://localhost:8000`

> ‚úÖ √ötil si quieres trabajar sin internet.

---

### üß™ Ejemplo completo en CyberChef: **Calcular SHA-256 de un texto o archivo**

---

#### üîπ Escenario

Imagina que tienes una contrase√±a que se env√≠a por red. Quieres calcular su **checksum SHA-256** para asegurarte que no fue alterada.

---

#### üìå Paso a paso (sin instalar nada)

1. Abre: [https://gchq.github.io/CyberChef/](https://gchq.github.io/CyberChef/)

2. En el panel izquierdo, escribe el texto:

```
HolaGustavo2025!
```

3. En el panel derecho (Operations), busca y arrastra:

```
‚Üí "SHA-256"
```

> Tambi√©n puedes buscar directamente escribiendo "sha" en la barra de b√∫squeda superior del panel de operaciones.

4. Ver√°s el resultado al instante en la parte inferior derecha:

```
SHA256:
d8d4ddc78a177c09a1b7eb1142b0ac186b993f5f1f7c1564cc44fd55f88b5272
```

5. Ahora puedes copiar este valor como **checksum**, por ejemplo, para validar si ese valor llega intacto a una base de datos o a una API.

---

#### üìÅ ¬øY si es un archivo?

1. Ve al panel de entrada (arriba a la izquierda)
2. Haz clic en el √≠cono üìÅ y **sube el archivo**
3. Arrastra la operaci√≥n `"SHA-256"` al panel de la receta
4. Obtendr√°s el hash del archivo en segundos

---

### üîê ¬øPara qu√© se usa esto en ciberseguridad?

| Uso pr√°ctico           | Descripci√≥n                                      |
| ---------------------- | ------------------------------------------------ |
| Verificar integridad   | Comprobar que archivos no hayan sido modificados |
| Comparar archivos      | Asegurarse que dos archivos son id√©nticos        |
| Seguridad en descargas | Comprobar que el software descargado es original |
| Evidencia digital      | Verificar que un archivo forense no fue alterado |

---

### üéØ Ejemplo real completo

#### Sup√≥n esto:

Tienes un archivo llamado `contrato.pdf` que el cliente firma digitalmente. Al enviarlo por correo, quieres asegurarte que **nadie lo alter√≥**.

1. Arrastras `contrato.pdf` a CyberChef

2. Aplicas `"SHA-256"`

3. Guardas el hash:
   `3b0a1dabc3efbd2d6e11d4b4c40a52b4bde1a1f5a6cd46e6f2431a2fa7999bc5`

4. Cuando te lo reenv√≠an, vuelves a calcular su hash.

5. Si **el hash coincide**, el archivo est√° √≠ntegro.

6. Si **no coincide**, el archivo fue modificado.

---

### üß† Diferencia r√°pida: Checksum vs Hash Criptogr√°fico

| Caracter√≠stica        | Checksum simple (CRC32) | Hash (MD5, SHA-256)   |
| --------------------- | ----------------------- | --------------------- |
| Detecta corrupci√≥n    | ‚úÖ                      | ‚úÖ                    |
| Evita manipulaci√≥n    | ‚ùå                      | ‚úÖ                    |
| Uso legal/forense     | ‚ùå                      | ‚úÖ                    |
| Resistencia a ataques | ‚ùå                      | ‚úÖ (SHA-256, SHA-512) |

---

### üß∞ Consejos pr√°cticos en CyberChef

- Puedes **combinar operaciones**. Ejemplo: decodificar Base64 ‚Üí aplicar SHA-256
- Puedes exportar recetas y compartirlas
- Muy √∫til para aprender **c√≥mo funcionan hashes en vivo**
- Ideal para **tareas de forense digital**, an√°lisis de malware, ciberseguridad

---

### üìå Conclusi√≥n

- **CyberChef** es una herramienta visual para aplicar funciones hash y m√°s.
- Es gratuita, abierta y se puede usar online o instalar localmente.
- Te permite verificar archivos, analizar datos, y aplicar hash f√°cilmente.
- En ciberseguridad, es esencial para comprobar integridad y autenticidad.

---

[üîº](#√≠ndice)

---

## **445. Error Correcting Codes (ECC)**

### üîê ¬øQu√© son los _Error Correcting Codes (ECC)_?

Los **ECC** son algoritmos que **detectan y corrigen errores** en los datos, especialmente cuando estos se **transmiten o almacenan**.

> üß† Imagina enviar un mensaje por WiFi, pero hay interferencia. Con ECC, el receptor **puede corregir los errores sin necesidad de reenviarlo**.

---

### üß© ¬øPor qu√© ocurren errores?

Errores ocurren por muchas razones:

- Interferencia electromagn√©tica
- Discos duros defectuosos
- Memoria RAM da√±ada
- Fallas en la red

Un **bit** puede cambiar de `1` a `0` o viceversa sin que el sistema lo note.

---

### üõ†Ô∏è Tipos comunes de ECC

| Tipo de c√≥digo          | ¬øCorrige errores? | ¬øDetecta errores? | F√°cil de entender |
| ----------------------- | ----------------- | ----------------- | ----------------- |
| **Parity (paridad)**    | ‚ùå                | ‚úÖ                | ‚úÖ                |
| **Checksum**            | ‚ùå                | ‚úÖ                | ‚úÖ                |
| **Hamming Code**        | ‚úÖ (1 bit)        | ‚úÖ                | ‚úÖ‚úÖ              |
| **Reed-Solomon**        | ‚úÖ (varios bits)  | ‚úÖ                | ‚ùå                |
| **Golay Code**, **BCH** | ‚úÖ                | ‚úÖ                | ‚ùå‚ùå              |

---

### üìö Explicaci√≥n simple con ejemplo: **C√≥digo de Hamming (7,4)**

#### üîé ¬øQu√© es?

El **c√≥digo de Hamming** es uno de los ECC m√°s conocidos. Con √©l se puede **detectar y corregir un error de 1 bit** en un bloque de datos.

- `(7,4)` significa: 4 bits de datos + 3 bits de paridad = 7 bits en total

---

#### üßÆ Ejemplo paso a paso: codificar con Hamming (7,4)

Sup√≥n que quieres enviar los **4 bits**:

```
D = 1 0 1 1
```

Necesitamos calcular 3 bits de **paridad (P1, P2, P4)** para completar los 7 bits.

El orden final ser√°:

```
[P1] [P2] D1 [P4] D2 D3 D4
```

‚Üí Sustituimos:

```
 P1  P2  1   P4  0   1   1
```

Ahora calculamos los bits de paridad as√≠:

- `P1 = bit 1 ‚äï 3 ‚äï 5 ‚äï 7 = 1 ‚äï 1 ‚äï 0 ‚äï 1 = 1`
- `P2 = bit 2 ‚äï 3 ‚äï 6 ‚äï 7 = 1 ‚äï 1 ‚äï 1 = 1`
- `P4 = bit 4 ‚äï 5 ‚äï 6 ‚äï 7 = 0 ‚äï 1 ‚äï 1 = 0`

Entonces, la secuencia final enviada es:

```
P1 P2 D1 P4 D2 D3 D4
1   1  1  0  0  1  1
```

‚Üí **Transmitimos: `1110011`**

---

#### ‚ùå Sup√≥n que se corrompe el bit 5:

```
1110111 ‚Üê El bit 5 cambi√≥ de 0 a 1
```

Usamos el **algoritmo de Hamming** para detectar y corregir el error autom√°ticamente.

üìå La suma de los bits de control muestra en qu√© posici√≥n est√° el error. Se repara **corrigiendo ese bit**.

---

### üíæ ¬øD√≥nde se usan los ECC?

| √Årea                       | Ejemplo real                                     |
| -------------------------- | ------------------------------------------------ |
| Memoria RAM ECC            | Servidores que necesitan estabilidad 24/7        |
| Discos duros y SSD         | Detectan errores de escritura/lectura            |
| Comunicaciones satelitales | Corrigen errores por ruido c√≥smico               |
| Redes inal√°mbricas         | 802.11 (Wi-Fi), 4G/5G                            |
| CDs/DVDs                   | Reed-Solomon ECC corrige rayones leves           |
| Transmisi√≥n de video       | H.264 y MPEG usan FEC (Forward Error Correction) |

---

### üíª ¬øC√≥mo puedo practicar ECC (Hamming) en mi PC?

Puedes usar **Python**, es muy did√°ctico y no necesitas instalar m√°s que lo b√°sico.

#### ‚úÖ Requisitos

Solo necesitas tener **Python 3** instalado.

#### üß™ Ejemplo completo: codificaci√≥n y detecci√≥n de error (Hamming 7,4)

```python
def calculate_parity(bits):
    p1 = bits[0] ^ bits[1] ^ bits[3]
    p2 = bits[0] ^ bits[2] ^ bits[3]
    p4 = bits[1] ^ bits[2] ^ bits[3]
    return [p1, p2, bits[0], p4, bits[1], bits[2], bits[3]]

def detect_and_correct(code):
    s1 = code[0] ^ code[2] ^ code[4] ^ code[6]
    s2 = code[1] ^ code[2] ^ code[5] ^ code[6]
    s4 = code[3] ^ code[4] ^ code[5] ^ code[6]
    error_position = s1 + (s2 << 1) + (s4 << 2)
    if error_position != 0:
        print(f"‚ùå Error en el bit: {error_position}")
        code[error_position - 1] ^= 1
        print(f"‚úÖ Bit corregido: {code}")
    else:
        print("‚úÖ No hay errores detectados.")
    return code

# Ejemplo
data = [1, 0, 1, 1]
encoded = calculate_parity(data)
print(f"üîê C√≥digo enviado: {encoded}")

# Simulamos un error en la posici√≥n 5
encoded[4] ^= 1
print(f"üß® C√≥digo con error: {encoded}")

# Detecci√≥n y correcci√≥n
corrected = detect_and_correct(encoded)
```

#### üßæ Resultado esperado

```
üîê C√≥digo enviado: [0, 1, 1, 0, 0, 1, 1]
üß® C√≥digo con error: [0, 1, 1, 0, 1, 1, 1]
‚ùå Error en el bit: 5
‚úÖ Bit corregido: [0, 1, 1, 0, 0, 1, 1]
```

---

### üß† Resumen

| Concepto          | Explicaci√≥n breve                           |
| ----------------- | ------------------------------------------- |
| ¬øQu√© es ECC?      | Detecta y corrige errores en datos          |
| ¬øPara qu√© sirve?  | Garantiza integridad de la informaci√≥n      |
| ¬øEjemplo cl√°sico? | C√≥digo de Hamming (7,4)                     |
| ¬øD√≥nde se usa?    | RAM ECC, discos, redes, sat√©lites           |
| ¬øC√≥mo probarlo?   | Con CyberChef, Python o herramientas online |

---

[üîº](#√≠ndice)

---

## **446. Funcionamiento Hamming Codes**

### üîê ¬øQu√© son los C√≥digos de Hamming?

Los **c√≥digos de Hamming** son una t√©cnica de **correcci√≥n y detecci√≥n de errores** desarrollada por Richard Hamming en 1950. Son usados para **detectar y corregir errores de 1 bit** en transmisiones o almacenamiento de datos.

---

### üß© ¬øC√≥mo funcionan?

Los c√≥digos de Hamming agregan **bits de paridad (control)** a los datos originales para formar una palabra de c√≥digo. Estos bits permiten:

- ‚úÖ Detectar **hasta 2 errores** (pero no corregir 2).
- ‚úÖ Corregir **1 error de un solo bit**.

> üëÄ ¬°Es como si agregaras "pistas" al mensaje para que el receptor pueda saber si algo se da√±√≥ en el camino!

---

### üß† Ejemplo: C√≥digo de Hamming (7,4)

El c√≥digo Hamming **(7,4)** trabaja con:

- **4 bits de datos** (`D1 D2 D3 D4`)
- **3 bits de paridad** (`P1 P2 P4`)
- En total: 7 bits transmitidos

---

#### üßÆ ¬øC√≥mo se organizan los bits?

Se colocan as√≠:

```
Posici√≥n:     1  2  3  4  5  6  7
Contenido:   P1 P2 D1 P4 D2 D3 D4
```

> Los bits de paridad est√°n en las posiciones que son potencias de 2: 1, 2 y 4.

---

### üõ†Ô∏è Paso a paso para codificar

Supongamos que queremos enviar los siguientes **4 bits de datos**:

```
D1 = 1, D2 = 0, D3 = 1, D4 = 1
```

#### Paso 1: Ubicar los bits

```
Posici√≥n:     1  2  3  4  5  6  7
Contenido:   P1 P2  1 P4  0  1  1
```

#### Paso 2: Calcular los bits de paridad

Usamos XOR (‚äï) para calcular los bits de paridad:

- `P1` verifica posiciones: 1, 3, 5, 7 ‚Üí P1 = D1 ‚äï D2 ‚äï D4 = 1 ‚äï 0 ‚äï 1 = **0**
- `P2` verifica posiciones: 2, 3, 6, 7 ‚Üí P2 = D1 ‚äï D3 ‚äï D4 = 1 ‚äï 1 ‚äï 1 = **1**
- `P4` verifica posiciones: 4, 5, 6, 7 ‚Üí P4 = D2 ‚äï D3 ‚äï D4 = 0 ‚äï 1 ‚äï 1 = **0**

#### Resultado final a transmitir:

```
[ P1 P2 D1 P4 D2 D3 D4 ] ‚Üí [ 0 1 1 0 0 1 1 ]
```

---

### ‚ùå ¬øY si ocurre un error?

Sup√≥n que el bit 5 (D2) se corrompe y cambia de 0 a 1:

```
Recibido: 0 1 1 0 1 1 1
```

Ahora usamos los **bits de control** para detectar el error.

---

#### üîé Detecci√≥n de errores: c√°lculo de s√≠ndrome

Calculamos tres bits de s√≠ndrome:

- `S1 = P1 ‚äï D1 ‚äï D2 ‚äï D4 = 0 ‚äï 1 ‚äï 1 ‚äï 1 = 1`
- `S2 = P2 ‚äï D1 ‚äï D3 ‚äï D4 = 1 ‚äï 1 ‚äï 1 ‚äï 1 = 0`
- `S4 = P4 ‚äï D2 ‚äï D3 ‚äï D4 = 0 ‚äï 1 ‚äï 1 ‚äï 1 = 1`

Resultado del s√≠ndrome:
`S4 S2 S1 = 1 0 1 = 5 (en decimal)`

‚Üí ¬°Error en el **bit 5**!

---

### ‚úÖ Correcci√≥n

Simplemente invertimos el bit 5 (de 1 ‚Üí 0), y los datos vuelven a estar correctos.

---

### üíª ¬øC√≥mo se instala y usa esto en la pr√°ctica?

#### Requisitos

- Solo necesitas tener **Python 3** en tu m√°quina
- No necesitas instalar librer√≠as externas

---

### üß™ Ejemplo completo en Python

```python
def calc_parity(data):
    # data = [D1, D2, D3, D4]
    P1 = data[0] ^ data[1] ^ data[3]
    P2 = data[0] ^ data[2] ^ data[3]
    P4 = data[1] ^ data[2] ^ data[3]
    return [P1, P2, data[0], P4, data[1], data[2], data[3]]

def detect_error(code):
    S1 = code[0] ^ code[2] ^ code[4] ^ code[6]
    S2 = code[1] ^ code[2] ^ code[5] ^ code[6]
    S4 = code[3] ^ code[4] ^ code[5] ^ code[6]
    position = S4 * 4 + S2 * 2 + S1
    return position

# Paso 1: codificar
data = [1, 0, 1, 1]
code = calc_parity(data)
print(f"üîê C√≥digo generado: {code}")

# Paso 2: simular error
code[4] ^= 1  # cambiar el bit 5
print(f"üß® C√≥digo con error: {code}")

# Paso 3: detectar y corregir
error = detect_error(code)
if error:
    print(f"‚ùå Error en la posici√≥n: {error}")
    code[error - 1] ^= 1
    print(f"‚úÖ C√≥digo corregido: {code}")
else:
    print("‚úÖ Sin errores detectados.")
```

#### üßæ Resultado esperado

```
üîê C√≥digo generado: [0, 1, 1, 0, 0, 1, 1]
üß® C√≥digo con error: [0, 1, 1, 0, 1, 1, 1]
‚ùå Error en la posici√≥n: 5
‚úÖ C√≥digo corregido: [0, 1, 1, 0, 0, 1, 1]
```

---

### üß† Resumen general

| Tema          | Detalle                                                     |
| ------------- | ----------------------------------------------------------- |
| ¬øQu√© es?      | T√©cnica para detectar/corregir errores en bits transmitidos |
| Tipo com√∫n    | C√≥digo Hamming (7,4)                                        |
| Capacidad     | Detecta 2 errores, corrige 1                                |
| C√≥mo lo hace  | Calcula bits de paridad y los distribuye estrat√©gicamente   |
| Casos reales  | Memoria ECC, discos, comunicaciones, almacenamiento         |
| C√≥mo probarlo | Python puro, sin necesidad de librer√≠as externas            |

---

[üîº](#√≠ndice)

---

## **447. Error Correcting Codes en la pr√°ctica**

### üõ°Ô∏è ¬øQu√© son los Error Correcting Codes (ECC)?

Los **Error Correcting Codes (ECC)** son t√©cnicas que permiten:

- üîç **Detectar** errores durante la transmisi√≥n o almacenamiento de datos.
- üõ†Ô∏è **Corregir** errores sin tener que reenviar la informaci√≥n.

> Se usan en memorias, discos duros, redes, telecomunicaciones y m√°s.

---

### üì¶ Ejemplo de la vida real

Imagina que mandas una carta con la palabra:

```
GATO
```

Pero en el camino alguien la cambia a:

```
GALO
```

Un **c√≥digo de correcci√≥n de errores (ECC)** incluir√≠a informaci√≥n adicional para que el receptor diga:

> ‚Äú¬°Hey! Este dato fue alterado. El original era ‚ÄòGATO‚Äô. Lo corregir√©.‚Äù

---

### üìö Tipos comunes de ECC

| C√≥digo                      | Usado en...                | Capacidad                       |
| --------------------------- | -------------------------- | ------------------------------- |
| **C√≥digo de Hamming**       | Memoria RAM ECC, redes     | Corrige 1 error de 1 bit        |
| **CRC (Cyclic Redundancy)** | Ethernet, discos duros     | Detecta errores, no los corrige |
| **Reed-Solomon**            | CDs, DVDs, QR codes, 4G/5G | Corrige m√∫ltiples errores       |
| **LDPC**                    | WiFi 802.11n/ac/ax, 5G     | Alta eficiencia de correcci√≥n   |

---

### üß† ¬øC√≥mo funciona un ECC en general?

1. üßÆ Se agregan **bits extras** (de paridad) al mensaje original.
2. üì§ Se transmite o guarda la versi√≥n **codificada**.
3. üì• El receptor **verifica** si hubo errores y **los corrige** usando esos bits extras.

---

### ‚öôÔ∏è ¬øC√≥mo se instala o usa ECC en la pr√°ctica?

#### ‚úÖ En hardware (RAM ECC)

- Algunas placas madre soportan **RAM con ECC**.
- Los m√≥dulos ECC tienen **un bit extra por byte** para corregir errores.
- Instalaci√≥n:

  1. Aseg√∫rate de que tu placa base y CPU soporten ECC.
  2. Compra memorias ECC compatibles.
  3. Activa ECC desde la BIOS si es necesario.

> ECC RAM es com√∫n en servidores, no tanto en PCs dom√©sticas.

---

#### üíª En software (pr√°ctica con Python)

Vamos a hacer un **ejemplo pr√°ctico con c√≥digo de Hamming (7,4)** para:

- Codificar un mensaje de 4 bits
- Introducir un error
- Detectar y corregirlo

---

#### üß™ Ejemplo completo en Python: C√≥digo de Hamming

```python
def agregar_paridad(data):
    # data: lista de 4 bits [D1, D2, D3, D4]
    D1, D2, D3, D4 = data
    P1 = D1 ^ D2 ^ D4
    P2 = D1 ^ D3 ^ D4
    P4 = D2 ^ D3 ^ D4
    return [P1, P2, D1, P4, D2, D3, D4]

def detectar_y_corregir(code):
    # Calcula los s√≠ndromes
    S1 = code[0] ^ code[2] ^ code[4] ^ code[6]
    S2 = code[1] ^ code[2] ^ code[5] ^ code[6]
    S4 = code[3] ^ code[4] ^ code[5] ^ code[6]
    error_pos = S4 * 4 + S2 * 2 + S1
    if error_pos:
        print(f"‚ùå Error detectado en la posici√≥n {error_pos}")
        code[error_pos - 1] ^= 1  # corregir el bit
        print("‚úÖ Error corregido.")
    else:
        print("‚úÖ Sin errores detectados.")
    return code

# 1. Datos originales
datos = [1, 0, 1, 1]  # D1 D2 D3 D4
codigo = agregar_paridad(datos)
print(f"üì¶ C√≥digo ECC generado: {codigo}")

# 2. Simular error
codigo[6] ^= 1  # cambiar bit 7 (D4)
print(f"üß® C√≥digo con error: {codigo}")

# 3. Detectar y corregir
codigo_corregido = detectar_y_corregir(codigo)
print(f"üîÑ C√≥digo final corregido: {codigo_corregido}")
```

---

#### üíª Resultado esperado

```
üì¶ C√≥digo ECC generado: [0, 1, 1, 0, 0, 1, 1]
üß® C√≥digo con error: [0, 1, 1, 0, 0, 1, 0]
‚ùå Error detectado en la posici√≥n 7
‚úÖ Error corregido.
üîÑ C√≥digo final corregido: [0, 1, 1, 0, 0, 1, 1]
```

---

### üìà Aplicaciones reales de ECC

| √Årea              | C√≥mo se usa ECC                                                |
| ----------------- | -------------------------------------------------------------- |
| ‚òÅÔ∏è Servidores     | RAM ECC para corregir errores de bits                          |
| üíΩ Almacenamiento | RAID con Reed-Solomon para restaurar bloques da√±ados           |
| üì∂ Telecom        | 5G/WiFi usa LDPC y Turbo Codes para transmisi√≥n confiable      |
| üì¶ QR codes       | Reed-Solomon permite que escanees c√≥digos aunque est√©n da√±ados |

---

### ‚úÖ Ventajas de ECC

- Alta fiabilidad en transmisi√≥n y almacenamiento.
- Evita p√©rdidas de informaci√≥n.
- Reduce necesidad de retransmisiones.

### ‚ö†Ô∏è Limitaciones

- No todos los ECC pueden corregir muchos errores.
- Algunos solo **detectan**, no **corrigen** (como CRC).
- Agregan **sobrecarga** (m√°s bits transmitidos).

---

### üß† Resumen general

| Concepto               | Detalle                                            |
| ---------------------- | -------------------------------------------------- |
| Qu√© es ECC             | T√©cnicas para detectar/corregir errores de datos   |
| Ejemplo simple         | C√≥digo de Hamming (corrige 1 error de bit)         |
| Aplicaci√≥n en hardware | RAM ECC, discos duros, redes                       |
| Aplicaci√≥n en software | Python para pruebas de codificaci√≥n/decodificaci√≥n |
| Ventaja clave          | Mayor confiabilidad sin necesidad de retransmisi√≥n |

---

[üîº](#√≠ndice)

---

## **448. Message Authentication Code (MAC)**

### üîê ¬øQu√© es un Message Authentication Code (MAC)?

Un **MAC** es un valor especial que se **calcula a partir de un mensaje y una clave secreta**, y que sirve para:

1. ‚úÖ **Verificar la integridad** del mensaje (que no ha sido modificado).
2. ‚úÖ **Autenticar el origen** del mensaje (que viene de quien tiene la clave secreta).

---

#### üì¶ Ejemplo f√°cil de la vida real

Imagina que tu amigo y t√∫ comparten una contrase√±a secreta: `secreto123`.

Tu amigo te env√≠a el siguiente mensaje:

```
Mensaje: "Pasa a las 7"
MAC: "h4cK3aD0"
```

T√∫, al recibir el mensaje y el MAC, **usas la clave secreta** para recalcular el MAC del mensaje. Si coincide, sabes:

- Que el mensaje no fue modificado.
- Que fue enviado por alguien que conoce el secreto (tu amigo).

üîê Esto **NO cifra el mensaje**, solo garantiza **autenticidad e integridad**.

---

### üìö ¬øC√≥mo se calcula un MAC?

Se usa una **funci√≥n hash o criptogr√°fica especial** que toma:

- üìÑ Un mensaje.
- üîë Una clave secreta compartida.

Y genera un **c√≥digo √∫nico (MAC)** que:

- Cambia completamente si el mensaje cambia.
- Solo se puede generar si conoces la clave.

---

### üß™ F√≥rmula conceptual

```
MAC = F(clave, mensaje)
```

Por ejemplo, usando HMAC (una forma de MAC con SHA-256):

```
MAC = HMAC-SHA256("claveSecreta", "Hola Mundo")
```

---

### üîß ¬øC√≥mo se instala un sistema con MAC?

#### ‚úÖ En una API o backend (ejemplo real)

1. üîí Generas un secreto compartido (`claveSecreta`).
2. üì§ Cada mensaje que env√≠as a un cliente o servidor incluye:

   - El mensaje.
   - El MAC calculado.

3. ‚úÖ El receptor recalcula el MAC con la clave.
4. üõë Si el MAC no coincide: el mensaje fue alterado o es falso.

> üîê Si alguien modifica el mensaje, el MAC dejar√° de coincidir.

---

### üß∞ Tipos de MAC m√°s comunes

| M√©todo        | Detalles                                                   |
| ------------- | ---------------------------------------------------------- |
| **HMAC**      | Usa funciones hash como SHA-256. Muy usado en APIs.        |
| **CMAC**      | Basado en cifrado sim√©trico (AES). M√°s seguro en hardware. |
| **UMAC/VMAC** | M√°s r√°pidos, pero menos comunes.                           |

---

### üì¶ Instalaci√≥n / uso en Python

Usaremos **HMAC con SHA-256**, que es parte de la biblioteca est√°ndar de Python (`hmac` y `hashlib`).

---

#### ‚úÖ Ejemplo completo y f√°cil en Python

```python
import hmac
import hashlib

# üîë Clave secreta compartida
clave = b"claveSecreta123"

# üìÑ Mensaje a autenticar
mensaje = b"Transferir $1000 a la cuenta 123456"

# üßÆ Crear MAC usando HMAC-SHA256
mac = hmac.new(clave, mensaje, hashlib.sha256).hexdigest()

print("üîê Mensaje:", mensaje.decode())
print("üìé MAC generado:", mac)

# ‚úÖ Simular verificaci√≥n del MAC en el receptor
def verificar_mac(mensaje_recibido, mac_recibido, clave_secreta):
    mac_verificacion = hmac.new(clave_secreta, mensaje_recibido, hashlib.sha256).hexdigest()
    return hmac.compare_digest(mac_verificacion, mac_recibido)

# ‚úîÔ∏è Prueba con mensaje correcto
es_valido = verificar_mac(mensaje, mac, clave)
print("‚úÖ ¬øMAC v√°lido?:", es_valido)

# ‚ùå Simular mensaje alterado
mensaje_alterado = b"Transferir $5000 a la cuenta 123456"
es_valido = verificar_mac(mensaje_alterado, mac, clave)
print("üö® ¬øMAC v√°lido con mensaje alterado?:", es_valido)
```

---

#### üß™ Resultado esperado

```
üîê Mensaje: Transferir $1000 a la cuenta 123456
üìé MAC generado: 5f4c8b7df2...
‚úÖ ¬øMAC v√°lido?: True
üö® ¬øMAC v√°lido con mensaje alterado?: False
```

---

### üß† ¬øPor qu√© usar MAC?

| Ventaja                   | Explicaci√≥n                                               |
| ------------------------- | --------------------------------------------------------- |
| üõ°Ô∏è Garantiza integridad   | Detecta si el mensaje fue modificado.                     |
| üîí Autentica al remitente | Solo quien tiene la clave puede generar el MAC correcto.  |
| üì¶ Ligero y r√°pido        | No cifra, solo firma. Muy eficiente.                      |
| ‚úÖ Usado en APIs REST     | HMAC-SHA256 es com√∫n en tokens de autenticaci√≥n firmados. |

---

### üìå Diferencias entre MAC, hash y cifrado

| T√©cnica     | Protege integridad | Protege confidencialidad | Requiere clave |
| ----------- | ------------------ | ------------------------ | -------------- |
| **Hash**    | ‚úÖ                 | ‚ùå                       | ‚ùå             |
| **MAC**     | ‚úÖ                 | ‚ùå                       | ‚úÖ             |
| **Cifrado** | ‚ùå (normalmente)   | ‚úÖ                       | ‚úÖ             |

---

### üß™ ¬øD√≥nde se usa en el mundo real?

- ‚úÖ **Tokens JWT** (firmados con HMAC-SHA256).
- ‚úÖ **Servicios de pago** que verifican que no se alter√≥ una orden.
- ‚úÖ **APIs seguras** donde el cliente y servidor comparten una clave.
- ‚úÖ **Sistemas de mensajer√≠a** que necesitan validar la fuente.

---

### ‚úÖ Resumen general

| Concepto                 | Detalle                                                            |
| ------------------------ | ------------------------------------------------------------------ |
| Qu√© es                   | Un valor que garantiza la integridad y autenticidad de un mensaje. |
| C√≥mo se genera           | Usando una funci√≥n hash y una clave secreta compartida.            |
| C√≥mo se instala o aplica | En APIs, mensajes o archivos que se desean proteger.               |
| Ejemplo pr√°ctico         | Python con HMAC-SHA256.                                            |
| Usos comunes             | Verificaci√≥n de integridad y autenticaci√≥n de mensajes.            |

---

[üîº](#√≠ndice)

---

## **449. CBC-MAC**

### üß† ¬øQu√© es CBC-MAC?

**CBC-MAC** es un tipo de **c√≥digo de autenticaci√≥n de mensajes (MAC)** que se basa en el uso de un **algoritmo de cifrado de bloque** (como AES) en modo **CBC (Cipher Block Chaining)**.

Su prop√≥sito es garantizar:

- ‚úÖ **Autenticidad**: que el mensaje fue enviado por alguien con la clave secreta.
- ‚úÖ **Integridad**: que el mensaje **no ha sido modificado**.

> No confundir con cifrado. CBC-MAC **no cifra el mensaje**, solo genera un c√≥digo que valida su autenticidad e integridad.

---

### üß© ¬øC√≥mo funciona CBC-MAC?

1. Divide el mensaje en **bloques de tama√±o fijo** (por ejemplo, 128 bits).
2. Cifra cada bloque en **modo CBC**, encadenando el resultado anterior con el siguiente bloque.
3. El **√∫ltimo bloque cifrado** es el **MAC** (el c√≥digo de autenticaci√≥n).

üìå **Clave secreta compartida**: Tanto quien env√≠a como quien recibe deben conocerla para generar y verificar el MAC.

---

### üîê CBC-MAC ‚â† Cifrado CBC

| Concepto         | Cifrado CBC                      | CBC-MAC                                  |
| ---------------- | -------------------------------- | ---------------------------------------- |
| Objetivo         | Ocultar el contenido del mensaje | Validar que el mensaje es aut√©ntico      |
| Salida           | Texto cifrado completo           | Solo el √∫ltimo bloque cifrado (MAC)      |
| IV (vector init) | Se usa y es necesario            | Suele ser **cero fijo** (para seguridad) |

---

### üì¶ ¬øC√≥mo se instala CBC-MAC?

En entornos pr√°cticos (como Python), no existe una funci√≥n `cbc_mac()` directa, pero puedes implementarlo t√∫ mismo usando:

- Una **librer√≠a de cifrado** como `pycryptodome`
- Modo de operaci√≥n `AES.MODE_CBC`
- Usar **un IV de ceros**
- Tomar el **√∫ltimo bloque cifrado como MAC**

---

#### ‚úÖ Instalaci√≥n en Python

Instala la librer√≠a recomendada:

```bash
pip install pycryptodome
```

---

### üß™ Ejemplo completo: CBC-MAC en Python (con AES)

Vamos a implementar CBC-MAC desde cero.

```python
from Crypto.Cipher import AES
from Crypto.Util.Padding import pad
import os

# üîë Clave secreta de 16 bytes (AES-128)
clave = b'clave_super_segura'

# üìÑ Mensaje original (puede tener cualquier longitud)
mensaje = b'Transferencia de $5000 a cuenta 123456789'

# üì¶ Rellenamos a m√∫ltiplos de 16 bytes
mensaje_padded = pad(mensaje, 16)

# IV de ceros (para CBC-MAC)
iv = b'\x00' * 16

# üîê Crear el objeto AES en modo CBC
cipher = AES.new(clave, AES.MODE_CBC, iv)

# üìé Cifrar el mensaje
mensaje_cifrado = cipher.encrypt(mensaje_padded)

# ‚ú® El MAC es el √∫ltimo bloque cifrado
cbc_mac = mensaje_cifrado[-16:]

# üîç Mostrar resultados
print("üìÑ Mensaje:", mensaje.decode())
print("üìé CBC-MAC (hex):", cbc_mac.hex())
```

---

### ‚úÖ Verificaci√≥n del MAC

Para verificar el MAC en el receptor:

1. Se recibe el mensaje original y el MAC.
2. El receptor vuelve a calcular CBC-MAC con la misma clave.
3. Compara el resultado con el MAC recibido.

```python
def verificar_cbc_mac(mensaje_recibido, mac_recibido, clave_secreta):
    mensaje_padded = pad(mensaje_recibido, 16)
    iv = b'\x00' * 16
    cipher = AES.new(clave_secreta, AES.MODE_CBC, iv)
    nuevo_mac = cipher.encrypt(mensaje_padded)[-16:]
    return nuevo_mac == mac_recibido

# ‚úîÔ∏è Verificaci√≥n
es_valido = verificar_cbc_mac(mensaje, cbc_mac, clave)
print("‚úÖ ¬øMAC v√°lido?:", es_valido)
```

---

### üö® ¬øQu√© pasa si alguien cambia el mensaje?

Prueba esto:

```python
mensaje_falso = b'Transferencia de $9000 a cuenta 123456789'
es_valido = verificar_cbc_mac(mensaje_falso, cbc_mac, clave)
print("üö® ¬øMAC v√°lido con mensaje falso?:", es_valido)
```

#### Resultado:

```
üìÑ Mensaje: Transferencia de $5000 a cuenta 123456789
üìé CBC-MAC (hex): a13fbb0...
‚úÖ ¬øMAC v√°lido?: True
üö® ¬øMAC v√°lido con mensaje falso?: False
```

---

### ‚ö†Ô∏è Limitaciones de CBC-MAC

1. ‚ùó **Solo seguro para mensajes de longitud fija**.

   - Si var√≠an en longitud, es vulnerable a ataques.

2. ‚úÖ Por eso se recomienda usar **CMAC** (una versi√≥n mejorada).
3. ‚ùå **No debe usarse con IV aleatorio**, siempre IV = 0.

---

### üìå CBC-MAC vs HMAC vs CMAC

| Tipo de MAC | Basado en                 | Seguro con long. variable | Uso recomendado         |
| ----------- | ------------------------- | ------------------------- | ----------------------- |
| CBC-MAC     | Cifrado por bloques (AES) | ‚ùå                        | Solo con mensajes fijos |
| HMAC        | Funciones hash (SHA-256)  | ‚úÖ                        | APIs, Web, JWT, etc.    |
| CMAC        | AES + est√°ndar NIST       | ‚úÖ                        | Hardware, dispositivos  |

---

### ‚úÖ Resumen

| Concepto         | Detalles                                                     |
| ---------------- | ------------------------------------------------------------ |
| ¬øQu√© es?         | M√©todo de autenticaci√≥n de mensajes basado en cifrado CBC.   |
| ¬øPara qu√© sirve? | Verificar integridad y autenticidad del mensaje.             |
| ¬øC√≥mo se usa?    | Cifras el mensaje con CBC y tomas el √∫ltimo bloque como MAC. |
| ¬øQu√© librer√≠a?   | `pycryptodome` en Python.                                    |
| ¬øAlternativas?   | HMAC (m√°s com√∫n), CMAC (m√°s moderno y seguro).               |

---

[üîº](#√≠ndice)

---

## **450. ¬øC√≥mo construir√≠as una funci√≥n MAC con una funci√≥n HASH?**

### üß† ¬øQu√© es una funci√≥n MAC?

Una **MAC (C√≥digo de Autenticaci√≥n de Mensajes)** es un valor que se **adjunta a un mensaje** para asegurar su:

- ‚úÖ **Autenticidad** (que viene de quien dice ser).
- ‚úÖ **Integridad** (que no ha sido alterado).

Una funci√≥n MAC toma dos entradas:

- Una **clave secreta compartida**
- Un **mensaje**

Y devuelve un c√≥digo (el MAC) que se env√≠a junto al mensaje.

---

### üîê ¬øQu√© es HMAC?

**HMAC (Hash-based Message Authentication Code)** es una forma **segura y est√°ndar** de construir una MAC usando una funci√≥n hash como SHA-256 o SHA-1.

üìå **Ventajas de HMAC:**

- Seguro incluso si el hash tiene ciertas debilidades (como SHA-1).
- Usado ampliamente en **firmas digitales, APIs, tokens, JWT, OAuth, etc.**

---

### üì¶ F√≥rmula de HMAC (simplificada)

```
HMAC(K, m) = H( (K' ‚äï opad) ‚à• H((K' ‚äï ipad) ‚à• m) )
```

Donde:

- `K` = clave secreta
- `K'` = clave ajustada al tama√±o del bloque del hash (ej: 64 bytes para SHA-256)
- `m` = mensaje
- `H` = funci√≥n hash (ej: SHA-256)
- `opad` = 0x5c...5c (relleno externo)
- `ipad` = 0x36...36 (relleno interno)
- `‚à•` = concatenaci√≥n
- `‚äï` = XOR (exclusiva)

> B√°sicamente, se hace un doble hash, mezclando la clave con dos m√°scaras distintas.

---

### üß™ Ejemplo paso a paso: Construir HMAC con SHA-256

Usaremos Python y la librer√≠a `hashlib`.

#### ‚úÖ 1. Instalaci√≥n (ya viene con Python)

No necesitas instalar nada extra. `hashlib` est√° incluido por defecto.

---

#### ‚úÖ 2. C√≥digo paso a paso

```python
import hashlib
import binascii

# üîë Clave secreta
clave = b'superclavecompartida'

# üìÑ Mensaje a proteger
mensaje = b'Transfiere $5000 a cuenta 123456789'

# üß± Tama√±o del bloque para SHA-256 = 64 bytes
block_size = 64

# üîß Paso 1: Ajustar la clave al tama√±o del bloque
if len(clave) > block_size:
    clave = hashlib.sha256(clave).digest()
if len(clave) < block_size:
    clave = clave + b'\x00' * (block_size - len(clave))

# üìå Paso 2: Definir los paddings
ipad = bytes([0x36] * block_size)
opad = bytes([0x5c] * block_size)

# üß© Paso 3: Preparar los valores intermedios
clave_ipad = bytes([b1 ^ b2 for b1, b2 in zip(clave, ipad)])
clave_opad = bytes([b1 ^ b2 for b1, b2 in zip(clave, opad)])

# üîÅ Paso 4: Hacer el doble hash
hash_interno = hashlib.sha256(clave_ipad + mensaje).digest()
hmac = hashlib.sha256(clave_opad + hash_interno).digest()

# üìé Resultado
print("üìÑ Mensaje:", mensaje.decode())
print("üîê HMAC (SHA-256):", hmac.hex())
```

---

#### üß™ Salida esperada:

```
üìÑ Mensaje: Transfiere $5000 a cuenta 123456789
üîê HMAC (SHA-256): 52a7ac21cde64b7a3775088b83f4fc1cbf8b1a26c11ae441e7dc9a7aaea9f3bc
```

---

### ‚úÖ ¬øC√≥mo verificar el HMAC?

El receptor hace lo mismo:

1. Tiene el mensaje y el HMAC.
2. Calcula el HMAC localmente con la misma clave.
3. Compara con el HMAC recibido.

```python
# Supongamos que recibimos este mensaje y HMAC
mensaje_recibido = b'Transfiere $5000 a cuenta 123456789'
hmac_recibido = hmac  # el que calculamos antes

# Repetimos el c√°lculo (usando misma clave)
clave_ipad = bytes([b1 ^ b2 for b1, b2 in zip(clave, ipad)])
clave_opad = bytes([b1 ^ b2 for b1, b2 in zip(clave, opad)])
hash_interno = hashlib.sha256(clave_ipad + mensaje_recibido).digest()
hmac_verificado = hashlib.sha256(clave_opad + hash_interno).digest()

print("‚úÖ ¬øHMAC v√°lido?:", hmac_recibido == hmac_verificado)
```

---

### üîí ¬øQu√© pasa si alguien cambia el mensaje?

Cambia una letra del mensaje y el HMAC ya **no coincidir√°**, mostrando que el mensaje fue alterado.

---

### üîÅ Forma simplificada con `hmac` de Python

Python ya tiene una funci√≥n lista para HMAC:

```python
import hmac
import hashlib

clave = b'superclavecompartida'
mensaje = b'Transfiere $5000 a cuenta 123456789'

# üí° Usar HMAC directamente
h = hmac.new(clave, mensaje, hashlib.sha256)

print("üîê HMAC (simplificado):", h.hexdigest())
```

---

### üì¶ Aplicaciones de HMAC

| Uso t√≠pico                     | Ejemplo pr√°ctico                                  |
| ------------------------------ | ------------------------------------------------- |
| APIs seguras                   | Verificaci√≥n de firmas (ej: Amazon, Stripe, etc.) |
| Tokens JWT                     | Firmas de tokens JWT (`HS256`)                    |
| Verificaci√≥n de archivos       | Descargas de software, backup, etc.               |
| Autenticaci√≥n entre servidores | HMAC + timestamps para evitar reenv√≠os (replay)   |

---

### ‚úÖ Resumen

| Elemento                | Explicaci√≥n sencilla                                          |
| ----------------------- | ------------------------------------------------------------- |
| ¬øQu√© es MAC?            | C√≥digo para verificar autenticidad e integridad de un mensaje |
| ¬øC√≥mo se hace con hash? | Se usa una funci√≥n como SHA-256 con una clave secreta         |
| ¬øQu√© es HMAC?           | Es una f√≥rmula segura que aplica hash 2 veces con la clave    |
| ¬øPara qu√© sirve?        | Evita que se altere un mensaje sin que te des cuenta          |
| ¬øLibrer√≠a recomendada?  | `hashlib` o `hmac` (integradas en Python)                     |

---

[üîº](#√≠ndice)

---

## **451. HMAC**

![HMAC](../img/6_Ciberseguridad_Defensiva/HMAC.png "HMAC")

### üß† ¬øQu√© es HMAC?

**HMAC** significa **Hash-based Message Authentication Code** (C√≥digo de Autenticaci√≥n de Mensajes basado en Hash).

#### ‚úÖ ¬øPara qu√© sirve?

HMAC **verifica que un mensaje sea aut√©ntico y no haya sido modificado**. Se usa mucho en:

- üîê Autenticaci√≥n de APIs
- üì¶ Verificaci√≥n de integridad de archivos
- üîë Firmas digitales
- üîê Tokens JWT (HS256)

---

### üß™ ¬øC√≥mo funciona?

HMAC combina dos cosas:

1. Un **mensaje**
2. Una **clave secreta compartida**

Luego, aplica una **funci√≥n hash** como SHA-256 sobre una combinaci√≥n de ambos.

üìå **F√≥rmula t√©cnica:**

```
HMAC(K, m) = H((K ‚äï opad) ‚à• H((K ‚äï ipad) ‚à• m))
```

- `K`: clave secreta
- `m`: mensaje
- `H`: funci√≥n hash (SHA-256, SHA-1, etc.)
- `ipad` y `opad`: valores predefinidos
- `‚äï`: XOR (operaci√≥n bit a bit)

Esta doble aplicaci√≥n del hash hace que HMAC sea muy **resistente a ataques**.

---

### üì¶ Instalaci√≥n

En la mayor√≠a de lenguajes de programaci√≥n, HMAC ya est√° incluido.

#### ‚úÖ En Python

No necesitas instalar nada. Usa `hmac` y `hashlib`.

```bash
# Python lo trae por defecto
```

#### ‚úÖ En JavaScript (Node.js)

Instalado por defecto en Node.js.

```bash
# No necesitas instalar nada. Usa el m√≥dulo 'crypto'
```

#### ‚úÖ En otros lenguajes

- PHP: `hash_hmac()`
- Java: `javax.crypto.Mac`

---

### üîß Ejemplo completo paso a paso en Python

Supongamos que quieres proteger el mensaje:

```
"Usuario Gustavo ha transferido $1000 a la cuenta 123456789"
```

#### ‚úÖ Paso 1: C√≥digo completo

```python
import hmac
import hashlib

# Mensaje que queremos proteger
mensaje = b"Usuario Gustavo ha transferido $1000 a la cuenta 123456789"

# Clave secreta compartida
clave = b"superclave_secreta"

# Usamos SHA-256 como funci√≥n hash
hmac_obj = hmac.new(clave, mensaje, hashlib.sha256)

# Obtenemos el resultado en hexadecimal
hmac_hex = hmac_obj.hexdigest()

print("üîê HMAC (SHA-256):", hmac_hex)
```

#### üß™ Salida esperada:

```
üîê HMAC (SHA-256): 385f52ac2606d0c187df3f871d0fa3bc6a3c5a55355dc3b6318c5dd97f49d3e2
```

Este valor **verifica que el mensaje no ha sido alterado**. Si alguien cambia una sola letra del mensaje o usa otra clave, el HMAC cambiar√° totalmente.

---

### üõ°Ô∏è ¬øC√≥mo se verifica el HMAC?

Sup√≥n que el servidor te manda:

- El mensaje
- El HMAC

Entonces t√∫ puedes comprobar si el mensaje fue modificado:

```python
# Sup√≥n que recibes estos dos valores
mensaje_recibido = b"Usuario Gustavo ha transferido $1000 a la cuenta 123456789"
hmac_recibido = "385f52ac2606d0c187df3f871d0fa3bc6a3c5a55355dc3b6318c5dd97f49d3e2"

# Calculas el HMAC con tu clave
hmac_calculado = hmac.new(clave, mensaje_recibido, hashlib.sha256).hexdigest()

# Compara
if hmac_recibido == hmac_calculado:
    print("‚úÖ Mensaje aut√©ntico y sin alteraciones.")
else:
    print("üö® Alerta: El mensaje fue modificado.")
```

---

### üß∞ Ejemplo real: proteger una API

Supongamos que tienes una API que solo debe aceptar peticiones si vienen firmadas con HMAC:

#### En el cliente:

```python
import requests
import hmac
import hashlib

mensaje = b"GET:/datos/sensibles"
clave = b"miclaveapi123"

firma = hmac.new(clave, mensaje, hashlib.sha256).hexdigest()

# Enviar a la API
headers = {
    "X-Auth-Message": mensaje.decode(),
    "X-Auth-Signature": firma
}

# Simulaci√≥n de petici√≥n
print(headers)
```

#### En el servidor:

```python
# El servidor recibe los encabezados y verifica:
mensaje = b"GET:/datos/sensibles"
firma_recibida = "firma_del_cliente"

firma_correcta = hmac.new(clave, mensaje, hashlib.sha256).hexdigest()

if hmac.compare_digest(firma_correcta, firma_recibida):
    print("‚úÖ Acceso concedido.")
else:
    print("üö´ Acceso denegado. Firma inv√°lida.")
```

---

### üß† Resumen

| Elemento           | Descripci√≥n                                                       |
| ------------------ | ----------------------------------------------------------------- |
| **¬øQu√© es?**       | M√©todo para verificar la autenticidad e integridad de un mensaje. |
| **¬øQu√© usa?**      | Clave secreta + funci√≥n hash (como SHA-256).                      |
| **¬øQu√© hace?**     | Genera una firma que cambia si el mensaje o clave cambian.        |
| **¬øD√≥nde se usa?** | APIs, JWT, comunicaciones seguras, verificaci√≥n de archivos.      |
| **¬øInstalaci√≥n?**  | Ya viene integrado en lenguajes como Python, JS, PHP, Java.       |

---

[üîº](#√≠ndice)

---

## **452. No repudio y HMACs**

### ‚úÖ ¬øQu√© es el **no repudio**?

El **no repudio** es una propiedad en seguridad inform√°tica que **garantiza que una persona no pueda negar haber realizado una acci√≥n**.

Por ejemplo:

- üì© Si t√∫ env√≠as un correo firmado digitalmente, **no puedes negar que lo enviaste**.
- üí≥ Si realizas una transferencia electr√≥nica con tu firma o clave, **no puedes decir luego que no fuiste t√∫**.

#### üéØ En otras palabras:

> El **no repudio** asegura que una acci√≥n fue realizada por una identidad espec√≠fica, y esa identidad **no puede negarlo despu√©s**.

---

### üîê ¬øQu√© es un HMAC?

HMAC (**Hash-based Message Authentication Code**) es una t√©cnica criptogr√°fica que:

- Garantiza que un mensaje no fue **modificado** (integridad)
- Y que viene de alguien que conoce la **clave secreta** (autenticaci√≥n)

üëâ Usa una **funci√≥n hash** (como SHA-256) y una **clave secreta compartida** para generar una firma √∫nica del mensaje.

---

### ü§î ¬øEntonces HMAC garantiza el no repudio?

#### ‚ùå No del todo. Aqu√≠ viene lo importante:

- HMAC **no garantiza el no repudio**, porque **ambas partes conocen la misma clave secreta**.
- Por tanto, **ambas partes podr√≠an haber generado ese HMAC**, y ninguna puede probar que **solo la otra parte lo hizo**.

---

### üìå Comparaci√≥n con firma digital (que s√≠ da no repudio)

| M√©todo                         | Integridad | Autenticidad | No repudio |
| ------------------------------ | ---------- | ------------ | ---------- |
| **HMAC**                       | ‚úÖ         | ‚úÖ           | ‚ùå         |
| **Firma digital (RSA, ECDSA)** | ‚úÖ         | ‚úÖ           | ‚úÖ         |

---

### üß™ Ejemplo f√°cil de entender:

#### üßë‚Äçüíª Caso 1: HMAC

- Alice y Bob **comparten una clave secreta**.
- Alice env√≠a un mensaje a Bob con un HMAC.
- Bob puede verificar que el mensaje es correcto.
- Pero Bob **no puede probarle a un juez que Alice lo mand√≥**, porque **√©l tambi√©n tiene la clave secreta y pudo generarlo**.

#### üßë‚Äç‚öñÔ∏è Caso 2: Firma digital

- Alice firma el mensaje con su **clave privada**.
- Bob verifica con la **clave p√∫blica de Alice**.
- Solo Alice tiene su clave privada, entonces **s√≠ se garantiza el no repudio**.

---

### üöß ¬øD√≥nde s√≠ se usa HMAC y est√° bien?

- APIs seguras entre servidores que conf√≠an entre s√≠
- Tokens JWT (usando HMAC con `HS256`)
- Verificaci√≥n de integridad en sistemas internos
- Donde **no se necesita no repudio legal**, solo autenticaci√≥n e integridad

---

### ‚öôÔ∏è Instalaci√≥n de HMAC

#### ‚úÖ En Python (ya viene incluido)

```bash
# No necesitas instalar nada
```

#### ‚úÖ En Node.js (crypto incluido)

```bash
# Nada que instalar
```

---

### üß™ Ejemplo completo paso a paso en Python

Vamos a ver c√≥mo **crear y verificar un HMAC**, y despu√©s analizamos por qu√© **no garantiza no repudio**.

#### üë©‚Äçüíª Paso 1: Crear HMAC

```python
import hmac
import hashlib

# Mensaje
mensaje = b"Transferencia: Gustavo envi√≥ $500 a Ana"

# Clave secreta compartida
clave = b"clave_super_secreta"

# Crear HMAC con SHA-256
firma_hmac = hmac.new(clave, mensaje, hashlib.sha256).hexdigest()

print("üßæ Firma HMAC:", firma_hmac)
```

#### üë®‚Äçüíª Paso 2: Verificar HMAC

```python
# Sup√≥n que recibes el mensaje y la firma
mensaje_recibido = b"Transferencia: Gustavo envi√≥ $500 a Ana"
firma_recibida = firma_hmac  # Viene del paso anterior

# Verificar la firma
firma_calculada = hmac.new(clave, mensaje_recibido, hashlib.sha256).hexdigest()

if hmac.compare_digest(firma_calculada, firma_recibida):
    print("‚úÖ Mensaje aut√©ntico, sin alteraciones.")
else:
    print("üö® El mensaje fue modificado o es falso.")
```

---

### üö´ ¬øD√≥nde est√° el problema de no repudio?

Imagina esto:

- Bob dice: "Alice me envi√≥ este mensaje con esta firma HMAC".
- Alice dice: "No, yo no lo envi√©. T√∫ tambi√©n tienes la clave secreta, pudiste haberlo generado t√∫".
- Bob **no puede demostrar** que fue Alice quien lo hizo.

Por eso **HMAC no es suficiente para no repudio**.

---

### ‚úÖ ¬øC√≥mo lograr no repudio real?

Usa **firmas digitales** (como RSA o ECDSA):

- Solo el emisor tiene la clave privada.
- Todos pueden verificar con la clave p√∫blica.
- Garantiza integridad, autenticidad y **no repudio**.

---

### üìö Resumen final

| Concepto                       | Explicaci√≥n                                             |
| ------------------------------ | ------------------------------------------------------- |
| **No repudio**                 | Nadie puede negar que hizo una acci√≥n.                  |
| **HMAC**                       | Firma con clave secreta para autenticidad + integridad. |
| **¬øHMAC da no repudio?**       | ‚ùå No. Porque ambas partes tienen la clave.             |
| **¬øD√≥nde usar HMAC?**          | APIs, tokens, integridad de archivos internos.          |
| **¬øQu√© usar para no repudio?** | Firmas digitales (clave privada y p√∫blica).             |

---

[üîº](#√≠ndice)

---

## **453. Confidencialidad, integridad y autenticaci√≥n (aes-256-cbc-hmac-sha256)**

### üß† ¬øQu√© significan estos tres conceptos?

| Concepto             | ¬øQu√© garantiza?                                      | Ejemplo f√°cil de entender                       |
| -------------------- | ---------------------------------------------------- | ----------------------------------------------- |
| **Confidencialidad** | Que nadie pueda leer el mensaje si no tiene la clave | Como guardar un mensaje en una caja con candado |
| **Integridad**       | Que el mensaje **no haya sido alterado**             | Si el contenido cambia, se detecta              |
| **Autenticaci√≥n**    | Que el mensaje fue enviado por quien dice enviarlo   | Verificamos qui√©n lo envi√≥                      |

---

### üîê ¬øQu√© es `AES-256-CBC + HMAC-SHA256`?

Es una **combinaci√≥n de dos t√©cnicas** para lograr esos tres objetivos:

1. **AES-256-CBC** = cifrado sim√©trico ‚Üí da **confidencialidad**
2. **HMAC-SHA256** = funci√≥n de hash con clave ‚Üí da **integridad y autenticaci√≥n**

---

### üì¶ ¬øC√≥mo se instalan estas herramientas?

En **Python**, puedes usar la librer√≠a `cryptography`, que cubre todo lo que necesitamos.

#### ‚úÖ Instalaci√≥n en terminal:

```bash
pip install cryptography
```

---

### üß± Estructura del cifrado AES-256-CBC + HMAC-SHA256

1. Generas una clave de **32 bytes** para AES-256.
2. Generas un **IV (vector de inicializaci√≥n)** para CBC (16 bytes).
3. Cifras el mensaje con AES-256-CBC.
4. Calculas el **HMAC-SHA256** del IV + mensaje cifrado.
5. Env√≠as: `IV + mensaje cifrado + HMAC`

---

### ‚úçÔ∏è Ejemplo pr√°ctico completo

Vamos a crear un script que:

1. Cifre un mensaje
2. Calcule HMAC
3. Descifre y verifique integridad

---

#### ‚úÖ C√≥digo completo en Python:

```python
from cryptography.hazmat.primitives import hashes, hmac, padding
from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes
from cryptography.hazmat.backends import default_backend
import os

# Claves (simulan ser compartidas entre emisor y receptor)
clave_aes = os.urandom(32)   # 256 bits
clave_hmac = os.urandom(32) # tambi√©n 256 bits

def cifrar_y_firmar(mensaje, clave_aes, clave_hmac):
    # Convertir mensaje a bytes
    datos = mensaje.encode()

    # Padding (AES requiere m√∫ltiplos de 16)
    padder = padding.PKCS7(128).padder()
    datos_padded = padder.update(datos) + padder.finalize()

    # Crear IV (vector de inicializaci√≥n)
    iv = os.urandom(16)

    # Cifrar con AES-256-CBC
    cipher = Cipher(algorithms.AES(clave_aes), modes.CBC(iv), backend=default_backend())
    cifrador = cipher.encryptor()
    mensaje_cifrado = cifrador.update(datos_padded) + cifrador.finalize()

    # Generar HMAC-SHA256 del IV + mensaje cifrado
    h = hmac.HMAC(clave_hmac, hashes.SHA256(), backend=default_backend())
    h.update(iv + mensaje_cifrado)
    firma = h.finalize()

    # Devolver todo junto
    return iv + mensaje_cifrado + firma

def verificar_y_descifrar(dato_total, clave_aes, clave_hmac):
    # Separar los componentes
    iv = dato_total[:16]
    mensaje_cifrado = dato_total[16:-32]
    firma_recibida = dato_total[-32:]

    # Verificar HMAC
    h = hmac.HMAC(clave_hmac, hashes.SHA256(), backend=default_backend())
    h.update(iv + mensaje_cifrado)
    try:
        h.verify(firma_recibida)
        print("‚úÖ Integridad y autenticaci√≥n confirmadas.")
    except:
        print("üö® HMAC inv√°lido: mensaje alterado o falso.")
        return None

    # Descifrar mensaje
    cipher = Cipher(algorithms.AES(clave_aes), modes.CBC(iv), backend=default_backend())
    descifrador = cipher.decryptor()
    datos_padded = descifrador.update(mensaje_cifrado) + descifrador.finalize()

    # Remover padding
    unpadder = padding.PKCS7(128).unpadder()
    datos = unpadder.update(datos_padded) + unpadder.finalize()

    return datos.decode()

# -------------------------------
# üß™ Prueba del sistema completo
mensaje_original = "Hola Gustavo, esto es confidencial üöÄ"

# Cifrar y firmar
paquete = cifrar_y_firmar(mensaje_original, clave_aes, clave_hmac)

# Simula enviar el paquete...

# Verificar y descifrar
mensaje_descifrado = verificar_y_descifrar(paquete, clave_aes, clave_hmac)

print("üìù Mensaje original:", mensaje_original)
print("üîì Mensaje descifrado:", mensaje_descifrado)
```

---

### üß† ¬øQu√© logramos con esto?

| Objetivo         | C√≥mo se cumple                                               |
| ---------------- | ------------------------------------------------------------ |
| Confidencialidad | Con AES-256-CBC, nadie puede leer sin la clave               |
| Integridad       | El HMAC detecta si el mensaje fue alterado                   |
| Autenticaci√≥n    | El HMAC usa clave secreta ‚Üí solo el emisor real puede firmar |

---

### ‚ùó Importante

- El emisor y receptor deben **compartir las dos claves** (AES y HMAC).
- Este sistema no da **no repudio**, porque ambas partes conocen las claves.
- Si quieres confidencialidad + autenticaci√≥n **sin clave compartida**, necesitas **criptograf√≠a asim√©trica** (por ejemplo, GPG o RSA).

---

### üéØ Resumen final

| Componente      | Funci√≥n                                                   |
| --------------- | --------------------------------------------------------- |
| `AES-256-CBC`   | Cifrado sim√©trico para **confidencialidad**               |
| `HMAC-SHA256`   | Firma del mensaje para **integridad** y **autenticaci√≥n** |
| `IV`            | Impide patrones repetitivos en el cifrado                 |
| `PKCS7 Padding` | Asegura que los bloques sean del tama√±o adecuado          |

---

[üîº](#√≠ndice)

---

## **454. Modo de operaci√≥n GCM**

### üß† ¬øQu√© es el Modo de operaci√≥n GCM?

**GCM** significa **Galois/Counter Mode**. Es un **modo de cifrado** que trabaja con algoritmos como AES.

#### üîê GCM combina:

- **Confidencialidad** (cifra los datos como AES-Counter Mode)
- **Integridad + autenticaci√≥n** (genera un _tag_ tipo HMAC)

---

### üìå ¬øPor qu√© es √∫til?

Tradicionalmente, se usaban dos pasos:

- Primero: **cifrar** (con AES)
- Segundo: **verificar** (con HMAC)

üí° **GCM hace ambas cosas al mismo tiempo**. Es r√°pido, eficiente y seguro. Muy usado en:

- HTTPS (TLS 1.2/1.3)
- VPNs
- API segura
- Dispositivos m√≥viles

---

### üîÑ ¬øC√≥mo funciona?

1. **Se cifra el texto** con un contador (como AES-CTR)
2. Se genera un **tag de autenticaci√≥n** que permite:

   - Detectar si fue modificado
   - Confirmar la identidad del remitente

---

### üîê ¬øQu√© necesitas para usar AES-GCM?

- **Clave** (por ejemplo 256 bits ‚Üí 32 bytes)
- **Nonce** o IV (√∫nico por mensaje, 12 bytes es lo recomendado)
- **Mensaje** (texto plano)
- **Tag** de autenticaci√≥n (16 bytes t√≠picamente)

---

### ‚öôÔ∏è Instalaci√≥n de herramienta

Usaremos la librer√≠a `cryptography`, que ya incluye soporte para GCM.

#### ‚úÖ Instalaci√≥n con pip:

```bash
pip install cryptography
```

---

### üíª Ejemplo completo en Python

Vamos a:

1. Cifrar un mensaje usando AES-256-GCM
2. Incluir autenticaci√≥n
3. Verificar y descifrar el mensaje

---

#### üßæ C√≥digo completo:

```python
from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes
from cryptography.hazmat.backends import default_backend
import os

# üîê Generar claves y datos
clave = os.urandom(32)          # AES-256 ‚Üí 32 bytes
nonce = os.urandom(12)          # Recomendado: 12 bytes
mensaje = b"Hola Gustavo, esto es AES-GCM üí¨"

# -------------------------------
# üõ°Ô∏è Cifrado
encryptor = Cipher(
    algorithms.AES(clave),
    modes.GCM(nonce),
    backend=default_backend()
).encryptor()

mensaje_cifrado = encryptor.update(mensaje) + encryptor.finalize()
tag = encryptor.tag  # üîí Etiqueta de autenticaci√≥n (integridad)

print("üîê Mensaje cifrado:", mensaje_cifrado.hex())
print("üîè Tag de autenticaci√≥n:", tag.hex())

# -------------------------------
# üîì Descifrado
decryptor = Cipher(
    algorithms.AES(clave),
    modes.GCM(nonce, tag),
    backend=default_backend()
).decryptor()

mensaje_descifrado = decryptor.update(mensaje_cifrado) + decryptor.finalize()

print("üì¨ Mensaje descifrado:", mensaje_descifrado.decode())
```

---

### ‚úÖ Resultado esperado

```text
üîê Mensaje cifrado: <texto en hexadecimal>
üîè Tag de autenticaci√≥n: <texto en hexadecimal>
üì¨ Mensaje descifrado: Hola Gustavo, esto es AES-GCM üí¨
```

---

### üß† ¬øQu√© conseguimos con esto?

| Seguridad        | ¬øC√≥mo lo logra GCM?                                      |
| ---------------- | -------------------------------------------------------- |
| Confidencialidad | Cifra con AES-Counter (r√°pido y seguro)                  |
| Integridad       | Usa el `tag` (Galois Field) para detectar manipulaciones |
| Autenticaci√≥n    | El `tag` se calcula usando la clave ‚Üí asegura el origen  |

---

### üõ°Ô∏è Ventajas de AES-GCM

- üîê M√°s seguro que CBC + HMAC si se usa correctamente
- ‚ö° R√°pido (paralelizable)
- üîÑ Puede cifrar + autenticar datos y metadatos (AAD)
- üß™ Detecta cambios o corrupci√≥n autom√°ticamente

---

### ‚ö†Ô∏è Buenas pr√°cticas

| Recomendaci√≥n                                   | ¬øPor qu√©?                           |
| ----------------------------------------------- | ----------------------------------- |
| Nunca reutilices el **nonce**                   | Si lo haces, puede revelar la clave |
| Usa claves aleatorias seguras                   | Nunca claves hardcodeadas           |
| Almacena o transmite tambi√©n el `nonce` y `tag` | Necesarios para descifrar           |

---

[üîº](#√≠ndice)

---

## **455. Protecci√≥n de los datos**

### ‚úÖ ¬øQu√© es la protecci√≥n de los datos?

La **protecci√≥n de los datos** consiste en aplicar m√©todos, tecnolog√≠as y buenas pr√°cticas para **evitar la p√©rdida, el robo, la alteraci√≥n o el uso indebido de la informaci√≥n**, ya sea en tr√°nsito, en uso o en reposo.

---

### üéØ Objetivos principales

| Objetivo             | Significado                                                       |
| -------------------- | ----------------------------------------------------------------- |
| **Confidencialidad** | Que solo las personas autorizadas vean los datos                  |
| **Integridad**       | Que los datos no se modifiquen sin autorizaci√≥n o accidentalmente |
| **Disponibilidad**   | Que los datos est√©n accesibles cuando se necesiten                |

---

### üì¶ ¬øQu√© tipos de datos hay que proteger?

- **Datos personales**: nombre, DNI, direcci√≥n
- **Credenciales**: contrase√±as, tokens
- **Datos financieros**: tarjetas, cuentas
- **Informaci√≥n empresarial**: secretos, planes
- **Archivos m√©dicos**, jur√≠dicos, etc.

---

### üß∞ ¬øC√≥mo se protege la informaci√≥n? (T√©cnicas)

| T√©cnica                               | ¬øQu√© hace?                                                       |
| ------------------------------------- | ---------------------------------------------------------------- |
| **Cifrado (en reposo y en tr√°nsito)** | Convierte los datos en ilegibles sin clave                       |
| **Autenticaci√≥n y autorizaci√≥n**      | Verifica qui√©n accede y qu√© puede hacer                          |
| **Copias de seguridad (backups)**     | Permite recuperar los datos si se pierden                        |
| **Control de acceso**                 | Solo usuarios espec√≠ficos pueden ver o editar cierta informaci√≥n |
| **Firewall y antivirus**              | Bloquean accesos o archivos peligrosos                           |
| **Tokenizaci√≥n / enmascaramiento**    | Sustituye partes sensibles de los datos por valores ficticios    |
| **Hashing**                           | Protege contrase√±as sin necesidad de almacenarlas directamente   |

---

### üíª Herramientas comunes

- **BitLocker** / **VeraCrypt** (cifrado de discos)
- **OpenSSL** (cifrado con claves p√∫blicas/privadas)
- **GPG** (encriptar y firmar documentos)
- **Antivirus/EDR** (detecci√≥n de malware)
- **Vault** (gesti√≥n segura de secretos)

---

### ‚öôÔ∏è ¬øC√≥mo se instala una soluci√≥n b√°sica de protecci√≥n?

Te mostrar√© c√≥mo proteger **archivos sensibles** usando **GPG (GNU Privacy Guard)**, una herramienta gratuita y muy usada para cifrar, descifrar y firmar informaci√≥n.

---

### ‚úÖ Instalaci√≥n de GPG

#### En Windows:

1. Descarga Gpg4win:
   üëâ [https://gpg4win.org/](https://gpg4win.org/)
2. Inst√°lalo normalmente

#### En Linux (Debian/Ubuntu):

```bash
sudo apt update
sudo apt install gnupg
```

#### En macOS (con Homebrew):

```bash
brew install gnupg
```

---

### üîê Ejemplo pr√°ctico: cifrado y protecci√≥n de datos personales

#### üéØ Escenario:

Tienes un archivo llamado `datos_sensibles.txt` que contiene informaci√≥n personal. No quieres que nadie lo vea sin tu permiso.

#### üìÑ Paso 1: Crea el archivo

```bash
echo "DNI: 12345678 - Nombre: Gustavo" > datos_sensibles.txt
```

#### üîë Paso 2: Genera una clave GPG (solo la primera vez)

```bash
gpg --full-generate-key
```

- Tipo: `RSA and RSA`
- Tama√±o: `2048 o 4096`
- Nombre/email: lo que quieras
- Passphrase: una contrase√±a fuerte

#### üîê Paso 3: Cifrar el archivo

```bash
gpg -e -r "TuNombre o email" datos_sensibles.txt
```

Esto genera `datos_sensibles.txt.gpg` que est√° cifrado.

#### üîì Paso 4: Descifrar el archivo

```bash
gpg -d datos_sensibles.txt.gpg > datos_sensibles_descifrado.txt
```

Solo se puede descifrar si tienes la clave privada.

---

### üéÅ Resultado final

| Archivo                          | Estado                                 |
| -------------------------------- | -------------------------------------- |
| `datos_sensibles.txt`            | Original (sin protecci√≥n)              |
| `datos_sensibles.txt.gpg`        | Cifrado (solo t√∫ puedes leerlo)        |
| `datos_sensibles_descifrado.txt` | Ya descifrado, protegido durante env√≠o |

---

### üß† ¬øPor qu√© esto protege los datos?

- ‚úÖ **Cifrado fuerte** (RSA)
- ‚úÖ **Autenticaci√≥n de identidad** (firma opcional)
- ‚úÖ **Evita fugas en tr√°nsito o robo de archivos**
- ‚úÖ **Se integra f√°cilmente en entornos reales (email, backup, etc.)**

---

[üîº](#√≠ndice)

---

## **456. Ampliaci√≥n del entorno: Instalaci√≥n Windows 11**

### ‚úÖ ¬øQu√© significa "ampliaci√≥n del entorno"?

**Ampliaci√≥n del entorno** se refiere a mejorar o actualizar tu entorno de trabajo. En este caso, se trata de instalar un sistema operativo m√°s moderno: **Windows 11**, que ofrece:

- Mejor seguridad
- Compatibilidad con aplicaciones modernas
- Mejor rendimiento
- Nuevas interfaces (m√°s intuitiva)

---

### üìã Requisitos para instalar Windows 11

Antes de instalar Windows 11, verifica si tu equipo lo soporta.

#### ‚úîÔ∏è Requisitos m√≠nimos:

| Requisito       | Detalle                                 |
| --------------- | --------------------------------------- |
| CPU             | 1 GHz o m√°s, con 2 o m√°s n√∫cleos 64-bit |
| RAM             | 4 GB m√≠nimo                             |
| Almacenamiento  | 64 GB m√≠nimo                            |
| TPM             | Versi√≥n 2.0                             |
| Secure Boot     | Debe estar activado                     |
| Tarjeta gr√°fica | Compatible con DirectX 12               |
| Pantalla        | 720p, 9" o m√°s                          |

---

### üß∞ Herramienta para verificar compatibilidad

#### üîç "PC Health Check" (Revisi√≥n de compatibilidad)

1. Desc√°rgala desde:
   üëâ [https://aka.ms/GetPCHealthCheckApp](https://aka.ms/GetPCHealthCheckApp)
2. Ejecuta la herramienta y te dir√° si tu PC puede instalar Windows 11.

---

### üîÑ Opciones para instalar Windows 11

| M√©todo                         | ¬øCu√°ndo se usa?                               |
| ------------------------------ | --------------------------------------------- |
| Actualizaci√≥n desde Windows 10 | Si ya tienes Windows 10 y tu PC es compatible |
| Instalaci√≥n limpia desde USB   | Si quieres empezar desde cero (formateo)      |
| M√°quina virtual (VM)           | Si quieres probarlo sin afectar tu PC         |

---

### üíæ Instalaci√≥n desde USB paso a paso (instalaci√≥n limpia)

#### üß± Paso 1: Descargar el instalador

Ve a la web oficial de Microsoft:
üëâ [https://www.microsoft.com/es-es/software-download/windows11](https://www.microsoft.com/es-es/software-download/windows11)

Descarga la **herramienta de creaci√≥n de medios** (Media Creation Tool).

---

#### üîß Paso 2: Crear un USB booteable

1. Conecta un USB de al menos 8 GB
2. Ejecuta el Media Creation Tool
3. Elige "USB Flash Drive" como medio
4. Espera que se cree el USB booteable

---

#### ‚öôÔ∏è Paso 3: Cambiar el orden de arranque (boot)

1. Reinicia tu computadora
2. Presiona la tecla de BIOS/UEFI (normalmente F2, F10, F12, ESC o DEL)
3. Ve a la opci√≥n de **Boot Order** y pon el USB primero
4. Guarda y reinicia

---

#### üíª Paso 4: Instalar Windows 11

1. Elige el idioma y zona
2. Selecciona "Instalaci√≥n personalizada"
3. Borra la partici√≥n si deseas una instalaci√≥n limpia
4. Elige la partici√≥n donde instalar
5. Espera que copie archivos (puede tardar 15‚Äì40 minutos)
6. Configura nombre de usuario, contrase√±a, idioma, red, etc.

---

### ‚úÖ Ejemplo completo (resumen paso a paso)

Imaginemos que Gustavo quiere instalar Windows 11 desde cero en una laptop.

1. **Verifica requisitos** con PC Health Check
2. Descarga **Media Creation Tool**
3. Crea un USB booteable con Windows 11
4. Cambia el orden de arranque en BIOS
5. Inicia desde el USB
6. Elige instalaci√≥n limpia y formatea la unidad
7. Sigue el asistente de configuraci√≥n
8. Windows 11 queda instalado

---

### üõ°Ô∏è Ventajas de tener Windows 11

- Seguridad mejorada (TPM 2.0, Secure Boot, Windows Hello)
- Entorno moderno para desarrollo o ciberseguridad
- Mejor soporte de hardware
- Interfaz fluida (Snap Layouts, Widgets)
- Soporte para **WSL2** (Linux en Windows)

---

### üöÄ ¬øY si quiero probar sin afectar mi PC?

Usa **una m√°quina virtual** con VirtualBox o VMware. As√≠ puedes experimentar sin borrar nada.

#### üß™ Bonus: Instalar Windows 11 en VirtualBox

1. Descarga la **ISO de Windows 11**
2. Instala **VirtualBox**
3. Crea una nueva VM con:

   - Tipo: Windows 11 (64-bit)
   - RAM: 4 GB m√≠nimo
   - Disco: 64 GB

4. Inicia y carga el ISO
5. Instala igual que en una m√°quina real

---

[üîº](#√≠ndice)

---

## **457. Clasificaci√≥n de la informaci√≥n: GDPR, PCI-DSS, HIPAA**

### üìò ¬øQu√© es la clasificaci√≥n de la informaci√≥n?

Es el proceso de **organizar y etiquetar los datos seg√∫n su nivel de sensibilidad** o riesgo en caso de p√©rdida, robo o mal uso.

Esto permite aplicar **niveles de protecci√≥n adecuados**.
Piensa en ello como etiquetas que te dicen cu√°nto debes proteger algo, como:

- üü¢ **P√∫blica**: Cualquiera puede verla (ej. folleto)
- üü° **Interna/confidencial**: Solo dentro de la empresa
- üî¥ **Secreta/Sensible**: Datos cr√≠ticos o personales (ej. contrase√±as, DNI, historial m√©dico)

---

### üéØ ¬øPor qu√© es importante?

- Cumples con **leyes y normas**
- Proteges a los usuarios
- Evitas multas
- Reduces riesgos

---

### üìö Normas importantes de protecci√≥n de datos

#### 1. **GDPR** (Europa)

> Reglamento General de Protecci√≥n de Datos
>
> Aplica a cualquier empresa que maneje datos de personas en la **Uni√≥n Europea**.

**Ejemplo de datos protegidos:**

- Nombre
- Direcci√≥n
- Correo
- IP
- Datos biom√©tricos

**Requiere:**

- Consentimiento del usuario
- Eliminar datos si lo piden
- Informar si hay fuga de datos

---

#### 2. **HIPAA** (EE.UU. ‚Äì Salud)

> Ley de Portabilidad y Responsabilidad del Seguro M√©dico

Protege la **informaci√≥n m√©dica** de los pacientes.

**Ejemplo de datos protegidos:**

- Diagn√≥sticos
- Historiales m√©dicos
- Resultados de laboratorio

**Requiere:**

- Control de acceso a datos
- Auditor√≠as
- Cifrado de datos m√©dicos

---

#### 3. **PCI-DSS** (Global ‚Äì Tarjetas de cr√©dito)

> Est√°ndar de Seguridad de Datos de la Industria de Tarjetas de Pago

Protege la informaci√≥n relacionada a pagos con tarjeta.

**Ejemplo de datos protegidos:**

- N√∫meros de tarjeta (PAN)
- CVV
- Fecha de expiraci√≥n

**Requiere:**

- Cifrado de datos
- No almacenar CVV
- Registro de accesos

---

### üß∞ ¬øC√≥mo se ‚Äúinstalan‚Äù estas normativas?

No se instalan como programas, sino que se **implementan como pol√≠ticas, controles y procedimientos** dentro de una empresa.

---

### üõ†Ô∏è Paso a paso para aplicar una clasificaci√≥n seg√∫n estas normas

Supongamos que tienes una empresa que:

- Vende productos online (usa tarjetas)
- Tiene usuarios de la UE
- Recoge correos, direcciones, etc.
- Usa formularios con datos m√©dicos

#### 1. **Identifica los datos recolectados**

Ejemplo:

| Dato               | Normativa afectada |
| ------------------ | ------------------ |
| Correo, nombre     | GDPR               |
| N√∫mero de tarjeta  | PCI-DSS            |
| Diagn√≥stico m√©dico | HIPAA              |

---

#### 2. **Clasifica los datos**

| Dato               | Clasificaci√≥n |
| ------------------ | ------------- |
| Nombre             | Interno       |
| Contrase√±a         | Sensible      |
| N√∫mero de tarjeta  | Cr√≠tico       |
| Diagn√≥stico m√©dico | Cr√≠tico       |
| Direcci√≥n IP       | Personal      |

---

#### 3. **Aplica controles por nivel**

| Nivel    | Qu√© hacer                                     |
| -------- | --------------------------------------------- |
| P√∫blica  | Puede estar en el sitio web                   |
| Interna  | Solo accesible por empleados                  |
| Sensible | Encriptaci√≥n, acceso restringido              |
| Cr√≠tico  | Cifrado, monitoreo, control estricto, alertas |

---

#### 4. **Documenta tus pol√≠ticas**

Crea pol√≠ticas como:

- Pol√≠tica de clasificaci√≥n de datos
- Pol√≠tica de retenci√≥n y eliminaci√≥n
- Pol√≠tica de cifrado y respaldo

---

### üß™ Ejemplo completo pr√°ctico

**Contexto:** Gustavo crea una web para agendar consultas psicol√≥gicas. Recoge:

- Nombre completo
- Email
- Fecha de nacimiento
- Descripci√≥n del problema (dato de salud)
- Pago con tarjeta

#### üìç Clasificaci√≥n de la informaci√≥n:

| Dato                     | Normativa | Clasificaci√≥n |
| ------------------------ | --------- | ------------- |
| Nombre, email            | GDPR      | Sensible      |
| Tarjeta de cr√©dito       | PCI-DSS   | Cr√≠tico       |
| Descripci√≥n del problema | HIPAA     | Cr√≠tico       |

---

#### üîê Controles implementados por Gustavo:

- Cifrado con **AES-256** para datos sensibles
- Env√≠o por HTTPS (SSL/TLS activado)
- Formulario con consentimiento (‚ÄúAcepto que mis datos sean tratados seg√∫n la pol√≠tica de privacidad‚Äù)
- Base de datos con **HMAC para autenticaci√≥n de datos**
- No almacena CVV de la tarjeta
- Logs de acceso a la base de datos

---

#### üßæ Resultado:

‚úÖ Cumple con GDPR, PCI-DSS y HIPAA

‚úÖ Clasifica correctamente los datos

‚úÖ Protege los datos con controles adecuados

‚úÖ Evita sanciones legales y protege la confianza del usuario

---

### üìå Conclusi√≥n

La **clasificaci√≥n de la informaci√≥n** es clave para cumplir con normas como **GDPR**, **PCI-DSS** y **HIPAA**.
No se instala como un programa, pero se **implementa** con buenas pr√°cticas, cifrado, control de acceso, pol√≠ticas internas y herramientas de seguridad.

---

[üîº](#√≠ndice)

---

## **458. ISO 27001 y 27002**

### üß† ¬øQu√© es ISO 27001?

Es un **est√°ndar internacional** que te **gu√≠a para crear y mantener un Sistema de Gesti√≥n de Seguridad de la Informaci√≥n (SGSI)**.

> Su objetivo es **proteger la confidencialidad, integridad y disponibilidad de la informaci√≥n** en una organizaci√≥n.

---

### üìö ¬øY qu√© es ISO 27002?

ISO 27002 **complementa a ISO 27001**.
Contiene una **lista detallada de controles y buenas pr√°cticas** que puedes aplicar para cumplir los requisitos de ISO 27001.

- **ISO 27001** = _¬øQu√© debes hacer?_
- **ISO 27002** = _¬øC√≥mo lo puedes hacer?_

---

### üéØ ¬øPara qu√© sirve?

Ayuda a:

- Proteger datos personales, financieros, confidenciales, etc.
- Cumplir con leyes (GDPR, HIPAA, etc.)
- Evitar hackeos, p√©rdidas de informaci√≥n, errores humanos
- Obtener certificaci√≥n y confianza de clientes

---

### üè∑Ô∏è Ejemplo f√°cil

Imagina que tienes una **cl√≠nica virtual**. ISO 27001 te pide:

> ‚ÄúDebes proteger los datos m√©dicos de tus pacientes‚Äù.

Entonces vas a ISO 27002 y encuentras controles como:

- Cifrado de datos sensibles
- Control de acceso por usuario
- Copias de seguridad
- Capacitaci√≥n del personal

---

### üß∞ ¬øC√≥mo se ‚Äúinstalan‚Äù? (C√≥mo se implementan en la pr√°ctica)

Aqu√≠ ‚Äúinstalar‚Äù significa **aplicar** el est√°ndar paso a paso dentro de tu organizaci√≥n.

---

### ‚öôÔ∏è PASOS PARA IMPLEMENTAR ISO 27001 + 27002

#### ‚úÖ Paso 1: Evaluaci√≥n inicial

- ¬øQu√© datos manejas? (Ej. correos, historiales, pagos)
- ¬øQu√© riesgos existen? (Hackeos, errores, robo de equipos)

#### ‚úÖ Paso 2: Crear un SGSI (Sistema de Gesti√≥n de Seguridad de la Informaci√≥n)

- Documentar pol√≠ticas
- Crear objetivos de seguridad
- Asignar roles y responsabilidades

#### ‚úÖ Paso 3: Aplicar controles (usando ISO 27002)

- Ejemplos:

  - üîê Control de acceso (contrase√±as fuertes)
  - üß© Gesti√≥n de incidentes (registro de ataques)
  - üíæ Respaldo de informaci√≥n (backups diarios)
  - üë®‚Äçüè´ Capacitaci√≥n a empleados

#### ‚úÖ Paso 4: Documentaci√≥n

Tienes que tener evidencia clara de tus procesos:

- Manual del SGSI
- Evaluaciones de riesgo
- Pol√≠ticas de seguridad
- Registros de actividades

#### ‚úÖ Paso 5: Auditor√≠a interna

Te aseguras de que los controles funcionan.

#### ‚úÖ Paso 6: Certificaci√≥n (opcional)

Puedes contratar una empresa certificadora externa para que revise tu SGSI y te otorgue el certificado ISO 27001.

---

### üß™ EJEMPLO COMPLETO

#### üéØ Contexto: Cl√≠nica virtual ‚ÄúSalud Digital Per√∫‚Äù

**Recoge:**

- Nombre, correo, DNI
- Historial m√©dico
- Pagos con tarjeta

---

#### üìù Paso 1: Evaluaci√≥n de riesgos

| Activo              | Riesgo                 | Impacto |
| ------------------- | ---------------------- | ------- |
| Historial m√©dico    | Robo de datos (hacker) | Alto    |
| Base de datos       | Borrado accidental     | Medio   |
| Informaci√≥n de pago | Filtraci√≥n por malware | Alto    |

---

#### üõ°Ô∏è Paso 2: Implementar controles (seg√∫n ISO 27002)

| Control ISO 27002                   | Acci√≥n aplicada                             |
| ----------------------------------- | ------------------------------------------- |
| 5.1 Pol√≠ticas de seguridad          | Se redact√≥ pol√≠tica de uso de datos         |
| 8.2 Clasificaci√≥n de la informaci√≥n | Se etiquetaron datos seg√∫n sensibilidad     |
| 9.2 Gesti√≥n de acceso de usuarios   | Se cre√≥ control de acceso con roles         |
| 10.1 Cifrado                        | Se implement√≥ AES-256 para la base de datos |
| 12.3 Copias de respaldo             | Backups autom√°ticos diarios                 |
| 16.1 Gesti√≥n de incidentes          | Se defini√≥ un plan de respuesta             |
| 17.1 Continuidad del negocio        | Se desarroll√≥ plan ante desastres           |

---

#### üìÇ Paso 3: Documentaci√≥n

- Manual de SGSI con controles aplicados
- Mapa de activos
- Evaluaci√≥n de riesgos y tratamiento
- Registros de formaci√≥n del personal

---

#### üîé Paso 4: Auditor√≠a interna

- Se verifica el cumplimiento de controles.
- Se simulan incidentes para probar la respuesta.

---

#### ü•á Paso 5: Certificaci√≥n (opcional)

Se contrata a una entidad certificadora (como BSI, T√úV o SGS)
‚Üí Se obtiene el certificado ISO 27001.

---

### üîö Conclusi√≥n

| ISO 27001                         | ISO 27002                            |
| --------------------------------- | ------------------------------------ |
| Define **qu√© hacer** (crear SGSI) | Sugiere **c√≥mo hacerlo** (controles) |
| Est√°ndar base                     | Gu√≠a pr√°ctica con controles          |
| Puedes certificarte               | Es gu√≠a de apoyo, no se certifica    |

---

### üõ† ¬øY c√≥mo se empieza?

Puedes usar herramientas gratuitas como:

- [ISO 27001 Toolkit de ISMS.online](https://www.isms.online/)
- Google Sheets para clasificar y documentar
- CyberChef o VeraCrypt para cifrado
- GitHub o Google Drive con control de versiones

---

[üîº](#√≠ndice)

---

## **459. Data Loss Prevention (DLP)**

![Data Loss Prevention](../img/6_Ciberseguridad_Defensiva/DLP.jpg "Data Loss Prevention")

### ‚úÖ ¬øQu√© es DLP?

**Data Loss Prevention (Prevenci√≥n de P√©rdida de Datos)** es un conjunto de **herramientas y estrategias** que evitan que **informaci√≥n sensible** se pierda, se filtre o sea enviada a personas no autorizadas.

---

### üéØ ¬øPor qu√© es importante?

Las empresas manejan informaci√≥n muy valiosa como:

- N√∫meros de tarjeta
- Datos personales (DNI, nombres, tel√©fonos)
- Archivos m√©dicos, legales o financieros
- Propiedad intelectual (c√≥digos fuente, f√≥rmulas, dise√±os)

Un error humano, un malware o un empleado malintencionado podr√≠a:

- Enviar un correo con archivos confidenciales por accidente
- Subir documentos sensibles a la nube p√∫blica
- Copiar la base de datos en un USB

DLP ayuda a **detectar, bloquear y alertar** sobre estos incidentes.

---

### üì¶ Tipos de DLP

| Tipo de DLP      | ¬øD√≥nde act√∫a?                           | Ejemplo                                     |
| ---------------- | --------------------------------------- | ------------------------------------------- |
| **Endpoint DLP** | En dispositivos: laptops, USB, etc.     | Bloquear copiar a USB                       |
| **Network DLP**  | En el tr√°fico de red                    | Detectar env√≠o de datos por email o web     |
| **Storage DLP**  | En servidores, bases de datos o la nube | Evitar que subas info a Dropbox sin permiso |

---

### üß™ Ejemplo f√°cil de entender

> Pedro trabaja en una empresa financiera. Sin querer, intenta enviar por correo un archivo Excel con datos de tarjetas de cr√©dito a un cliente.

Con DLP:

- El sistema analiza el archivo.
- Detecta que contiene 16 d√≠gitos que parecen tarjetas Visa.
- Bloquea el env√≠o y le muestra una advertencia:

  _‚ÄúEste archivo contiene informaci√≥n confidencial. Revisa antes de enviarlo.‚Äù_

---

### ‚öôÔ∏è ¬øC√≥mo se instala o implementa DLP?

---

### üõ† 1. Elegir una herramienta DLP

#### Algunas opciones populares:

| Herramienta               | Tipo                       | Detalles                          |
| ------------------------- | -------------------------- | --------------------------------- |
| **Microsoft Purview DLP** | Integrado en Microsoft 365 | Detecta y bloquea datos sensibles |
| **Symantec DLP**          | Empresarial                | Muy completo y personalizable     |
| **Forcepoint DLP**        | Empresarial                | Anal√≠tica avanzada                |
| **OpenDLP**               | Gratuito                   | Escanea datos en red/local        |

---

### üõ† 2. Definir las **pol√≠ticas de seguridad**

¬øQu√© quieres proteger?

- N√∫meros de DNI, tarjetas, contrase√±as, correos, archivos legales‚Ä¶
- ¬øQu√© acciones quieres evitar? (Enviar por email, copiar a USB, subir a Google Drive‚Ä¶)

---

### üõ† 3. Instalar los agentes o integraciones

- En **laptops o PCs** (agentes DLP)
- En el **servidor de correo electr√≥nico** (Outlook, Gmail)
- En la **red** (firewalls, proxies)
- En la **nube** (Google Workspace, Microsoft 365, OneDrive)

---

### üõ† 4. Configurar reglas

Por ejemplo:

- **Regla 1**: Si un archivo contiene 10 o m√°s n√∫meros similares a DNI ‚Üí bloquear.
- **Regla 2**: Si alguien intenta copiar archivos .xlsx a un USB ‚Üí alertar.
- **Regla 3**: Si se detectan datos bancarios en correos salientes ‚Üí detener y notificar.

---

### üõ† 5. Pruebas y monitoreo

- Env√≠as datos de prueba para ver si la DLP reacciona correctamente.
- Generas reportes autom√°ticos para el equipo de seguridad.

---

### üíª EJEMPLO COMPLETO: DLP en una cl√≠nica

#### üè• Cl√≠nica ‚ÄúSalud Digital Per√∫‚Äù

**Objetivo**: Proteger informaci√≥n m√©dica y DNI de pacientes.

---

#### 1. Selecci√≥n de la soluci√≥n DLP

‚û°Ô∏è Se elige **Microsoft Purview DLP** (viene con Microsoft 365 E5).

---

#### 2. Definici√≥n de pol√≠tica

- Bloquear cualquier correo externo que incluya:

  - N√∫meros de DNI (8 d√≠gitos)
  - Palabras clave como ‚Äúdiagn√≥stico‚Äù, ‚Äúhistorial cl√≠nico‚Äù

---

#### 3. Configuraci√≥n en Microsoft Purview

Desde el portal [https://compliance.microsoft.com](https://compliance.microsoft.com):

üîπ Crear pol√≠tica nueva ‚Üí DLP ‚Üí Exchange email

üîπ Elegir condici√≥n:

**‚ÄúContent contains Peruvian National ID Format‚Äù**

üîπ Acci√≥n:

**Bloquear env√≠o** + **Notificar al usuario y administrador**

---

#### 4. Prueba

Pedro redacta este email desde Outlook:

> ‚ÄúAdjunto el diagn√≥stico del paciente con DNI 74563211 en archivo Word.‚Äù

Resultado:

üö´ Outlook bloquea el env√≠o ‚Üí
üì© Mensaje: _‚ÄúNo puedes enviar este contenido fuera de la organizaci√≥n.‚Äù_

---

#### 5. Reporte

El sistema guarda este intento y genera un **log de incidentes** para que lo revise el equipo de seguridad.

---

### üîö Conclusi√≥n

| Ventaja del DLP                           | ¬øC√≥mo se aplica?                                            |
| ----------------------------------------- | ----------------------------------------------------------- |
| Protege datos personales y confidenciales | Detecta patrones (como DNI, tarjetas)                       |
| Previene fugas accidentales o maliciosas  | Bloquea, alerta y registra                                  |
| Se adapta a empresas peque√±as o grandes   | Desde soluciones como Microsoft 365 hasta DLP empresariales |

---

[üîº](#√≠ndice)

---

## **460. DLP Profesional/Empresarial**

### üîê ¬øQu√© es DLP profesional o empresarial?

**DLP (Data Loss Prevention)** profesional o empresarial es una **soluci√≥n avanzada** usada por **empresas medianas y grandes** para:

- Detectar datos sensibles (como informaci√≥n personal, financiera, m√©dica, etc.)
- Controlar c√≥mo se **usan, mueven o comparten** esos datos
- Evitar fugas de informaci√≥n, tanto **accidentales como intencionales**
- Generar **alertas, bloqueos o reportes** detallados para los equipos de seguridad

---

### üß† Diferencias entre un DLP b√°sico y uno profesional

| Caracter√≠stica       | DLP b√°sico (gratuito o local) | DLP profesional (empresarial)                               |
| -------------------- | ----------------------------- | ----------------------------------------------------------- |
| Alcance              | PC o red local                | Toda la organizaci√≥n (nube, red, endpoints)                 |
| Integraci√≥n          | Limitada                      | Con Microsoft 365, Google Workspace, correo, bases de datos |
| Inteligencia         | Reglas simples                | AI, aprendizaje autom√°tico, patrones predefinidos           |
| Auditor√≠a y reportes | B√°sicos o inexistentes        | Centralizados, exportables, personalizables                 |
| Escalabilidad        | Manual                        | Centralizada y automatizada                                 |

---

### üéØ ¬øQu√© protege un DLP empresarial?

- Nombres completos
- DNI / SSN / Pasaportes
- Tarjetas de cr√©dito
- Archivos m√©dicos (como PDF, Excel)
- Contratos confidenciales
- C√≥digo fuente

---

### üõ† Ejemplos f√°ciles de entender

#### 1. Escenario com√∫n

> Un empleado quiere subir un archivo Excel con datos de pacientes a su cuenta personal de Google Drive.

**Sin DLP**: lo sube y no queda rastro.

**Con DLP**: el sistema detecta que el archivo contiene datos m√©dicos y bloquea la subida. Env√≠a una alerta al administrador.

---

#### 2. Otro escenario

> Una empleada copia 50 archivos PDF legales a su USB.

**Con DLP Endpoint**:

Detecta el tipo de archivo y el contexto ‚Üí bloquea la acci√≥n o lo cifra autom√°ticamente para evitar fuga.

---

### üß∞ ¬øQu√© herramientas DLP profesionales existen?

| Herramienta                         | Ventajas clave                                                |
| ----------------------------------- | ------------------------------------------------------------- |
| **Microsoft Purview DLP**           | Ideal para empresas con Microsoft 365                         |
| **Symantec DLP**                    | Potente, con inspecci√≥n profunda de datos                     |
| **Forcepoint DLP**                  | An√°lisis del comportamiento, buena para insider threats       |
| **Digital Guardian**                | DLP para entornos con IP muy sensible (propiedad intelectual) |
| **McAfee Total Protection for DLP** | Muy completo, con m√≥dulos para nube y red                     |

---

### üß™ ¬øC√≥mo se instala e implementa un DLP empresarial?

---

#### üî∏ Paso 1: **Elegir el proveedor**

Ejemplo: Microsoft Purview (para una empresa con Microsoft 365)

---

#### üî∏ Paso 2: **Definir qu√© datos son sensibles**

- N√∫meros de tarjetas, DNI, correo corporativo
- Palabras clave como ‚Äúconfidencial‚Äù, ‚Äúsecreto‚Äù, ‚Äúinforme m√©dico‚Äù

---

#### üî∏ Paso 3: **Instalar los agentes**

- En computadoras (Windows/macOS): para Endpoint DLP
- En el correo (Exchange, Gmail)
- En la nube (OneDrive, SharePoint, Google Drive)
- En red o servidores (si aplica)

---

#### üî∏ Paso 4: **Crear pol√≠ticas DLP**

Ejemplo:

- Regla: Si alguien adjunta un archivo con 5 o m√°s DNIs ‚Üí bloquear el correo
- Regla: Si se detecta un patr√≥n de tarjeta de cr√©dito ‚Üí enviar alerta
- Regla: Si alguien copia documentos a USB ‚Üí solo si est√° encriptado

---

#### üî∏ Paso 5: **Probar y afinar**

Antes de bloquear, se puede poner en ‚Äúmodo auditor√≠a‚Äù para revisar qu√© se detecta.

---

#### üî∏ Paso 6: **Supervisar y generar reportes**

- Informes de intentos bloqueados
- Usuarios que intentan mover datos sensibles
- Actividad sospechosa

---

### ‚úÖ Ejemplo completo: DLP empresarial con Microsoft Purview

#### üè¢ Empresa: ‚ÄúLegalTech Per√∫ SAC‚Äù

**Problema**: Los abogados env√≠an contratos con datos personales por correo y quieren evitar fugas.

---

#### üß© Paso a paso

##### üõ† Instalaci√≥n/configuraci√≥n (Microsoft 365)

1. Ingresar a [compliance.microsoft.com](https://compliance.microsoft.com)
2. Ir a ‚Äú**Pol√≠ticas de prevenci√≥n de p√©rdida de datos (DLP)**‚Äù
3. Crear nueva pol√≠tica:

   - Nombre: ‚ÄúProtecci√≥n de Contratos‚Äù
   - Ubicaci√≥n: Outlook, Teams, OneDrive
   - Tipo de datos: Peruvian DNI, nombres y t√©rminos como ‚Äúcontrato‚Äù, ‚Äúcliente‚Äù

##### ‚öôÔ∏è Configurar regla:

- Acci√≥n: **Bloquear el env√≠o si es a un correo externo**
- Notificaci√≥n: enviar alerta al equipo de seguridad + mostrar mensaje al usuario

##### üß™ Prueba:

Se intenta enviar un Word con el siguiente contenido:

```
Contrato del cliente Juan P√©rez, DNI 78562341. Adjuntamos copia.
```

A: `cliente@gmail.com`

---

##### üßæ Resultado:

- El correo **no se env√≠a**
- El usuario ve: _‚ÄúEste mensaje fue bloqueado por contener informaci√≥n sensible.‚Äù_
- El administrador recibe un correo:

  ‚Äú‚ö†Ô∏è Intento de env√≠o de datos personales bloqueado desde [pedro@legaltech.com](mailto:pedro@legaltech.com)‚Äù

---

### üìä Beneficios para la empresa

‚úÖ Cumple con normativas como **GDPR**, **Ley de protecci√≥n de datos personales del Per√∫**, etc.

‚úÖ Aumenta la **conciencia de seguridad** en los empleados

‚úÖ Reduce riesgos de filtraci√≥n, multas y da√±o reputacional

‚úÖ Centraliza el control y reporte

---

### üìå Conclusi√≥n

> Un DLP empresarial no solo **protege datos**, sino que **educa, audita y responde** autom√°ticamente a intentos de fuga de informaci√≥n.

Es una **pieza clave en la ciberseguridad corporativa**.

---

[üîº](#√≠ndice)

---

## **461. Cuadrante m√°gico de Gartner**

### üß† ¬øQu√© es el Cuadrante M√°gico de Gartner?

El **Cuadrante M√°gico (Magic Quadrant)** es una herramienta visual desarrollada por la empresa **Gartner**, una de las firmas m√°s importantes del mundo en **investigaci√≥n y asesor√≠a tecnol√≥gica**.

El Cuadrante M√°gico **eval√∫a a los proveedores de tecnolog√≠a** en funci√≥n de:

- **Su capacidad de ejecuci√≥n**
- **La integridad de su visi√≥n**

Y **los ubica en un gr√°fico dividido en 4 cuadrantes**, lo cual permite a empresas tomar **decisiones informadas** sobre qu√© proveedor o tecnolog√≠a elegir.

---

### üéØ ¬øCu√°l es el objetivo?

Ayudar a las empresas a responder preguntas como:

- ¬øQu√© herramientas o empresas son l√≠deres en ciberseguridad?
- ¬øQu√© proveedor de nube tiene mejor rendimiento?
- ¬øQu√© software de an√°lisis de datos est√° creciendo?

---

### üìà Los 4 cuadrantes de Gartner

El gr√°fico se divide en 2 ejes:

- **Eje X:** _Integridad de visi√≥n_ (qu√© tan innovadora y clara es su estrategia)
- **Eje Y:** _Capacidad de ejecuci√≥n_ (qu√© tan bien ejecutan esa estrategia)

Y forma estos **4 cuadrantes**:

| Cuadrante                     | Significado                                                                         |
| ----------------------------- | ----------------------------------------------------------------------------------- |
| **L√≠deres (Leaders)**         | Alta ejecuci√≥n + visi√≥n s√≥lida. Son empresas consolidadas. Ej: Microsoft, Palo Alto |
| **Retadores (Challengers)**   | Alta ejecuci√≥n, pero visi√≥n limitada. Cumplen bien, pero no innovan tanto.          |
| **Visionarios (Visionaries)** | Visi√≥n innovadora, pero a√∫n no ejecutan bien o no est√°n consolidados.               |
| **Nicho (Niche Players)**     | Baja ejecuci√≥n y visi√≥n limitada. Enfocados en mercados espec√≠ficos.                |

---

#### üìä Ejemplo visual:

```
               |
               |               ‚óè Microsoft
 Capacidad     |    ‚óè Fortinet     (Leaders)
 de ejecuci√≥n  |                     ‚óè Palo Alto
               |
               |    ‚óè Sophos
               |         (Challengers)
               |
               -----------------------------------
                   Integridad de la visi√≥n ‚Üí
                       ‚óè SentinelOne (Visionary)
                       ‚óè Empresa local X (Niche)
```

---

### üìå Ejemplo real: Cuadrante de ciberseguridad (EDR - Endpoint Detection & Response)

Supongamos que una empresa quiere elegir una soluci√≥n para proteger sus computadoras.

#### Gartner eval√∫a empresas como:

- **CrowdStrike**
- **Microsoft Defender for Endpoint**
- **SentinelOne**
- **Trend Micro**

Y en el cuadrante puedes ver que:

- **Microsoft y CrowdStrike** ‚Üí est√°n en ‚ÄúL√≠deres‚Äù
- **SentinelOne** ‚Üí est√° como ‚ÄúVisionario‚Äù
- **Trend Micro** ‚Üí puede estar en ‚ÄúChallenger‚Äù

---

### üõ† ¬øC√≥mo accedo al Cuadrante M√°gico de Gartner?

#### 1. Acceso directo desde Gartner (requiere cuenta):

- Ir a: [https://www.gartner.com/en/research/magic-quadrant](https://www.gartner.com/en/research/magic-quadrant)
- Crear una cuenta gratuita (con correo corporativo)
- Buscar por categor√≠a: ej. _Magic Quadrant for Endpoint Protection Platforms_

> ‚ö†Ô∏è Algunos informes son de pago, pero puedes acceder gratis si los **proveedores** los publican en sus p√°ginas.

---

#### 2. Acceso gratuito desde proveedores:

Por ejemplo, busca en Google:

```
"Magic Quadrant EDR site:crowdstrike.com"
```

All√≠ ver√°s algo como:

üëâ [CrowdStrike - Gartner Magic Quadrant 2024](https://www.crowdstrike.com/resources/reports/gartner-magic-quadrant-2024/)

Solo te pedir√° llenar un formulario (nombre, empresa, correo) y te descarga el PDF.

---

### ‚úÖ Ejemplo completo: C√≥mo elegir una soluci√≥n SIEM usando el Cuadrante de Gartner

#### üè¢ Empresa: ‚ÄúSeguriTech SAC‚Äù

**Necesidad**: Implementar un sistema **SIEM** (Security Information and Event Management) para monitorear eventos de seguridad.

---

#### üîé Paso 1: Buscar el cuadrante

- Google: `magic quadrant siem site:ibm.com`
- Accedemos al PDF gratuito de IBM

---

#### üìä Paso 2: Analizar el cuadrante

El Cuadrante M√°gico para SIEM 2023 posiciona as√≠:

| Categor√≠a         | Empresas                      |
| ----------------- | ----------------------------- |
| **L√≠deres**       | Splunk, Microsoft, IBM QRadar |
| **Visionarios**   | Sumo Logic, Exabeam           |
| **Challengers**   | LogRhythm                     |
| **Niche Players** | Devo, LogPoint                |

---

#### üß† Paso 3: Decidir

La empresa ya usa Microsoft 365, as√≠ que puede usar **Microsoft Sentinel** (que est√° como L√≠der).

Decisi√≥n: **Microsoft Sentinel** es la mejor opci√≥n por compatibilidad, liderazgo y escalabilidad.

---

### üèÅ Conclusi√≥n

El **Cuadrante M√°gico de Gartner** es como una **"br√∫jula tecnol√≥gica"**, ideal para tomar decisiones empresariales.

**Ventajas clave:**

‚úÖ Permite comparar proveedores l√≠deres

‚úÖ Es visual y f√°cil de entender

‚úÖ Se actualiza cada a√±o

‚úÖ Ayuda a justificar decisiones ante directivos

---

[üîº](#√≠ndice)

---

## **462. Information Rights Management (IRM)**

### üß† ¬øQu√© es _Information Rights Management (IRM)_?

**IRM** (Gesti√≥n de Derechos de la Informaci√≥n) es una tecnolog√≠a que **controla qu√© pueden hacer las personas con la informaci√≥n**, incluso despu√©s de que ya la tengan.

üîê Es como ponerle un "candado inteligente" a tus archivos:

- Solo ciertas personas pueden abrirlo
- No pueden copiarlo, reenviarlo, imprimirlo o editarlo
- Y puedes hacer que expire en una fecha espec√≠fica

> IRM se usa en empresas para **proteger datos confidenciales**, como contratos, reportes financieros, secretos comerciales, etc.

---

### üéØ ¬øPara qu√© sirve IRM?

- **Evita filtraciones accidentales o malintencionadas**
- Protege documentos aunque salgan de tu red
- Permite revocar accesos incluso despu√©s de enviar el archivo
- Aplica controles como:

  - No copiar
  - No reenviar
  - No imprimir
  - V√°lido solo por ciertos d√≠as

---

### üì¶ ¬øD√≥nde se usa IRM?

- Microsoft Word, Excel, PowerPoint, Outlook
- PDF con Adobe Acrobat
- SharePoint, OneDrive, Teams
- Google Workspace (con funciones similares llamadas IRM o DLP)
- Herramientas empresariales como Azure Information Protection

---

### üß© Ejemplos f√°ciles de entender

| Ejemplo                         | Explicaci√≥n                                                       |
| ------------------------------- | ----------------------------------------------------------------- |
| üìß Mandas un informe por correo | Con IRM puedes evitar que el receptor lo reenv√≠e o lo imprima     |
| üìÑ Proteges un contrato en Word | El documento se puede abrir, pero no se puede copiar su contenido |
| üïí Das acceso solo por 7 d√≠as   | Despu√©s del plazo, el archivo queda ilegible autom√°ticamente      |
| üëÄ Solo para el gerente         | Solo su correo puede abrirlo, nadie m√°s                           |

---

### üõ† C√≥mo instalar IRM (en Windows y Microsoft Office)

#### ‚úÖ Requisitos:

1. Tener Microsoft 365 (Office moderno)
2. Una cuenta de empresa o educativa (no funciona con cuentas personales de Gmail)
3. Tener activado **Azure Information Protection (AIP)** o **Microsoft Purview**

---

#### üîß Paso a paso en Office Word (Ejemplo):

##### Paso 1: Abrir Word y el archivo que quieres proteger

##### Paso 2: Ir a `Archivo > Informaci√≥n > Proteger documento`

##### Paso 3: Clic en `Restringir acceso` ‚Üí Aparecen opciones IRM

##### Paso 4: Elegir:

- **"No reenviar"** o
- **"Solo lectura"**,
- o personalizar permisos (qui√©n puede ver, imprimir, editar)

##### Paso 5: Guardar el archivo

¬°Listo! Solo los usuarios que autorices podr√°n acceder seg√∫n las reglas.

---

### üß™ Ejemplo completo: Proteger un informe financiero con IRM

#### üè¢ Escenario:

Eres analista financiero y tienes que enviar un informe a dos gerentes, pero **no quieres que se reenv√≠e ni copie el contenido**.

---

#### 1. Abrir el archivo en Microsoft Word

Archivo: `informe-financiero.docx`

---

#### 2. Aplicar IRM

- Ir a: `Archivo > Informaci√≥n > Proteger documento > Restringir acceso`
- Elegir:

  ‚Üí ‚ÄúSolo los siguientes usuarios pueden leer‚Äù

  ‚Üí Agregas: `gerente1@empresa.com` y `gerente2@empresa.com`

  ‚Üí Desmarcas opci√≥n de imprimir, copiar y reenviar

  ‚Üí Estableces fecha de expiraci√≥n: 7 d√≠as

---

#### 3. Guardar el archivo y enviarlo

- Guardas el archivo como protegido (`.docx`)
- Lo env√≠as por Outlook

---

#### 4. Resultado:

- Solo esos 2 gerentes pueden abrir el archivo
- No pueden copiar ni imprimir
- Despu√©s de 7 d√≠as el archivo deja de abrirse
- Si lo reenv√≠an, otros usuarios no podr√°n verlo

---

### üîç ¬øY c√≥mo se ve del lado del receptor?

Cuando abren el documento:

- Les pide **iniciar sesi√≥n** con su cuenta autorizada
- Si no est√° en la lista, **no podr√°n abrirlo**
- Las opciones de "copiar", "imprimir", "reenviar" estar√°n deshabilitadas

---

### üéÅ Bonus: IRM para correos en Outlook

Tambi√©n puedes enviar correos protegidos:

- Abrir Outlook
- Redactar nuevo correo
- En la pesta√±a ‚ÄúOpciones‚Äù ‚Üí Clic en ‚ÄúPermisos‚Äù
- Selecciona: ‚ÄúNo reenviar‚Äù o ‚ÄúConfidencial‚Äù
- Env√≠as y el correo est√° protegido por IRM

---

### ‚úÖ Ventajas de IRM

‚úîÔ∏è Protege informaci√≥n sensible

‚úîÔ∏è Controla acciones incluso fuera de tu red

‚úîÔ∏è Compatible con Office y otros programas

‚úîÔ∏è Evita fugas por error humano

---

### ‚ùó Nota final

IRM **no reemplaza otras medidas de seguridad** como cifrado o firewalls, pero **las complementa**. Y es una herramienta muy poderosa en entornos profesionales y de ciberseguridad.

---

[üîº](#√≠ndice)

---

## **463. IRM Profesional/Empresarial**

### üõ° ¬øQu√© es IRM Profesional o Empresarial?

**IRM (Information Rights Management)** en el entorno **empresarial** es una soluci√≥n avanzada que **protege la informaci√≥n confidencial dentro y fuera de la organizaci√≥n** mediante **controles de acceso persistentes**.

üîë A diferencia del IRM b√°sico (como proteger un documento en Word), en su versi√≥n empresarial:

- Se integra con pol√≠ticas corporativas
- Usa sistemas como **Azure Information Protection**, **Microsoft Purview**, **Google Workspace DLP**, **Adobe DRM**, etc.
- Protege informaci√≥n en tr√°nsito, en uso y en reposo
- Incluye monitoreo y auditor√≠a de accesos

---

### ‚úÖ ¬øQu√© puede hacer IRM Profesional?

| Capacidad                         | Ejemplo                                                  |
| --------------------------------- | -------------------------------------------------------- |
| üîê Controlar acceso por identidad | Solo los empleados del √°rea legal pueden ver el contrato |
| ‚è≥ Caducar acceso autom√°ticamente | Un documento se autodestruye en 7 d√≠as                   |
| ‚õî Restringir acciones            | Bloquear copiar, imprimir, capturas de pantalla          |
| üì© Proteger correos electr√≥nicos  | Solo destinatarios aprobados pueden abrirlo              |
| üìÅ Proteger archivos en la nube   | En SharePoint, OneDrive o Google Drive                   |
| üìä Auditar el acceso              | Saber qui√©n abri√≥ un documento, desde d√≥nde y cu√°ndo     |
| üîÅ Revocar acceso remoto          | Aun si el archivo ya se descarg√≥                         |

---

### üß† ¬øC√≥mo funciona IRM Empresarial?

1. **Un administrador** define las pol√≠ticas: qui√©n puede acceder, qu√© puede hacer.
2. Los documentos se **etiquetan y protegen autom√°ticamente** seg√∫n contenido.
3. Al abrir el documento, el usuario debe **autenticarse** (ej. Microsoft Entra ID o Google Workspace).
4. Si cumple con las reglas, puede usarlo con restricciones.

---

### üß∞ ¬øQu√© soluciones IRM existen en el mundo profesional?

| Soluci√≥n IRM                          | Plataforma          | En qu√© se usa                                          |
| ------------------------------------- | ------------------- | ------------------------------------------------------ |
| **Microsoft Purview (antes AIP)**     | Windows, Office 365 | Word, Excel, PowerPoint, Outlook, OneDrive, SharePoint |
| **Google Workspace DLP + IRM**        | Gmail, Drive, Docs  | Control en Google Docs y correos                       |
| **Adobe LiveCycle Rights Management** | PDFs y Adobe Docs   | Control total sobre PDFs                               |
| **Vera IRM**                          | Multiplataforma     | Documentos y correos en cualquier plataforma           |
| **Seclore**, **Forcepoint DLP**       | Empresarial         | Protecci√≥n avanzada y auditor√≠a                        |

---

### ‚öôÔ∏è C√≥mo se instala IRM Empresarial (Microsoft Purview ‚Äì Ejemplo real)

#### üîß Paso 1: Requisitos

- Tener suscripci√≥n empresarial de **Microsoft 365 E3 o E5**
- Contar con Azure Active Directory (Microsoft Entra ID)
- Tener habilitado **Microsoft Purview Information Protection**

---

#### üîê Paso 2: Activar Rights Management

1. Ir a **Microsoft Purview Admin Center**: [https://compliance.microsoft.com/](https://compliance.microsoft.com/)
2. Navegar a **Information Protection**
3. Activar **Azure Rights Management** desde "Rights Management"

---

#### üìö Paso 3: Crear etiquetas de confidencialidad

1. Crear una etiqueta como:

   - ‚ÄúConfidencial - Solo RRHH‚Äù
   - ‚ÄúUso interno - No reenviar‚Äù

2. Definir pol√≠ticas:

   - Qui√©n puede ver
   - Si puede imprimir/copiar
   - Fecha de expiraci√≥n
   - Protecci√≥n en correos y archivos

3. Publicar etiquetas a grupos o usuarios

---

#### üì¶ Paso 4: Aplicaci√≥n de pol√≠ticas

Los empleados podr√°n:

- Seleccionar una etiqueta desde Word/Excel/Outlook
- O las pol√≠ticas se aplican autom√°ticamente si el archivo contiene, por ejemplo, **n√∫meros de tarjeta, DNI, contratos, etc.**

---

### üß™ Ejemplo completo: Proteger un contrato solo visible por Legal

#### üßæ Escenario:

Un abogado de la empresa debe compartir un contrato confidencial que solo el equipo legal puede leer. No debe imprimirse ni reenviarse.

---

#### 1. Crear etiqueta: ‚ÄúLegal - Confidencial‚Äù

- Acceso: Solo grupo `LegalTeam`
- Permisos: Leer, sin imprimir, sin copiar
- Expira: en 15 d√≠as
- Aplicable en Word y Outlook

---

#### 2. El abogado redacta el contrato en Word

- Selecciona en la cinta de Word:

  `Inicio > Sensibilidad > Legal - Confidencial`

---

#### 3. Env√≠a por Outlook

- El archivo adjunto mantiene los controles
- En Outlook:

  `Opciones > Permisos > No reenviar`

---

#### 4. Resultado

- Solo el equipo legal puede abrir el archivo
- No pueden copiar, imprimir ni reenviar
- Si lo reenv√≠an, el destinatario no podr√° abrirlo
- El acceso expira en 15 d√≠as autom√°ticamente

---

### üìà Beneficios del IRM Empresarial

| Ventaja                     | ¬øPor qu√© importa?                                   |
| --------------------------- | --------------------------------------------------- |
| üîí Seguridad persistente    | Protege el archivo sin importar d√≥nde est√©          |
| üëÄ Control granular         | Decide qui√©n, c√≥mo y cu√°ndo accede                  |
| üïµÔ∏è Auditor√≠a y trazabilidad | Puedes ver qui√©n abri√≥, cu√°ndo y desde d√≥nde        |
| üîÑ Revocaci√≥n remota        | Puedes bloquear el acceso incluso despu√©s del env√≠o |

---

### üß© ¬øDLP vs IRM?

- **DLP (Data Loss Prevention)**: Previene fugas en tiempo real (antes de salir)
- **IRM**: Protege la informaci√≥n **despu√©s de salir**

> ‚úÖ **Lo ideal**: Usar **DLP + IRM juntos** para m√°xima protecci√≥n

---

### ‚úÖ Conclusi√≥n

**IRM Profesional** es una herramienta cr√≠tica en ciberseguridad empresarial, especialmente para organizaciones que manejan datos confidenciales, legales o financieros. Te permite **controlar y monitorear la informaci√≥n m√°s all√° de tu red**, cumpliendo con regulaciones como GDPR, HIPAA, etc.

---

[üîº](#√≠ndice)

---

## **464. Full Disk Encryption**

### üîê ¬øQu√© es Full Disk Encryption (FDE)?

**Full Disk Encryption (FDE)** significa **cifrar todo el contenido de un disco duro o SSD** para proteger los datos **en caso de robo, p√©rdida o acceso no autorizado**.

#### üîç En palabras simples:

> Es como poner una caja fuerte virtual a todo tu disco: solo alguien con la **contrase√±a correcta** puede abrirla.

---

### üéØ ¬øPor qu√© es importante?

Imagina que pierdes tu laptop con:

- Fotos personales
- Documentos del trabajo
- Contrase√±as guardadas

Si tienes **FDE activado**, **nadie puede leer tu disco**, ni conect√°ndolo a otro equipo. Ver√°n solo ‚Äúbasura cifrada‚Äù.

---

### üîí ¬øQu√© cifra exactamente FDE?

- Archivos personales
- Archivos del sistema
- Programas instalados
- Particiones de recuperaci√≥n

üìå _Solo se puede acceder al contenido despu√©s de autenticarte al inicio del sistema (antes de Windows o Linux)._

---

### ‚úÖ Ejemplos de herramientas FDE populares

| Sistema        | Herramienta FDE | Tipo              |
| -------------- | --------------- | ----------------- |
| Windows        | BitLocker       | Nativo            |
| macOS          | FileVault       | Nativo            |
| Linux          | LUKS + dm-crypt | Nativo (avanzado) |
| Cross-platform | VeraCrypt       | Libre y gratuito  |

---

### ‚öôÔ∏è ¬øC√≥mo se instala y configura?

Te mostrar√© c√≥mo hacerlo en:

---

#### üíª 1. **Windows 10/11 con BitLocker (F√°cil)**

##### üìå Requisitos:

- Windows 10/11 Pro o Enterprise
- TPM 1.2 o superior (la mayor√≠a de laptops lo tienen)
- Ser administrador del sistema

##### üîß Pasos para activar BitLocker:

1. **Panel de Control** > ‚ÄúSistema y Seguridad‚Äù > ‚ÄúCifrado de unidad BitLocker‚Äù
2. Clic en ‚ÄúActivar BitLocker‚Äù en la unidad del sistema (usualmente C:)
3. Elige c√≥mo desbloquear:

   - Contrase√±a al arrancar
   - USB con llave de inicio

4. Guarda la **clave de recuperaci√≥n** (muy importante)
5. Elige:

   - ‚ÄúSolo espacio usado‚Äù (m√°s r√°pido) o
   - ‚ÄúDisco completo‚Äù (m√°s seguro)

6. Inicia el cifrado (toma unos minutos o horas)

‚úÖ Cuando reinicies, pedir√° la contrase√±a o usar√° TPM.

---

#### üêß 2. **Linux Ubuntu con LUKS (Durante la instalaci√≥n)**

##### üîß Pasos:

1. Al instalar Ubuntu, selecciona:

   > ‚úÖ ‚ÄúCifrar la nueva instalaci√≥n de Ubuntu por seguridad‚Äù

2. Crea una contrase√±a maestra segura
3. El sistema instalar√° LUKS autom√°ticamente
4. Cada vez que inicies Ubuntu, pedir√° la contrase√±a

‚úîÔ∏è Tambi√©n se puede cifrar manualmente una partici√≥n usando:

```bash
cryptsetup luksFormat /dev/sdX
```

---

#### üõ°Ô∏è 3. **VeraCrypt (Multiplataforma)**

##### Compatible con Windows, macOS, Linux

Pasos b√°sicos:

1. Descargar desde: [https://www.veracrypt.fr/](https://www.veracrypt.fr/)
2. Instalar y ejecutar
3. Crear un ‚Äúvolumen cifrado‚Äù o cifrar todo el disco
4. Seguir el asistente para seleccionar disco, algoritmo y contrase√±a
5. Montar el volumen cifrado como una unidad virtual

---

### üß™ Ejemplo completo: Proteger tu laptop personal con BitLocker

#### üéØ Escenario:

Gustavo trabaja como data scientist con informaci√≥n confidencial. Tiene una laptop con Windows 11 Pro y quiere evitar el robo de sus datos si le roban la laptop.

---

#### üìù Pasos que sigue:

1. En el men√∫ Inicio, escribe: `BitLocker` y abre ‚ÄúAdministrar BitLocker‚Äù
2. En la unidad C:, hace clic en ‚ÄúActivar BitLocker‚Äù
3. Elige desbloquear con **contrase√±a al encender**
4. Guarda la clave de recuperaci√≥n en su **cuenta Microsoft**
5. Escoge cifrar **todo el disco**
6. Inicia el proceso de cifrado (30 min aprox.)
7. Reinicia la laptop: pide la contrase√±a de BitLocker antes de Windows

---

#### ‚úÖ Resultado:

- Si alguien roba el disco, **no puede acceder a nada** sin la contrase√±a
- Gustavo trabaja tranquilo sabiendo que sus datos est√°n cifrados
- Cumple con buenas pr√°cticas de seguridad y auditor√≠a

---

### üìä Ventajas y desventajas

| Ventajas                                  | Desventajas                                                               |
| ----------------------------------------- | ------------------------------------------------------------------------- |
| ‚úÖ Protecci√≥n total de datos              | ‚ùå Rendimiento puede bajar levemente (m√≠nimo con SSD)                     |
| ‚úÖ Cifrado autom√°tico al inicio           | ‚ùå Si olvidas la contrase√±a y la clave de recuperaci√≥n, pierdes los datos |
| ‚úÖ Compatible con pol√≠ticas empresariales | ‚ùå TPM puede no estar disponible en PCs antiguas                          |

---

### üîÅ Buenas pr√°cticas

- Usa **contrase√±as fuertes**
- **Guarda la clave de recuperaci√≥n** en un lugar seguro (nube o USB)
- Combina FDE con otras capas: antivirus, firewall, backups
- Usa FDE **desde el inicio del sistema**, no cuando ya hay malware

---

### ‚úÖ Conclusi√≥n

**Full Disk Encryption** es una **herramienta fundamental en ciberseguridad personal y empresarial**. Es f√°cil de activar, protege todo tu disco, y te permite trabajar con confianza sabiendo que **nadie m√°s podr√° ver tus archivos** sin tu autorizaci√≥n.

---

[üîº](#√≠ndice)

---

## **465. Full Disk Encryption con Bitlocker**

### üîê ¬øQu√© es Full Disk Encryption (FDE)?

**Full Disk Encryption (FDE)** es una t√©cnica que **cifra todos los datos del disco duro** de una computadora para protegerlos del acceso no autorizado.

#### üìå ¬øQu√© significa cifrar?

Convertir los datos en un formato ilegible sin la **clave o contrase√±a correcta**.

---

### üí° ¬øQu√© es BitLocker?

**BitLocker** es una herramienta de cifrado **nativa de Windows** (incluida en Windows 10/11 Pro, Enterprise o Education) que permite realizar FDE de forma sencilla.

#### üõ°Ô∏è ¬øQu√© cifra BitLocker?

- Todo el sistema operativo
- Programas y documentos
- Archivos temporales
- Archivos eliminados que a√∫n no se sobrescribieron

---

### üéØ ¬øPara qu√© sirve usar BitLocker?

Imagina que pierdes tu laptop con informaci√≥n sensible. Aunque alguien saque el disco y lo conecte a otra computadora, **no podr√° acceder a tus archivos** sin la contrase√±a de BitLocker.

---

### ‚úÖ Requisitos para usar BitLocker

1. Windows 10/11 Pro, Enterprise o Education
2. Tener un chip **TPM (Trusted Platform Module)** en la placa madre (casi todas las laptops lo traen desde 2016)
3. Ser **administrador del equipo**

üß† **¬øQu√© es el TPM?**

Un microchip de seguridad que almacena claves criptogr√°ficas. BitLocker lo usa para proteger la clave de cifrado.

---

### ‚öôÔ∏è ¬øC√≥mo se activa BitLocker? (Pasos paso a paso)

#### üîß Paso 1: Comprobar si tu Windows lo permite

1. Presiona `Windows + R`, escribe:

   ```shell
   winver
   ```

   ‚úÖ Debes tener **Windows 10/11 Pro, Enterprise o Education**

---

#### üîß Paso 2: Activar BitLocker

1. Ve a:

   `Panel de Control > Sistema y seguridad > Cifrado de unidad BitLocker`

2. En la unidad del sistema (usualmente C:), haz clic en:

   ‚û§ **‚ÄúActivar BitLocker‚Äù**

3. Selecciona **c√≥mo quieres desbloquear el disco**:

   - Con una **contrase√±a**
   - Con una **unidad USB**
   - Autom√°ticamente con el TPM (m√°s c√≥modo pero menos control)

4. Guarda la **clave de recuperaci√≥n**:

   - Puedes guardarla en tu cuenta Microsoft, USB, o imprimirla
   - ‚ö†Ô∏è ¬°No la pierdas! Si olvidas la contrase√±a, esta clave es tu √∫nico acceso

5. Selecciona **qu√© parte del disco quieres cifrar**:

   - Solo el espacio usado (m√°s r√°pido)
   - Todo el disco (m√°s seguro, recomendado)

6. Elige **modo de cifrado**:

   - Nuevo modo (para discos en esta PC)
   - Compatible (para discos que podr√≠as mover a otras PCs)

7. Haz clic en **‚ÄúIniciar cifrado‚Äù**

---

### üïí ¬øCu√°nto demora?

Depende del tama√±o del disco y de qu√© opci√≥n elegiste:

- 128 GB: unos 10‚Äì30 minutos (solo espacio usado)
- 1 TB: puede demorar 1‚Äì3 horas (disco completo)

---

### üß™ Ejemplo pr√°ctico completo

#### üéØ Escenario:

Gustavo tiene una laptop con Windows 11 Pro y quiere proteger toda la informaci√≥n personal, de sus proyectos, y clientes.

---

#### üìù Paso a paso de Gustavo:

1. Presiona `Windows + S`, escribe **BitLocker** y abre ‚ÄúAdministrar BitLocker‚Äù
2. En la unidad **C:**, elige **‚ÄúActivar BitLocker‚Äù**
3. Elige **‚ÄúUsar contrase√±a para desbloquear la unidad‚Äù**
4. Crea una contrase√±a fuerte:
   `Gus$2025Seguridad`
5. Guarda la **clave de recuperaci√≥n** en su cuenta Microsoft
6. Selecciona **‚ÄúCifrar todo el disco‚Äù** para mayor seguridad
7. Elige el **modo nuevo** de cifrado
8. Clic en **‚ÄúIniciar cifrado‚Äù**
9. Espera 20 minutos. Se reinicia la PC.
10. Enciende su laptop, ingresa la contrase√±a BitLocker, y listo ‚úÖ

---

#### üîê ¬øQu√© pasa ahora si alguien roba el disco duro?

- No podr√° ver ni un solo archivo
- Aunque conecte el disco a otro PC, **todo estar√° cifrado**
- Gustavo conserva el control total de su informaci√≥n

---

### üìä Ventajas de BitLocker

| ‚úÖ Ventajas                     | ‚ùå Desventajas                                          |
| ------------------------------- | ------------------------------------------------------- |
| Muy f√°cil de usar en Windows    | Solo disponible en ediciones Pro o superiores           |
| Protecci√≥n completa del disco   | Si pierdes la clave de recuperaci√≥n, pierdes todo       |
| Usa el chip TPM de forma segura | Liger√≠sima reducci√≥n de rendimiento (casi nula en SSDs) |

---

### üîÅ Buenas pr√°cticas

- Guarda la **clave de recuperaci√≥n** en 2 lugares seguros (USB + nube)
- Usa una contrase√±a BitLocker distinta de tu usuario de Windows
- No uses solo el TPM: agr√©gale **una contrase√±a adicional**
- Haz **copias de seguridad cifradas** tambi√©n

---

### üìå ¬øQuieres probar sin activar BitLocker?

Puedes usar una **unidad USB** de prueba:

1. Inserta un USB > click derecho > "Activar BitLocker"
2. Pon contrase√±a > guarda clave > cifra la unidad
3. Ahora solo puedes abrir el USB en PCs con la contrase√±a

---

[üîº](#√≠ndice)

---

## **466. Full Disk Encryption en Linux (LUKS)**

### üß© ¬øQu√© es Full Disk Encryption (FDE)?

**Full Disk Encryption (FDE)** significa **cifrar todo el contenido del disco**, incluyendo:

- Archivos
- Sistema operativo
- Memoria swap
- Espacio libre

#### üéØ ¬øPara qu√© sirve?

Si alguien roba tu disco o laptop, **no podr√° leer nada sin la contrase√±a de cifrado**, ni siquiera arrancar el sistema.

---

### üîê ¬øQu√© es LUKS?

**LUKS** significa **Linux Unified Key Setup**, y es el **est√°ndar en Linux** para hacer FDE.

- Usa **cifrado sim√©trico** (por ejemplo AES)
- Se combina con `dm-crypt`, que maneja la parte del cifrado en el kernel
- Puedes proteger con contrase√±a o llave USB
- Soporta m√∫ltiples claves (hasta 8 slots)

üîí LUKS cifra el disco **desde el arranque (boot)**. Solo quien conozca la clave puede iniciar Linux.

---

### üî® ¬øD√≥nde se usa LUKS?

- En laptops Linux para proteger archivos personales
- En servidores para proteger informaci√≥n sensible
- En sistemas donde la ley exige cifrado (como GDPR, HIPAA)

---

### üõ†Ô∏è ¬øC√≥mo se instala/configura LUKS?

Hay **dos formas** comunes:

1. **Cifrar el disco completo al instalar Linux (recomendado para nuevos sistemas)**
2. **Cifrar un disco o partici√≥n ya existente** (√∫til si ya tienes Linux instalado)

---

### ‚úÖ Ejemplo 1: LUKS desde instalaci√≥n (Ubuntu, Debian, Arch, etc.)

> Esta es la forma m√°s sencilla y segura. La mayor√≠a de distros modernas lo permiten desde el instalador gr√°fico.

#### üéØ Paso a paso:

1. Inicia desde el **USB de instalaci√≥n** de tu distro
2. Cuando elijas c√≥mo particionar:

   - Selecciona "Usar cifrado para seguridad" o "Cifrar disco con LVM y LUKS"

3. Elige una contrase√±a fuerte (ejemplo: `Guss!Cifra2025`)
4. Instala el sistema normalmente
5. Al reiniciar, el sistema pedir√° **la contrase√±a LUKS antes de arrancar Linux**

---

### ‚úÖ Ejemplo 2: Cifrar una partici√≥n o disco manualmente

> Ideal para discos externos, USBs, o particiones de respaldo.

#### üì¶ Requisitos previos:

- Una distro Linux instalada
- Terminal con privilegios de root
- Paquete `cryptsetup` (viene por defecto en muchas distros)

---

#### ‚öôÔ∏è Instalaci√≥n de cryptsetup (por si no est√°):

```bash
sudo apt update
sudo apt install cryptsetup
```

---

#### üîß Paso a paso (disco `/dev/sdb` como ejemplo):

‚ö†Ô∏è Este proceso **borra todo lo que hay** en la unidad, √∫salo con cuidado.

```bash
# 1. Verifica el disco
lsblk

# 2. Inicializa el cifrado LUKS en la unidad
sudo cryptsetup luksFormat /dev/sdb

# 3. Abre la unidad cifrada (le damos un nombre temporal: disco_cifrado)
sudo cryptsetup open /dev/sdb disco_cifrado

# 4. Crea un sistema de archivos dentro del contenedor cifrado
sudo mkfs.ext4 /dev/mapper/disco_cifrado

# 5. Monta el disco como cualquier otro
sudo mkdir /mnt/seguro
sudo mount /dev/mapper/disco_cifrado /mnt/seguro
```

‚úÖ ¬°Listo! Ahora `/mnt/seguro` es un disco completamente cifrado.

---

#### üíæ Para desmontar:

```bash
sudo umount /mnt/seguro
sudo cryptsetup close disco_cifrado
```

---

### üß™ Ejemplo completo (caso real de pr√°ctica)

#### üéØ Escenario:

Gustavo tiene un **disco externo USB** y quiere cifrarlo completamente con LUKS para guardar respaldos sensibles.

---

#### üöÄ Comandos usados por Gustavo:

```bash
# Detecta el disco
lsblk

# Inicializa LUKS (esto borra el contenido)
sudo cryptsetup luksFormat /dev/sdb

# Introduce contrase√±a fuerte: GussUSB2025!

# Abre el contenedor cifrado
sudo cryptsetup open /dev/sdb usb_cifrado

# Da formato ext4
sudo mkfs.ext4 /dev/mapper/usb_cifrado

# Monta y copia archivos
sudo mkdir /mnt/usbseguro
sudo mount /dev/mapper/usb_cifrado /mnt/usbseguro

# Copia documentos confidenciales
cp ~/Documentos/proyecto_final.pdf /mnt/usbseguro

# Cierra y desmonta
sudo umount /mnt/usbseguro
sudo cryptsetup close usb_cifrado
```

üéâ ¬°Disco listo! Ahora si alguien roba el USB, **no podr√° abrirlo sin la contrase√±a**.

---

### üìä Comparaci√≥n BitLocker vs LUKS

| Caracter√≠stica     | BitLocker (Windows) | LUKS (Linux)         |
| ------------------ | ------------------- | -------------------- |
| Sistema operativo  | Solo Windows Pro+   | Solo Linux           |
| Nivel de seguridad | Muy alto (TPM)      | Muy alto (flexible)  |
| Claves m√∫ltiples   | No                  | S√≠ (8 claves)        |
| Soporte gr√°fico    | S√≠                  | S√≠ (algunas distros) |
| C√≥digo abierto     | No                  | S√≠ (auditable)       |

---

### üß† Recomendaciones de uso

- Usa contrase√±as fuertes (m√≠nimo 12 caracteres)
- Guarda un **respaldo de la clave LUKS**
- Usa `LUKS + LVM` para gestionar m√∫ltiples vol√∫menes f√°cilmente
- Aplica `auto unlock` con llaves en USB si te molesta escribir la clave

---

[üîº](#√≠ndice)

---

## **467. Autopsy con full disk encryption (Bitlocker)**

### üß© ¬øQu√© es Autopsy?

**Autopsy** es una herramienta de an√°lisis forense digital gratuita y de c√≥digo abierto. Sirve para examinar:

- Discos duros
- Particiones
- Im√°genes de disco
- Archivos eliminados
- Actividades del sistema (navegadores, correo, etc.)

Es muy usada por investigadores, polic√≠as y expertos en ciberseguridad para hacer **an√°lisis forense digital**.

---

### üîê ¬øQu√© es BitLocker?

**BitLocker** es una tecnolog√≠a de cifrado de disco completo de Windows. Protege todo el contenido del disco duro usando:

- Algoritmos de cifrado como **AES-128 o AES-256**
- TPM (Trusted Platform Module)
- PIN o contrase√±a
- Llaves USB

Si un disco est√° protegido con BitLocker, **no se puede leer su contenido directamente sin la clave o el archivo de recuperaci√≥n**.

---

### üéØ Objetivo de este ejemplo

Queremos usar **Autopsy** para **analizar un disco cifrado con BitLocker**, por ejemplo, uno extra√≠do de una laptop sospechosa.

Pero **Autopsy no puede abrir discos cifrados directamente** con BitLocker. Entonces, el flujo correcto es:

---

### üß≠ Flujo de trabajo completo

1. **Descifrar** o **desbloquear el disco cifrado con BitLocker**
2. Crear una imagen forense (por ejemplo, formato `.E01`, `.img` o `.dd`)
3. Cargar esa imagen en **Autopsy** para analizarla

---

### üõ†Ô∏è Requisitos

- Una PC con Windows 10/11 o Linux
- Autopsy instalado
- Acceso al **disco f√≠sico cifrado** (o imagen del disco)
- Clave de recuperaci√≥n de BitLocker (requisito imprescindible)

---

### üß© 1. Instalaci√≥n de Autopsy

#### üîπ En Windows:

1. Ve a: [https://www.sleuthkit.org/autopsy/](https://www.sleuthkit.org/autopsy/)
2. Descarga el instalador (ej: `autopsy-4.21.0.msi`)
3. Inst√°lalo como cualquier otro programa
4. Al abrir, selecciona:

   - **New Case** ‚Üí Escribe un nombre ‚Üí Define una carpeta ‚Üí Avanza

---

### üîì 2. Desbloquear disco con BitLocker

#### üìå Si tienes el disco conectado por USB o SATA:

1. Conecta el disco cifrado a tu PC (como disco externo)
2. Windows detectar√° que est√° cifrado con BitLocker
3. Escribe la clave de recuperaci√≥n (o usa el archivo `.bek` o USB)

üëâ Si no tienes la clave, **NO podr√°s hacer an√°lisis con Autopsy**. Solo podr√°s hacer ataques por fuerza bruta (tema avanzado).

---

### üì• 3. Crear una imagen del disco ya descifrado

Usa herramientas como:

- **FTK Imager** (gratuito)
- **dd** (Linux/Mac)
- **Guymager** (Linux forense)

#### üî∏ Ejemplo con FTK Imager:

1. Abre FTK Imager
2. `File` ‚Üí `Create Disk Image`
3. Selecciona `Physical Drive`
4. Escoge el disco ya desbloqueado
5. Elige formato `.E01` o `.img`
6. Guarda la imagen en otra unidad

---

### üîç 4. Analizar imagen con Autopsy

1. Abre Autopsy
2. `New Case` ‚Üí Dale un nombre (ej: `CasoLaptopBitlocker`)
3. Selecciona `Add Data Source` ‚Üí `Disk Image or VM file`
4. Elige el archivo `.E01` o `.img`
5. Espera a que Autopsy lo cargue

#### Autopsy har√° autom√°ticamente:

- Indexaci√≥n de archivos
- B√∫squeda de documentos, im√°genes, v√≠deos
- Extracci√≥n de archivos borrados
- Historial de navegador, registros de uso
- Metadatos, actividad del sistema, etc.

---

### ‚úÖ Ejemplo completo paso a paso

#### üéØ Escenario:

Gustavo tiene acceso a una laptop sospechosa, que tiene el disco cifrado con **BitLocker**. Se le ha proporcionado la clave de recuperaci√≥n (clave de 48 d√≠gitos).

---

#### üß™ Procedimiento:

1. **Extrae el disco de la laptop y lo conecta por USB a su PC**
2. Windows detecta el disco cifrado y pide la **clave de recuperaci√≥n**
3. Gustavo la introduce y accede a los archivos
4. Abre **FTK Imager** y crea una imagen del disco como `laptop_caso01.E01`
5. Abre **Autopsy**, crea un nuevo caso
6. Carga la imagen `laptop_caso01.E01`
7. Autopsy analiza:

   - Archivos eliminados
   - Historial de Chrome
   - Documentos sensibles en `C:\Users\...`
   - Carpetas sospechosas como `C:\Temp\hidden`

---

### üß† Consejos pr√°cticos

- **Nunca trabajes sobre el disco original**: siempre usa una imagen.
- Guarda la clave de BitLocker en un lugar seguro (puede que sea requerida varias veces).
- Usa discos SSD externos para guardar las im√°genes (r√°pido y seguro).
- Siempre documenta cada paso del proceso (buenas pr√°cticas forenses).

---

### ‚ö†Ô∏è ¬øY si no tienes la clave BitLocker?

En ese caso:

- Autopsy **no puede ayudarte directamente**
- Necesitas usar herramientas como:

  - **Elcomsoft Forensic Disk Decryptor** (comercial)
  - **Passware Kit Forensic** (comercial)

- O intentar ataques con `hashcat` (requiere extraer hash de volumen)

Esas son t√©cnicas m√°s avanzadas que implican:

- An√°lisis de memoria RAM (si est√° encendida)
- Recuperaci√≥n del archivo `VMK` y `FVEK`

Si te interesa, puedo explicarte ese proceso tambi√©n.

---

[üîº](#√≠ndice)

---

## **468. Tokenizaci√≥n**

### üîê ¬øQu√© es la Tokenizaci√≥n?

**Tokenizaci√≥n** es un proceso de **seguridad de datos** que **reemplaza datos sensibles** (como n√∫meros de tarjetas, DNI, correos, etc.) por un **token** que **no tiene valor por s√≠ solo**.

üîπ Un **token** es como una ficha sustituta:

> En vez de guardar "4111 1111 1111 1111", se guarda "TKN-abc123xyz"

---

### üõ°Ô∏è ¬øPara qu√© sirve?

La tokenizaci√≥n **protege los datos originales** porque:

- El token **no se puede revertir f√°cilmente** (no es como el cifrado)
- No expone los datos sensibles al hacer an√°lisis, reportes, etc.
- Si un atacante roba tokens, **no obtiene los datos reales**

Se usa mucho en:

| Uso                   | Ejemplo                            |
| --------------------- | ---------------------------------- |
| üõí E-commerce         | N√∫mero de tarjeta de cr√©dito       |
| üè• Salud              | Nombres/DNI de pacientes           |
| üíº Recursos Humanos   | Sueldos, DNI, direcciones          |
| üìä Anal√≠tica de datos | Emails, IDs, etc., sin ver lo real |

---

### üîÅ ¬øEn qu√© se diferencia del cifrado?

| Caracter√≠stica    | Cifrado                   | Tokenizaci√≥n                 |
| ----------------- | ------------------------- | ---------------------------- |
| Se puede revertir | ‚úÖ (con clave)            | ‚ùå (no por s√≠ solo)          |
| Usa algoritmo     | ‚úÖ (AES, RSA...)          | ‚ùå (reemplazo por tabla)     |
| Relaci√≥n directa  | üîÑ (uno a uno reversible) | üîÄ (uno a uno no reversible) |
| Requiere clave    | ‚úÖ                        | ‚ùå                           |

---

### üõ†Ô∏è ¬øC√≥mo se "instala" o aplica?

No es un programa que "instales" como Word, sino una **l√≥gica que implementas en el sistema** (backend, app, API).

Puedes usar:

- üîß **Sistemas comerciales**: como **Protegrity**, **Thales CipherTrust**, **AWS Tokenization**
- üë®‚Äçüíª O hacerlo t√∫ mismo con c√≥digo (veremos un ejemplo)

---

### üì¶ Ejemplo pr√°ctico: Tokenizaci√≥n en Node.js

Vamos a ver un ejemplo en el que:

- Tenemos una lista con datos sensibles (como DNI o tarjeta)
- Usamos una tabla de tokens para guardar/reemplazar
- Simulamos guardar tokens en lugar de datos reales

---

#### 1. üß± Instalaci√≥n b√°sica

Instala Node.js desde [https://nodejs.org/](https://nodejs.org/)

Luego en tu proyecto:

```bash
mkdir tokenization-demo
cd tokenization-demo
npm init -y
npm install uuid
```

Usamos `uuid` para crear tokens √∫nicos.

---

#### 2. üßë‚Äçüíª C√≥digo de ejemplo (`tokenizer.js`)

```js
const { v4: uuidv4 } = require("uuid");

// Base de datos simulada
const tokenDB = new Map(); // token => valor real
const reverseDB = new Map(); // valor real => token

// Funci√≥n para tokenizar
function tokenize(data) {
  if (reverseDB.has(data)) {
    return reverseDB.get(data); // ya est√° tokenizado
  }
  const token = "TKN-" + uuidv4();
  tokenDB.set(token, data);
  reverseDB.set(data, token);
  return token;
}

// Funci√≥n para detokenizar
function detokenize(token) {
  return tokenDB.get(token) || null;
}

// Simulaci√≥n
const dniOriginal = "45789632";
const tarjeta = "4111 1111 1111 1111";

const tokenDNI = tokenize(dniOriginal);
const tokenCard = tokenize(tarjeta);

console.log("DNI tokenizado:", tokenDNI);
console.log("Tarjeta tokenizada:", tokenCard);

console.log("Recuperando datos reales:");
console.log("DNI original:", detokenize(tokenDNI));
console.log("Tarjeta original:", detokenize(tokenCard));
```

---

#### 3. üîç ¬øQu√© hace este script?

- Reemplaza los datos reales por un token tipo `TKN-abc123`
- Guarda una tabla interna para poder detokenizar si lo necesitas
- Evita guardar datos sensibles en bases de datos

---

### ‚úÖ Salida esperada

```bash
DNI tokenizado: TKN-6d0b3569-7e95-4a4e-8a52-68e9093e3fc5
Tarjeta tokenizada: TKN-d3c9afce-e8dc-4f58-99b3-4c0f3cc6e6e4

Recuperando datos reales:
DNI original: 45789632
Tarjeta original: 4111 1111 1111 1111
```

---

### üîê Seguridad real: producci√≥n vs demo

‚ö†Ô∏è Este ejemplo **no es seguro para producci√≥n**. En la pr√°ctica, usar√≠as:

- Un almac√©n seguro de tokens
- Control de acceso (para ver o revertir tokens)
- Auditor√≠a de acceso
- Rotaci√≥n de tokens
- Sistemas externos como:

  - AWS Macie / AWS Tokenization
  - Google DLP API
  - Thales CipherTrust

---

### üß† Resumen

| Concepto                 | Explicaci√≥n breve                                     |
| ------------------------ | ----------------------------------------------------- |
| ¬øQu√© es tokenizaci√≥n?    | Sustituye datos reales por tokens sin valor √∫til      |
| ¬øPor qu√© usarlo?         | Para proteger datos sensibles                         |
| ¬øC√≥mo se aplica?         | Por software: API, backend, sistema de seguridad      |
| ¬øDiferencia con cifrado? | No reversible, no usa claves, m√°s dif√≠cil de explotar |
| ¬øD√≥nde se usa?           | Finanzas, salud, e-commerce, anal√≠tica, RRHH          |
| ¬øC√≥mo hacerlo?           | Manual con c√≥digo o con soluciones comerciales        |

---

[üîº](#√≠ndice)

---

## **469. Disponibilidad y Ciberresiliencia**

### üîí ¬øQu√© es Disponibilidad?

La **Disponibilidad** es uno de los tres pilares de la seguridad de la informaci√≥n (junto con **Confidencialidad** e **Integridad**).

#### üëâ Definici√≥n sencilla:

> **Disponibilidad** significa que los datos, sistemas y servicios est√©n **accesibles cuando se necesiten**, por las personas autorizadas.

---

### üõ°Ô∏è ¬øQu√© es Ciberresiliencia?

La **Ciberresiliencia** es la capacidad de una organizaci√≥n o sistema para:

- **Prepararse ante ciberataques**
- **Resistir** o minimizar los impactos
- **Recuperarse r√°pidamente** despu√©s del incidente
- Y **adaptarse** para prevenir futuros ataques

üîÅ En resumen:

> **Ciberresiliencia = Protecci√≥n + Respuesta + Recuperaci√≥n**

---

### üß† Diferencia entre Disponibilidad y Ciberresiliencia

| Caracter√≠stica     | Disponibilidad              | Ciberresiliencia                         |
| ------------------ | --------------------------- | ---------------------------------------- |
| Objetivo principal | Que el servicio est√© activo | Que el servicio sobreviva a los ataques  |
| Enfoque            | T√©cnica / Operacional       | Estrat√©gico / Integral                   |
| Protege contra     | Fallos t√©cnicos             | Ciberataques, errores, fallos, desastres |
| Ejemplo            | Redundancia de servidores   | Plan de recuperaci√≥n ante ransomware     |

---

### üß∞ ¬øC√≥mo se implementa?

Aqu√≠ tienes formas de **instalar / aplicar** estos conceptos:

#### ‚úÖ Disponibilidad

| T√©cnica                  | ¬øQu√© hace?                                             |
| ------------------------ | ------------------------------------------------------ |
| Balanceadores de carga   | Distribuyen tr√°fico entre varios servidores            |
| Redundancia              | Duplicaci√≥n de componentes (servidores, discos, redes) |
| Backups frecuentes       | Copias de seguridad para restaurar datos               |
| Monitoreo de servicios   | Detecta fallos para responder r√°pidamente              |
| Alta disponibilidad (HA) | Cl√∫steres que garantizan funcionamiento continuo       |

#### ‚úÖ Ciberresiliencia

| Pr√°ctica                                  | Ejemplo pr√°ctico                                    |
| ----------------------------------------- | --------------------------------------------------- |
| Plan de recuperaci√≥n ante desastres (DRP) | Plan para restaurar sistemas tras un fallo o ataque |
| Pruebas de incidentes (simulacros)        | Simular ataques o ca√≠das de sistemas                |
| Entrenamiento al personal                 | C√≥mo actuar frente a phishing o ransomware          |
| Segmentaci√≥n de red                       | A√≠sla partes de la red para contener ataques        |
| Cifrado y tokenizaci√≥n de datos           | Protecci√≥n adicional si los datos son robados       |

---

### üß™ Ejemplo pr√°ctico: Web con alta disponibilidad y resiliencia

#### üéØ Objetivo:

Simular una web que:

- Est√° en alta disponibilidad
- Tiene backups autom√°ticos
- Y se puede recuperar tras una ca√≠da

---

#### ‚öôÔ∏è Herramientas usadas

| Herramienta               | ¬øPara qu√© sirve?             |
| ------------------------- | ---------------------------- |
| **Docker**                | Crear entornos reproducibles |
| **NGINX**                 | Balanceador de carga         |
| **Node.js + Express**     | Servidor web simple          |
| **MongoDB (Replica Set)** | Base de datos redundante     |
| **Cron + rsync**          | Para backups autom√°ticos     |

---

#### üí° Simulaci√≥n: 2 servidores web + balanceador

```
                        [ Cliente ]
                            |
                            ‚ñº
                       [ NGINX LB ]
                          /    \
                         /      \
               [ Web 1 ]        [ Web 2 ]
                         ‚Üò    ‚Üô
                          [ MongoDB Replica ]
```

---

#### üõ†Ô∏è Instalaci√≥n paso a paso (simplificada)

##### 1. Crear dos apps Node.js (`web1` y `web2`):

```bash
# web/app.js
const express = require('express');
const app = express();
app.get('/', (_, res) => res.send('Servidor activo üöÄ'));
app.listen(3000, () => console.log('Web 1 escuchando'));
```

##### 2. Crear archivo `nginx.conf`:

```nginx
http {
    upstream backend {
        server web1:3000;
        server web2:3000;
    }

    server {
        listen 80;
        location / {
            proxy_pass http://backend;
        }
    }
}
```

##### 3. Montar con Docker Compose:

```yaml
version: "3.8"
services:
  web1:
    build: ./web
    container_name: web1

  web2:
    build: ./web
    container_name: web2

  nginx:
    image: nginx:latest
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
    ports:
      - "8080:80"
    depends_on:
      - web1
      - web2
```

üü¢ Con esto, accediendo a `localhost:8080` ver√°s que si uno de los servidores falla, el otro responde.

---

#### üíæ Backups y recuperaci√≥n simulada:

Usar `cron` en Linux para hacer backups cada noche:

```bash
crontab -e

# Copia MongoDB a diario a las 3 am
0 3 * * * mongodump --out /mnt/backups/mongodb-$(date +\%F)
```

Para restaurar:

```bash
mongorestore /mnt/backups/mongodb-2025-07-22
```

---

### üß† Conclusi√≥n

| Concepto             | Explicaci√≥n clave                                               |
| -------------------- | --------------------------------------------------------------- |
| **Disponibilidad**   | Garantizar que el sistema est√© accesible siempre                |
| **Ciberresiliencia** | Poder sobrevivir y recuperarse de fallos o ciberataques         |
| **C√≥mo se aplica**   | Redundancia, backups, monitoreo, segmentaci√≥n, simulacros       |
| **Ejemplo**          | Web balanceada, con respaldo diario, y replica de base de datos |

---

[üîº](#√≠ndice)

---

## **470. Ciberresiliencia**

### üß† ¬øQu√© es Ciberresiliencia?

La **ciberresiliencia** es la capacidad de una organizaci√≥n o sistema para:

1. **Prepararse** ante incidentes cibern√©ticos (como ataques o errores humanos)
2. **Resistir** el impacto cuando ocurren
3. **Responder y continuar operando**
4. **Recuperarse y adaptarse** r√°pidamente

üîê **No se trata solo de prevenir ataques, sino de garantizar que el negocio sobreviva y siga funcionando incluso si ocurren.**

---

### üß© Relaci√≥n con otros conceptos

| Concepto                    | Ciberresiliencia se asegura de...              |
| --------------------------- | ---------------------------------------------- |
| Seguridad inform√°tica       | Que los controles est√©n en su lugar            |
| Gesti√≥n de riesgos          | Que los riesgos est√©n identificados y tratados |
| Continuidad del negocio     | Que la operaci√≥n no se detenga en una crisis   |
| Recuperaci√≥n ante desastres | Que se puedan restaurar datos y sistemas       |

---

### üìå Ejemplos f√°ciles de entender

#### üè• Ejemplo 1: Hospital

> Un ransomware encripta los datos del hospital. ¬øQu√© ocurre?

- üõ°Ô∏è Si el hospital **tiene copias de seguridad offline** y **plan de recuperaci√≥n**, podr√° restaurar su sistema en horas.
- üî¥ Si **no tiene nada**, los pacientes podr√≠an quedar sin atenci√≥n cr√≠tica durante d√≠as.

**üí° El hospital resiliente sigue funcionando. El que no lo es, se paraliza.**

---

#### üßæ Ejemplo 2: Empresa con sitio web

> Un ataque DDoS tira la web de ventas durante Black Friday.

- Empresa **A** usa solo un servidor ‚Üí se cae por 12 horas.
- Empresa **B** tiene balanceo de carga y servidores distribuidos ‚Üí redirige tr√°fico y sigue vendiendo.

---

### üõ†Ô∏è ¬øC√≥mo se instala o aplica la ciberresiliencia?

Implementar ciberresiliencia **no se trata de instalar un programa espec√≠fico**, sino de aplicar buenas pr√°cticas, tecnolog√≠as y cultura organizacional.

#### üîß Herramientas y pr√°cticas

| Pr√°ctica                                              | ¬øQu√© hace?                                                 |
| ----------------------------------------------------- | ---------------------------------------------------------- |
| üîÅ **Backups autom√°ticos**                            | Permiten restaurar informaci√≥n despu√©s de un ataque        |
| üîê **Segmentaci√≥n de red**                            | Evita que un ataque afecte toda la infraestructura         |
| ‚ö†Ô∏è **Simulacros de ataque (Red Team)**                | Miden c√≥mo responde el equipo ante un incidente            |
| üìã **Planes de continuidad y recuperaci√≥n (BCP/DRP)** | Define qu√© hacer si todo falla                             |
| üìà **Monitoreo continuo**                             | Detecta anomal√≠as antes de que causen da√±os graves         |
| üßë‚Äçüè´ **Capacitaci√≥n al personal**                       | Reduce riesgos por errores humanos como el phishing        |
| üß™ **Pruebas de penetraci√≥n**                         | Detectan vulnerabilidades antes de que lo haga un atacante |

---

### ‚úÖ Fases para implementar Ciberresiliencia

1. **Evaluar** los activos cr√≠ticos
2. **Identificar** riesgos y amenazas
3. **Dise√±ar planes** de mitigaci√≥n y respuesta
4. **Implementar controles** (tecnol√≥gicos y organizacionales)
5. **Simular ataques** (ej. ransomware, ca√≠das, errores humanos)
6. **Actualizar continuamente** los planes

---

### üí° Herramientas √∫tiles para aplicar ciberresiliencia

| Herramienta                      | ¬øPara qu√© sirve?                         |
| -------------------------------- | ---------------------------------------- |
| **Veeam / Bacula / Duplicati**   | Backups y restauraci√≥n de sistemas       |
| **Zabbix / Nagios / Prometheus** | Monitoreo de disponibilidad              |
| **Metasploit / Kali Linux**      | Simulaci√≥n de ataques                    |
| **Graylog / Splunk / ELK**       | Recolecci√≥n de logs y detecci√≥n temprana |
| **AWS/Azure/GCP HA Services**    | Alta disponibilidad en la nube           |

---

### üß™ Ejemplo pr√°ctico: Simulaci√≥n de ciberresiliencia en un servidor Linux

#### üéØ Objetivo:

Configurar un entorno b√°sico que pueda:

- Hacer backups autom√°ticos
- Detectar fallos en servicios web
- Restaurarse r√°pidamente ante errores

---

#### üîß Requisitos:

- Ubuntu Server (puede ser en una m√°quina virtual o WSL)
- Cron (ya viene instalado)
- `rsync` para backups
- Un servicio web (como `nginx` o `apache`)
- Script de monitoreo

---

#### üë£ Paso a paso

##### 1. Instalar nginx y rsync

```bash
sudo apt update
sudo apt install nginx rsync
```

##### 2. Crear un script de backup

```bash
# backup.sh
#!/bin/bash
FECHA=$(date +%F)
DEST=/home/usuario/backups
mkdir -p $DEST
rsync -a /var/www/html $DEST/html-$FECHA
```

Hazlo ejecutable:

```bash
chmod +x backup.sh
```

##### 3. Programar backup diario con cron

```bash
crontab -e
```

Agrega esta l√≠nea:

```bash
0 2 * * * /home/usuario/backup.sh
```

‚úÖ Esto hace un backup todos los d√≠as a las 2 am.

---

##### 4. Simular ca√≠da del servicio

```bash
sudo systemctl stop nginx
```

##### 5. Crear script de monitoreo autom√°tico

```bash
# monitor.sh
#!/bin/bash
if ! systemctl is-active --quiet nginx; then
    echo "¬°Nginx est√° ca√≠do! Reiniciando..."
    systemctl start nginx
    echo "$(date): Se reinici√≥ nginx" >> /var/log/restart-nginx.log
fi
```

Y a√±ade a `crontab` cada 5 minutos:

```bash
*/5 * * * * /home/usuario/monitor.sh
```

---

#### üß™ Simula un ataque:

- Borra la carpeta `/var/www/html`
- Luego corre manualmente el backup para restaurar:

```bash
sudo cp -r /home/usuario/backups/html-2025-07-22/* /var/www/html/
```

‚úÖ El servidor vuelve a estar funcional.

---

### üßæ Resultado

Tienes un sistema b√°sico pero resiliente que:

- Se respalda todos los d√≠as
- Detecta ca√≠das del servicio web y lo reinicia
- Puede restaurar archivos da√±ados o eliminados

---

### üß† Conclusi√≥n

| Elemento                | Resultado esperado                                              |
| ----------------------- | --------------------------------------------------------------- |
| **Ciberresiliencia**    | El sistema puede resistir, recuperarse y adaptarse a incidentes |
| **Aplicaci√≥n pr√°ctica** | Con backup, monitoreo y restauraci√≥n autom√°tica                 |
| **No es una app**       | Es una **estrategia + procesos + tecnolog√≠a**                   |

---

[üîº](#√≠ndice)

---

## **471. Backups (Copias de seguridad)**

### üîê ¬øQu√© son los _Backups_ (Copias de seguridad)?

Un **backup** es una **copia de tus datos importantes** que se guarda en un lugar diferente al original. Su objetivo es **recuperar informaci√≥n** en caso de:

- Ataques (como ransomware)
- Errores humanos (borrado accidental)
- Fallos del sistema (discos da√±ados, incendios, etc.)

### üéØ ¬øPor qu√© son importantes?

Porque **nada es 100% seguro**. Los sistemas pueden fallar, y sin un backup podr√≠as **perder toda tu informaci√≥n**.

---

### üß† Ejemplos f√°ciles de entender

#### üßë‚Äçüéì Caso 1: Estudiante

Imagina que est√°s escribiendo tu tesis en Word y se da√±a tu laptop.
**Si hiciste un backup en Google Drive o USB, no perdiste nada.**

---

#### üè¢ Caso 2: Empresa

Una tienda online sufre un ataque y se borra su base de datos.
**Con backups autom√°ticos diarios, pueden restaurar y seguir vendiendo.**

---

### üß© Tipos de backups

| Tipo            | ¬øQu√© hace?                                    | Ventaja                     |
| --------------- | --------------------------------------------- | --------------------------- |
| **Completo**    | Copia todos los archivos                      | R√°pida recuperaci√≥n         |
| **Incremental** | Solo copia los cambios desde el √∫ltimo backup | Ahorra espacio              |
| **Diferencial** | Copia cambios desde el √∫ltimo backup completo | M√°s r√°pido que uno completo |

---

### üì¶ ¬øD√≥nde guardar los backups?

| Lugar                                             | ¬øCu√°ndo usarlo?                   |
| ------------------------------------------------- | --------------------------------- |
| Disco externo (USB, HDD)                          | Para copias locales r√°pidas       |
| Otro servidor (NAS)                               | En redes de empresa               |
| Nube (Google Drive, AWS S3, Dropbox, Azure, etc.) | Copias remotas (muy recomendable) |

---

### üìå Buenas pr√°cticas

‚úÖ Tener **m√∫ltiples copias** (regla 3-2-1):

- 3 copias en total
- 2 en medios diferentes
- 1 fuera del sitio (en la nube)

‚úÖ **Probar la restauraci√≥n** regularmente

‚úÖ **Automatizar** el backup (para que no se te olvide)

‚úÖ **Encriptar** los backups (para que nadie acceda a ellos si los roban)

---

### üõ†Ô∏è ¬øC√≥mo se instala o configura un sistema de backup?

Te muestro c√≥mo hacerlo en 3 entornos:

---

#### üñ•Ô∏è 1. En Windows (manual)

##### Opci√≥n b√°sica: Copia en disco externo

1. Conecta un USB o disco externo
2. Usa "Historial de archivos" o ‚ÄúCopias de seguridad‚Äù
3. Configura qu√© carpetas respaldar y cada cu√°nto

**Ruta:**
`Panel de control ‚Üí Sistema y seguridad ‚Üí Historial de archivos`

---

#### üñ•Ô∏è 2. En Linux (autom√°tico con `rsync` y `cron`)

##### Paso 1: Instala rsync

```bash
sudo apt update && sudo apt install rsync
```

##### Paso 2: Crea un script

```bash
nano backup.sh
```

```bash
#!/bin/bash
FECHA=$(date +%F)
DEST=/home/usuario/backups
mkdir -p $DEST
rsync -a /home/usuario/documentos/ $DEST/documentos-$FECHA
```

Hazlo ejecutable:

```bash
chmod +x backup.sh
```

##### Paso 3: Automatiza con cron

```bash
crontab -e
```

Agrega:

```bash
0 3 * * * /home/usuario/backup.sh
```

üëâ Esto ejecuta el backup cada d√≠a a las 3:00 a.m.

---

#### ‚òÅÔ∏è 3. Backup en la nube (ej. con Google Drive)

##### Paso 1: Instala **rclone**

```bash
sudo apt install rclone
```

##### Paso 2: Configura acceso a Google Drive

```bash
rclone config
```

- Elige `n` para nueva configuraci√≥n
- Nombre: `gdrive`
- Elige "Google Drive"
- Sigue las instrucciones del navegador

##### Paso 3: Backup hacia Google Drive

```bash
rclone copy /home/usuario/documentos gdrive:backups/documentos
```

---

### ‚úÖ Ejemplo completo: Sistema autom√°tico de backup en Linux

#### üéØ Objetivo:

Hacer un backup diario de `/home/gustavo/proyecto` hacia un disco externo o carpeta local

---

#### üë£ Paso a paso

##### 1. Crear script de backup

```bash
nano /home/gustavo/backup_proyecto.sh
```

```bash
#!/bin/bash
FECHA=$(date +%Y-%m-%d)
DEST=/mnt/disco_externo/backups
mkdir -p $DEST
rsync -a /home/gustavo/proyecto/ $DEST/proyecto-$FECHA
```

##### 2. Dar permisos

```bash
chmod +x /home/gustavo/backup_proyecto.sh
```

##### 3. Programar con cron

```bash
crontab -e
```

Agrega:

```bash
0 1 * * * /home/gustavo/backup_proyecto.sh
```

---

#### üîÑ ¬øC√≥mo restaurar?

```bash
cp -r /mnt/disco_externo/backups/proyecto-2025-07-22 /home/gustavo/proyecto/
```

‚úÖ ¬°Recuperaste tu proyecto!

---

### üß† Conclusi√≥n

| Concepto              | Resumen                                             |
| --------------------- | --------------------------------------------------- |
| ¬øQu√© son los backups? | Copias de seguridad de tu informaci√≥n               |
| ¬øPara qu√© sirven?     | Para **protegerte de p√©rdida de datos**             |
| ¬øD√≥nde se guardan?    | Disco externo, red local o nube                     |
| ¬øC√≥mo se instalan?    | Scripts automatizados, software como Veeam o rclone |
| Buenas pr√°cticas      | Copias frecuentes, automatizadas y probadas         |
| Resultado             | ¬°Tu informaci√≥n siempre segura y recuperable!       |

---

[üîº](#√≠ndice)

---

## **472. Tipos de Backup: Completo, Incremental**

### üîç ¬øQu√© son los tipos de backup?

Un **backup** (copia de seguridad) es un respaldo de tus archivos o datos importantes para poder restaurarlos si se pierden o da√±an.
Pero **no todos los backups funcionan igual**: hay diferentes tipos, y cada uno tiene ventajas y desventajas.

---

### üìå Tipos principales de Backup

#### üü¢ 1. Backup **Completo**

- Copia **todos los archivos y datos seleccionados**, sin importar si han cambiado o no.

##### ‚úÖ Ventajas:

- Restaura m√°s r√°pido.
- Todo est√° en un solo lugar.

##### ‚ùå Desventajas:

- Lento de hacer.
- Usa mucho espacio.

##### üìò Ejemplo f√°cil:

Copias toda tu carpeta "Mis Documentos" (20 GB) cada vez que haces un backup, incluso si solo cambiaste un archivo de Word.

---

#### üîµ 2. Backup **Incremental**

- Copia **solo los archivos que han cambiado** desde el √∫ltimo backup (completo o incremental).

##### ‚úÖ Ventajas:

- Muy r√°pido de hacer.
- Ahorra espacio.

##### ‚ùå Desventajas:

- La restauraci√≥n puede tardar m√°s (necesitas el backup completo + todos los incrementales).

##### üìò Ejemplo f√°cil:

Haces un backup completo el lunes. El martes solo cambias 2 archivos, entonces el backup incremental solo guarda esos 2 archivos. El mi√©rcoles cambias 1 m√°s, entonces el backup del mi√©rcoles solo guarda ese.

---

#### üü£ 3. (Extra) Backup **Diferencial**

- Copia los archivos que han cambiado **desde el √∫ltimo backup completo**, no desde el √∫ltimo incremental.

> Es un punto intermedio. No lo veremos en detalle hoy, pero si lo necesitas tambi√©n te lo explico.

---

### üéØ Comparaci√≥n r√°pida

| Tipo        | Tiempo de respaldo | Espacio usado | Velocidad de restauraci√≥n   |
| ----------- | ------------------ | ------------- | --------------------------- |
| Completo    | Lento              | Mucho         | R√°pido                      |
| Incremental | R√°pido             | Poco          | M√°s lento (m√∫ltiples pasos) |

---

### üõ†Ô∏è ¬øC√≥mo se instalan/configuran?

#### En Windows:

Puedes usar herramientas como:

- **Historial de archivos** (sistema)
- **Cobian Backup** (gratuito)
- **Acronis**, **Macrium Reflect** (profesionales)

#### En Linux:

Se usan scripts con herramientas como:

- `rsync`
- `tar`
- `duplicity`
- `borgbackup`
- o `rsnapshot` (ideal para backups incrementales)

---

### ‚úÖ EJEMPLO COMPLETO Y PR√ÅCTICO

Te muestro **c√≥mo hacer un backup completo + incrementales** en Linux usando `rsync`.

---

#### üñ•Ô∏è Supuesto:

- Tienes una carpeta: `/home/gustavo/proyecto`
- Quieres respaldarla en: `/mnt/backup/proyecto`
- Backup completo: cada lunes
- Backup incremental: martes a domingo

---

#### 1Ô∏è‚É£ Paso 1: Script de backup completo

```bash
# backup_completo.sh
#!/bin/bash
FECHA=$(date +%Y-%m-%d)
DEST="/mnt/backup/proyecto/semana-$FECHA"
mkdir -p "$DEST"
rsync -av --delete /home/gustavo/proyecto/ "$DEST"
```

Este script:

- Copia **todo el contenido**
- Borra archivos eliminados para mantener sincron√≠a

---

#### 2Ô∏è‚É£ Paso 2: Script de backup incremental

```bash
# backup_incremental.sh
#!/bin/bash
FECHA=$(date +%Y-%m-%d)
DEST="/mnt/backup/proyecto/incremental-$FECHA"
mkdir -p "$DEST"
rsync -av --link-dest=/mnt/backup/proyecto/semana-ULTIMO-COMPLETO /home/gustavo/proyecto/ "$DEST"
```

Reemplaza `ULTIMO-COMPLETO` con el nombre de la √∫ltima carpeta de backup completo.

`--link-dest` usa enlaces simb√≥licos para que solo se copien archivos nuevos o modificados.

---

#### 3Ô∏è‚É£ Paso 3: Programar en `cron`

```bash
crontab -e
```

Agrega:

```bash
# Backup completo todos los lunes a las 2 a.m.
0 2 * * 1 /home/gustavo/backup_completo.sh

# Backup incremental martes a domingo a las 2 a.m.
0 2 * * 2-7 /home/gustavo/backup_incremental.sh
```

---

#### 4Ô∏è‚É£ Restaurar archivos

Para restaurar:

- Si fue un backup completo: solo copias la carpeta.
- Si fue incremental, restauras primero el completo y luego agregas los incrementales.

---

### üß† Conclusi√≥n

| Concepto           | Detalles clave                                         |
| ------------------ | ------------------------------------------------------ |
| Backup completo    | Copia total. √ötil para restauraci√≥n r√°pida             |
| Backup incremental | Copia solo cambios. Ahorra espacio y tiempo            |
| ¬øC√≥mo se instalan? | Scripts con `rsync`, herramientas GUI en Windows       |
| ¬øCu√°ndo usarlos?   | Combinados: completo semanal + incrementales diarios   |
| Recomendaci√≥n      | **Automatiza** y **verifica regularmente** tus backups |

---

[üîº](#√≠ndice)

---

## **473. Tipos de Backups: Diferencial, Incremental inverso**

### üîê ¬øQu√© es un backup?

Un **backup (copia de seguridad)** es una forma de proteger tus archivos importantes, haciendo una copia de ellos en otro lugar (disco externo, red, nube, etc.) por si se pierden, da√±an o los atacan con malware.

Ya conoces el backup **completo** y el **incremental tradicional**, pero ahora vamos a ver dos tipos m√°s avanzados y muy √∫tiles.

---

### üü° 1. Backup **Diferencial**

#### üìñ ¬øQu√© es?

Un backup diferencial copia **todos los archivos que han cambiado desde el √∫ltimo backup completo**, sin importar si ya se copiaron en un backup anterior.

#### üìå Caracter√≠sticas:

| Caracter√≠stica       | Valor                   |
| -------------------- | ----------------------- |
| Copia desde...       | √öltimo backup completo  |
| Tama√±o con el tiempo | Aumenta gradualmente    |
| Restauraci√≥n         | R√°pida (solo 2 backups) |

#### ‚úÖ Ventajas:

- **F√°cil de restaurar**: solo necesitas el backup completo + el √∫ltimo diferencial.
- M√°s seguro que el incremental tradicional si tienes muchos cambios.

#### ‚ùå Desventajas:

- Consume m√°s espacio que los incrementales porque repite archivos.

#### üìò Ejemplo f√°cil:

| D√≠a       | Cambios realizados    | Tipo de backup                                  |
| --------- | --------------------- | ----------------------------------------------- |
| Lunes     | Backup completo       | Todos los archivos                              |
| Martes    | Cambias archivo A y B | Copias A y B (diferencial)                      |
| Mi√©rcoles | Cambias archivo C     | Copias A, B y C (todos los cambios desde lunes) |

---

### üîµ 2. Backup **Incremental Inverso** (Reverse Incremental)

#### üìñ ¬øQu√© es?

Es una t√©cnica **m√°s avanzada**, donde siempre mantienes una **imagen completa actualizada**, y los cambios anteriores se guardan como **incrementos hacia atr√°s**.

Esto significa:

- El **√∫ltimo backup** es **siempre completo**.
- Los archivos anteriores se pueden reconstruir aplicando cambios hacia atr√°s.

#### üìå Caracter√≠sticas:

| Caracter√≠stica       | Valor                                      |
| -------------------- | ------------------------------------------ |
| √öltimo backup        | Siempre completo y actualizado             |
| Restauraci√≥n √∫ltima  | Muy r√°pida                                 |
| Versiones anteriores | Se reconstruyen aplicando parches inversos |

#### ‚úÖ Ventajas:

- Restauraci√≥n inmediata del estado m√°s reciente.
- Menor uso de espacio con muchas versiones.
- Muy eficiente para backups diarios.

#### ‚ùå Desventajas:

- M√°s complejo de implementar.
- Requiere herramientas espec√≠ficas (ej. `rsnapshot`, `rbackup`, `Veeam`).

---

#### üìò Ejemplo f√°cil:

| D√≠a       | Archivos modificados | Resultado (Backup)                                                           |
| --------- | -------------------- | ---------------------------------------------------------------------------- |
| Lunes     | Backup completo      | Imagen completa                                                              |
| Martes    | Cambias A y B        | Se actualiza la imagen, y guarda cambios previos de A y B en archivo inverso |
| Mi√©rcoles | Cambias C            | Imagen se actualiza (con C), y guarda versi√≥n anterior de C                  |

‚û°Ô∏è Si quieres restaurar a martes, aplicas el **incremento inverso** sobre el backup actual.

---

### üõ†Ô∏è ¬øC√≥mo se instalan o usan?

#### üîπ En Windows:

Herramientas como:

- **Macrium Reflect** (soporta incremental inverso)
- **Veeam Agent for Windows** (profesional)
- **AOMEI Backupper**

#### üî∏ En Linux:

Puedes usar:

- `rsnapshot` (diferencial y pseudo-incremental)
- `borgbackup` (soporta incremental inverso)
- `rbackup`
- `duplicity`

---

### ‚úÖ EJEMPLO PR√ÅCTICO: Backup Diferencial en Linux con `rsync`

#### üéØ Objetivo:

- Backup completo el lunes
- Backups diferenciales martes a viernes
- Carpeta fuente: `/home/gustavo/proyecto`
- Carpeta destino: `/mnt/backup/proyecto`

---

#### üìÅ Estructura esperada:

```
/mnt/backup/proyecto/
‚îÇ
‚îú‚îÄ‚îÄ completo-lunes/
‚îú‚îÄ‚îÄ diferencial-martes/
‚îú‚îÄ‚îÄ diferencial-miercoles/
...
```

---

#### üîß Script de backup completo (lunes)

```bash
# backup_completo.sh
#!/bin/bash
DEST="/mnt/backup/proyecto/completo-lunes"
mkdir -p "$DEST"
rsync -av --delete /home/gustavo/proyecto/ "$DEST"
```

---

#### üîß Script de backup diferencial (martes a viernes)

```bash
# backup_diferencial.sh
#!/bin/bash
FECHA=$(date +%Y-%m-%d)
DEST="/mnt/backup/proyecto/diferencial-$FECHA"
mkdir -p "$DEST"
rsync -av --compare-dest=/mnt/backup/proyecto/completo-lunes /home/gustavo/proyecto/ "$DEST"
```

`--compare-dest` hace que `rsync` compare contra el √∫ltimo completo y solo copie lo que ha cambiado.

---

### üîÅ Restaurar

- Para restaurar el backup del **mi√©rcoles**:

  1. Copias la carpeta `completo-lunes/`
  2. Sobrescribes con el contenido de `diferencial-miercoles/`

---

### üß† Conclusi√≥n general

| Tipo de Backup      | Uso recomendado                                     | Restauraci√≥n                 |
| ------------------- | --------------------------------------------------- | ---------------------------- |
| Completo            | Semanal, para base s√≥lida                           | Muy r√°pida                   |
| Diferencial         | Cambios diarios, f√°cil recuperaci√≥n                 | R√°pida                       |
| Incremental Inverso | Backups frecuentes y restauraci√≥n r√°pida del √∫ltimo | Instant√°nea (√∫ltima versi√≥n) |

---

[üîº](#√≠ndice)

---

## **474. ¬øCu√°ndo utilizar√≠as cada tipo de backup?**

### üß† ¬øQu√© tipos de backup existen?

Los principales tipos de backup son:

1. üîµ **Backup completo**
2. üü° **Backup diferencial**
3. üü† **Backup incremental**
4. üü£ **Backup incremental inverso**
5. üî¥ **Backup en espejo (mirror)** _(menos com√∫n)_

---

### ‚úÖ ¬øCu√°ndo usar cada uno? ‚Äì Comparativa detallada

| Tipo de Backup             | ¬øCu√°ndo usarlo?                                                            | Ventajas                    | Desventajas                             |
| -------------------------- | -------------------------------------------------------------------------- | --------------------------- | --------------------------------------- |
| üîµ **Completo**            | Al iniciar un sistema, semanal o mensual                                   | F√°cil de restaurar          | Lento y ocupa mucho espacio             |
| üü° **Diferencial**         | Si necesitas restauraci√≥n r√°pida y no te preocupa el espacio               | R√°pida recuperaci√≥n         | Crece con el tiempo                     |
| üü† **Incremental**         | Cuando tienes poco espacio y muchos cambios diarios                        | Ahorra espacio              | Restauraci√≥n m√°s lenta                  |
| üü£ **Incremental inverso** | Cuando necesitas restauraci√≥n r√°pida del √∫ltimo backup (ideal empresarial) | √öltima copia es instant√°nea | M√°s complejo                            |
| üî¥ **Espejo (mirror)**     | Para sincronizar archivos (RAID, servidores)                               | Siempre al d√≠a              | Si se borra algo, se borra en el backup |

---

### üéØ Casos pr√°cticos (f√°ciles de entender)

#### ‚úÖ 1. Backup Completo

üß© **Caso**: Empresa peque√±a hace backup todos los viernes

üìÅ Backup completo de toda la carpeta `/datos`

üëâ **Ideal cuando**:

- Hay pocos archivos
- No se modifica mucho
- Se quiere simplicidad

üîÅ **Restauraci√≥n**: f√°cil, solo necesitas 1 copia.

---

#### ‚úÖ 2. Backup Diferencial

üß© **Caso**: Profesional que trabaja de lunes a viernes

üìÅ Hace backup completo los domingos y diferencial cada d√≠a

üëâ **Ideal cuando**:

- Necesitas restaurar r√°pido
- Puedes sacrificar algo de espacio

üîÅ **Restauraci√≥n**: solo necesitas el backup completo + √∫ltimo diferencial

---

#### ‚úÖ 3. Backup Incremental

üß© **Caso**: Base de datos cambia todos los d√≠as

üìÅ Backup completo el domingo, y copias incrementales cada d√≠a

üëâ **Ideal cuando**:

- Quieres ahorrar espacio
- Restauraci√≥n completa no es frecuente

üîÅ **Restauraci√≥n**: necesitas el completo + todos los incrementales

---

#### ‚úÖ 4. Incremental Inverso

üß© **Caso**: Empresa con datos cr√≠ticos (sistema contable)

üìÅ Siempre debe tener una **copia reciente lista para restaurar al instante**

üëâ **Ideal cuando**:

- √öltimo estado debe estar listo inmediatamente
- Tienes recursos para usar herramientas como **Veeam** o **borgbackup**

üîÅ **Restauraci√≥n**: instant√°nea para el √∫ltimo d√≠a

---

#### ‚úÖ 5. Backup Espejo (Mirror)

üß© **Caso**: Dos servidores sincronizados en tiempo real

üìÅ Lo que cambia en uno, se refleja en el otro

üëâ **Ideal cuando**:

- Se necesita alta disponibilidad
- No hay tolerancia a la p√©rdida

üîÅ **Restauraci√≥n**: r√°pida, pero **no sirve contra errores humanos o ransomware**

---

### üõ†Ô∏è ¬øC√≥mo se instala y usa?

#### üß∞ Herramientas comunes:

| Sistema | Herramienta recomendada                                         |
| ------- | --------------------------------------------------------------- |
| Windows | **Cobian Backup**, **Veeam Agent**, **Macrium Reflect**         |
| Linux   | **rsync**, **borgbackup**, **rsnapshot**, **duplicity**         |
| Cloud   | **Google Drive Backup**, **Dropbox Smart Sync**, **AWS Backup** |

---

### üì¶ Ejemplo completo ‚Äì Backup completo + diferencial en Windows con **Cobian Backup**

#### üßæ Paso a paso:

1. **Descarga** Cobian Backup:
   [https://www.cobiansoft.com/](https://www.cobiansoft.com/)

2. **Inst√°lalo** como servicio.

3. **Crea dos tareas**:

   - Una semanal (**completo**) cada domingo a las 9:00 a.m.
   - Una diaria (**diferencial**) de lunes a viernes a las 6:00 p.m.

4. **Configura la carpeta fuente y destino**, por ejemplo:

   - Origen: `C:\Usuarios\Gustavo\Documentos`
   - Destino: `D:\Backups\`

5. En ‚Äú**Tipo de backup**‚Äù elige:

   - ‚ÄúCompleto‚Äù para la tarea del domingo
   - ‚ÄúDiferencial‚Äù para los d√≠as de semana

6. Activa ‚Äú**Compresi√≥n zip**‚Äù y ‚Äú**eliminar backups antiguos**‚Äù si lo deseas

---

### üß™ Restaurar archivos

- En **Cobian**, solo ve a la carpeta del √∫ltimo backup completo y copia los archivos.
- Luego **sobrescribe** con los archivos del √∫ltimo **diferencial**, si deseas el √∫ltimo estado.

---

### üß† Recomendaciones finales

| Recomendaci√≥n               | Detalles                                                      |
| --------------------------- | ------------------------------------------------------------- |
| üóìÔ∏è Usa m√∫ltiples tipos      | Backup completo + diferencial o incremental funciona muy bien |
| ‚òÅÔ∏è Usa copia externa o nube | ¬°Siempre ten backup fuera del equipo!                         |
| üß™ Prueba la restauraci√≥n   | No sirve de nada un backup que nunca fue probado              |
| üîê Encripta los backups     | Usa ZIP con contrase√±a o cifrado tipo AES-256                 |

---

[üîº](#√≠ndice)

---

## **475. Caso pr√°ctico: Backup Profesional/Empresarial**

### üîê ¬øQu√© es un Backup Profesional/Empresarial?

Un **backup empresarial** es una soluci√≥n de copia de seguridad dise√±ada para proteger grandes vol√∫menes de datos, m√∫ltiples usuarios, y garantizar que la informaci√≥n cr√≠tica de la empresa **est√© segura, disponible y recuperable** ante fallos, errores humanos, ataques o desastres.

---

### üéØ Objetivos del backup empresarial

1. ‚úÖ Proteger informaci√≥n confidencial (clientes, ventas, documentos legales)
2. ‚úÖ Cumplir normativas (GDPR, HIPAA, ISO 27001)
3. ‚úÖ Recuperar operaciones r√°pidamente (resiliencia)
4. ‚úÖ Automatizar tareas (sin intervenci√≥n manual)
5. ‚úÖ Monitorizar y auditar los respaldos

---

### üß† Tipos de backup usados en empresas

| Tipo de backup          | ¬øPara qu√© se usa en empresas?                                    |
| ----------------------- | ---------------------------------------------------------------- |
| **Completo**            | Copias maestras semanales o mensuales                            |
| **Incremental**         | Copias diarias (ahorra espacio)                                  |
| **Diferencial**         | Restauraci√≥n m√°s r√°pida sin tanto espacio                        |
| **Incremental inverso** | √öltimo estado siempre disponible, ideal para recuperaci√≥n r√°pida |

---

### üß∞ Herramientas profesionales populares

| Herramienta                    | Plataforma            | Ideal para...                              |
| ------------------------------ | --------------------- | ------------------------------------------ |
| **Veeam Backup & Replication** | Windows, VMware       | Empresas grandes y medianas                |
| **Acronis Cyber Protect**      | Multiplataforma       | Copias h√≠bridas (local + nube)             |
| **Nakivo**                     | Windows/Linux         | F√°cil integraci√≥n con NAS y virtualizaci√≥n |
| **BorgBackup** + scripts       | Linux                 | Empresas con bajo presupuesto              |
| **Veritas NetBackup**          | Grandes corporaciones | Alto rendimiento y escalabilidad           |

---

### üõ†Ô∏è Instalaci√≥n pr√°ctica ‚Äì Ejemplo con **Veeam Agent for Windows (Gratuito)**

#### ‚úÖ ¬øPor qu√© Veeam Agent?

- Profesional y gratuito para servidores/workstations
- Admite backup completo, incremental y diferencial
- Puede guardar en disco externo, red (NAS), nube (Azure, AWS)
- F√°cil de usar, interfaz gr√°fica

---

### üîß Instalaci√≥n paso a paso de Veeam Agent

#### üîΩ 1. Descarga

- Ir a: [https://www.veeam.com/windows-endpoint-server-backup-free.html](https://www.veeam.com/windows-endpoint-server-backup-free.html)
- Registrarse y descargar el instalador

#### üñ•Ô∏è 2. Instala Veeam Agent

- Ejecuta el `.exe` y acepta los t√©rminos
- Instala como **"Standalone"**

#### üõ†Ô∏è 3. Crea una tarea de backup

- Abre Veeam Agent ‚Üí "Create Backup Job"
- Elegir **tipo de backup**:

  - "Entire Computer" (Completo)
  - "Volume level backup" (Ej. solo disco C:)
  - "File level backup" (Carpetas espec√≠ficas)

- Elegir destino:

  - Disco externo, red (NAS), o nube

#### üïì 4. Programa el backup

- Ejemplo:

  - Lunes a s√°bado ‚Üí **Incremental diario a las 8:00 p.m.**
  - Domingo ‚Üí **Completo a las 9:00 a.m.**

#### üîê 5. (Opcional) Cifrado y notificaciones

- Activa cifrado AES-256 con clave
- Configura alertas por correo electr√≥nico

---

### üì¶ Ejemplo completo ‚Äì Caso empresa contable

#### üìò Escenario

Una empresa contable peque√±a tiene:

- 10 empleados
- Archivos en red: `\\SERVIDOR\CONTABILIDAD`
- Equipos con Windows 10
- NAS Synology de respaldo (`\\NAS\Backups`)

#### üéØ Objetivo del backup

- Backup completo semanal del servidor
- Backup incremental diario de carpetas compartidas
- Cifrado de backups
- Recuperaci√≥n r√°pida ante ransomware

---

#### üîÑ Plan de respaldo

| D√≠a          | Tipo de Backup | Origen                            | Destino         |
| ------------ | -------------- | --------------------------------- | --------------- |
| Domingo      | Completo       | Disco C: + Compartidos            | `\\NAS\Backups` |
| Lunes-S√°bado | Incremental    | Carpeta `\\SERVIDOR\CONTABILIDAD` | `\\NAS\Backups` |

---

#### üß™ Restauraci√≥n simulada

En caso de que se borre accidentalmente una carpeta:

1. Abrir Veeam Agent
2. Ir a "Restore" ‚Üí "File Level Restore"
3. Elegir la fecha y carpeta
4. Click derecho ‚Üí "Restore" o "Export"

¬°Listo! Archivos recuperados en minutos.

---

### üß† Consejos adicionales para empresas

‚úÖ **Usa la regla 3-2-1**:

- 3 copias de cada archivo
- 2 medios distintos (disco local + red)
- 1 copia fuera del sitio (nube)

‚úÖ **Monitorea los backups**:

- Con Veeam puedes ver logs y alertas por email

‚úÖ **Prueba restauraciones regularmente**

‚úÖ **Usa cifrado si hay datos sensibles**

‚úÖ **Capacita al personal** para reconocer errores y reportarlos

---

[üîº](#√≠ndice)

---

## **476. Consideraciones de seguridad al almacenar Backups**

### üß† ¬øPor qu√© es importante la seguridad en los backups?

Aunque los **backups (copias de seguridad)** son una medida para proteger los datos, **si no se protegen adecuadamente, pueden ser un punto d√©bil**. Un backup inseguro puede:

- Ser robado f√°cilmente (si est√° sin cifrar).
- Ser manipulado (y restaurar datos maliciosos).
- Ser eliminado por ransomware.
- Filtrar informaci√≥n confidencial.

> **En resumen**: Un backup sin seguridad es como dejar la puerta abierta en una casa con sistema de alarmas.

---

### üîí Principales consideraciones de seguridad

#### 1. üîê **Cifrado de los Backups**

**¬øQu√© es?** Codificar los datos para que solo puedan ser le√≠dos por quien tenga la clave.

- **Backup cifrado en reposo**: Protege el backup cuando est√° almacenado.
- **Backup cifrado en tr√°nsito**: Protege los datos al enviarlos por red (por ejemplo, a la nube).

**Ejemplo pr√°ctico:**

- Con Veeam, puedes activar el cifrado AES-256 al crear el job.
- En Linux con `borgbackup`:

```bash
borg init --encryption=repokey /mnt/backups
```

---

#### 2. üßë‚Äçü§ù‚Äçüßë **Control de acceso**

**¬øQu√© es?** Limitar qui√©n puede acceder, modificar o borrar los backups.

- Usa **cuentas con permisos m√≠nimos** (principio de menor privilegio).
- No almacenes backups con el mismo acceso del sistema original.
- Separa las cuentas de backup del dominio o acceso del sistema.

**Ejemplo:**

- Crea un usuario en el NAS solo con acceso de lectura para restaurar, y otro con escritura para respaldar.

---

#### 3. üîÑ **Integridad de los datos**

**¬øQu√© es?** Garantizar que el backup no se haya modificado o corrompido.

- Usa **checksums**, funciones hash (SHA-256) o firmas digitales.
- Verifica regularmente los backups.

**Ejemplo:**

```bash
sha256sum backup.tar.gz > hash.txt
# Luego, para verificar:
sha256sum -c hash.txt
```

---

#### 4. üß™ **Pruebas de restauraci√≥n**

**¬øPor qu√©?** Un backup que no se puede restaurar, **no sirve**.

- Agenda pruebas de restauraci√≥n mensuales o trimestrales.
- Documenta el procedimiento de recuperaci√≥n.

---

#### 5. üïµÔ∏è **Monitoreo y registros (logs)**

- Registra cada intento de backup, acceso o restauraci√≥n.
- Activa alertas por correo o Slack en herramientas como Veeam o Bacula.

---

#### 6. ‚òÅÔ∏è **Almacenamiento seguro (nube, NAS o f√≠sico)**

- Usa almacenamiento que **soporte cifrado**.
- A√≠sla los dispositivos de backup de la red principal.
- Aplica la regla **3-2-1**:

  - **3 copias**
  - **2 tipos de medios**
  - **1 copia off-site (en la nube o en otra ubicaci√≥n f√≠sica)**

---

### üí• Casos de amenazas comunes

| Amenaza                        | ¬øC√≥mo evitarla?                               |
| ------------------------------ | --------------------------------------------- |
| Ransomware elimina backups     | Backups **offline o inmutables**              |
| Robo de disco duro con backups | Cifrado AES-256                               |
| Acceso indebido                | Autenticaci√≥n multifactor, permisos limitados |
| Error humano al borrar backups | Versionado, backup inmutable, notificaciones  |

---

### üõ†Ô∏è Herramientas que aplican buenas pr√°cticas

| Herramienta    | Seguridad destacada                   |
| -------------- | ------------------------------------- |
| **Veeam**      | Cifrado AES, backup inmutable, logs   |
| **Acronis**    | Antivirus + backup, encriptaci√≥n      |
| **BorgBackup** | Cifrado nativo, integridad con hash   |
| **Restic**     | Muy seguro, todo cifrado y verificado |
| **AWS Backup** | Copias inmutables + acceso granular   |

---

### ‚úÖ Caso pr√°ctico completo ‚Äì Backup empresarial seguro

#### üè¢ Escenario

- Empresa de marketing con archivos confidenciales de clientes.
- NAS local para backup diario.
- Backup mensual adicional en Google Cloud Storage.

---

#### üîê Plan de seguridad implementado

1. **Backup diario con Borg en Linux**:

```bash
borg init --encryption=repokey /mnt/nas/backups
borg create /mnt/nas/backups::$(date +%F) /home/empresa/docs
```

2. **Checksum diario de los backups**:

```bash
sha256sum /mnt/nas/backups/2025-07-22 > /mnt/nas/backups/2025-07-22.hash
```

3. **Sync mensual con Google Cloud (off-site)**:

```bash
rclone sync /mnt/nas/backups remote:gcs-backups --transfers=4
```

4. **Usuario NAS con permisos limitados**:

   - Solo acceso de escritura
   - Logs auditables

5. **Copia inmutable en la nube (GCS con Object Lock)**:

   - Protege contra borrado accidental o intencional

6. **Pruebas de restauraci√≥n cada mes**:

   - Restauraci√≥n parcial de 2 archivos al azar
   - Verificaci√≥n con hash

---

### üß† Recomendaciones finales

- Nunca guardes backups en el mismo servidor que los datos originales.
- Usa backups inmutables si es posible.
- Asegura tanto el almacenamiento **como el transporte** de backups.
- Automatiza alertas de fallos o actividades sospechosas.
- Cifra siempre, incluso los backups en dispositivos externos.

---

[üîº](#√≠ndice)

---

## **477. Inventariado de activos: CMDB**

### üîé ¬øQu√© es una CMDB?

**CMDB** significa **Base de Datos de Gesti√≥n de Configuraci√≥n** (en ingl√©s _Configuration Management Database_). Es **una herramienta centralizada** donde se almacena toda la informaci√≥n relevante de los activos de una empresa, como:

- Computadoras, servidores, laptops, routers, m√≥viles.
- Software instalado, licencias, versiones.
- Usuarios asociados, √°reas, ubicaci√≥n.
- Relaci√≥n entre ellos (por ejemplo, qu√© servidor soporta qu√© aplicaci√≥n).

> üéØ **Objetivo**: Saber **qu√© tienes**, **d√≥nde est√°**, **qui√©n lo usa** y **c√≥mo se conecta con otros elementos del sistema**.

---

### üß† ¬øPor qu√© es importante una CMDB?

- üìã Mantiene un **inventario exacto y actualizado**.
- üõ†Ô∏è Facilita el **soporte t√©cnico y resoluci√≥n de incidentes**.
- üîê Mejora la **gesti√≥n de riesgos y seguridad**.
- ‚úÖ Es fundamental para cumplir normas como **ISO 27001**, **ITIL**, **GDPR**, etc.
- üìà Permite decisiones informadas en upgrades, cambios o compras.

---

### üìå Ejemplo sencillo de activos y relaciones

| Activo         | Tipo     | Usuario   | Ubicaci√≥n | Relaci√≥n                       |
| -------------- | -------- | --------- | --------- | ------------------------------ |
| PC-001         | Laptop   | Ana G√≥mez | Lima      | Conectado a WiFi-Oficina       |
| App-Cobranzas  | Software | --        | Servidor1 | Corre en `Servidor1`           |
| Servidor1      | Servidor | --        | CPD       | Soporta `App-Cobranzas`        |
| Router-Oficina | Red      | --        | Lima      | Da red a `PC-001`, `Servidor1` |

---

### üß∞ ¬øQu√© contiene una CMDB?

1. **CI (Configuration Items)**: Cada activo o componente.
2. **Atributos**: Nombre, IP, sistema operativo, fecha de compra, estado.
3. **Relaciones**: Qu√© depende de qu√©. Ej: App depende del servidor.
4. **Historial**: Cambios, actualizaciones, incidencias.

---

### üõ†Ô∏è Herramientas populares para CMDB

| Herramienta    | Caracter√≠sticas principales                   |
| -------------- | --------------------------------------------- |
| **GLPI**       | Gratuito, con m√≥dulos de CMDB e inventario    |
| **iTop**       | CMDB + ITSM (IT Service Management)           |
| **ServiceNow** | Profesional, potente, cloud, pago             |
| **Ralph**      | Inventario de hardware y red con CMDB         |
| **Open-AudIT** | Descubrimiento de red e inventario autom√°tico |

---

### üíª C√≥mo instalar una CMDB b√°sica: Ejemplo con GLPI

GLPI es uno de los sistemas de gesti√≥n de activos y CMDB m√°s usados en el mundo de habla hispana. Aqu√≠ te muestro c√≥mo instalarlo en **Windows** usando XAMPP.

#### üîß Requisitos

- Tener **XAMPP** (Apache + PHP + MySQL)
- Navegador web
- Descargar GLPI

---

#### üì¶ Pasos de instalaci√≥n en Windows

1. **Descargar e instalar XAMPP**
   [https://www.apachefriends.org](https://www.apachefriends.org)

2. **Descargar GLPI**
   Desde su sitio oficial: [https://glpi-project.org](https://glpi-project.org)

3. **Copiar GLPI a XAMPP**

   - Descomprime GLPI
   - Copia la carpeta `glpi` a:
     `C:\xampp\htdocs\`

4. **Iniciar Apache y MySQL desde XAMPP Control Panel**

5. **Crear base de datos GLPI**

   - Ir a: [http://localhost/phpmyadmin](http://localhost/phpmyadmin)
   - Crear una base de datos llamada `glpi`

6. **Iniciar la instalaci√≥n en navegador**

   - Ve a: [http://localhost/glpi](http://localhost/glpi)
   - Sigue los pasos del asistente (idioma, DB, admin, etc.)

7. **Accede con usuario admin**

   - Usuario: `glpi`
   - Contrase√±a: `glpi`

---

### üßë‚Äçüè´ Ejemplo completo ‚Äì CMDB de una empresa peque√±a

**Empresa:** ‚ÄúSolucionesCloud‚Äù

**Activos a registrar:**

1. Laptop de Mar√≠a (PC-MAR)
2. Servidor de correos (SRV-MAIL)
3. App CRM en la nube (CRM-App)
4. Router de red (Router-01)

---

#### 1. üìã Crear los activos (CI)

| Nombre    | Tipo     | IP            | Usuario    | Ubicaci√≥n  | Estado     |
| --------- | -------- | ------------- | ---------- | ---------- | ---------- |
| PC-MAR    | Laptop   | 192.168.1.100 | Mar√≠a Le√≥n | Lima       | Activo     |
| SRV-MAIL  | Servidor | 192.168.1.10  | --         | DataCenter | Producci√≥n |
| CRM-App   | Software | SaaS          | Todos      | Internet   | Activo     |
| Router-01 | Red      | 192.168.1.1   | --         | Lima       | Activo     |

---

#### 2. üîó Relacionarlos en la CMDB

- **CRM-App depende de internet (Router-01)**.
- **SRV-MAIL se comunica a trav√©s del Router-01**.
- **PC-MAR accede a SRV-MAIL y CRM-App**.

---

#### 3. üíº Utilizar la CMDB para:

- üì• Ver qu√© pasar√≠a si se cae el router (impacto).
- üßæ Verificar licencias de software.
- üõ†Ô∏è Hacer mantenimiento planificado.
- üìë Auditor√≠as de TI.

---

### ‚úÖ Buenas pr√°cticas en el uso de una CMDB

- üîÑ **Mant√©n la CMDB actualizada** con automatizaci√≥n o pol√≠ticas claras.
- üîê **Controla los accesos**: No todos deben editar.
- üîç **Haz revisiones regulares** de exactitud.
- üß© **Relaciona los activos** para ver dependencias e impactos.
- üóÉÔ∏è Usa la CMDB como base para seguridad, cambios, continuidad, etc.

---

### üìå Resumen final

| Clave                   | Detalle                                                  |
| ----------------------- | -------------------------------------------------------- |
| ¬øQu√© es?                | Base de datos que registra activos, relaciones y estados |
| ¬øPara qu√© sirve?        | Saber qu√© hay en la empresa, c√≥mo se usa y se conecta    |
| Herramienta recomendada | GLPI (gratis), ServiceNow (empresarial), iTop            |
| Casos de uso            | Auditor√≠as, resoluci√≥n de fallos, seguridad, cambios     |

---

[üîº](#√≠ndice)

---

## **478. Almacenamiento de claves: TPM y HSM**

### üîé ¬øQu√© significa almacenar claves de forma segura?

Cuando hablamos de **almacenar claves**, nos referimos a **guardar claves criptogr√°ficas** (como las de cifrado o firma digital) de forma que **no puedan ser robadas f√°cilmente**. Estas claves protegen:

- Contrase√±as
- Certificados digitales
- Archivos cifrados
- Comunicaci√≥n segura (VPN, HTTPS, etc.)
- Firmas electr√≥nicas

Si las claves se guardan en texto plano o en disco, un atacante que compromete el equipo podr√≠a robarlas. Por eso se usan tecnolog√≠as especiales como:

---

### üß± TPM (Trusted Platform Module)

#### üìå ¬øQu√© es?

Es un **chip f√≠sico** (soldado en la placa base) que **almacena y protege claves criptogr√°ficas**, contrase√±as y certificados **de forma segura**.

> üéØ Su funci√≥n principal es **aislar las claves del sistema operativo** para que no puedan ser robadas incluso si el sistema est√° comprometido.

---

#### üõ°Ô∏è ¬øQu√© hace el TPM?

- Almacena claves de cifrado y firmas digitales.
- Genera n√∫meros aleatorios seguros.
- Protege el **arranque seguro (Secure Boot)**.
- Valida la integridad del sistema al iniciarse (medici√≥n del arranque).

---

#### üß† Ejemplo f√°cil:

- Tienes una laptop con **BitLocker activado**.
- BitLocker usa el **TPM** para guardar la clave de cifrado del disco.
- Si un ladr√≥n roba el disco duro e intenta usarlo en otra PC, **no podr√° descifrarlo** sin el TPM original.

---

#### ‚úÖ ¬øC√≥mo saber si tengo TPM?

En Windows:

1. Presiona `Win + R`, escribe `tpm.msc` y presiona Enter.
2. Si aparece la consola de administraci√≥n de TPM ‚Üí tienes un chip TPM.
3. Ver√°s versi√≥n 1.2 o 2.0.

---

### üè¢ HSM (Hardware Security Module)

#### üìå ¬øQu√© es?

Es un **dispositivo f√≠sico externo** (hardware dedicado) para **gestionar claves criptogr√°ficas** en ambientes empresariales. Se usa principalmente en:

- Bancos
- Empresas grandes
- Centros de datos
- Autoridades certificadoras (CA)

> üè¶ Imagina un cofre de seguridad en un banco, pero para claves digitales.

---

#### üîê ¬øQu√© hace un HSM?

- Genera, guarda y usa claves sin exponerlas al sistema.
- Soporta operaciones criptogr√°ficas como:

  - Firma digital
  - Cifrado y descifrado
  - Autenticaci√≥n

- Tiene protecci√≥n contra manipulaciones f√≠sicas (autodestrucci√≥n si se abre).

---

#### üß† Ejemplo f√°cil:

- Un banco quiere firmar electr√≥nicamente transacciones.
- Usa un **HSM** que contiene la clave privada.
- Solo el HSM puede firmar. **La clave nunca sale del dispositivo**.

---

### üÜö Diferencias entre TPM y HSM

| Caracter√≠stica  | TPM                              | HSM                                |
| --------------- | -------------------------------- | ---------------------------------- |
| Uso             | Computadoras personales, laptops | Entornos empresariales             |
| Forma           | Chip soldado en placa madre      | Dispositivo f√≠sico dedicado        |
| Acceso          | Desde sistema operativo          | Desde aplicaciones v√≠a API o red   |
| Claves privadas | Generadas y almacenadas          | Generadas y protegidas             |
| Rendimiento     | Limitado                         | Alto (puede manejar muchas claves) |
| Ejemplo de uso  | BitLocker, Secure Boot           | Firmas digitales de bancos         |

---

### üõ†Ô∏è Instalaci√≥n / Uso

#### üîß TPM

No se instala manualmente. Viene **preinstalado en laptops y PCs modernas**. Para usarlo:

##### En Windows 10/11:

1. **Activar BitLocker**:

   - Ve a _Configuraci√≥n > Actualizaci√≥n y seguridad > Cifrado de dispositivo_.
   - O usa `Control Panel > Sistema y seguridad > Cifrado de unidad BitLocker`.
   - BitLocker detecta el TPM autom√°ticamente.

2. **Para programadores**:

   - Se puede acceder desde C, C++, o PowerShell usando `Windows.Security.Cryptography`.

---

#### üîê HSM

Un HSM se instala en:

- üîå Forma de appliance f√≠sica (hardware conectado al servidor).
- ‚òÅÔ∏è Forma de servicio cloud (por ejemplo, AWS CloudHSM, Azure Key Vault con HSM).

##### Ejemplo de uso con AWS CloudHSM:

```bash
# Crear una clave de cifrado en AWS CloudHSM (v√≠a consola o CLI)
aws kms create-key \
  --customer-master-key-spec RSA_2048 \
  --key-usage SIGN_VERIFY \
  --origin AWS_CLOUDHSM
```

- Puedes integrar este HSM con servicios de firma, cifrado de datos, etc.
- El cliente nunca ve la clave privada: **solo usa la clave, no la extrae**.

---

### ‚úÖ Ejemplo completo ‚Äì Comparaci√≥n y uso

Sup√≥n que tienes:

| Escenario                      | Soluci√≥n recomendada  | Motivo                                                       |
| ------------------------------ | --------------------- | ------------------------------------------------------------ |
| Laptop personal                | TPM + BitLocker       | TPM asegura la clave del disco, f√°cil de usar, ya instalado. |
| Empresa que firma certificados | HSM                   | Mayor seguridad, velocidad y cumplimiento normativo.         |
| Aplicaci√≥n en la nube          | CloudHSM (AWS, Azure) | Escalable, no requiere hardware f√≠sico.                      |

---

#### üîí Caso de uso real: Protecci√≥n de documentos PDF

- Tienes documentos PDF legales que se firman digitalmente.
- En PC personal: usas **firma digital con certificado almacenado en TPM**.
- En empresa: el sistema firma los PDFs usando **clave alojada en un HSM**.

En ambos casos, la clave **no es accesible directamente** desde el sistema operativo.

---

### üìå Resumen final

| T√©rmino | Descripci√≥n corta                                       | Ejemplo claro                              |
| ------- | ------------------------------------------------------- | ------------------------------------------ |
| **TPM** | Chip en PC/laptop para almacenar claves de forma segura | BitLocker usa TPM para proteger tu disco   |
| **HSM** | M√≥dulo de seguridad de hardware usado en empresas       | Un banco usa HSM para firmar transacciones |

---

[üîº](#√≠ndice)

---

| **Inicio**         | **atr√°s 3**                                          | **Siguiente 5**                                                                           |
| ------------------ | ---------------------------------------------------- | ----------------------------------------------------------------------------------------- |
| [üè†](../README.md) | [‚è™](./6_3_Criptografia_moderna_y_Ciberseguridad.md) | [‚è©](./6_5_CiberSeguridad_de_las_Comunicaciones_y_redes_informaticas_Network_Security.md) |
