| **Inicio**         | **atr√°s 6**                                              |
| ------------------ | -------------------------------------------------------- |
| [üè†](../README.md) | [‚è™](./5_6_Hacking_etico_y_post_explotacion_avanzada.md) |

---

## **√çndice**

| Temario                                                                                                    |
| ---------------------------------------------------------------------------------------------------------- |
| [359. Arquitectura y registro en la nube (AWS)](#359-arquitectura-y-registro-en-la-nube-aws)               |
| [360. Registro y configuraci√≥n de una cuenta en AWS](#360-registro-y-configuraci√≥n-de-una-cuenta-en-aws)   |
| [361. Infraestructura de red en la nube (AWS)](#361-infraestructura-de-red-en-la-nube-aws)                 |
| [362. Seguridad y computaci√≥n en la nube (AWS)](#362-seguridad-y-computaci√≥n-en-la-nube-aws)               |
| [363. Balanceadores y almacenamiento en la nube (AWS)](#363-balanceadores-y-almacenamiento-en-la-nube-aws) |
| [364. Recopilaci√≥n de informaci√≥n en un entorno real](#364-recopilaci√≥n-de-informaci√≥n-en-un-entorno-real) |
| [365. Controles de seguridad en un entorno real](#365-controles-de-seguridad-en-un-entorno-real)           |
| [366. Auditando la infraestructura interna](#366-auditando-la-infraestructura-interna)                     |
| [367. Tipos de auditor√≠as de seguridad](#368-eliminando-el-entorno-en-la-nube-aws)                         |
| [368. Eliminando el entorno en la nube (AWS)](#368-eliminando-el-entorno-en-la-nube-aws)                   |

---

# **Hacking Etico en entornos reales (Amazon AWS)**

## **359. Arquitectura y registro en la nube (AWS)**

![AWS](../img/5_Hacking_Etico_y_Ciberseguridad_Avanzado/AWS.png "AWS")

### üß† ¬øQu√© es AWS?

**Amazon Web Services (AWS)** es una **plataforma de servicios en la nube** de Amazon. Te permite alquilar infraestructura como:

- Servidores (EC2)
- Bases de datos (RDS)
- Almacenamiento de archivos (S3)
- Redes virtuales (VPC)
- Y muchos otros servicios

Con AWS puedes lanzar proyectos sin comprar hardware f√≠sico, y pagar **solo por lo que usas**.

---

### üß± ¬øQu√© es la arquitectura en la nube?

La **arquitectura en la nube** se refiere a c√≥mo dise√±amos y organizamos los **componentes tecnol√≥gicos** en una nube como AWS para construir soluciones como:

- Sitios web
- Aplicaciones m√≥viles
- Plataformas de an√°lisis de datos
- Infraestructuras empresariales

#### üîß Componentes comunes en una arquitectura en AWS

| Componente     | Servicio AWS              | ¬øPara qu√© sirve?            |
| -------------- | ------------------------- | --------------------------- |
| Computaci√≥n    | EC2, Lambda               | Ejecutar aplicaciones       |
| Almacenamiento | S3, EBS                   | Guardar archivos y discos   |
| Base de datos  | RDS, DynamoDB             | Datos estructurados o NoSQL |
| Redes          | VPC, Load Balancer        | Aislar y enrutar tr√°fico    |
| Seguridad      | IAM, Security Groups, KMS | Control de acceso y cifrado |
| Supervisi√≥n    | CloudWatch, CloudTrail    | Logs, m√©tricas, auditor√≠as  |

---

### üìù ¬øC√≥mo me registro en AWS?

#### Paso 1: Ir al sitio oficial

Accede a: [https://aws.amazon.com](https://aws.amazon.com)

Haz clic en **"Create an AWS Account"**.

---

### #Paso 2: Completa el formulario de registro

1. Ingresa tu **correo electr√≥nico**, **nombre de cuenta**, y **contrase√±a**.
2. Elige si eres **cuenta personal** o **empresa**.
3. Proporciona un **n√∫mero de tel√©fono y direcci√≥n real**.
4. Ingresa los **datos de tu tarjeta de cr√©dito/d√©bito**. _(No te cobrar√°n si usas el nivel gratuito)_.
5. Verifica tu identidad con un c√≥digo enviado a tu tel√©fono.
6. Elige un plan: elige **Free Tier (nivel gratuito)**.

---

#### Paso 3: Accede al **AWS Management Console**

Una vez registrado, puedes acceder desde:

üîó [https://console.aws.amazon.com/](https://console.aws.amazon.com/)

Usa tu usuario y contrase√±a para acceder.

---

### üß™ Ejemplo completo: Lanzar un servidor en la nube con AWS

#### üéØ Objetivo:

Crear un servidor virtual (EC2) en AWS, con acceso remoto, y probarlo desde tu PC.

---

#### 1. Acceder al servicio EC2

1. Entra a la consola: [https://console.aws.amazon.com](https://console.aws.amazon.com)
2. En el buscador escribe ‚ÄúEC2‚Äù y haz clic.
3. Clic en ‚ÄúLaunch instance‚Äù.

---

#### 2. Configurar la instancia

| Paso               | Opci√≥n sugerida                                   |
| ------------------ | ------------------------------------------------- |
| Nombre             | MiServidorLinux                                   |
| Imagen             | Amazon Linux 2023 o Ubuntu 22.04 (Free Tier)      |
| Tipo de instancia  | t2.micro (1 vCPU, 1GB RAM)                        |
| Par de claves      | Crear nueva: ‚Äúmi_clave.pem‚Äù                       |
| Firewall (puertos) | Abrir SSH (puerto 22), HTTP (puerto 80) si deseas |

---

#### 3. Descargar clave privada `.pem`

Guarda tu archivo `mi_clave.pem` en un lugar seguro. Luego cambia los permisos:

```bash
chmod 400 mi_clave.pem
```

---

#### 4. Conectarte a tu servidor por SSH

Desde tu terminal (Linux/Mac/WSL):

```bash
ssh -i mi_clave.pem ec2-user@<IP-P√öBLICA>
```

(Si elegiste Ubuntu, el usuario puede ser `ubuntu`)

---

#### 5. Probar el servidor

En la terminal del servidor puedes hacer:

```bash
sudo yum update  # (si es Amazon Linux)
sudo apt update  # (si es Ubuntu)
```

Crear un archivo:

```bash
echo "Hola desde AWS" > hola.txt
cat hola.txt
```

---

### üì¶ Resultado

¬°Ya tienes un servidor funcionando en la nube! Puedes instalar NGINX, desplegar una app, correr un backend o conectarte a una base de datos.

---

### üß† Buenas pr√°cticas b√°sicas

- üîê Nunca compartas tu archivo `.pem`.
- üîí Usa **Security Groups** para limitar acceso solo desde tu IP.
- üí∞ Monitorea el uso para no exceder el **Free Tier**.
- üì§ Det√©n o termina instancias si no las est√°s usando.

---

### üöÄ ¬øQu√© sigue?

Con tu cuenta de AWS puedes ahora:

- Crear una bucket S3 para alojar archivos
- Lanzar una base de datos RDS para tu app
- Crear funciones Lambda sin servidores
- Automatizar todo con CloudFormation o Terraform

---

[üîº](#√≠ndice)

---

## **360. Registro y configuraci√≥n de una cuenta en AWS**

### üß† ¬øQu√© es AWS?

**Amazon Web Services (AWS)** es una plataforma de servicios en la nube que te permite:

- Crear servidores virtuales (EC2)
- Guardar archivos (S3)
- Usar bases de datos (RDS)
- Analizar datos, crear sitios web, apps m√≥viles, etc.

Y lo mejor: puedes comenzar gratis con el plan **Free Tier**.

---

### ‚úÖ ¬øQu√© necesitas para registrarte en AWS?

1. Correo electr√≥nico v√°lido (mejor si es uno profesional o que uses para proyectos serios)
2. N√∫mero de tel√©fono celular
3. Tarjeta de cr√©dito o d√©bito (se requiere para verificar, pero no te cobran si usas el nivel gratuito)
4. Conexi√≥n a Internet estable

---

### üìù Paso a Paso: Registro de una cuenta en AWS

#### üîπ Paso 1: Ingresar al sitio oficial

Abre tu navegador y ve a:

üëâ [https://aws.amazon.com](https://aws.amazon.com)

Haz clic en el bot√≥n **"Crear una cuenta de AWS"**.

---

#### üîπ Paso 2: Crear una cuenta

Completa el formulario:

| Campo                | Ejemplo                                             |
| -------------------- | --------------------------------------------------- |
| Correo electr√≥nico   | [guss.dev@example.com](mailto:guss.dev@example.com) |
| Nombre de cuenta     | GussDev Cloud                                       |
| Contrase√±a           | \[Tu contrase√±a segura]                             |
| Confirmar contrase√±a | \[La misma]                                         |

Haz clic en **Continuar (Next)**.

---

#### üîπ Paso 3: Datos de contacto

Selecciona si es:

- Personal (para ti)
- Empresa (si es una organizaci√≥n)

Completa con tu nombre, direcci√≥n, pa√≠s y n√∫mero de tel√©fono. Aseg√∫rate que sea **correcto**, porque recibir√°s un c√≥digo de verificaci√≥n.

---

#### üîπ Paso 4: M√©todo de pago

Aqu√≠ debes ingresar los datos de **una tarjeta de cr√©dito o d√©bito** v√°lida.

üí° **TIP:** AWS har√° un cobro de **\$1 o menos**, solo para verificar. Se devuelve despu√©s.

---

#### üîπ Paso 5: Verificaci√≥n por tel√©fono

AWS te llamar√° o te enviar√° un SMS con un **c√≥digo de 4 d√≠gitos**.

üìû Ingresa el c√≥digo para verificar que el n√∫mero es tuyo.

---

#### üîπ Paso 6: Elige un plan

Ver√°s tres opciones:

- Free Tier (Gratis)
- Developer (pago)
- Business (pago)

üîπ **Elige "Free Tier"**.

---

#### üîπ Paso 7: ¬°Listo!

Tu cuenta est√° activa. Puedes entrar a la consola en:

üëâ [https://console.aws.amazon.com](https://console.aws.amazon.com)

Usa tu correo y contrase√±a para iniciar sesi√≥n.

---

### üõ†Ô∏è ¬øQu√© es la Consola de Administraci√≥n de AWS?

Es el panel de control donde puedes ver y administrar **todos los servicios** de AWS.

Desde aqu√≠ puedes:

- Crear servidores
- Subir archivos
- Gestionar bases de datos
- Configurar seguridad
- Usar servicios de inteligencia artificial, etc.

---

### üîê Recomendaciones de configuraci√≥n inicial

Despu√©s de registrarte, sigue estos pasos importantes:

#### üî∏ 1. Activar la verificaci√≥n en dos pasos (MFA)

1. En la esquina superior derecha haz clic en tu nombre > **"Security credentials"**.
2. Ve a la secci√≥n "Multi-Factor Authentication (MFA)".
3. Configura con una app como **Google Authenticator**.

üîí Esto protege tu cuenta si alguien roba tu contrase√±a.

---

#### üî∏ 2. Crear un usuario administrador (no usar root)

1. En la consola, busca **IAM** (Identity and Access Management).
2. Crea un nuevo usuario:

   - Tipo: **IAM user**
   - Permisos: **Administrador**

3. Usa este nuevo usuario para trabajar en AWS. Evita usar la cuenta **root** (principal) todo el tiempo.

---

#### üî∏ 3. Crear una clave SSH (si usar√°s EC2)

Desde tu terminal (Linux/Mac):

```bash
ssh-keygen -t rsa -b 4096 -f gussdev-key
```

Esto crea dos archivos:

- `gussdev-key` ‚Üí clave privada (¬°gu√°rdala bien!)
- `gussdev-key.pub` ‚Üí clave p√∫blica (la subir√°s a AWS para conectarte a servidores)

---

### üöÄ Ejemplo completo: Crear y conectarte a tu primer servidor (EC2)

#### üéØ Objetivo:

Crear un servidor en la nube (Amazon Linux) y conectarte por SSH.

---

#### 1. Desde la consola, busca **EC2**

Haz clic en **"Launch Instance"** (Iniciar instancia).

---

#### 2. Configura la instancia

| Opci√≥n            | Valor recomendado                      |
| ----------------- | -------------------------------------- |
| Nombre            | MiPrimerServidor                       |
| AMI (sistema)     | Amazon Linux 2023 (Free tier)          |
| Tipo de instancia | t2.micro (gratis)                      |
| Par de claves     | Sube tu clave p√∫blica o crea una nueva |
| Config. red       | Habilita puerto 22 (SSH)               |

Haz clic en **Launch Instance**.

---

#### 3. Conectarte por SSH desde tu terminal

```bash
ssh -i gussdev-key ec2-user@<IP-P√öBLICA>
```

Cambiar permisos si es necesario:

```bash
chmod 400 gussdev-key
```

---

#### 4. Probar que funciona

Una vez dentro:

```bash
echo "¬°Hola desde AWS!" > hola.txt
cat hola.txt
```

¬°Tu servidor en la nube est√° funcionando!

---

### üìå Resumen r√°pido

| Paso | Acci√≥n                                                     |
| ---- | ---------------------------------------------------------- |
| 1    | Crea tu cuenta en [aws.amazon.com](https://aws.amazon.com) |
| 2    | Verifica tu n√∫mero y tarjeta                               |
| 3    | Elige el plan gratuito (Free Tier)                         |
| 4    | Activa MFA y crea usuarios IAM seguros                     |
| 5    | Lanza una instancia EC2                                    |
| 6    | Con√©ctate con SSH usando tu clave privada                  |

---

[üîº](#√≠ndice)

---

## **361. Infraestructura de red en la nube (AWS)**

### üåê ¬øQu√© es la Infraestructura de Red en la Nube (AWS)?

En AWS, la **infraestructura de red** es el conjunto de **recursos virtuales de red** que permiten que tus servidores, bases de datos, aplicaciones web, etc., se conecten de forma segura y controlada.

---

#### üîß Componentes principales de una red en AWS

| Componente                      | ¬øQu√© hace?                                                                  | Ejemplo                                         |
| ------------------------------- | --------------------------------------------------------------------------- | ----------------------------------------------- |
| **VPC (Virtual Private Cloud)** | Red privada virtual donde trabajas                                          | Como una "casa" para tus servidores             |
| **Subnets**                     | Divisiones de tu red (pueden ser p√∫blicas o privadas)                       | Un cuarto p√∫blico o privado                     |
| **Route Tables**                | Tabla de rutas para saber a d√≥nde va el tr√°fico                             | Como decir "si vas a Internet, usa esta puerta" |
| **Internet Gateway**            | Permite conexi√≥n a Internet desde la VPC                                    | La puerta principal de salida                   |
| **NAT Gateway**                 | Permite a subredes privadas salir a Internet sin ser accesibles desde fuera | Una salida con espejo unidireccional            |
| **Security Groups**             | Firewalls virtuales que controlan puertos                                   | "Abre solo el puerto 22 (SSH)"                  |
| **Network ACLs**                | Otro tipo de firewall pero por subred                                       | Seguridad a nivel de subnet                     |

---

### üéì Met√°fora para entenderlo f√°cilmente

Imagina que construyes una casa:

- üè† La casa completa = VPC
- üõèÔ∏è Cuartos privados/p√∫blicos = Subnets
- üö™ Puerta principal (a la calle) = Internet Gateway
- üîë Llaves que solo abren ciertas puertas = Security Groups
- üì¶ Paquetes con direcciones = Route Tables

---

### ‚úÖ ¬øPor qu√© crear tu propia red en AWS?

- Aislar servicios por seguridad (por ejemplo, un servidor backend en una subred privada)
- Conectar solo lo necesario a Internet (mayor control)
- Escalar de forma profesional (como lo hacen las grandes empresas)
- Prepararte para arquitecturas en producci√≥n

---

### üõ†Ô∏è C√≥mo instalar y configurar una infraestructura de red en AWS

---

#### üì¶ PASO 1: Crear una VPC personalizada

1. Entra a la consola de AWS:
   üëâ [https://console.aws.amazon.com](https://console.aws.amazon.com)

2. Busca "VPC" en la barra superior.

3. Ve a **Your VPCs** > clic en **Create VPC**.

4. Completa:

| Campo           | Valor recomendado |
| --------------- | ----------------- |
| Name tag        | `guss-vpc`        |
| IPv4 CIDR block | `10.0.0.0/16`     |
| Tenancy         | default           |

Haz clic en **Create VPC**.

---

#### üì¶ PASO 2: Crear subredes

##### üîπ Subred p√∫blica

1. Ve a **Subnets** > Create subnet.
2. Elige la VPC `guss-vpc`.
3. Asigna:

| Campo             | Valor                    |
| ----------------- | ------------------------ |
| Name tag          | `guss-public-subnet`     |
| Availability Zone | us-east-1a (por ejemplo) |
| IPv4 CIDR         | `10.0.1.0/24`            |

Haz clic en **Create subnet**.

##### üîπ Subred privada (para base de datos o backend)

Mismo proceso, pero usa:

- Name: `guss-private-subnet`
- CIDR: `10.0.2.0/24`

---

#### üì¶ PASO 3: Crear una Internet Gateway (IGW)

1. Ve a **Internet Gateways** > Create.
2. Name tag: `guss-igw`
3. Crea y luego haz clic en "Attach to VPC" ‚Üí elige `guss-vpc`.

---

#### üì¶ PASO 4: Asociar tabla de rutas a la subred p√∫blica

1. Ve a **Route Tables**.

2. Crea una nueva:

   - Name tag: `guss-public-rt`
   - VPC: `guss-vpc`

3. Luego edita las rutas:

- Destino: `0.0.0.0/0`
- Target: Internet Gateway (`guss-igw`)

4. Asocia esta tabla a la subred p√∫blica (`guss-public-subnet`).

---

#### üì¶ PASO 5: Crear un Security Group

1. Ve a **Security Groups** > Create.

| Campo       | Valor                 |
| ----------- | --------------------- |
| Name        | `guss-sg`             |
| Description | `Permitir SSH y HTTP` |
| VPC         | `guss-vpc`            |

2. En reglas de entrada (Inbound):

- Tipo: SSH, puerto 22, origen: `0.0.0.0/0`
- Tipo: HTTP, puerto 80, origen: `0.0.0.0/0`

3. Guarda el grupo.

---

### ‚úÖ Ejemplo completo: crear una infraestructura para un servidor web

#### Objetivo

‚úÖ Lanzar una instancia EC2 en la subred p√∫blica

‚úÖ Conectarte v√≠a SSH

‚úÖ Acceder a un sitio web en Apache

---

#### PASO 1: Lanzar una instancia EC2

1. EC2 > Launch Instance
2. Nombre: `ServidorWeb`
3. AMI: Amazon Linux 2023
4. Tipo: `t2.micro`
5. Key pair: selecciona o crea una
6. Red: `guss-vpc`
   Subred: `guss-public-subnet`
   Auto-assign public IP: Enabled
7. Security Group: `guss-sg`
8. Lanzar

---

#### PASO 2: Instalar Apache

Con√©ctate por SSH:

```bash
ssh -i guss-key.pem ec2-user@<IP_PUBLICA>
```

Instala Apache:

```bash
sudo yum update -y
sudo yum install -y httpd
sudo systemctl start httpd
sudo systemctl enable httpd
```

Crea una p√°gina de prueba:

```bash
echo "<h1>¬°Hola desde AWS!</h1>" | sudo tee /var/www/html/index.html
```

---

#### PASO 3: Visita el sitio en el navegador

Abre tu navegador y visita:

```
http://<IP_PUBLICA>
```

üëÄ Ver√°s el mensaje: **¬°Hola desde AWS!**

---

### ‚úÖ Resumen Visual (Arquitectura Final)

```
       Internet
          ‚îÇ
          ‚ñº
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ Internet GW  ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ           guss-vpc (10.0.0.0/16)     ‚îÇ
    ‚îÇ                                      ‚îÇ
    ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
    ‚îÇ ‚îÇ Public Sub ‚îÇ     ‚îÇ Private Sub  ‚îÇ  ‚îÇ
    ‚îÇ ‚îÇ 10.0.1.0/24‚îÇ     ‚îÇ 10.0.2.0/24  ‚îÇ  ‚îÇ
    ‚îÇ ‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ     ‚îÇ DB/Backend   ‚îÇ  ‚îÇ
    ‚îÇ ‚îÇ ‚îÇ EC2 üñ•Ô∏è ‚îÇ ‚îÇ     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
    ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                       ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

### üéÅ ¬øQu√© sigue?

Ahora que ya sabes c√≥mo crear tu red, puedes:

- Agregar una base de datos en la subred privada (RDS)
- Usar balanceadores de carga
- Desplegar contenedores en ECS o EKS
- Montar un backend en Node, Flask o Django

---

[üîº](#√≠ndice)

---

## **362. Seguridad y computaci√≥n en la nube (AWS)**

### ‚òÅÔ∏è ¬øQu√© es la seguridad en la computaci√≥n en la nube?

La **seguridad en la nube** se refiere a todos los mecanismos, servicios y buenas pr√°cticas que se aplican para **proteger tus datos, servicios y recursos alojados en AWS**.

---

#### üß± ¬øQu√© debes proteger en la nube?

| Elemento              | ¬øPor qu√© se protege?                         |
| --------------------- | -------------------------------------------- |
| ‚úÖ Datos              | Evitar accesos no autorizados (ej. clientes) |
| ‚úÖ M√°quinas virtuales | Proteger tus servidores (EC2)                |
| ‚úÖ Red virtual        | Bloquear accesos no deseados (firewalls)     |
| ‚úÖ Cuentas y usuarios | Controlar qui√©n accede y qu√© hace            |
| ‚úÖ Archivos en S3     | Evitar filtraciones de informaci√≥n           |

---

### üîê Principios clave de seguridad en AWS

1. **M√≠nimos privilegios**: solo lo necesario para cada usuario o recurso.
2. **Autenticaci√≥n y autorizaci√≥n**: cada acci√≥n debe estar validada.
3. **Encriptaci√≥n**: cifrar datos en tr√°nsito y en reposo.
4. **Monitoreo constante**: alertas y registros de actividad.
5. **Segmentaci√≥n de red**: dividir recursos para aislar riesgos.

---

### üîß Herramientas de seguridad que ofrece AWS

| Servicio                                 | ¬øQu√© hace?                                   | Ejemplo f√°cil                                  |
| ---------------------------------------- | -------------------------------------------- | ---------------------------------------------- |
| **IAM** (Identity and Access Management) | Gestiona usuarios, permisos y roles          | Crear un usuario que solo puede leer un bucket |
| **Security Groups**                      | Firewall por instancia                       | Solo permitir tr√°fico por puerto 22 (SSH)      |
| **Network ACLs**                         | Firewall a nivel de subred                   | Bloquear tr√°fico desde ciertos IPs             |
| **CloudTrail**                           | Guarda logs de todo lo que pasa en tu cuenta | Saber qui√©n borr√≥ una base de datos            |
| **KMS** (Key Management Service)         | Maneja claves para cifrado                   | Cifrar archivos de S3 autom√°ticamente          |
| **S3 Bucket Policies**                   | Controla acceso a buckets de forma precisa   | Permitir solo a cierto usuario descargar       |
| **GuardDuty**                            | Detecta amenazas autom√°ticamente             | Alertas por comportamiento sospechoso          |

---

### üõ†Ô∏è ¬øC√≥mo se instala o configura?

En la nube, **"instalar" significa activar o usar servicios desde la consola de AWS o mediante c√≥digo**. Te muestro los m√°s importantes y c√≥mo configurarlos:

---

#### üîë 1. Crear una pol√≠tica de acceso (IAM)

**Objetivo**: permitir acceso solo de lectura a un bucket S3.

1. Ve a la consola de AWS ‚Üí **IAM** ‚Üí Policies ‚Üí **Create policy**.
2. Elige JSON y pega esto:

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": ["s3:GetObject"],
      "Resource": ["arn:aws:s3:::mi-bucket-ejemplo/*"]
    }
  ]
}
```

3. Gu√°rdalo como `SoloLecturaS3`.

---

#### üë§ 2. Crear un usuario seguro con MFA (doble factor)

1. En IAM ‚Üí **Users** ‚Üí Add user.
2. Nombre: `lector-s3`
3. Tipo de acceso: **Programmatic access**
4. Adjunta la pol√≠tica `SoloLecturaS3`
5. En la configuraci√≥n avanzada, activa **MFA** y sigue las instrucciones para usar Google Authenticator o Authy.

---

#### üîê 3. Proteger una instancia EC2 con Security Groups

1. Al crear una EC2, elige:

   - Solo permitir tr√°fico por el puerto 22 (SSH)
   - Elimina reglas que permitan acceso general (0.0.0.0/0) si no es necesario

---

#### üîç 4. Habilitar AWS CloudTrail

1. Ve a **CloudTrail** ‚Üí Create trail
2. Nombre: `miTrail`
3. Apunta los logs a un bucket S3
4. ¬°Listo! Ahora se registrar√° toda la actividad de la cuenta.

---

#### üîí 5. Encriptar un bucket de S3

1. Ve a S3 ‚Üí Elige tu bucket ‚Üí Properties.
2. Busca ‚ÄúDefault encryption‚Äù.
3. Activa la opci√≥n y elige **AWS-KMS** o **SSE-S3**.

---

### ‚úÖ Ejemplo completo: sitio web seguro en EC2 + bucket S3 con pol√≠ticas

#### Objetivo:

Crear un sitio web en EC2 que:

- Est√° protegido por un Security Group.
- Sube y descarga archivos de un bucket S3.
- Solo ciertos usuarios pueden acceder al bucket.

---

#### PASO 1: Crear instancia EC2 segura

- Tipo: Amazon Linux 2023
- Security Group: Solo puerto 22 (SSH) y 80 (HTTP)
- Script de instalaci√≥n (User Data):

```bash
#!/bin/bash
sudo yum update -y
sudo yum install -y httpd
echo "<h1>Sitio web seguro con AWS</h1>" > /var/www/html/index.html
sudo systemctl start httpd
sudo systemctl enable httpd
```

---

#### PASO 2: Crear bucket S3 con pol√≠tica

1. Nombre: `sitio-web-guss`
2. En ‚ÄúPermissions‚Äù ‚Üí Bucket Policy:

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "LecturaUsuario",
      "Effect": "Allow",
      "Principal": {
        "AWS": "arn:aws:iam::tu-ID-de-cuenta:user/lector-s3"
      },
      "Action": ["s3:GetObject"],
      "Resource": ["arn:aws:s3:::sitio-web-guss/*"]
    }
  ]
}
```

---

#### PASO 3: Proteger acceso con CloudTrail y MFA

- Activa CloudTrail como se explic√≥ arriba.
- Activa MFA para el usuario `lector-s3`.

---

#### PASO 4: Prueba final

- El usuario `lector-s3` puede acceder al bucket solo si se autentica correctamente.
- Tu instancia EC2 es accesible por navegador web en el puerto 80.
- Todo acceso queda registrado en CloudTrail.

---

### ‚úÖ Conclusi√≥n

La seguridad en la nube con AWS **no es opcional**. Te ayuda a:

- Cumplir normas (ISO, GDPR, etc.)
- Prevenir ataques
- Tener control total de tus recursos
- Automatizar auditor√≠as

---

[üîº](#√≠ndice)

---

## **363. Balanceadores y almacenamiento en la nube (AWS)**

### üß≠ 1. ¬øQu√© es un Balanceador de Carga (Load Balancer)?

Un **balanceador de carga** distribuye autom√°ticamente el tr√°fico entrante (por ejemplo, de usuarios que entran a tu sitio web) entre varios servidores (EC2), para:

- **Evitar que un solo servidor se sobrecargue**
- **Mejorar la alta disponibilidad** (si un servidor cae, el otro sigue funcionando)
- **Hacer el sistema m√°s escalable y seguro**

üîÅ Ejemplo simple:

Si tienes 3 servidores que muestran tu sitio, el balanceador reparte el tr√°fico entre ellos:

```text
Usuario 1 ‚îÄ‚î¨‚îÄ> EC2-1
Usuario 2 ‚îÄ‚î§
Usuario 3 ‚îÄ‚îº‚îÄ> EC2-2
Usuario 4 ‚îÄ‚î§
Usuario 5 ‚îÄ‚î¥‚îÄ> EC2-3
```

---

#### üì¶ Tipos de Load Balancer en AWS (ELB)

| Tipo                                | Uso principal                         |
| ----------------------------------- | ------------------------------------- |
| **Application Load Balancer (ALB)** | Para sitios web, apps HTTP/S (capa 7) |
| **Network Load Balancer (NLB)**     | Para tr√°fico TCP/UDP masivo (capa 4)  |
| **Gateway Load Balancer (GWLB)**    | Para appliances de seguridad virtual  |

‚úÖ Para la mayor√≠a de aplicaciones web, usamos **ALB**.

---

### üóÑÔ∏è 2. ¬øQu√© es el Almacenamiento en la nube (AWS)?

AWS tiene varios tipos de almacenamiento. Los principales son:

| Servicio    | ¬øQu√© guarda?                      | Ejemplo f√°cil                          |
| ----------- | --------------------------------- | -------------------------------------- |
| **S3**      | Archivos, im√°genes, backups, etc. | Subes un PDF o una imagen              |
| **EBS**     | Disco para m√°quinas EC2           | Como el disco C: de tu laptop          |
| **EFS**     | Sistema de archivos compartido    | Varios servidores pueden leer/escribir |
| **Glacier** | Archivos viejos (archivado)       | Backups antiguos que rara vez usas     |

‚úÖ El m√°s usado es **Amazon S3** por su simplicidad y escalabilidad.

---

### üõ†Ô∏è 3. ¬øC√≥mo se configuran? (Instalaci√≥n)

En AWS, ‚Äúinstalar‚Äù significa **habilitar y conectar servicios desde la consola o CLI**. Veamos paso a paso:

---

#### üîß Paso 1: Crear una VPC con 2 subredes p√∫blicas

1. VPC > Launch VPC Wizard
2. Nombre: `mi-vpc`
3. Crea 2 subredes p√∫blicas: `subred-1`, `subred-2`
4. Aseg√∫rate de tener una **gateway de internet**

---

#### üîß Paso 2: Lanzar 2 instancias EC2 en diferentes subredes

- Tipo: Amazon Linux 2 o Ubuntu
- Agrega el siguiente script en **User Data** para instalar servidor web:

```bash
#!/bin/bash
sudo yum update -y
sudo yum install -y httpd
echo "<h1>Servidor $(hostname)</h1>" > /var/www/html/index.html
sudo systemctl start httpd
sudo systemctl enable httpd
```

Esto mostrar√° el nombre del servidor en el navegador para saber cu√°l responde.

---

#### üîß Paso 3: Crear un Application Load Balancer

1. Ve a **EC2 ‚Üí Load Balancers ‚Üí Create Load Balancer**
2. Elige **Application Load Balancer**
3. Nombre: `mi-alb`
4. Escoge las 2 subredes p√∫blicas creadas antes
5. Crea un nuevo **Security Group** que permita tr√°fico por el puerto 80
6. Crea un **Target Group** con tipo `instance`, nombre: `grupo-web`
7. A√±ade las 2 EC2 al target group
8. Termina la configuraci√≥n

‚úÖ Resultado: tu ALB repartir√° tr√°fico entre los dos servidores EC2.

---

#### üîß Paso 4: Crear bucket S3 para almacenamiento

1. Ve a **S3 ‚Üí Create bucket**
2. Nombre: `mi-almacenamiento-guss`
3. Desactiva acceso p√∫blico si no lo necesitas (por seguridad)
4. Ve a ‚ÄúPermissions‚Äù y crea una pol√≠tica si lo quieres p√∫blico temporalmente:

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "PublicReadGetObject",
      "Effect": "Allow",
      "Principal": "*",
      "Action": "s3:GetObject",
      "Resource": "arn:aws:s3:::mi-almacenamiento-guss/*"
    }
  ]
}
```

---

#### üß™ Paso 5: Prueba el sistema

1. Sube una imagen o archivo PDF al bucket S3.
2. Abre el link generado y verifica que funciona.
3. Copia la **DNS del Load Balancer**, p√©gala en el navegador:

   - Ver√°s que cada vez que actualizas, responde un servidor diferente (`Servidor ip-...`)

---

### ‚úÖ EJEMPLO COMPLETO (Resumen Visual)

```text
        Internet
           |
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ Load Balancer (ALB) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    |                              |
‚îå‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îê                     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îê
| EC2-1|                     | EC2-2   |
| Web  |                     | Web     |
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚Üò                     ‚Üô
           Bucket S3: mi-almacenamiento-guss
                 (imagenes, backups, etc)
```

---

### üß† ¬øPor qu√© usar Balanceador + S3?

| Ventaja balanceador            | Ventaja S3                               |
| ------------------------------ | ---------------------------------------- |
| Alta disponibilidad            | Almacenamiento barato y escalable        |
| Escalabilidad autom√°tica       | Puedes servir archivos p√∫blicos/privados |
| Tolerancia a fallos (failover) | Integraci√≥n con Lambda, CloudFront, etc. |
| SSL f√°cilmente habilitable     | Seguridad granular con IAM y pol√≠ticas   |

---

[üîº](#√≠ndice)

---

## **364. Recopilaci√≥n de informaci√≥n en un entorno real**

### üß† ¬øQu√© es la recopilaci√≥n de informaci√≥n?

La **recopilaci√≥n de informaci√≥n (o "Information Gathering")** es la **primera fase del hacking √©tico** o pentesting. Consiste en **recolectar la mayor cantidad de datos posibles sobre el objetivo**, sin alertarlo (fase pasiva) o interactuando directamente (fase activa).

---

### üéØ ¬øPara qu√© sirve?

- Entender la infraestructura de red y servidores del objetivo
- Identificar posibles puntos d√©biles o vulnerabilidades
- Planificar futuras fases como escaneo o explotaci√≥n

---

### üß± Tipos de recopilaci√≥n de informaci√≥n

| Tipo       | Descripci√≥n                                | Ejemplo f√°cil                  |
| ---------- | ------------------------------------------ | ------------------------------ |
| **Pasiva** | No interact√∫as directamente con el sistema | Googlear el nombre del dominio |
| **Activa** | Interact√∫as con el sistema objetivo        | Escanear con Nmap o ping       |

---

### üõ†Ô∏è Herramientas utilizadas (Instalables)

A continuaci√≥n, una tabla con herramientas populares y c√≥mo instalarlas:

| Herramienta    | Funci√≥n principal             | Instalaci√≥n en Kali/Linux         |
| -------------- | ----------------------------- | --------------------------------- |
| `whois`        | Info sobre dominio            | `sudo apt install whois`          |
| `dig`          | Info DNS del dominio          | `sudo apt install dnsutils`       |
| `nslookup`     | Resolver dominios             | Viene preinstalado                |
| `theHarvester` | Emails, subdominios, IPs      | `sudo apt install theharvester`   |
| `recon-ng`     | Framework OSINT               | `sudo apt install recon-ng`       |
| `Nmap`         | Escaneo de puertos            | `sudo apt install nmap`           |
| `WhatWeb`      | Identificar tecnolog√≠as web   | `sudo apt install whatweb`        |
| `Shodan CLI`   | Busqueda en base de datos IoT | `pip install -U shodan` + API Key |

---

### üì• Ejemplo completo paso a paso

Vamos a suponer que tienes que auditar el dominio: `midominioempresa.com`

#### ü™™ 1. Whois ‚Äì Informaci√≥n del dominio

```bash
whois midominioempresa.com
```

üí° Qu√© obtienes:

- Nombre del registrante
- Empresa
- Emails administrativos
- Fechas de creaci√≥n y expiraci√≥n

---

#### üåê 2. DNS y subdominios ‚Äì dig / nslookup / theHarvester

```bash
dig midominioempresa.com
```

```bash
nslookup midominioempresa.com
```

```bash
theHarvester -d midominioempresa.com -b google
```

üí° Qu√© obtienes:

- Direcci√≥n IP p√∫blica del dominio
- Servidores de nombres (DNS)
- Subdominios como `mail.midominioempresa.com`, `vpn.`, etc.
- Correos electr√≥nicos expuestos

---

#### üîé 3. Tecnolog√≠as Web ‚Äì WhatWeb

```bash
whatweb http://midominioempresa.com
```

üí° Qu√© obtienes:

- Framework usado (WordPress, Laravel, etc)
- Lenguaje backend (PHP, ASP.NET)
- Servidor web (Apache, Nginx)

---

#### üåç 4. Informaci√≥n p√∫blica ‚Äì Google Dorks + LinkedIn

```bash
site:midominioempresa.com filetype:pdf
```

Busca PDF internos de la empresa, info t√©cnica, versiones.

En LinkedIn:

- Buscas empleados
- Nombres de dominio de correo (`juan.perez@midominioempresa.com`)
- Estructura organizacional

---

#### üõ∞Ô∏è 5. Shodan ‚Äì Infraestructura expuesta en Internet

Instala el CLI y usa tu API:

```bash
pip install shodan
shodan init TU_API_KEY
shodan search midominioempresa.com
```

üí° Qu√© puedes encontrar:

- Dispositivos abiertos al mundo (c√°maras, firewalls)
- Puertos abiertos
- Tecnolog√≠as antiguas o sin parches

---

### üéØ Resultado Final: Resumen pr√°ctico

```yaml
Dominio: midominioempresa.com

IP p√∫blica: 142.250.183.238
Servidor web: Apache/2.4.7 (Ubuntu)
Framework: WordPress 5.4.2
Subdominios:
  - mail.midominioempresa.com
  - vpn.midominioempresa.com
  - intranet.midominioempresa.com

Correos encontrados:
  - soporte@midominioempresa.com
  - admin@midominioempresa.com

Empleados (de LinkedIn):
  - Juan P√©rez, CTO
  - Mar√≠a Rojas, Infraestructura

Shodan:
  - IP 142.250.183.238 expone puerto 22 (SSH)
  - Certificado SSL autofirmado caducado
```

---

#### ‚úÖ Conclusiones

Has realizado una **recopilaci√≥n de informaci√≥n completa** sin interactuar agresivamente con el objetivo. Esto te permite:

- Descubrir **superficies de ataque**
- Evaluar vulnerabilidades sin alertar
- Prepararte para fases como **escaneo de puertos y explotaci√≥n**

---

[üîº](#√≠ndice)

---

## **365. Controles de seguridad en un entorno real**

### üõ°Ô∏è ¬øQu√© son los controles de seguridad?

Son **medidas que se implementan para proteger sistemas, redes, datos y usuarios** frente a amenazas y ataques. Pueden ser f√≠sicos, t√©cnicos o administrativos.

#### üìö Tipos de controles de seguridad

| Tipo                 | Qu√© hacen                                     | Ejemplo f√°cil                             |
| -------------------- | --------------------------------------------- | ----------------------------------------- |
| **Preventivos**      | Evitan que ocurra un incidente                | Contrase√±a fuerte, antivirus              |
| **Detectivos**       | Detectan actividades sospechosas o ataques    | IDS, monitoreo de logs                    |
| **Correctivos**      | Ayudan a recuperarse tras un ataque           | Backups, restauraci√≥n de sistemas         |
| **Disuasivos**       | Desalientan a los atacantes                   | Mensajes legales, c√°maras de seguridad    |
| **F√≠sicos**          | Protegen el acceso f√≠sico                     | Puertas con llave, tarjetas RFID          |
| **L√≥gicos/T√©cnicos** | Protegen sistemas y redes mediante tecnolog√≠a | Firewall, autenticaci√≥n multifactor (MFA) |

---

### üß† ¬øPor qu√© son importantes?

Porque una organizaci√≥n sin controles:

- Puede sufrir robos de informaci√≥n
- Es vulnerable a ransomware
- Pierde reputaci√≥n y puede tener sanciones legales

---

### üß∞ Instalaci√≥n y ejemplos por categor√≠a

Te muestro ejemplos **reales y aplicables** que puedes instalar t√∫ mismo:

---

#### üîê 1. Control preventivo: Autenticaci√≥n multifactor (MFA)

**Instalaci√≥n en Linux con Google PAM Module:**

```bash
sudo apt install libpam-google-authenticator
google-authenticator
```

üëâ Esto activa el uso de una app m√≥vil tipo Google Authenticator para iniciar sesi√≥n en el sistema.

---

#### üî• 2. Control t√©cnico: Firewall con UFW (Ubuntu)

```bash
sudo apt install ufw
sudo ufw enable
sudo ufw allow 22     # Permite SSH
sudo ufw deny 23      # Bloquea Telnet
```

üëâ Protege el servidor filtrando qu√© puertos est√°n accesibles.

---

#### üïµÔ∏è 3. Control detectivo: Monitoreo con `auditd`

```bash
sudo apt install auditd
sudo auditctl -w /etc/passwd -p wa -k passwd_changes
```

üëâ Esto registra cualquier escritura o acceso al archivo de contrase√±as.

---

#### üíæ 4. Control correctivo: Copias de seguridad autom√°ticas

```bash
crontab -e
```

Y agregas esta l√≠nea:

```bash
0 1 * * * tar -czf /backup/$(date +\%F).tar.gz /home/usuario
```

üëâ Se genera un respaldo diario a la 1:00 AM.

---

#### üßë‚Äçüè´ 5. Control administrativo: Pol√≠ticas de seguridad

Redacta un archivo `politicas_seguridad.txt` con puntos como:

```text
- Cambiar la contrase√±a cada 90 d√≠as
- No compartir credenciales
- Reportar incidentes en menos de 24 horas
```

üëâ Aunque no es t√©cnico, es clave para que los usuarios sepan c√≥mo comportarse.

---

### ‚úÖ Ejemplo completo: "Segurizando una peque√±a empresa"

Imagina que est√°s protegiendo un servidor web de una startup.

#### üîß Configuras lo siguiente:

1. **Preventivo:**

   - Contrase√±as fuertes obligatorias (`/etc/login.defs`)
   - MFA para el acceso SSH con Google Authenticator

2. **Detectivo:**

   - `auditd` monitoreando cambios en `/etc/passwd` y `/var/www`
   - `fail2ban` detectando intentos de fuerza bruta en SSH

3. **Correctivo:**

   - Script diario de backup autom√°tico con `cron` y `tar`
   - Snapshot semanal de la instancia si usas AWS o Azure

4. **Disuasivo:**

   - Mensaje legal en el banner de SSH:

```bash
echo "ACCESO NO AUTORIZADO PROHIBIDO. TODO EST√Å MONITOREADO." | sudo tee /etc/issue.net
sudo sed -i 's/#Banner none/Banner \/etc\/issue.net/' /etc/ssh/sshd_config
sudo systemctl restart sshd
```

5. **T√©cnico:**

   - `ufw` para restringir puertos (solo 22 y 80 abiertos)
   - `clamav` como antivirus b√°sico

---

### üìã Resultado esperado

Con todos estos controles implementados:

- Un atacante no podr√° acceder f√°cilmente
- Si lo intenta, ser√° detectado
- Si logra algo, podr√°s restaurar con backups
- Legalmente est√°s cubierto (banner + pol√≠ticas)
- T√©cnicamente el sistema est√° mucho m√°s seguro

---

[üîº](#√≠ndice)

---

## **366. Auditando la infraestructura interna**

### üß† ¬øQu√© significa auditar la infraestructura interna?

**Auditar la infraestructura interna** es evaluar los sistemas, redes, dispositivos y pol√≠ticas internas de una organizaci√≥n para detectar vulnerabilidades, configuraciones incorrectas y riesgos de seguridad.

> üëâ Es como hacer una revisi√≥n m√©dica completa, pero a los servidores, computadoras, routers, etc.

---

### üéØ ¬øQu√© incluye una auditor√≠a interna?

1. **Descubrimiento de red (qu√© hay conectado)**
2. **Enumeraci√≥n de servicios (qu√© corre en cada equipo)**
3. **Detecci√≥n de vulnerabilidades**
4. **Revisi√≥n de configuraciones (firewall, puertos, usuarios)**
5. **Pruebas de acceso (con o sin credenciales)**
6. **An√°lisis de registros (logs del sistema)**

---

### üß∞ Herramientas que usaremos

| Herramienta   | ¬øPara qu√© sirve?                      |
| ------------- | ------------------------------------- |
| `nmap`        | Escaneo de red y puertos              |
| `netdiscover` | Descubrir dispositivos en la red      |
| `OpenVAS`     | An√°lisis de vulnerabilidades          |
| `Lynis`       | Auditor√≠a de seguridad local en Linux |
| `Nikto`       | Evaluaci√≥n de servidores web          |
| `logwatch`    | Analiza logs del sistema              |

---

### üîß Paso a paso: C√≥mo instalar las herramientas (Ubuntu/Debian)

#### 1. Instalar Nmap y Netdiscover

```bash
sudo apt update
sudo apt install nmap netdiscover -y
```

#### 2. Instalar OpenVAS (ahora llamado `gvm`)

```bash
sudo apt install gvm -y
sudo gvm-setup
sudo gvm-check-setup
```

#### 3. Instalar Lynis

```bash
sudo apt install lynis -y
```

#### 4. Instalar Nikto

```bash
sudo apt install nikto -y
```

#### 5. Instalar Logwatch

```bash
sudo apt install logwatch -y
```

---

### üß™ Ejemplo completo: Auditor√≠a de una red interna peque√±a

Imaginemos que est√°s auditando una oficina peque√±a con:

- 1 servidor web
- 3 PCs de usuarios
- 1 router

---

#### üïµÔ∏è Paso 1: Descubrir la red

```bash
sudo netdiscover -r 192.168.1.0/24
```

> üîé Esto te muestra todos los dispositivos conectados a esa red local, sus IPs y MAC.

---

#### üîç Paso 2: Escanear servicios con Nmap

```bash
nmap -sS -sV -O 192.168.1.10
```

> Escanea puertos, versiones de servicios y sistema operativo del host `192.168.1.10`.

---

#### üõ°Ô∏è Paso 3: Buscar vulnerabilidades con OpenVAS

1. Abre el panel web:

```bash
sudo gvm-start
```

2. Ingresa a `https://localhost:9392` con tu usuario
3. Realiza un "Full and fast scan" contra los IPs descubiertos

---

#### üîç Paso 4: Auditor√≠a local con Lynis (en cada equipo Linux)

```bash
sudo lynis audit system
```

> Esto revisa configuraciones de seguridad, permisos, servicios activos, logs, etc.

---

#### üåê Paso 5: Revisar seguridad del servidor web con Nikto

```bash
nikto -h http://192.168.1.10
```

> Detecta directorios inseguros, archivos ocultos, headers d√©biles, etc.

---

#### üìú Paso 6: Revisar logs con Logwatch

```bash
sudo logwatch --detail high --service all --range today --format text
```

> Muestra un resumen de actividad sospechosa del d√≠a: intentos de login, fallos, etc.

---

### üìä ¬øQu√© obtienes con todo esto?

üîê Un panorama claro de la **seguridad de la red interna**:

- Sabes **qu√© hay conectado**
- Sabes **qu√© puertos y servicios est√°n activos**
- Puedes ver **vulnerabilidades conocidas**
- Detectas **configuraciones incorrectas**
- Monitoreas actividad sospechosa en los logs

---

### ‚úÖ Recomendaciones tras la auditor√≠a

- **Cerrar puertos innecesarios**
- **Actualizar software vulnerable**
- **Cambiar contrase√±as d√©biles**
- **Aplicar reglas de firewall**
- **Hacer auditor√≠as peri√≥dicas**

---

[üîº](#√≠ndice)

---

## **367. Tipos de auditor√≠as de seguridad**

### üõ°Ô∏è ¬øQu√© es una Auditor√≠a de Seguridad?

Una **auditor√≠a de seguridad** es un proceso sistem√°tico para **evaluar la seguridad** de sistemas, redes, software y procedimientos. Se busca identificar **vulnerabilidades, errores de configuraci√≥n, amenazas** o incumplimientos de normas de seguridad.

---

### ‚úÖ ¬øPor qu√© se hace una auditor√≠a de seguridad?

- Para **proteger informaci√≥n sensible**
- Para **cumplir normas o regulaciones** (ISO 27001, GDPR, PCI-DSS, etc.)
- Para **detectar vulnerabilidades** antes que un atacante
- Para **fortalecer la seguridad interna**

---

### üß© TIPOS DE AUDITOR√çA DE SEGURIDAD

Existen diferentes tipos, seg√∫n **lo que se eval√∫a** o **c√≥mo se realiza**. Aqu√≠ te los explico con ejemplos sencillos.

---

#### üîç 1. **Auditor√≠a interna**

> La realiza personal de la propia organizaci√≥n.

**Ejemplo:**

El √°rea de IT revisa los accesos de los empleados y configura alertas por intentos de acceso fallido.

**Objetivo:**

Verificar que se cumplen pol√≠ticas internas de seguridad.

---

#### üïµÔ∏è 2. **Auditor√≠a externa**

> La hace una empresa externa o consultor independiente.

**Ejemplo:**

Contratas una empresa para que revise tu red, intente vulnerarla y te entregue un informe con recomendaciones.

**Objetivo:**

Obtener una visi√≥n objetiva e imparcial de tu seguridad.

---

#### üíª 3. **Auditor√≠a de sistemas**

> Eval√∫a servidores, equipos, SO, configuraci√≥n, permisos, etc.

**Ejemplo:**

Verificar que no hay servicios obsoletos corriendo en un servidor Linux y que los permisos de archivos son seguros.

---

#### üåê 4. **Auditor√≠a de red**

> Eval√∫a la infraestructura de red: routers, switches, firewall, puertos, tr√°fico, etc.

**Ejemplo:**

Escaneo con Nmap y an√°lisis de firewall para detectar puertos abiertos o protocolos inseguros (como Telnet).

---

#### üß™ 5. **Auditor√≠a de aplicaciones web**

> Se eval√∫an apps web en busca de XSS, SQLi, CSRF, etc.

**Ejemplo:**

Escanear un sitio web con **OWASP ZAP** o **Nikto** para detectar vulnerabilidades como inyecciones o scripts maliciosos.

---

#### üë§ 6. **Auditor√≠a de usuarios y accesos**

> Revisa c√≥mo est√°n configuradas las cuentas de usuario, grupos, permisos y pol√≠ticas de contrase√±as.

**Ejemplo:**

Revisar en Active Directory que ning√∫n usuario tenga contrase√±a que nunca expire.

---

#### üîí 7. **Auditor√≠a de cumplimiento**

> Eval√∫a si una empresa cumple con normas o est√°ndares como:

- ISO 27001
- PCI-DSS
- GDPR
- HIPAA

**Ejemplo:**

Verificar si se aplican controles de cifrado, registros de logs y respaldo de informaci√≥n en una cl√≠nica m√©dica.

---

#### üí£ 8. **Auditor√≠a de vulnerabilidades (Pentest)**

> Simula un ataque real para detectar debilidades.

**Ejemplo:**

Utilizar Metasploit o Burp Suite para intentar tomar control de un servidor vulnerable.

---

### üîß ¬øC√≥mo se hace una auditor√≠a de seguridad? (Proceso general)

1. **Definir el alcance**: ¬øqu√© se va a auditar?
2. **Recopilar informaci√≥n**: Infraestructura, usuarios, sistemas.
3. **Evaluar configuraci√≥n**: Revisar SO, red, contrase√±as, firewalls, etc.
4. **Detectar vulnerabilidades**: Escaneo, pruebas de penetraci√≥n.
5. **Analizar resultados**: Clasificar por riesgo.
6. **Redactar informe**: Con hallazgos, impacto y recomendaciones.

---

### üß™ EJEMPLO COMPLETO: Auditor√≠a interna + de red + de sistema

#### üñ• Escenario: Tienes una red de 4 PCs, un servidor Ubuntu y un router.

---

##### üîπ PASO 1: Descubrir la red

```bash
sudo netdiscover -r 192.168.1.0/24
```

> Muestra qu√© equipos est√°n conectados en la red.

---

##### üîπ PASO 2: Escanear servicios con Nmap

```bash
sudo nmap -sS -sV -O 192.168.1.1-254
```

> Detecta qu√© puertos y servicios est√°n abiertos en los dispositivos.

---

##### üîπ PASO 3: Revisar configuraci√≥n del servidor

```bash
sudo lynis audit system
```

> Auditor√≠a de seguridad local del sistema Linux (permisos, configuraciones, servicios).

---

##### üîπ PASO 4: Probar aplicaci√≥n web interna

```bash
nikto -h http://192.168.1.10
```

> Detecta configuraciones inseguras o rutas expuestas en servidores web.

---

##### üîπ PASO 5: Revisar logs

```bash
sudo logwatch --detail high --range today --service all
```

> Muestra alertas, accesos sospechosos, errores, etc.

---

### üìÑ RESULTADO FINAL

Tienes un **informe t√©cnico** con:

- Equipos conectados
- Puertos inseguros abiertos
- Servicios mal configurados
- Logs con actividad sospechosa
- Recomendaciones de mitigaci√≥n

---

### ‚úÖ Buenas pr√°cticas tras la auditor√≠a

- Cierra puertos innecesarios
- Actualiza software vulnerable
- Aplica pol√≠ticas de contrase√±as fuertes
- Configura firewalls correctamente
- Monitorea logs y alertas

---

[üîº](#√≠ndice)

---

## **368. Eliminando el entorno en la nube (AWS)**

### üß† ¬øQu√© significa ‚Äúeliminar el entorno en la nube‚Äù?

Significa **borrar todos los recursos** creados en tu cuenta de AWS para un proyecto: servidores, bases de datos, redes, balanceadores, buckets de S3, etc. Se hace normalmente cuando:

- Finalizaste un proyecto o prueba
- Ya no necesitas los recursos
- Quieres evitar gastos
- Vas a crear un nuevo entorno desde cero

---

### ‚úÖ ¬øQu√© se debe eliminar?

Un entorno t√≠pico puede incluir muchos servicios. Aqu√≠ te muestro los m√°s comunes que debes revisar y eliminar:

| Categor√≠a         | Servicios comunes a eliminar                                    |
| ----------------- | --------------------------------------------------------------- |
| üñ•Ô∏è C√≥mputo        | EC2 (instancias), Auto Scaling Groups, AMIs, Snapshots          |
| üíæ Almacenamiento | EBS Volumes, S3 Buckets, Snapshots                              |
| üåê Red            | VPCs, Subnets, Security Groups, Internet Gateways, Route Tables |
| üîß Balanceo       | ELB (Elastic Load Balancer)                                     |
| üìä Monitoreo      | CloudWatch Logs, Alarms, Metrics                                |
| üîê IAM            | Roles, Policies, Users, Access Keys                             |
| üõ†Ô∏è Otros          | RDS, Lambda, API Gateway, etc.                                  |

---

### üß∞ ¬øQu√© herramientas puedes usar para eliminar tu entorno?

1. **Consola de AWS** (modo gr√°fico)
2. **AWS CLI** (modo terminal)
3. **AWS CloudFormation** (si todo fue creado como infraestructura como c√≥digo)

---

### üß≠ Requisitos previos (si usas AWS CLI)

1. Instala AWS CLI:
   En Linux/macOS:

   ```bash
   curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "awscliv2.zip"
   unzip awscliv2.zip
   sudo ./aws/install
   ```

   En Windows: descarga desde [https://aws.amazon.com/cli/](https://aws.amazon.com/cli/)

2. Configura tu perfil:

   ```bash
   aws configure
   ```

   Se te pedir√°:

   - Access Key ID
   - Secret Access Key
   - Regi√≥n (por ejemplo: `us-east-1`)
   - Formato de salida (puedes poner `json`)

---

### üß™ EJEMPLO PR√ÅCTICO: Eliminando un entorno sencillo en AWS

#### üéØ Escenario:

Has creado un entorno que incluye:

- 1 instancia EC2
- 1 volumen EBS
- 1 bucket S3
- 1 VPC personalizada
- 1 rol de IAM

Vamos a eliminarlo paso a paso.

---

#### üîπ PASO 1: Ver las instancias EC2 activas

```bash
aws ec2 describe-instances --query "Reservations[*].Instances[*].InstanceId"
```

#### üîπ PASO 2: Terminar la instancia EC2

```bash
aws ec2 terminate-instances --instance-ids i-1234567890abcdef0
```

---

#### üîπ PASO 3: Eliminar vol√∫menes EBS sin usar

```bash
aws ec2 describe-volumes --filters Name=status,Values=available
```

```bash
aws ec2 delete-volume --volume-id vol-0abcd1234ef567890
```

---

#### üîπ PASO 4: Eliminar un bucket S3

Primero, vac√≠alo:

```bash
aws s3 rm s3://mi-bucket-prueba --recursive
```

Luego elim√≠nalo:

```bash
aws s3api delete-bucket --bucket mi-bucket-prueba
```

---

#### üîπ PASO 5: Eliminar VPC personalizada (¬°con cuidado!)

Primero obt√©n el ID de la VPC:

```bash
aws ec2 describe-vpcs --query "Vpcs[*].VpcId"
```

Elimina los elementos asociados antes de eliminar la VPC (como subredes, gateways, tablas de rutas):

```bash
aws ec2 delete-subnet --subnet-id subnet-0abcd1234
aws ec2 detach-internet-gateway --internet-gateway-id igw-0abcd1234 --vpc-id vpc-0abcd1234
aws ec2 delete-internet-gateway --internet-gateway-id igw-0abcd1234
aws ec2 delete-route-table --route-table-id rtb-0abcd1234
aws ec2 delete-vpc --vpc-id vpc-0abcd1234
```

---

#### üîπ PASO 6: Eliminar un rol de IAM

```bash
aws iam delete-role-policy --role-name MiRol --policy-name MiPolitica
aws iam delete-role --role-name MiRol
```

---

### ‚úÖ Verificaci√≥n final

Puedes revisar si ya no hay recursos:

```bash
aws ec2 describe-instances --filters Name=instance-state-name,Values=running
aws s3 ls
aws ec2 describe-vpcs
```

---

### üßΩ ¬øY si usaste CloudFormation?

Si usaste una plantilla, basta con eliminar el _stack_:

```bash
aws cloudformation delete-stack --stack-name MiEntornoDePrueba
```

Esto **autom√°ticamente borra todos los recursos asociados**.

---

### üîê Recomendaciones finales

- Verifica que **no quedan recursos activos** (especialmente bases de datos, buckets S3 o instancias EC2)
- **Borra claves de acceso IAM** si ya no usar√°s esa cuenta
- Puedes habilitar **Billing Alerts** para evitar gastos si algo qued√≥ activo

---

[üîº](#√≠ndice)

---

| **Inicio**         | **atr√°s 6**                                              |
| ------------------ | -------------------------------------------------------- |
| [üè†](../README.md) | [‚è™](./5_6_Hacking_etico_y_post_explotacion_avanzada.md) |
