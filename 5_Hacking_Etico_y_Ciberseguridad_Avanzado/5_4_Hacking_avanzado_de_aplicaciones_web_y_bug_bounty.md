| **Inicio**         | **atr√°s 3**                                                  | **Siguiente 5**                                |
| ------------------ | ------------------------------------------------------------ | ---------------------------------------------- |
| [üè†](../README.md) | [‚è™](./5_3_Acceso_a_credenciales_y_movimientos_laterales.md) | [‚è©](./5_5_Deteccion_y_Evasion_de_defensas.md) |

---

## **√çndice**

| Temario                                                                                                                                  |
| ---------------------------------------------------------------------------------------------------------------------------------------- |
| [327. Unas palabras sobre Bug Bounty](#327-unas-palabras-sobre-bug-bounty)                                                               |
| [328. Preparaci√≥n del entorno vulnerable](#328-preparaci√≥n-del-entorno-vulnerable)                                                       |
| [329. Identificaci√≥n de subdominios: Subfinder, Sublist3r y Subbrute](#329-identificaci√≥n-de-subdominios-subfinder-sublist3r-y-subbrute) |
| [330. Identificaci√≥n de tecnolog√≠as web: WhatWeb y WebAnalyze](#330-identificaci√≥n-de-tecnolog√≠as-web-whatweb-y-webanalyze)              |
| [331. Identificaci√≥n de contenido: Dirbuster](#331-identificaci√≥n-de-contenido-dirbuster)                                                |
| [332. Gobuster y Seclists](#332-gobuster-y-seclists)                                                                                     |
| [333. An√°lisis de vulnerabilidades: OWASP ZAP Proxy](#333-an√°lisis-de-vulnerabilidades-owasp-zap-proxy)                                  |
| [334. Nikto y Skipfish](#334-nikto-y-skipfish)                                                                                           |
| [335. Nuclei y Nuclei Templates](#335-nuclei-y-nuclei-templates)                                                                         |
| [336. Fuzzing b√°sico con ffuf](#336-fuzzing-b√°sico-con-ffuf)                                                                             |
| [337. Fuzzing avanzado con ffuf](#337-fuzzing-avanzado-con-ffuf)                                                                         |
| [338. Explotaci√≥n: Commix](#338-explotaci√≥n-commix)                                                                                      |
| [339. Unas palabras sobre la fase de explotaci√≥n](#339-unas-palabras-sobre-la-fase-de-explotaci√≥n)                                       |
| [340. Changeme, Gitleaks y CyberChef](#340-changeme-gitleaks-y-cyberchef)                                                                |

---

# **Hacking avanzado de aplicaciones web y bug bounty**

## **327. Unas palabras sobre Bug Bounty**

### üêû ¬øQu√© es el Bug Bounty?

**Bug Bounty** (en espa√±ol, "recompensa por errores") es un programa donde las empresas **ofrecen dinero o premios a los hackers √©ticos** (conocidos como bug bounty hunters) por encontrar **vulnerabilidades** o **errores de seguridad** en sus sistemas, apps, p√°ginas web, APIs, etc.

---

### üéØ ¬øQu√© se busca en un programa de Bug Bounty?

- Vulnerabilidades **web** como:

  - XSS (Cross-Site Scripting)
  - SQL Injection
  - CSRF
  - Broken Authentication

- Fallas m√≥viles (Android/iOS)
- Fallas en APIs
- Problemas en configuraci√≥n de servidores, etc.

---

### ü§ù ¬øQui√©n ofrece Bug Bounties?

Plataformas famosas:

| Plataforma | Sitio Web                                              |
| ---------- | ------------------------------------------------------ |
| HackerOne  | [https://hackerone.com](https://hackerone.com)         |
| Bugcrowd   | [https://bugcrowd.com](https://bugcrowd.com)           |
| Synack     | [https://www.synack.com](https://www.synack.com)       |
| Integrity  | [https://www.intigriti.com](https://www.intigriti.com) |
| YesWeHack  | [https://www.yeswehack.com](https://www.yeswehack.com) |

Tambi√©n hay empresas que **tienen su propio programa**, como:

- Google (Google VRP)
- Meta/Facebook
- Microsoft
- TikTok
- Apple (aunque m√°s cerrado)

---

### üõ†Ô∏è ¬øC√≥mo "instalarse" en el mundo de Bug Bounty?

No necesitas instalar un software espec√≠fico, pero s√≠ necesitas estas **herramientas y pasos** para empezar:

---

#### 1. Crear cuenta en una plataforma (como HackerOne)

üëâ Ve a [https://hackerone.com](https://hackerone.com), haz clic en **Join HackerOne** y crea tu cuenta como **researcher**.

---

#### 2. Aprende las bases de hacking √©tico

##### Conocimientos recomendados:

- **HTML, JS, HTTP, APIs**
- OWASP Top 10
- Burp Suite
- Reconocimiento con herramientas como `amass`, `nmap`, `subfinder`
- Scripting b√°sico en **Python**, **Bash**

---

#### 3. Instalar herramientas b√°sicas

##### ‚úÖ Burp Suite (analizador de tr√°fico web)

```bash
sudo apt install burpsuite
```

O descargar desde: [https://portswigger.net/burp](https://portswigger.net/burp)

---

##### ‚úÖ Subfinder (recolecci√≥n de subdominios)

```bash
go install -v github.com/projectdiscovery/subfinder/v2/cmd/subfinder@latest
```

---

##### ‚úÖ Nuclei (busca vulnerabilidades autom√°ticamente)

```bash
go install -v github.com/projectdiscovery/nuclei/v2/cmd/nuclei@latest
```

---

##### ‚úÖ Dirsearch (descubre rutas ocultas)

```bash
git clone https://github.com/maurosoria/dirsearch.git
cd dirsearch
python3 dirsearch.py -u https://target.com
```

---

### üß™ Ejemplo realista de Bug Bounty

#### üéØ Target: Sitio web de ejemplo en un programa de HackerOne

**Paso 1:** Entras al programa y encuentras que aceptan el dominio:

```
https://testsite.h1-example.com
```

---

**Paso 2:** Usas Burp Suite para interceptar el tr√°fico y pruebas un campo de b√∫squeda con:

```html
<script>
  alert(1);
</script>
```

Si ves un `alert(1)` ejecutarse, ¬°descubriste un **XSS**!

---

**Paso 3:** Confirmas que el bug es **explotable** y no es un duplicado (lo reportas con pruebas).

---

**Paso 4:** Lo reportas en HackerOne con:

- Descripci√≥n clara
- Reproducci√≥n paso a paso
- Capturas de pantalla o video
- Impacto de seguridad

---

**Resultado:** Si es v√°lido, la empresa te recompensa con:

üí∏ Recompensa t√≠pica: **\$100 a \$5,000+ USD**
üèÖ Tambi√©n ganas puntos de reputaci√≥n y visibilidad

---

### üéì ¬øD√≥nde practicar?

Plataformas seguras y legales para practicar:

| Nombre               | Sitio web                                                                    |
| -------------------- | ---------------------------------------------------------------------------- |
| Hack The Box         | [https://hackthebox.com](https://hackthebox.com)                             |
| PortSwigger Labs     | [https://portswigger.net/web-security](https://portswigger.net/web-security) |
| TryHackMe            | [https://tryhackme.com](https://tryhackme.com)                               |
| Web Security Academy | [https://portswigger.net/web-security](https://portswigger.net/web-security) |
| PentesterLab         | [https://pentesterlab.com](https://pentesterlab.com)                         |

---

### ‚úÖ Resumen

| Concepto           | Descripci√≥n                                             |
| ------------------ | ------------------------------------------------------- |
| ¬øQu√© es?           | Programa de recompensas por encontrar vulnerabilidades. |
| ¬øQui√©n puede?      | Cualquiera con conocimientos en ciberseguridad.         |
| ¬øQu√© necesitas?    | Burp Suite, terminal, conocimientos en web y OWASP.     |
| ¬øD√≥nde practicar?  | HTB, PortSwigger, TryHackMe.                            |
| ¬øD√≥nde participar? | HackerOne, Bugcrowd, Intigriti, etc.                    |

---

[üîº](#√≠ndice)

---

## **328. Preparaci√≥n del entorno vulnerable**

### üîê ¬øQu√© es un entorno vulnerable?

Un entorno vulnerable es un laboratorio controlado que simula computadoras, servidores, servicios y aplicaciones **con vulnerabilidades reales**, pero en un entorno seguro. Es ideal para aprender:

- Hacking √©tico
- Red Team / Blue Team
- Active Directory
- Explotaci√≥n web
- Privilege escalation
- Post-explotaci√≥n

---

### üéØ Objetivo

Crear un laboratorio local con m√°quinas virtuales vulnerables en tu PC, usando:

- VirtualBox o VMware
- Kali Linux (atacante)
- Windows Server + Windows 10 (v√≠ctimas)
- Active Directory mal configurado
- M√°quinas de pr√°ctica (como Metasploitable, DVWA, etc.)

---

### üß∞ Requisitos

| Requisito                                                         | Descripci√≥n                          |
| ----------------------------------------------------------------- | ------------------------------------ |
| RAM                                                               | 8GB m√≠nimo (ideal 16GB)              |
| Disco duro                                                        | 80 GB libres m√≠nimo                  |
| VirtualBox / VMware                                               | Para ejecutar las m√°quinas virtuales |
| ISO o VM de Kali Linux                                            | Para atacar                          |
| M√°quinas vulnerables (Metasploitable, DVWA, Windows Server, etc.) | Para practicar                       |

---

### üß± PASO 1: Instalar VirtualBox y Extensiones

#### üîß Instalar VirtualBox

1. Ir a: [https://www.virtualbox.org/](https://www.virtualbox.org/)
2. Descargar e instalar seg√∫n tu sistema operativo (Windows/Linux/Mac).
3. Instala el **Extension Pack** para red, USB y carpetas compartidas.

---

### üêç PASO 2: Descargar Kali Linux (m√°quina atacante)

1. Ir a [https://www.kali.org/get-kali/#kali-virtual-machines](https://www.kali.org/get-kali/#kali-virtual-machines)
2. Descargar la versi√≥n **Kali Linux VirtualBox** (ya viene lista).
3. Importar el archivo `.ova` en VirtualBox:
   Men√∫ ‚Üí Archivo ‚Üí **Importar servicio virtualizado** ‚Üí Selecciona el `.ova`.

> üõ†Ô∏è Usuario: `kali` | Contrase√±a: `kali`

---

### üí£ PASO 3: Descargar m√°quinas vulnerables

#### üì¶ Opci√≥n A: Metasploitable 2 (Linux vulnerable)

- Descargar:
  [https://sourceforge.net/projects/metasploitable/files/Metasploitable2/](https://sourceforge.net/projects/metasploitable/files/Metasploitable2/)

- Importar en VirtualBox como una nueva VM.

> Usuario: `msfadmin` | Contrase√±a: `msfadmin`

---

#### üì¶ Opci√≥n B: DVWA (Damn Vulnerable Web App)

Puedes instalarla dentro de una m√°quina Linux como Ubuntu o usarla en Docker:

```bash
git clone https://github.com/digininja/DVWA.git
cd DVWA
docker-compose up -d
```

---

#### üì¶ Opci√≥n C: Windows Server + Windows 10 (para Active Directory)

Puedes conseguir im√°genes gratuitas de evaluaci√≥n:

- Windows Server 2019 (ISO o VHD):
  [https://www.microsoft.com/en-us/evalcenter/evaluate-windows-server-2019](https://www.microsoft.com/en-us/evalcenter/evaluate-windows-server-2019)

- Windows 10 Enterprise:
  [https://developer.microsoft.com/en-us/windows/downloads/virtual-machines/](https://developer.microsoft.com/en-us/windows/downloads/virtual-machines/)

> Puedes simular un **entorno de dominio** con AD, usuarios, GPOs y vulnerabilidades como LLMNR, SMBv1, etc.

---

### üåê PASO 4: Configurar red interna o en puente

Para que Kali pueda "ver" a las dem√°s m√°quinas, usa uno de estos modos en VirtualBox:

- **Red interna** (`intnet`): todas las VMs se comunican entre s√≠ pero no tienen acceso a internet.
- **Adaptador en puente**: las VMs se comportan como si estuvieran en tu red local.

Ejemplo:

1. En cada VM, ve a configuraci√≥n ‚Üí red ‚Üí selecciona "Adaptador en puente"
2. Aseg√∫rate de que todas las m√°quinas tengan IPs en el mismo rango (ej. `192.168.1.X`)

---

### üîç PASO 5: Probar conectividad

Desde Kali (terminal):

```bash
ping 192.168.1.100  # IP de Metasploitable
```

Si responde, ¬°todo est√° listo!

---

### ‚úÖ PASO 6: Ejemplo completo ‚Äì Ataque a Metasploitable

#### üéØ Objetivo: Encontrar y explotar una vulnerabilidad en Metasploitable 2 desde Kali

---

##### 1. Descubrir la m√°quina:

```bash
nmap -sS -sV 192.168.1.100
```

Salida esperada:

```
21/tcp open  ftp
22/tcp open  ssh
23/tcp open  telnet
...
```

---

##### 2. Encontrar una vulnerabilidad (ej: VSFTPD 2.3.4 backdoor)

```bash
searchsploit vsftpd 2.3.4
```

Resultado:

```
Exploit Title: vsftpd 2.3.4 - Backdoor Command Execution
```

---

##### 3. Explotar con Metasploit:

```bash
msfconsole
```

```bash
use exploit/unix/ftp/vsftpd_234_backdoor
set RHOST 192.168.1.100
run
```

Si todo va bien, obtendr√°s una shell en la m√°quina remota:

```bash
id
uname -a
```

---

### üß™ BONUS: Herramientas √∫tiles para el laboratorio

| Herramienta      | Funci√≥n                      |
| ---------------- | ---------------------------- |
| **Burp Suite**   | Interceptar tr√°fico web      |
| **Wireshark**    | An√°lisis de red              |
| **Nmap**         | Escaneo de puertos           |
| **Metasploit**   | Framework de explotaci√≥n     |
| **BloodHound**   | An√°lisis de AD               |
| **Responder**    | Envenenamiento LLMNR/NBT-NS  |
| **CrackMapExec** | Enumeraci√≥n de redes Windows |

---

### ‚úÖ Resumen final

| Paso | Acci√≥n                                                              |
| ---- | ------------------------------------------------------------------- |
| 1    | Instalar VirtualBox y extensiones                                   |
| 2    | Descargar Kali Linux como atacante                                  |
| 3    | Descargar m√°quinas vulnerables (Metasploitable, DVWA, Windows)      |
| 4    | Configurar red interna o en puente                                  |
| 5    | Probar conectividad                                                 |
| 6    | Hacer pruebas reales (reconocimiento, explotaci√≥n, postexplotaci√≥n) |

---

[üîº](#√≠ndice)

---

## **329. Identificaci√≥n de subdominios: Subfinder, Sublist3r y Subbrute**

### üß† ¬øQu√© es la identificaci√≥n de subdominios?

Los **subdominios** son partes de un dominio principal, como:

- `www.ejemplo.com`
- `admin.ejemplo.com`
- `mail.ejemplo.com`

Algunos subdominios pueden contener aplicaciones vulnerables, paneles de administraci√≥n, entornos de desarrollo olvidados, etc. Por eso, **enumerarlos es crucial en la fase de reconocimiento**.

---

### üîß Herramientas a usar

| Herramienta | Lenguaje | Tipo de escaneo           |
| ----------- | -------- | ------------------------- |
| Subfinder   | Go       | Pasivo                    |
| Sublist3r   | Python   | Pasivo                    |
| Subbrute    | Python   | Activo (fuerza bruta DNS) |

---

### üì¶ 1. Subfinder (r√°pido y moderno)

#### üîß Instalaci√≥n (Linux / WSL / Mac)

1. Necesitas tener instalado `Go`:

   ```bash
   sudo apt install golang -y
   ```

2. Instala Subfinder:

   ```bash
   go install -v github.com/projectdiscovery/subfinder/v2/cmd/subfinder@latest
   ```

3. Agrega `GOPATH` al PATH si no lo has hecho:

   ```bash
   export PATH=$PATH:$(go env GOPATH)/bin
   ```

4. Verifica:

   ```bash
   subfinder -h
   ```

---

#### ‚úÖ Ejemplo de uso

```bash
subfinder -d ejemplo.com
```

Salida esperada:

```
mail.ejemplo.com
admin.ejemplo.com
api.ejemplo.com
```

> Puedes exportar la salida:

```bash
subfinder -d ejemplo.com -o subdominios.txt
```

---

### üêç 2. Sublist3r (ligero y popular)

#### üîß Instalaci√≥n

```bash
sudo apt install python3-pip
git clone https://github.com/aboul3la/Sublist3r.git
cd Sublist3r
pip3 install -r requirements.txt
```

---

#### ‚úÖ Ejemplo de uso

```bash
python3 sublist3r.py -d ejemplo.com
```

Opciones √∫tiles:

- `-o archivo.txt`: guarda salida
- `-v`: modo verbose

---

### üîé 3. Subbrute (fuerza bruta DNS)

#### üîß Instalaci√≥n

```bash
git clone https://github.com/TheRook/subbrute.git
cd subbrute
```

> Requiere tener `dnspython`, que se instala as√≠:

```bash
pip3 install dnspython
```

---

#### ‚úÖ Ejemplo de uso

```bash
python3 subbrute.py ejemplo.com
```

> Esta herramienta usa una wordlist (por defecto `names.txt`) para intentar subdominios por fuerza bruta.

Puedes cambiar la wordlist:

```bash
python3 subbrute.py -s custom_list.txt ejemplo.com
```

---

### üß™ Ejemplo completo de flujo

#### Escenario: Quieres investigar subdominios del dominio `testfire.net` (de pr√°ctica).

---

##### 1. Subfinder (pasivo r√°pido)

```bash
subfinder -d testfire.net -o subfinder.txt
```

---

##### 2. Sublist3r (busca en motores de b√∫squeda)

```bash
python3 sublist3r.py -d testfire.net -o sublist3r.txt
```

---

##### 3. Subbrute (fuerza bruta DNS)

```bash
python3 subbrute.py testfire.net > subbrute.txt
```

---

##### 4. Unir resultados

```bash
cat subfinder.txt sublist3r.txt subbrute.txt | sort -u > subdominios_final.txt
```

---

### üí° Consejos pr√°cticos

- Usa herramientas pasivas primero (Subfinder, Sublist3r) para evitar ser detectado.
- Luego, aplica fuerza bruta (Subbrute) solo si es necesario.
- Ap√≥yate con DNS resolvers p√∫blicos como Google (8.8.8.8) o Cloudflare (1.1.1.1).
- Puedes usar otras herramientas complementarias como **Amass**, **Assetfinder** o **crt.sh**.

---

### üß∞ Extras (si quieres automatizar)

Puedes usar todas estas herramientas juntas con herramientas como:

- **Recon-ng**
- **Assetnote Subdomain Wordlists**
- **OneForAll**
- **Sudomy**
- **Project Discovery tools** (con subfinder, httpx, etc.)

---

### ‚úÖ Conclusi√≥n

| Herramienta | M√©todo | Uso recomendado                   |
| ----------- | ------ | --------------------------------- |
| Subfinder   | Pasivo | R√°pido y moderno                  |
| Sublist3r   | Pasivo | B√°sico y popular                  |
| Subbrute    | Activo | Cuando necesitas fuerza bruta DNS |

La identificaci√≥n de subdominios es una de las **mejores formas de encontrar superficies de ataque ocultas**, y puede conducirte a APIs olvidadas, entornos de staging, paneles de admin abiertos y m√°s.

---

[üîº](#√≠ndice)

---

## **330. Identificaci√≥n de tecnolog√≠as web: WhatWeb y WebAnalyze**

### üß† ¬øQu√© es la identificaci√≥n de tecnolog√≠as web?

Cuando visitas un sitio web, en segundo plano este usa tecnolog√≠as como:

- Lenguaje: PHP, ASP.NET, Java
- CMS: WordPress, Joomla, Drupal
- Servidor web: Apache, Nginx, IIS
- Frameworks: React, Angular, Vue
- Librer√≠as JS, bases de datos, analytics, etc.

Identificar estas tecnolog√≠as es fundamental para:

üîπ Reconocimiento en **pentesting**
üîπ **Bug bounty** (saber qu√© exploits aplicar)
üîπ An√°lisis de competencia o footprinting

---

### üõ†Ô∏è Herramientas que usaremos

| Herramienta    | Lenguaje | Tipo de escaneo   | M√©todo                 |
| -------------- | -------- | ----------------- | ---------------------- |
| **WhatWeb**    | Ruby     | R√°pido y vers√°til | HTTP headers, HTML, JS |
| **Webanalyze** | Go       | Preciso y r√°pido  | Basado en Wappalyzer   |

---

### ‚úÖ 1. WhatWeb

#### üîß Instalaci√≥n en Linux / WSL / Kali / Parrot

```bash
sudo apt update
sudo apt install whatweb -y
```

> Tambi√©n puedes clonar manualmente si no est√°s en Debian/Kali:

```bash
git clone https://github.com/urbanadventurer/WhatWeb.git
cd WhatWeb
sudo ruby whatweb -h
```

---

#### üß™ Ejemplo b√°sico

```bash
whatweb https://www.peru.gob.pe
```

**Salida esperada (resumida):**

```
https://www.peru.gob.pe [200 OK] Country[PERU][PA] IP[200.37.63.100] JQuery[1.11.1] Google-Analytics[UA-xxxxxx] Apache[2.4.6]
```

> Esto te dice que usa Apache, jQuery, Google Analytics, etc.

---

#### üîß Opciones √∫tiles

- `-v` ‚Üí modo verbose
- `-a 3` ‚Üí agresividad (1 a 3)
- `--color=never` ‚Üí sin color
- `-o salida.txt` ‚Üí guardar resultados

```bash
whatweb -a 3 -v -o resultado.txt https://ejemplo.com
```

---

### ‚úÖ 2. Webanalyze

Es una alternativa ligera y r√°pida basada en Wappalyzer.

#### üîß Requisitos

Necesitas tener **Go** instalado:

```bash
sudo apt install golang -y
```

---

#### üîß Instalaci√≥n

```bash
git clone https://github.com/rverton/webanalyze
cd webanalyze
go build
```

> Esto crear√° un binario llamado `webanalyze`

---

#### üîÉ Descarga del archivo de tecnolog√≠as

```bash
./webanalyze -update
```

Este paso descarga la base de datos de tecnolog√≠as desde [Wappalyzer](https://www.wappalyzer.com/).

---

#### üß™ Ejemplo de uso

```bash
./webanalyze -host https://www.peru.gob.pe
```

**Salida esperada:**

```
peru.gob.pe
Technologies:
 - Google Analytics
 - jQuery 1.11.1
 - Apache
```

---

#### üìÇ Escaneo masivo con lista de dominios

Si tienes varios sitios en un archivo `dominios.txt`:

```bash
./webanalyze -hosts dominios.txt -crawl
```

---

### üß™ Ejemplo completo de identificaci√≥n de tecnolog√≠as

#### Escenario:

Quieres analizar el sitio **[https://testphp.vulnweb.com](https://testphp.vulnweb.com)**, que es un sitio vulnerable de pruebas de Acunetix.

---

#### üîé Paso 1: Con WhatWeb

```bash
whatweb -a 3 https://testphp.vulnweb.com
```

**Salida esperada:**

```
https://testphp.vulnweb.com [200 OK] Country[US][US] IP[xxx.xxx.xxx.xxx] Apache PHP[5.2.17] Cookies[PHPSESSID]
```

---

#### üîé Paso 2: Con Webanalyze

```bash
./webanalyze -host https://testphp.vulnweb.com
```

**Salida esperada:**

```
testphp.vulnweb.com
Technologies:
 - Apache
 - PHP 5.2.17
 - Cookie-based session
```

---

### üîê ¬øPor qu√© es √∫til esto?

Detectar tecnolog√≠as vulnerables te permite:

‚úÖ Saber si hay versiones antiguas de WordPress, Joomla, etc.

‚úÖ Identificar servidores mal configurados (Apache/Nginx viejos)

‚úÖ Explorar posibles **CVE** para explotar

‚úÖ Ayuda a elegir herramientas de ataque m√°s precisas

---

### ‚úÖ Conclusi√≥n

| Herramienta    | Ideal para...                          |
| -------------- | -------------------------------------- |
| **WhatWeb**    | Escaneo r√°pido y personalizable        |
| **Webanalyze** | Detecci√≥n precisa basada en Wappalyzer |

Usar ambas te da una **visi√≥n completa de la superficie de ataque** de cualquier dominio.

---

[üîº](#√≠ndice)

---

## **331. Identificaci√≥n de contenido: Dirbuster**

### üß† ¬øQu√© es DirBuster?

**DirBuster** es una herramienta gr√°fica desarrollada por OWASP que permite realizar ataques de **fuerza bruta** sobre aplicaciones web para descubrir:

‚úÖ Directorios ocultos

‚úÖ Archivos sensibles (ej: `.bak`, `.php`, `.zip`, etc.)

‚úÖ Rutas no publicadas por el desarrollador

Esto se usa mucho en **pentesting** y **bug bounty** para descubrir:

- `/admin/`, `/backup/`, `/test/`, `/config.php`, etc.

---

### üß∞ ¬øC√≥mo funciona?

DirBuster lanza peticiones HTTP autom√°ticas a un dominio, probando **miles de rutas posibles** desde una **lista de palabras (wordlist)**.

Por ejemplo:

```
GET /admin/
GET /login/
GET /wp-admin/
GET /backup.zip
```

Y observa si recibe respuestas **200 OK** (¬°existe!) o **403 Forbidden** (tambi√©n √∫til), o **404 Not Found**.

---

### üõ†Ô∏è Instalaci√≥n de DirBuster

#### ‚úÖ En Kali Linux / Parrot OS

Ya viene preinstalado:

```bash
dirbuster
```

Si no lo tienes:

```bash
sudo apt update
sudo apt install dirbuster -y
```

---

#### ‚úÖ En otras distros (Ubuntu/Debian)

```bash
sudo apt install dirbuster -y
```

---

#### ‚úÖ En Windows

1. Necesitas tener **Java instalado**.

2. Descarga desde:
   üîó [https://sourceforge.net/projects/dirbuster/](https://sourceforge.net/projects/dirbuster/)

3. Descomprime el `.zip`

4. Ejecuta: `DirBuster-0.12.jar` con doble clic o por terminal:

```bash
java -jar DirBuster-0.12.jar
```

---

### üñ•Ô∏è Interfaz de DirBuster (explicaci√≥n paso a paso)

1. **Target URL**: escribe la direcci√≥n, por ejemplo:

   ```
   http://testphp.vulnweb.com/
   ```

2. **List-based brute force**: deja activado.

3. **File with list of dirs/files**:
   Usa una lista de palabras. Puedes usar:

   ```
   /usr/share/wordlists/dirb/common.txt
   ```

4. **Number of Threads**: cantidad de hilos simult√°neos.

   - 10 a 30 es seguro
   - Si subes m√°s, es m√°s r√°pido pero m√°s agresivo

5. Clic en **"Start"**

---

### üìà ¬øQu√© buscar en los resultados?

- Estado **200 OK** ‚Üí Existe
- Estado **403 Forbidden** ‚Üí Existe, pero no se permite acceder
- Estado **500** ‚Üí Posible error interno al acceder (interesante)
- Estado **301/302** ‚Üí Redirecci√≥n

---

### üìÇ Wordlists recomendadas

- `/usr/share/wordlists/dirb/common.txt`
- `/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt`
- Puedes usar las de SecLists:
  üîó [https://github.com/danielmiessler/SecLists](https://github.com/danielmiessler/SecLists)

---

### üß™ Ejemplo completo con DirBuster

#### üîç Escenario:

Vamos a probar en el sitio vulnerable de Acunetix:

üîó `http://testphp.vulnweb.com`

#### üõ†Ô∏è Configuraci√≥n:

| Campo                 | Valor                                                   |
| --------------------- | ------------------------------------------------------- |
| Target URL            | `http://testphp.vulnweb.com`                            |
| Threads               | `20`                                                    |
| Wordlist              | `/usr/share/wordlists/dirb/common.txt`                  |
| Scan Type             | List-based brute force                                  |
| File extension to add | (en blanco o agrega `.php,.html,.bak` si deseas probar) |

#### ‚ñ∂Ô∏è Iniciar escaneo

Clic en `Start`.

#### üìä Resultados esperados:

```
[+] /admin/
[+] /images/
[+] /cart.php
[+] /password.txt (‚Üê ¬°esto ser√≠a cr√≠tico!)
[403] /logs/ (existe pero no se puede acceder)
```

---

### üß† ¬øPor qu√© es importante DirBuster?

- Te ayuda a **descubrir partes no p√∫blicas** del sitio.
- Permite encontrar **archivos mal protegidos** (ej: contrase√±as, backups).
- Puede revelar **paneles de administraci√≥n** ocultos.
- Es √∫til en **fases de reconocimiento** antes de un ataque.

---

### ‚úÖ Recomendaciones

| Consejo                     | Explicaci√≥n                                    |
| --------------------------- | ---------------------------------------------- |
| Usa m√∫ltiples wordlists     | Algunas son comunes, otras m√°s avanzadas       |
| Revisa respuestas 403 y 401 | A veces son rutas reales protegidas            |
| No uses demasiados hilos    | Puede ser detectado como DoS o bloqueo por WAF |
| Guarda los resultados       | Puedes exportarlos en un `.csv` desde la GUI   |

---

### üîö Conclusi√≥n

DirBuster es una herramienta imprescindible en pentesting web:

- F√°cil de usar (GUI)
- Muy configurable
- Compatible con grandes wordlists
- Detecta rutas y archivos ocultos de forma eficiente

---

[üîº](#√≠ndice)

---

## **332. Gobuster y Seclists**

### üõ†Ô∏è **Gobuster y SecLists: Enumeraci√≥n de directorios web desde terminal**

---

#### üß† ¬øQu√© es **Gobuster**?

**Gobuster** es una herramienta de fuerza bruta muy r√°pida escrita en Go. Sirve para encontrar:

- Directorios o archivos ocultos en un sitio web
- Subdominios
- Recursos en buckets S3, DNS, etc.

Usa una **wordlist** para probar rutas como:

```
http://example.com/admin
http://example.com/login
http://example.com/backup.zip
```

Y nos dice cu√°les existen.

---

#### üìö ¬øQu√© son **SecLists**?

**SecLists** es una colecci√≥n enorme de wordlists (listas de palabras) para pruebas de seguridad, que incluye listas para:

- Fuerza bruta
- Directorios y archivos comunes
- Usuarios, contrase√±as
- Subdominios
- Fuzzing, payloads, etc.

Gobuster las usa para lanzar ataques efectivos.

---

### üß™ Ejemplo real:

**Objetivo:** encontrar rutas ocultas en una p√°gina vulnerable:
`http://testphp.vulnweb.com`

---

### üîß Instalaci√≥n paso a paso

#### ‚úÖ 1. Instalar Gobuster

##### En Kali Linux / Parrot OS:

Ya viene instalado. Si no:

```bash
sudo apt update
sudo apt install gobuster -y
```

##### En Ubuntu/Debian:

```bash
sudo apt install gobuster -y
```

##### En Arch:

```bash
sudo pacman -S gobuster
```

##### O compilar desde el c√≥digo:

```bash
go install github.com/OJ/gobuster/v3@latest
```

> Ejecutable quedar√° en: `$HOME/go/bin/gobuster`

---

#### ‚úÖ 2. Instalar SecLists

Clona el repositorio:

```bash
git clone https://github.com/danielmiessler/SecLists.git
```

Esto te dar√° muchas listas, por ejemplo:

```
SecLists/Discovery/Web-Content/common.txt
SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt
SecLists/Passwords/Common-Credentials/
```

---

### ‚öôÔ∏è Sintaxis b√°sica de Gobuster

```bash
gobuster dir -u <URL> -w <WORDLIST>
```

Opciones comunes:

| Opci√≥n | Explicaci√≥n                                 |
| ------ | ------------------------------------------- |
| `-u`   | URL objetivo (ej. `http://example.com`)     |
| `-w`   | Wordlist (ruta al archivo `.txt`)           |
| `-x`   | Extensiones a buscar (`php,html,txt`)       |
| `-t`   | N√∫mero de hilos                             |
| `-o`   | Archivo de salida                           |
| `-q`   | Modo silencioso (solo respuestas positivas) |

---

### ‚úÖ Ejemplo completo

```bash
gobuster dir -u http://testphp.vulnweb.com -w SecLists/Discovery/Web-Content/common.txt -t 30 -x php,txt,html -o resultado.txt
```

üîç Esto har√°:

- Probar rutas del wordlist `common.txt`
- Usar 30 hilos (m√°s r√°pido)
- Buscar rutas como `/admin.php`, `/login.txt`, etc.
- Guardar resultados en `resultado.txt`

---

#### üí° Resultado esperado:

```bash
/htdocs (Status: 403)
/admin (Status: 200)
/login.php (Status: 200)
/backup.zip (Status: 200)
/robots.txt (Status: 200)
```

Esto indica qu√© rutas existen, lo cual es √∫til para explotaci√≥n.

---

### üß† Consejos √∫tiles

| Consejo                  | Descripci√≥n                                                                |
| ------------------------ | -------------------------------------------------------------------------- |
| Usa varias wordlists     | Prueba `directory-list-2.3-medium.txt` o `big.txt` para mejores resultados |
| Filtra respuestas 403    | A veces son rutas protegidas que tambi√©n son interesantes                  |
| Guarda los resultados    | Usa `-o` para mantener un registro                                         |
| Usa en conjunto con Burp | Puedes validar rutas sospechosas con Burp Suite                            |

---

### üö® Precauci√≥n

- **No escanees sitios que no tengas permiso de auditar.**
- Esto puede causar **bloqueos**, especialmente si usas muchos hilos o atacas servidores reales sin autorizaci√≥n.

---

### ‚úÖ Resumen final

| Herramienta  | Prop√≥sito                                                             |
| ------------ | --------------------------------------------------------------------- |
| **Gobuster** | Escanear directorios ocultos en aplicaciones web                      |
| **SecLists** | Wordlists listas para usar (archivos, contrase√±as, subdominios, etc.) |

Juntos, son una combinaci√≥n poderosa para **reconocimiento web y pruebas de seguridad**.

---

[üîº](#√≠ndice)

---

## **333. An√°lisis de vulnerabilidades: OWASP ZAP Proxy**

### üß† ¬øQu√© es OWASP ZAP?

**OWASP ZAP (Zed Attack Proxy)** es una herramienta gratuita y de c√≥digo abierto desarrollada por OWASP para detectar vulnerabilidades en aplicaciones web. Act√∫a como un **proxy entre el navegador y el sitio web**, interceptando y analizando las peticiones y respuestas.

### üîí ¬øQu√© puede hacer ZAP?

- Escaneo autom√°tico de vulnerabilidades web
- Intercepci√≥n y modificaci√≥n de peticiones HTTP/S
- An√°lisis de contenido web
- Descubrimiento de endpoints ocultos
- Fuerza bruta de autenticaci√≥n
- Pruebas manuales de seguridad

---

### ‚úÖ Caracter√≠sticas principales

| Caracter√≠stica          | Descripci√≥n                                    |
| ----------------------- | ---------------------------------------------- |
| **Interceptar tr√°fico** | Puedes ver y modificar peticiones/respuestas   |
| **Scan activo/pasivo**  | Encuentra vulnerabilidades autom√°ticamente     |
| **Spider**              | Descubre rutas de una aplicaci√≥n               |
| **Fuzzer**              | Prueba entradas con m√∫ltiples datos maliciosos |
| **Scripting**           | Automatiza tareas personalizadas               |
| **Integraci√≥n**         | Compatible con CI/CD y otras herramientas      |

---

### üíª Instalaci√≥n de OWASP ZAP

#### ‚úÖ 1. Requisitos

- Java 8 o superior
- Sistema: Windows, Linux o macOS

#### ‚úÖ 2. M√©todos de instalaci√≥n

##### üîπ Opci√≥n 1: Instalador oficial (GUI)

1. Ve a la web oficial:
   üëâ [https://www.zaproxy.org/download/](https://www.zaproxy.org/download/)

2. Descarga la versi√≥n para tu sistema (Windows/Linux/macOS).

3. Inst√°lalo como cualquier otro programa.

##### üîπ Opci√≥n 2: Snap (Linux)

```bash
sudo snap install zaproxy --classic
```

##### üîπ Opci√≥n 3: Docker

```bash
docker run -u zap -p 8080:8080 -i owasp/zap2docker-stable zap.sh
```

---

### üîß Primeros pasos: configurando el proxy

#### Paso 1: Ejecuta OWASP ZAP

- Si est√°s en Linux, ejecuta:

```bash
zaproxy
```

- En Windows/macOS, abre el programa como cualquier aplicaci√≥n.

#### Paso 2: Configura tu navegador (Firefox recomendado)

1. Abre Firefox.
2. Ve a **Preferencias > Red > Configuraci√≥n**.
3. Cambia a:

   - **Servidor proxy HTTP**: `127.0.0.1`
   - **Puerto**: `8080`
   - Marca la opci√≥n ‚ÄúUsar este proxy para todos los protocolos‚Äù.

Esto hace que todo el tr√°fico pase por ZAP.

#### Paso 3: Visita cualquier web (por ejemplo `http://testphp.vulnweb.com`)

ZAP capturar√° y mostrar√° todas las peticiones HTTP.

---

### üöÄ Ejemplo completo: An√°lisis de vulnerabilidades

#### üéØ Objetivo: Escanear `http://testphp.vulnweb.com`

#### Paso 1: Spider (exploraci√≥n de rutas)

1. En ZAP, haz clic derecho sobre `http://testphp.vulnweb.com` en la columna izquierda.
2. Elige **Attack > Spider Site**.
3. Espera a que termine. Esto identifica todas las URLs de la p√°gina.

#### Paso 2: Escaneo pasivo (autom√°tico)

- Mientras navegas por la p√°gina con Firefox, ZAP detectar√° posibles vulnerabilidades autom√°ticamente (XSS, cookies inseguras, etc.).

#### Paso 3: Escaneo activo

1. Haz clic derecho en el sitio.
2. Selecciona **Attack > Active Scan**.
3. Inicia el escaneo. Esto realiza pruebas autom√°ticas activas (inyecci√≥n SQL, XSS, etc.).

#### Paso 4: Resultados

Ve a la pesta√±a **Alerts** y revisa los hallazgos. Por ejemplo:

| Tipo de vulnerabilidad | Descripci√≥n                                  |
| ---------------------- | -------------------------------------------- |
| Reflected XSS          | Entrada de usuario sin validaci√≥n            |
| SQL Injection          | Par√°metros vulnerables a inyecciones         |
| Insecure Cookies       | Cookies sin la bandera `HttpOnly` o `Secure` |
| Server Info Disclosure | Fugas de versi√≥n del servidor                |

---

### üß† Consejos de uso

| Consejo                      | Detalle                                               |
| ---------------------------- | ----------------------------------------------------- |
| No uses ZAP sin autorizaci√≥n | Puede ser detectado como ataque real                  |
| Usa Firefox o Chromium       | Son los m√°s compatibles                               |
| Automatiza con scripts       | Puedes usar Python o Groovy para escaneos programados |
| Puedes integrarlo a CI/CD    | Ideal para DevSecOps                                  |

---

### üß™ ¬øC√≥mo usar ZAP desde la terminal (modo headless)?

```bash
zap.sh -daemon -port 8080 -host 127.0.0.1 -config api.disablekey=true
```

Y luego escanear un sitio:

```bash
zap-cli --zap-url http://127.0.0.1 -p 8080 quick-scan --self-contained http://testphp.vulnweb.com
```

---

### ‚úÖ Resumen

| Elemento             | Descripci√≥n                                                               |
| -------------------- | ------------------------------------------------------------------------- |
| **Herramienta**      | OWASP ZAP Proxy                                                           |
| **Prop√≥sito**        | Detectar vulnerabilidades web                                             |
| **Instalaci√≥n**      | GUI, Snap, Docker                                                         |
| **Modo de uso**      | Proxy, Spider, Escaneo pasivo y activo                                    |
| **Recomendado para** | Pentesters, developers, bug bounty hunters, estudiantes de ciberseguridad |

---

[üîº](#√≠ndice)

---

## **334. Nikto y Skipfish**

### üîç ¬øQu√© son Nikto y Skipfish?

#### üõ†Ô∏è Nikto

- **Nikto** es un esc√°ner de servidores web de c√≥digo abierto.
- Busca **archivos peligrosos**, **configuraciones err√≥neas**, **versiones antiguas de software**, etc.
- Es **r√°pido, simple** y se usa desde la terminal.
- Desarrollado en **Perl**.

#### üõ†Ô∏è Skipfish

- **Skipfish** es un esc√°ner de seguridad web creado por Google.
- Usa t√©cnicas de **fuzzing inteligente** y mapea sitios web mientras analiza.
- Su salida es un **reporte HTML interactivo** muy completo.
- Est√° hecho en **C**, lo que lo hace r√°pido y eficiente.

---

### üß© Diferencias clave

| Herramienta  | Lenguaje | Salida        | Mejor para...            |
| ------------ | -------- | ------------- | ------------------------ |
| **Nikto**    | Perl     | Texto plano   | Detectar errores comunes |
| **Skipfish** | C        | Reportes HTML | Mapeo profundo y fuzzing |

---

### üß™ ¬øQu√© buscan Nikto y Skipfish?

- Directorios sensibles (`/admin`, `/phpmyadmin`)
- Archivos de backup (`index.php~`, `config.old`)
- Errores de seguridad (XSS, CSRF, SQLi en formularios)
- Versiones inseguras de software (Apache, PHP, WordPress)
- Cookies inseguras, cabeceras mal configuradas, etc.

---

### üñ•Ô∏è Instalaci√≥n paso a paso

#### üîß Nikto

##### ‚úÖ En Kali Linux / Debian

```bash
sudo apt update
sudo apt install nikto
```

##### ‚úÖ En cualquier Linux (desde GitHub)

```bash
git clone https://github.com/sullo/nikto.git
cd nikto/program
chmod +x nikto.pl
```

Puedes ejecutarlo con:

```bash
perl nikto.pl -h http://localhost
```

---

#### üîß Skipfish

##### ‚úÖ En Kali Linux

```bash
sudo apt update
sudo apt install skipfish
```

##### ‚úÖ En Ubuntu/Debian (manual)

```bash
sudo apt install git build-essential libidn11-dev libssl-dev
git clone https://github.com/spinkham/skipfish.git
cd skipfish
make
```

Para ejecutarlo:

```bash
./skipfish -o reporte http://localhost
```

---

### üöÄ Ejemplos pr√°cticos y f√°ciles

#### üß™ Ejemplo completo con **Nikto**

Escanear un servidor web (por ejemplo `http://testphp.vulnweb.com`):

```bash
nikto -h http://testphp.vulnweb.com
```

üîç **¬øQu√© ver√°s en los resultados?**

- Software detectado: Apache/2.2.8
- Directorios inseguros: `/admin`, `/uploads`
- Archivos p√∫blicos: `/test.php`, `/config.php.bak`
- Cabeceras mal configuradas: Falta de `X-Frame-Options`, `Strict-Transport-Security`, etc.

---

#### üß™ Ejemplo completo con **Skipfish**

Escanear el mismo sitio con Skipfish y generar reporte HTML:

```bash
skipfish -o resultado-skipfish http://testphp.vulnweb.com
```

üìÅ Se crear√° una carpeta `resultado-skipfish` con un archivo `index.html`. √Åbrelo en tu navegador.

üîç **¬øQu√© ver√°s en el reporte?**

- Mapa del sitio escaneado
- Posibles vulnerabilidades
- Entradas de formularios analizadas
- Seguridad de cookies
- Errores HTTP (403, 500, etc.)
- Sugerencias de mitigaci√≥n

---

### ‚úÖ Consejos de uso

| Consejo                       | Nikto | Skipfish         |
| ----------------------------- | ----- | ---------------- |
| R√°pido para checklist b√°sica  | ‚úÖ    | ‚ùå               |
| Requiere poco conocimiento    | ‚úÖ    | ‚ùå (m√°s t√©cnico) |
| Reporte gr√°fico y detallado   | ‚ùå    | ‚úÖ               |
| Ideal para bug bounty         | ‚úÖ    | ‚úÖ               |
| Analiza profundidad del sitio | ‚ùå    | ‚úÖ               |

---

### ‚ö†Ô∏è Precauciones

- Ambas herramientas pueden generar mucho tr√°fico: **NO las uses sin permiso.**
- Pueden ser detectadas por firewalls como comportamiento sospechoso.
- Usa un entorno de pruebas o laboratorios como:

  - `http://testphp.vulnweb.com`
  - `https://www.hackthebox.com/`
  - `https://www.tryhackme.com/`

---

### üìå Resumen

| Herramienta | Funci√≥n Principal   | Comando                             |
| ----------- | ------------------- | ----------------------------------- |
| Nikto       | Escaneo b√°sico web  | `nikto -h http://target`            |
| Skipfish    | Fuzzing + mapeo web | `skipfish -o carpeta http://target` |

---

[üîº](#√≠ndice)

---

## **335. Nuclei y Nuclei Templates**

### üß† ¬øQu√© es **Nuclei**?

**Nuclei** es una **herramienta de escaneo de vulnerabilidades** s√∫per r√°pida desarrollada por **ProjectDiscovery**. Escanea objetivos web (URLs, IPs, etc.) en busca de **vulnerabilidades conocidas**, **archivos sensibles**, **cabeceras mal configuradas**, etc.

üìå Lo m√°s poderoso de Nuclei es que usa **templates** (plantillas YAML) para definir **qu√© tipo de vulnerabilidades buscar**. T√∫ puedes usar miles ya creadas o escribir las tuyas.

---

### üì¶ ¬øQu√© son los **Nuclei Templates**?

- Son **archivos en YAML** que definen un patr√≥n de ataque o verificaci√≥n.
- Pueden detectar:

  - CVEs conocidas (como CVE-2023-XXXXX)
  - Exposici√≥n de archivos (`.env`, `.git`, `wp-config.php`)
  - Headers mal configurados (CORS, CSP, etc.)
  - Paneles admin, login, subdominios, etc.

üëâ Hay miles disponibles en el repositorio oficial:

[https://github.com/projectdiscovery/nuclei-templates](https://github.com/projectdiscovery/nuclei-templates)

---

### üõ†Ô∏è ¬øC√≥mo se instala **Nuclei**?

#### ‚úÖ En Kali Linux, Ubuntu, Debian o WSL (recomendado)

```bash
sudo apt update
sudo apt install git curl
```

#### üì• Instalar Nuclei (binario oficial)

```bash
curl -s https://api.github.com/repos/projectdiscovery/nuclei/releases/latest \
| grep "browser_download_url.*linux_amd64.zip" \
| cut -d '"' -f 4 \
| wget -i -

unzip nuclei_*_linux_amd64.zip
chmod +x nuclei
sudo mv nuclei /usr/local/bin/
```

‚úÖ Verifica instalaci√≥n:

```bash
nuclei -version
```

---

### üì¶ ¬øC√≥mo se instalan los **templates**?

Ejecuta el siguiente comando (solo la primera vez o cuando quieras actualizar):

```bash
nuclei -update-templates
```

Esto crea una carpeta en `~/.local/nuclei-templates/` con m√°s de **3000 plantillas** actualizadas desde GitHub.

---

### üöÄ Ejemplo completo y f√°cil de entender

#### üéØ Objetivo: Analizar un sitio web en busca de vulnerabilidades

Usaremos un sitio de pruebas: `http://testphp.vulnweb.com`

```bash
nuclei -u http://testphp.vulnweb.com
```

üîç Este comando:

- Escanea esa URL con las plantillas predeterminadas.
- Analiza vulnerabilidades b√°sicas: headers, archivos expuestos, etc.
- Muestra resultados directamente en la terminal.

---

#### üìÅ Resultado t√≠pico:

```bash
[info] [http] [exposure] .git folder found http://testphp.vulnweb.com/.git/
[low] [cve] Apache version outdated http://testphp.vulnweb.com/ [CVE-2017-3167]
[medium] [misconfiguration] X-Frame-Options header not set
```

---

### üß† ¬øY si quiero escanear con un tipo de plantilla espec√≠fico?

#### Escanear solo en busca de CVEs:

```bash
nuclei -u http://testphp.vulnweb.com -t cves/
```

#### Escanear con m√∫ltiples URLs desde archivo:

```bash
cat sitios.txt
```

```txt
https://midominio.com
https://empresa.com/login
```

```bash
nuclei -l sitios.txt
```

---

### üõ†Ô∏è Crear tu propia plantilla personalizada (opcional)

Ejemplo: verificar si una URL devuelve el header `X-Powered-By: PHP`

```yaml
id: custom-x-powered-check

info:
  name: Check X-Powered-By Header
  author: gussdev
  severity: info

requests:
  - method: GET
    path:
      - "{{BaseURL}}"
    matchers:
      - type: word
        part: header
        words:
          - "X-Powered-By: PHP"
```

Gu√°rdalo como `myheader.yaml` y ejecuta:

```bash
nuclei -u http://example.com -t myheader.yaml
```

---

### üí° Consejos √∫tiles

| Comando                    | Descripci√≥n                                |
| -------------------------- | ------------------------------------------ |
| `nuclei -update-templates` | Descarga las plantillas m√°s recientes      |
| `nuclei -t exposures/`     | Escanea solo por exposiciones              |
| `nuclei -l urls.txt`       | Escanea m√∫ltiples URLs desde archivo       |
| `nuclei -json`             | Salida en formato JSON (√∫til para scripts) |
| `nuclei -silent`           | Muestra solo hallazgos, sin logs           |

---

### üîê ‚ö†Ô∏è ¬øEs legal usar Nuclei?

‚úÖ **S√≠**, si:

- Lo usas con **permiso** (tu propia web o entorno de pruebas).
- No haces DoS o algo destructivo.

  ‚ùå **No**, si:

- Atacas objetivos sin autorizaci√≥n (es ilegal y anti√©tico).

---

### üß™ ¬øD√≥nde practicar legalmente?

- [https://testphp.vulnweb.com/](https://testphp.vulnweb.com/)
- [https://demo.testfire.net/](https://demo.testfire.net/)
- [https://tryhackme.com/](https://tryhackme.com/)
- [https://www.hackthebox.com/](https://www.hackthebox.com/)

---

### üßæ Resumen

| Herramienta | Funci√≥n                                                       | Tipo de salida |
| ----------- | ------------------------------------------------------------- | -------------- |
| Nuclei      | Esc√°ner web de vulnerabilidades basado en plantillas YAML     | Consola, JSON  |
| Templates   | Plantillas que definen qu√© buscar (CVE, leaks, headers, etc.) | Actualizables  |

---

[üîº](#√≠ndice)

---

## **336. Fuzzing b√°sico con ffuf**

### üß† ¬øQu√© es FFUF?

**FFUF (Fuzz Faster U Fool)** es una herramienta de l√≠nea de comandos para hacer **fuzzing** de contenido web. Su prop√≥sito principal es:

- Descubrir **archivos y directorios ocultos** en un sitio web.
- Buscar **par√°metros** o **subdominios** v√°lidos.
- Hacer pruebas de fuerza bruta sobre APIs, rutas REST, etc.

---

### üõ†Ô∏è Instalaci√≥n de FFUF

#### ‚úÖ En Kali Linux (ya viene instalado en versiones nuevas)

Verifica con:

```bash
ffuf -h
```

#### üêß En Ubuntu/Debian o WSL

1. Instala `Go` (lenguaje en el que est√° escrito ffuf):

```bash
sudo apt update
sudo apt install golang -y
```

2. Instala `ffuf` desde GitHub:

```bash
go install github.com/ffuf/ffuf/v2@latest
```

3. Agrega `ffuf` al PATH:

```bash
echo 'export PATH=$PATH:$(go env GOPATH)/bin' >> ~/.bashrc
source ~/.bashrc
```

‚úÖ Ahora puedes usarlo con:

```bash
ffuf -h
```

---

### üìÅ ¬øQu√© necesitas para hacer fuzzing?

1. Un sitio web objetivo.
2. Una **wordlist** (lista de palabras) para probar.
   Ejemplo: `/usr/share/seclists/Discovery/Web-Content/common.txt`

   Instala seclists (si no lo tienes):

   ```bash
   sudo apt install seclists
   ```

---

### üöÄ Ejemplo b√°sico de Fuzzing con FFUF

#### üéØ Objetivo: Encontrar rutas ocultas en un sitio de pruebas

Usaremos: `http://testphp.vulnweb.com`

```bash
ffuf -u http://testphp.vulnweb.com/FUZZ -w /usr/share/seclists/Discovery/Web-Content/common.txt
```

üìå Qu√© significa:

| Opci√≥n | Significado                                                                      |
| ------ | -------------------------------------------------------------------------------- |
| `-u`   | URL objetivo. La palabra **FUZZ** ser√° reemplazada por cada palabra de la lista. |
| `-w`   | Wordlist usada.                                                                  |

#### üñ•Ô∏è Resultado esperado:

```bash
/backup              [Status: 403, Size: 279]
/admin               [Status: 200, Size: 4112]
/uploads             [Status: 200, Size: 1992]
```

üí° Esto significa que `/admin` y `/uploads` son rutas v√°lidas que **no estaban enlazadas directamente** en la web.

---

### üìÑ Otros ejemplos √∫tiles

#### üîπ Buscar archivos `.php` ocultos:

```bash
ffuf -u http://target.com/FUZZ.php -w /usr/share/seclists/Discovery/Web-Content/common.txt
```

#### üîπ Fuzzing en par√°metros GET (por ejemplo: `?id=FUZZ`):

```bash
ffuf -u "http://target.com/page.php?id=FUZZ" -w /usr/share/seclists/Fuzzing/1000-common-words.txt
```

#### üîπ Filtrar por c√≥digo de respuesta

```bash
ffuf -u http://target.com/FUZZ -w wordlist.txt -fc 404
```

Esto oculta todas las respuestas con c√≥digo 404.

---

### üí¨ Personaliza la salida

- `-t`: cantidad de hilos (m√°s r√°pido): `-t 100`
- `-mc`: filtrar por c√≥digo de respuesta (match code): `-mc 200`
- `-of json`: salida en formato JSON para usar en scripts

---

### üß™ Sitios para practicar legalmente

- [http://testphp.vulnweb.com/](http://testphp.vulnweb.com/)
- [http://dvwa.local](http://dvwa.local) (si instalas DVWA en local)
- [https://portswigger.net/web-security/](https://portswigger.net/web-security/) (laboratorios gratuitos)
- [https://tryhackme.com/](https://tryhackme.com/) y [https://hackthebox.com/](https://hackthebox.com/)

---

### üßæ Resumen

| Herramienta    | FFUF                                                                         |
| -------------- | ---------------------------------------------------------------------------- |
| Prop√≥sito      | Fuzzing de rutas, archivos, par√°metros web                                   |
| Instalaci√≥n    | `go install github.com/ffuf/ffuf/v2@latest`                                  |
| Wordlists      | Usa Seclists (com√∫n: `/usr/share/seclists/Discovery/Web-Content/common.txt`) |
| Comando b√°sico | `ffuf -u http://site.com/FUZZ -w wordlist.txt`                               |

---

[üîº](#√≠ndice)

---

## **337. Fuzzing avanzado con ffuf**

### üß† ¬øQu√© es el fuzzing avanzado?

El **fuzzing avanzado** con `ffuf` no solo implica buscar directorios o archivos, sino tambi√©n:

- üîç Encontrar **par√°metros ocultos**.
- üåê Descubrir **subdominios**.
- üìÇ Buscar archivos con extensiones espec√≠ficas.
- üí¨ Atacar **puntos m√∫ltiples** en una sola URL (`-input-cmd`, `-request`, `-request-proto`).
- üîê Bypass de m√©todos HTTP, cabeceras, y m√°s.

---

### üõ†Ô∏è Instalaci√≥n de FFUF

#### En Kali Linux (ya viene preinstalado):

```bash
ffuf -h
```

#### En Ubuntu/Debian:

1. Instala Go:

```bash
sudo apt install golang -y
```

2. Instala ffuf:

```bash
go install github.com/ffuf/ffuf/v2@latest
```

3. Agrega ffuf al PATH:

```bash
echo 'export PATH=$PATH:$(go env GOPATH)/bin' >> ~/.bashrc
source ~/.bashrc
```

‚úÖ Ahora puedes usar `ffuf`.

---

### üìÅ Wordlists recomendadas

Instala Seclists si no lo tienes:

```bash
sudo apt install seclists
```

Ubicaci√≥n: `/usr/share/seclists/`

---

### üß™ 1. Fuzzing avanzado de **par√°metros GET**

#### Objetivo: descubrir par√°metros ocultos como `?page=`, `?id=`, `?file=`, etc.

```bash
ffuf -u "http://target.com/index.php?FUZZ=test" -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt -fs 0
```

| Opci√≥n  | Significado                                                                          |
| ------- | ------------------------------------------------------------------------------------ |
| `FUZZ`  | Lugar a reemplazar con cada palabra                                                  |
| `-fs 0` | Filtra respuestas del mismo tama√±o que 0 bytes (√∫til para ignorar respuestas vac√≠as) |

---

### üß™ 2. Fuzzing de archivos con extensi√≥n

Buscar archivos `.php`, `.bak`, `.zip`, `.old`, etc.:

```bash
ffuf -u "http://target.com/FUZZ" -w /usr/share/seclists/Discovery/Web-Content/raft-small-files.txt -e .php,.bak,.zip,.old -fc 404
```

| Bandera   | Explicaci√≥n                                      |
| --------- | ------------------------------------------------ |
| `-e`      | A√±ade extensiones a cada palabra del diccionario |
| `-fc 404` | Oculta respuestas con c√≥digo 404                 |

---

### üß™ 3. Fuzzing de subdominios

Buscar subdominios v√°lidos con ffuf:

```bash
ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -u http://FUZZ.target.com -fs 0
```

‚ö†Ô∏è Necesitas que el dominio tenga wildcard DNS desactivado o usar una herramienta combinada con `dnsx`.

---

### üß™ 4. Fuzzing doble: m√∫ltiples puntos `-w` (par√°metro y valor)

#### Objetivo: probar combinaciones de par√°metro y valor

```bash
ffuf -u "http://target.com/index.php?PARAM=VALUE" -w paramlist.txt:PARAM -w valuelist.txt:VALUE -fs 0
```

üìÅ `paramlist.txt`:

```
id
page
file
```

üìÅ `valuelist.txt`:

```
1
admin
index.html
```

Esto generar√° peticiones como:

- `index.php?id=1`
- `index.php?page=admin`
- `index.php=file=index.html`

---

### üß™ 5. Fuzzing de m√©todos HTTP

Buscar m√©todos habilitados como `PUT`, `DELETE`, `OPTIONS`, etc.

```bash
ffuf -X FUZZ -u http://target.com/index.php -w /usr/share/seclists/Discovery/Web-Content/web-methods.txt -mc 200,403
```

üìÅ `web-methods.txt` puede contener:

```
GET
POST
PUT
DELETE
OPTIONS
HEAD
```

---

### üß™ 6. Fuzzing con cabeceras personalizadas (bypass)

#### Ejemplo: intentar bypass con cabecera `X-Original-URL`

```bash
ffuf -w /usr/share/seclists/Discovery/Web-Content/common.txt -u http://target.com/ -H "X-Original-URL: /FUZZ" -fs 0
```

Esto intenta acceder a `/admin` por medio de la cabecera en lugar de la URL directa.

---

### üß™ 7. Fuzzing con un archivo de petici√≥n raw

Si capturas una petici√≥n con Burp Suite, puedes guardarla como `.txt` y hacer fuzzing sobre ella.

1. Guarda la petici√≥n como `request.txt`, reemplaza valores con `FUZZ`.

2. Ejecuta:

```bash
ffuf -request request.txt -w wordlist.txt -input-cmd FUZZ
```

---

### üìå Ejemplo completo final

#### Objetivo: buscar archivos `.php`, `.bak`, `.zip` ocultos en un sitio vulnerable

```bash
ffuf -u http://testphp.vulnweb.com/FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-small-files.txt -e .php,.bak,.zip -fc 404 -t 50
```

- Descubre archivos como:

  - `login.php`
  - `config.bak`
  - `backup.zip`

---

### üéì Resumen

| Caracter√≠stica                | Uso                                   |
| ----------------------------- | ------------------------------------- |
| Fuzzing de par√°metros         | `http://site.com/index.php?FUZZ=test` |
| Subdominios                   | `http://FUZZ.site.com`                |
| Archivos con extensi√≥n        | `FUZZ.php`, `FUZZ.bak`, etc.          |
| Fuzzing doble (param y valor) | `?PARAM=VALUE`                        |
| M√©todos HTTP                  | `-X FUZZ`                             |
| Cabeceras personalizadas      | `-H "Header: FUZZ"`                   |
| Petici√≥n raw                  | `-request request.txt`                |

---

[üîº](#√≠ndice)

---

## **338. Explotaci√≥n: Commix**

### üß® Explotaci√≥n: **Commix (Command Injection Exploiter)**

---

### üß† ¬øQu√© es Commix?

**Commix (Command Injection Exploiter)** es una herramienta automatizada escrita en Python que permite detectar y explotar **vulnerabilidades de inyecci√≥n de comandos del sistema operativo** (OS Command Injection) en aplicaciones web.

Una inyecci√≥n de comandos ocurre cuando una aplicaci√≥n web **pasa datos del usuario a un comando del sistema operativo**, sin validarlos adecuadamente. Esto puede permitirle a un atacante ejecutar comandos arbitrarios en el sistema.

---

### üì• Instalaci√≥n de Commix

#### üîß Requisitos previos

- Python 3.x
- Git

#### üìå Instalaci√≥n en Kali Linux (ya viene instalado normalmente):

```bash
commix --help
```

Si no est√° instalado, haz esto:

#### üíª En Ubuntu / Debian

```bash
sudo apt update
sudo apt install git python3 -y
git clone https://github.com/commixproject/commix.git
cd commix
sudo python3 commix.py --help
```

Puedes dejarlo accesible globalmente con un alias:

```bash
echo "alias commix='python3 ~/commix/commix.py'" >> ~/.bashrc
source ~/.bashrc
```

---

### üîç ¬øC√≥mo funciona?

Commix **automatiza el proceso de inyecci√≥n de comandos**. Tiene varios modos de ataque y opciones, incluyendo:

- Inyecci√≥n directa (`GET`, `POST`, `Cookie`, etc.)
- Auto detecci√≥n de par√°metros vulnerables
- Shell interactiva si logra explotar
- Soporte para cookies y autenticaci√≥n
- Comandos personalizados

---

### üéØ Escenario b√°sico de ejemplo

Supongamos que tenemos una URL vulnerable como:

```
http://vulnerable.com/page.php?user=juan
```

Y el par√°metro `user` no est√° filtrado y permite ejecutar comandos, como:

```
http://vulnerable.com/page.php?user=juan;ls
```

Commix puede detectar esto y automatizar el ataque.

---

### üöÄ Uso b√°sico de Commix

```bash
python3 commix.py -u "http://vulnerable.com/page.php?user=juan"
```

Si hay vulnerabilidad, obtendr√°s una shell tipo:

```
commix(os-shell) >
```

Ejecuta comandos como:

```
whoami
ls -la
```

---

### ‚öôÔ∏è Opciones √∫tiles

| Opci√≥n        | Significado                                |
| ------------- | ------------------------------------------ |
| `--cookie`    | Pasar cookies si necesitas sesi√≥n          |
| `--data`      | Para inyecci√≥n en formularios POST         |
| `--os-cmd`    | Ejecutar un comando directamente           |
| `--os-shell`  | Acceder a una shell remota                 |
| `--force-ssl` | Si el sitio est√° en HTTPS                  |
| `--auth-type` | Autenticaci√≥n b√°sica, NTLM, etc.           |
| `--technique` | Limitar tipo de inyecci√≥n (`T`, `R`, etc.) |

---

#### üß™ Ejemplo 1: Inyecci√≥n en par√°metro GET

```bash
python3 commix.py -u "http://testphp.vulnweb.com/artists.php?artist=1"
```

Este sitio es vulnerable a inyecciones.

---

#### üß™ Ejemplo 2: Inyecci√≥n en formulario POST

Si est√°s atacando un formulario con `user` y `pass`, puedes usar:

```bash
python3 commix.py --url "http://target.com/login.php" --data "user=admin&pass=test"
```

Si `user` o `pass` es vulnerable, Commix lo detectar√°.

---

#### üß™ Ejemplo 3: Uso con cookies

```bash
python3 commix.py -u "http://target.com/panel.php?id=1" --cookie="PHPSESSID=abcd1234"
```

---

#### üß™ Ejemplo 4: Ejecutar un comando directamente

```bash
python3 commix.py -u "http://target.com/item.php?id=5" --os-cmd whoami
```

---

### üõ°Ô∏è ¬øC√≥mo evitar estas vulnerabilidades?

- Nunca ejecutar comandos con entradas del usuario.
- Usar funciones seguras (`subprocess.run()` con `shell=False` en Python).
- Validar, filtrar y sanitizar todos los inputs del usuario.
- Aplicar pol√≠ticas de m√≠nimo privilegio al servidor web.

---

### üß© Ejemplo completo final: DVWA

1. Instala DVWA (Damn Vulnerable Web Application) con Docker:

```bash
git clone https://github.com/digininja/DVWA
cd DVWA
sudo docker build -t dvwa .
sudo docker run -it -p 80:80 dvwa
```

2. Accede a: `http://localhost/setup.php`, configura y crea la DB.

3. En el panel, ve a ‚ÄúCommand Injection‚Äù.

4. Prueba con Commix:

```bash
python3 commix.py -u "http://localhost/vulnerabilities/exec/?ip=127.0.0.1&Submit=Submit"
```

5. Si todo va bien, tendr√°s una shell del servidor web.

---

### üß† Conclusi√≥n

‚úÖ **Commix** es ideal para detectar y explotar **inyecciones de comandos**, pero √∫salo √∫nicamente en entornos autorizados o de laboratorio.

---

[üîº](#√≠ndice)

---

## **339. Unas palabras sobre la fase de explotaci√≥n**

### üß† ¬øQu√© es la Fase de Explotaci√≥n?

La **fase de explotaci√≥n** es una de las etapas m√°s cr√≠ticas durante una auditor√≠a de seguridad o un pentest (test de penetraci√≥n). Consiste en **aprovechar una vulnerabilidad detectada** para **obtener acceso** no autorizado o control sobre un sistema, servicio o aplicaci√≥n.

En resumen:

> üéØ **Objetivo**: Lograr acceso (inicial o extendido) explotando una debilidad real en el objetivo.

---

### üõ†Ô∏è ¬øQu√© tipo de vulnerabilidades se explotan?

Algunos ejemplos comunes incluyen:

| Tipo de vulnerabilidad                        | ¬øQu√© permite hacer?                          |
| --------------------------------------------- | -------------------------------------------- |
| **Inyecci√≥n SQL**                             | Acceder o modificar una base de datos.       |
| **Inyecci√≥n de comandos (Command Injection)** | Ejecutar comandos en el sistema operativo.   |
| **Fallas en autenticaci√≥n**                   | Saltarse logins o acceder como otro usuario. |
| **RCE (Remote Code Execution)**               | Ejecutar c√≥digo remoto en el servidor.       |
| **Desbordamiento de b√∫fer**                   | Tomar control del flujo de un programa.      |
| **Cross-Site Scripting (XSS)**                | Inyectar scripts en navegadores.             |
| **Inyecciones en LDAP, XML, etc.**            | Manipular funciones internas.                |

---

### üß™ Herramientas comunes en la explotaci√≥n

- **Metasploit Framework**
- **Commix** (para command injection)
- **SQLMap** (para SQL injection)
- **Rubeus / Mimikatz** (en entornos Windows/AD)
- **Burp Suite** (para explotar vulnerabilidades web)
- **Exploit-DB** (para buscar exploits p√∫blicos)

---

### ‚ö†Ô∏è Consideraciones √âticas

Antes de explotar una vulnerabilidad:

- üìú Debes tener **permiso legal** (auditor√≠a contratada, CTF, laboratorio propio).
- üíæ Debes **documentar** cuidadosamente lo que explotas.
- üßº Intenta minimizar el impacto (no borres archivos ni afectes usuarios reales).
- ‚è±Ô∏è Planea qu√© hacer tras la explotaci√≥n: ¬øelevar privilegios?, ¬ømovimiento lateral?, ¬øpersistencia?

---

### üîß Instalaci√≥n de una herramienta de explotaci√≥n: **Metasploit**

Metasploit es el marco m√°s conocido para explotaci√≥n.

#### ‚úÖ En Kali Linux ya viene instalado

Solo corre:

```bash
msfconsole
```

#### üêß En Ubuntu / Debian

```bash
sudo apt update
sudo apt install metasploit-framework -y
msfconsole
```

#### üê≥ Con Docker

```bash
docker pull metasploitframework/metasploit-framework
docker run -it metasploitframework/metasploit-framework
```

---

### üéØ Ejemplo completo: Explotar una vulnerabilidad real en DVWA (Damn Vulnerable Web App)

#### 1. Instala DVWA en local (con Docker)

```bash
git clone https://github.com/digininja/DVWA.git
cd DVWA
docker-compose up -d
```

Accede en tu navegador a `http://localhost` y configura la base de datos desde `http://localhost/setup.php`.

#### 2. Activa el nivel de seguridad en **"Low"**.

#### 3. Inyecci√≥n de comandos en la secci√≥n **"Command Injection"**

En el input, pon:

```
127.0.0.1; whoami
```

Ver√°s el resultado del comando inyectado.

#### 4. Explotaci√≥n con Commix (opcional)

```bash
python3 commix.py -u "http://localhost/vulnerabilities/exec/?ip=127.0.0.1&Submit=Submit"
```

Y si es vulnerable, podr√°s ejecutar comandos como:

```bash
ls
cat /etc/passwd
```

---

### üß† ¬øQu√© pasa despu√©s?

Una vez explotada la vulnerabilidad, las fases siguientes podr√≠an ser:

- **Post-explotaci√≥n**: Obtener m√°s informaci√≥n del sistema, usuarios, contrase√±as.
- **Elevaci√≥n de privilegios**: Convertirte en administrador/root.
- **Persistencia**: Dejar puertas traseras o crear usuarios ocultos.
- **Movimiento lateral**: Saltar a otros sistemas de la red.
- **Extracci√≥n de datos (exfiltraci√≥n)**: Descargar informaci√≥n sensible.

---

### üßæ Resumen

| Paso                                   | Descripci√≥n               |
| -------------------------------------- | ------------------------- |
| 1Ô∏è‚É£ Identificar vulnerabilidad          | Inyecci√≥n, RCE, etc.      |
| 2Ô∏è‚É£ Verificar que se pueda explotar     | Manual o con herramientas |
| 3Ô∏è‚É£ Ejecutar c√≥digo o comando malicioso | Gana acceso               |
| 4Ô∏è‚É£ Obtener control o m√°s informaci√≥n   | Shell, datos, privilegios |
| 5Ô∏è‚É£ Documentar todo                     | Para el reporte final     |

---

### ‚úÖ Conclusi√≥n

- La fase de explotaci√≥n es **clave para demostrar el impacto real** de una vulnerabilidad.
- Debe hacerse de forma **controlada y √©tica**.
- Herramientas como **Metasploit**, **Commix**, **SQLMap** o **Burp Suite** son tus mejores aliadas.
- El objetivo no es destruir, sino aprender y fortalecer la seguridad.

---

[üîº](#√≠ndice)

---

## **340. Changeme, Gitleaks y CyberChef**

### 1. üîê **Changeme**

#### ¬øQu√© es?

Changeme es una herramienta dise√±ada para **detectar credenciales por defecto** en dispositivos y servicios (como routers, servidores web, bases de datos, etc.). Sirve para pentesters que quieren saber si alguien dej√≥ una contrase√±a como `admin:admin` o `root:toor`.

---

#### üîß Instalaci√≥n

**Requisitos**: Python 3 y Git.

```bash
git clone https://github.com/ztgrace/changeme.git
cd changeme
pip3 install -r requirements.txt
```

Luego puedes ejecutar:

```bash
python3 changeme/changeme.py -h
```

---

#### üéØ Ejemplo f√°cil

```bash
python3 changeme/changeme.py -t http://192.168.1.1
```

> Esto intenta acceder al panel web del router con contrase√±as por defecto. Si entra, ¬°lo detectar√°!

---

#### 2. üîç **Gitleaks**

#### ¬øQu√© es?

Gitleaks es una herramienta que **busca secretos filtrados** en repositorios Git, como:

- Claves API
- Tokens
- Contrase√±as
- Claves privadas SSH
- AWS secrets, etc.

Ideal para Bug Bounty y revisiones de c√≥digo.

---

#### üîß Instalaci√≥n

##### ‚úÖ En Linux o Mac (v√≠a curl):

```bash
curl -sSL https://github.com/gitleaks/gitleaks/releases/latest/download/gitleaks-linux-amd64 -o gitleaks
chmod +x gitleaks
sudo mv gitleaks /usr/local/bin/
```

##### ‚úÖ En Windows

1. Descarga el binario desde: [https://github.com/gitleaks/gitleaks/releases](https://github.com/gitleaks/gitleaks/releases)
2. Agrega el binario a tu `PATH`.

---

#### üéØ Ejemplo f√°cil

Analizar un repo local:

```bash
gitleaks detect --source .
```

Analizar un repo remoto:

```bash
gitleaks detect --source https://github.com/usuario/repositorio.git
```

> Si hay secretos filtrados, te los mostrar√° con el tipo, l√≠nea y archivo.

---

### 3. üßô‚Äç‚ôÇÔ∏è **CyberChef**

#### ¬øQu√© es?

CyberChef es una herramienta web de an√°lisis y transformaci√≥n de datos. Permite:

- Decodificar base64, JWT, hashes, etc.
- Desencriptar AES/RC4
- Buscar patrones
- Convertir entre formatos

> ¬°Como un "cuchillo suizo" de datos para forense y CTF!

---

#### üîß ¬øC√≥mo se instala?

CyberChef es una **webapp est√°tica**, as√≠ que puedes usarla online o instalarla localmente.

##### ‚úÖ Opci√≥n 1: Usar online

üëâ [https://gchq.github.io/CyberChef/](https://gchq.github.io/CyberChef/)

##### ‚úÖ Opci√≥n 2: Instalar local

```bash
git clone https://github.com/gchq/CyberChef.git
cd CyberChef
npm install
npm run build
```

Luego abre `CyberChef/dist/index.html` en tu navegador.

---

#### üéØ Ejemplo f√°cil

Sup√≥n que tienes esta cadena:

```
U29tZSBzZWNyZXQgdGV4dA==
```

Esto es **Base64**.

1. Ve a CyberChef.
2. Arrastra "From Base64" al panel de recetas.
3. Pega la cadena en el input.

‚úîÔ∏è Resultado: `Some secret text`

---

### üß™ Ejemplo completo integrando las 3 herramientas

#### Escenario:

Eres un pentester y:

1. Accediste a un router en `192.168.1.1`.
2. Encontraste un repositorio Git en `/var/www/html/.git`.
3. Extrajiste los datos y encontraste cadenas sospechosas.

#### Paso a paso:

##### 1. **Detectar credenciales por defecto**

```bash
python3 changeme/changeme.py -t http://192.168.1.1
```

Resultado: `‚úì Default credentials found: admin:admin`

##### 2. **Escanear el repo con Gitleaks**

```bash
gitleaks detect --source ./repositorio-extraido/
```

Resultado: Encontr√≥ una clave AWS y un token JWT.

##### 3. **Analizar el token en CyberChef**

- Usa ‚ÄúJWT Decode‚Äù o ‚ÄúFrom Base64‚Äù.
- Verifica si hay credenciales embebidas o datos de usuario.

---

### ‚úÖ Conclusi√≥n

| Herramienta | Para qu√© sirve                          | Ideal para                        |
| ----------- | --------------------------------------- | --------------------------------- |
| Changeme    | Detectar credenciales por defecto       | Pentest de redes, IoT, servidores |
| Gitleaks    | Buscar secretos en c√≥digo Git           | Bug Bounty, devsecops             |
| CyberChef   | Analizar, decodificar y convertir datos | Forense digital, CTF, reversing   |

---

[üîº](#√≠ndice)

---

| **Inicio**         | **atr√°s 3**                                                  | **Siguiente 5**                                |
| ------------------ | ------------------------------------------------------------ | ---------------------------------------------- |
| [üè†](../README.md) | [‚è™](./5_3_Acceso_a_credenciales_y_movimientos_laterales.md) | [‚è©](./5_5_Deteccion_y_Evasion_de_defensas.md) |
